<!DOCTYPE html><html lang='en'><head><title>[module.unit]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>10</a> Modules <a class='abbr_ref' href='./#module'>[module]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>10.1</a> Module units and purviews <a class='abbr_ref'>[module.unit]</a></h2><pre class='bnf'><a class='nontermdef' href='#nt:module-declaration' id='nt:module-declaration'>module-declaration</a><span class='ntdefcolon'>:</span>
&#9;export-keyword<span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> module-keyword <a class='grammarterm' href='#nt:module-name'>module-name</a> <a class='grammarterm' href='#nt:module-partition'>module-partition</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <a class='grammarterm' href='dcl.attr.grammar#nt:attribute-specifier-seq'>attribute-specifier-seq</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'>;</span>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:module-name' id='nt:module-name'>module-name</a><span class='ntdefcolon'>:</span>
&#9;<a class='grammarterm' href='#nt:module-name-qualifier'>module-name-qualifier</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <a class='grammarterm' href='lex.name#nt:identifier'>identifier</a>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:module-partition' id='nt:module-partition'>module-partition</a><span class='ntdefcolon'>:</span>
&#9;<span class='terminal'><span class='operator'>:</span></span> <a class='grammarterm' href='#nt:module-name-qualifier'>module-name-qualifier</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <a class='grammarterm' href='lex.name#nt:identifier'>identifier</a>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:module-name-qualifier' id='nt:module-name-qualifier'>module-name-qualifier</a><span class='ntdefcolon'>:</span>
&#9;<a class='grammarterm' href='lex.name#nt:identifier'>identifier</a> <span class='terminal'><span class='operator'>.</span></span>
&#9;<a class='grammarterm' href='#nt:module-name-qualifier'>module-name-qualifier</a> <a class='grammarterm' href='lex.name#nt:identifier'>identifier</a> <span class='terminal'><span class='operator'>.</span></span>
</pre><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/modules.tex#L29'>#</a></div><div id='1.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:module_unit' id='def:module_unit'><i >module unit</i></a> is a translation unit that contains
a <a class='grammarterm' href='#nt:module-declaration'>module-declaration</a><a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>A <a class='hidden_link' href='#def:module,named' id='def:module,named'><i >named module</i></a> is the
collection of module units with the same <a class='grammarterm' href='#nt:module-name'>module-name</a><a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='1.sentence-3' class='sentence'>The identifiers <span class='texttt'><span class='keyword'>module</span></span> and <span class='texttt'><span class='keyword'>import</span></span>
shall not appear as <a class='grammarterm' href='lex.name#nt:identifier'>identifier</a><span class='textit'>s</span>
in a <a class='grammarterm' href='#nt:module-name'>module-name</a> or <a class='grammarterm' href='#nt:module-partition'>module-partition</a><a class='hidden_link' href='#1.sentence-3'>.</a></div> <div id='1.sentence-4' class='sentence'><span class='indexparent'><a class='index' id=':module,reserved_name_of'></a></span>All <a class='grammarterm' href='#nt:module-name'>module-name</a><span class='textit'>s</span> either beginning with an <a class='grammarterm' href='lex.name#nt:identifier'>identifier</a>
consisting of <span class='texttt'>std</span> followed by zero or more <a class='grammarterm' href='lex.name#nt:digit'>digit</a><span class='textit'>s</span> or
containing a reserved identifier (<a href='lex.name'>[lex.name]</a>)
are reserved and shall not be specified in a <a class='grammarterm' href='#nt:module-declaration'>module-declaration</a>;
no diagnostic is required<a class='hidden_link' href='#1.sentence-4'>.</a></div> <div id='1.sentence-5' class='sentence'>If any <a class='grammarterm' href='lex.name#nt:identifier'>identifier</a> in a reserved <a class='grammarterm' href='#nt:module-name'>module-name</a>
is a reserved identifier,
the module name is reserved for use by C++ implementations;
otherwise it is reserved for future standardization<a class='hidden_link' href='#1.sentence-5'>.</a></div> <div id='1.sentence-6' class='sentence'>The optional <a class='grammarterm' href='dcl.attr.grammar#nt:attribute-specifier-seq'>attribute-specifier-seq</a>
appertains to the <a class='grammarterm' href='#nt:module-declaration'>module-declaration</a><a class='hidden_link' href='#1.sentence-6'>.</a></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/modules.tex#L50'>#</a></div><div id='2.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:module_interface_unit' id='def:module_interface_unit'><i >module interface unit</i></a> is a module unit whose
<a class='grammarterm' href='#nt:module-declaration'>module-declaration</a> starts with <span class='grammarterm'>export-keyword</span>;
any other module unit is a <a class='hidden_link' href='#def:module_implementation_unit' id='def:module_implementation_unit'><i >module implementation unit</i></a><a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'>A named module shall contain exactly one module interface unit
with no <a class='grammarterm' href='#nt:module-partition'>module-partition</a>, known as the
<a class='hidden_link' href='#def:primary_module_interface_unit' id='def:primary_module_interface_unit'><i >primary module interface unit</i></a> of the module;
no diagnostic is required<a class='hidden_link' href='#2.sentence-2'>.</a></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/modules.tex#L59'>#</a></div><div id='3.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:module_partition' id='def:module_partition'><i >module partition</i></a> is
a module unit whose <a class='grammarterm' href='#nt:module-declaration'>module-declaration</a> contains
a <a class='grammarterm' href='#nt:module-partition'>module-partition</a><a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='3.sentence-2' class='sentence'>A named module shall not contain multiple module partitions with
the same <a class='grammarterm' href='#nt:module-partition'>module-partition</a><a class='hidden_link' href='#3.sentence-2'>.</a></div> <div id='3.sentence-3' class='sentence'>All module partitions of a module
that are module interface units
shall be directly or indirectly exported
by the primary module interface unit (<a href='module.import'>[module.import]</a>)<a class='hidden_link' href='#3.sentence-3'>.</a></div> <div id='3.sentence-4' class='sentence'>No diagnostic is required for a violation of these rules<a class='hidden_link' href='#3.sentence-4'>.</a></div> <div id='3.note-1' class='note'>[&nbsp;<a class='note_link' href='#3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='3.sentence-5' class='sentence'>Module partitions can be imported only by
other module units in the same module<a class='hidden_link' href='#3.sentence-5'>.</a></div> <div id='3.sentence-6' class='sentence'>The division of a module into module units
is not visible outside the module<a class='hidden_link' href='#3.sentence-6'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/modules.tex#L77'>#</a></div><div id='4.example-1' class='example'>[&nbsp;<a class='example_link' href='#4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <p>Translation unit #1:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> A;
<span class='keyword'>export</span> <span class='keyword'>import</span> <span class='operator'>:</span>Foo;
<span class='keyword'>export</span> <span class='keyword'>int</span> baz<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</pre><p>Translation unit #2:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> A<span class='operator'>:</span>Foo;
<span class='keyword'>import</span> <span class='operator'>:</span>Internals;
<span class='keyword'>export</span> <span class='keyword'>int</span> foo<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='literal'>2</span> <span class='operator'>*</span> <span class='parenthesis'>(</span>bar<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>+</span> <span class='literal'>1</span><span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>
</pre><p>Translation unit #3:<pre class='codeblock'>
<span class='keyword'>module</span> A<span class='operator'>:</span>Internals;
<span class='keyword'>int</span> bar<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</pre><p>Translation unit #4:<pre class='codeblock'>
<span class='keyword'>module</span> A;
<span class='keyword'>import</span> <span class='operator'>:</span>Internals;
<span class='keyword'>int</span> bar<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> baz<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>-</span> <span class='literal'>10</span>; <span class='curlybracket'>}</span>
<span class='keyword'>int</span> baz<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='literal'>30</span>; <span class='curlybracket'>}</span>
</pre><div id='4.sentence-1' class='sentence'>Module <span class='texttt'>A</span> contains four translation units:
<ul class='itemize'><li >a primary module interface unit,</li><li >a module partition <span class='texttt'>A<span class='operator'>:</span>Foo</span>, which is a module interface unit
forming part of the interface of module <span class='texttt'>A</span>,</li><li >a module partition <span class='texttt'>A<span class='operator'>:</span>Internals</span>, which does not contribute
to the external interface of module <span class='texttt'>A</span>, and</li><li >a module implementation unit providing
a definition of <span class='texttt'>bar</span> and <span class='texttt'>baz</span>,
which cannot be imported because
it does not have a partition name<a class='hidden_link' href='#4.sentence-1'>.</a></li></ul></div> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/modules.tex#L117'>#</a></div><div id='5.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:purview,module_unit' id='def:purview,module_unit'><i >module unit purview</i></a> is
the sequence of <a class='grammarterm' href='lex.token#nt:token'>token</a><span class='textit'>s</span>
starting at the <a class='grammarterm' href='#nt:module-declaration'>module-declaration</a>
and extending to the end of the translation unit<a class='hidden_link' href='#5.sentence-1'>.</a></div> <div id='5.sentence-2' class='sentence'>The <a class='hidden_link' href='#def:purview,named_module' id='def:purview,named_module'><i >purview</i></a>
of a named module <span class='texttt'>M</span> is the set of module unit purviews
of <span class='texttt'>M</span>'s module units<a class='hidden_link' href='#5.sentence-2'>.</a></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/modules.tex#L126'>#</a></div><div id='6.sentence-1' class='sentence'>The <a class='hidden_link' href='#def:module,global' id='def:module,global'><i >global module</i></a> is the collection of all
<a class='grammarterm' href='module.global.frag#nt:global-module-fragment'>global-module-fragment</a><span class='textit'>s</span>
and all translation units that are not module units<a class='hidden_link' href='#6.sentence-1'>.</a></div> <div id='6.sentence-2' class='sentence'>Declarations appearing in such a context
are said to be in the <a class='hidden_link' href='#def:purview,global_module' id='def:purview,global_module'><i >purview</i></a> of the global module<a class='hidden_link' href='#6.sentence-2'>.</a></div> <div id='6.note-1' class='note'>[&nbsp;<a class='note_link' href='#6.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='6.sentence-3' class='sentence'>The global module has no name, no module interface unit, and is not
introduced by any <a class='grammarterm' href='#nt:module-declaration'>module-declaration</a><a class='hidden_link' href='#6.sentence-3'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/modules.tex#L137'>#</a></div><div id='7.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:module' id='def:module'><i >module</i></a> is either a named module or the global module<a class='hidden_link' href='#7.sentence-1'>.</a></div> <div id='7.sentence-2' class='sentence'>A declaration is <a class='hidden_link' href='#def:attached,declaration' id='def:attached,declaration'><i >attached</i></a> to a module as follows:
<ul class='itemize'><li id='7.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#7.1'>(7.1)</a></div>If the declaration
<ul class='itemize'><li id='7.1.1'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#7.1.1'>(7.1.1)</a></div>is a replaceable global allocation or deallocation
function (<a href='new.delete.single'>[new.delete.single]</a>, <a href='new.delete.array'>[new.delete.array]</a>), or</li><li id='7.1.2'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#7.1.2'>(7.1.2)</a></div>is a <a class='grammarterm' href='namespace.def#nt:namespace-definition'>namespace-definition</a> with external linkage, or</li><li id='7.1.3'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#7.1.3'>(7.1.3)</a></div>appears within a <a class='grammarterm' href='dcl.link#nt:linkage-specification'>linkage-specification</a>,</li></ul>
it is attached to the global module.</li><li id='7.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#7.2'>(7.2)</a></div>Otherwise, the declaration is
attached to the module in whose purview it appears.</li></ul></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/modules.tex#L154'>#</a></div><div id='8.sentence-1' class='sentence'>A <a class='grammarterm' href='#nt:module-declaration'>module-declaration</a>
that contains neither an <span class='grammarterm'>export-keyword</span>
nor a <a class='grammarterm' href='#nt:module-partition'>module-partition</a>
implicitly imports the primary module interface unit of the module
as if by a <a class='grammarterm' href='module.import#nt:module-import-declaration'>module-import-declaration</a><a class='hidden_link' href='#8.sentence-1'>.</a></div> <div id='8.example-1' class='example'>[&nbsp;<a class='example_link' href='#8.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <p>Translation unit #1:<pre class='codeblock'>
<span class='keyword'>module</span> B<span class='operator'>:</span>Y;                     <span class='comment'>// does not implicitly import <span class='tcode_in_codeblock'>B</span></span>
<span class='keyword'>int</span> y<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</pre><p>Translation unit #2:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> B;
<span class='keyword'>import</span> <span class='operator'>:</span>Y;                      <span class='comment'>// OK, does not create interface dependency cycle</span>
<span class='keyword'>int</span> n <span class='operator'>=</span> y<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</pre><p>Translation unit #3:<pre class='codeblock'>
<span class='keyword'>module</span> B<span class='operator'>:</span>X1;                    <span class='comment'>// does not implicitly import <span class='tcode_in_codeblock'>B</span></span>
<span class='keyword'>int</span> <span class='operator'>&amp;</span>a <span class='operator'>=</span> n;                     <span class='comment'>// error: <span class='tcode_in_codeblock'>n</span> not visible here</span>
</pre><p>Translation unit #4:<pre class='codeblock'>
<span class='keyword'>module</span> B<span class='operator'>:</span>X2;                    <span class='comment'>// does not implicitly import <span class='tcode_in_codeblock'>B</span></span>
<span class='keyword'>import</span> B;
<span class='keyword'>int</span> <span class='operator'>&amp;</span>b <span class='operator'>=</span> n;                     <span class='comment'>// OK</span>
</pre><p>Translation unit #5:<pre class='codeblock'>
<span class='keyword'>module</span> B;                       <span class='comment'>// implicitly imports <span class='tcode_in_codeblock'>B</span></span>
<span class='keyword'>int</span> <span class='operator'>&amp;</span>c <span class='operator'>=</span> n;                     <span class='comment'>// OK</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div></div></body></html>