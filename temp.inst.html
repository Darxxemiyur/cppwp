<!DOCTYPE html><html lang='en'><head><title>[temp.inst]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>13</a> Templates <a class='abbr_ref' href='./#temp'>[temp]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>13.9</a> Template instantiation and specialization <a class='abbr_ref' href='temp.spec#temp.inst'>[temp.spec]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>13.9.1</a> Implicit instantiation <a class='abbr_ref'>[temp.inst]</a></h3><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/templates.tex#L6080'>#</a></div><div id='1.sentence-1' class='sentence'>A template specialization <span class='math'><span class='mathalpha'>E</span></span> is a <a class='hidden_link' href='#def:specialization,declared' id='def:specialization,declared'><i >declared specialization</i></a>
if there is a reachable
explicit instantiation definition (<a href='temp.explicit'>[temp.explicit]</a>) or
explicit specialization declaration (<a href='temp.expl.spec'>[temp.expl.spec]</a>)
for <span class='math'><span class='mathalpha'>E</span></span>, or
if there is a reachable explicit instantiation declaration for <span class='math'><span class='mathalpha'>E</span></span> and
<span class='math'><span class='mathalpha'>E</span></span> is not
<ul class='itemize'><li id='1.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#1.1'>(1.1)</a></div>an inline function,</li><li id='1.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#1.2'>(1.2)</a></div>declared with a type deduced
from its initializer or return value (<a href='dcl.spec.auto'>[dcl.spec.auto]</a>),</li><li id='1.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#1.3'>(1.3)</a></div>a potentially-constant variable (<a href='expr.const'>[expr.const]</a>), or</li><li id='1.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#1.4'>(1.4)</a></div>a specialization of a templated class<a class='hidden_link' href='#1.sentence-1'>.</a></li></ul></div> <div id='1.note-1' class='note'>[&nbsp;<a class='note_link' href='#1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='1.sentence-2' class='sentence'>An implicit instantiation in an importing translation unit
cannot use names with internal linkage
from an imported translation unit (<a href='basic.link'>[basic.link]</a>)<a class='hidden_link' href='#1.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/templates.tex#L6105'>#</a></div><div id='2.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':instantiation,template_implicit'></a></span>Unless a class template specialization is a declared specialization,
the class template specialization is implicitly instantiated when the
specialization is referenced in a context that requires a completely-defined
object type or when the completeness of the class type affects the semantics
of the program<a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.note-1' class='note'>[&nbsp;<a class='note_link' href='#2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='2.sentence-2' class='sentence'>In particular, if the semantics of an expression depend on the member or
base class lists of a class template specialization, the class template
specialization is implicitly generated<a class='hidden_link' href='#2.sentence-2'>.</a></div> <div id='2.sentence-3' class='sentence'>For instance, deleting a pointer
to class type depends on whether or not the class declares a destructor,
and a conversion between pointers to class type depends on the
inheritance relationship between the two classes involved<a class='hidden_link' href='#2.sentence-3'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='2.example-1' class='example'>[&nbsp;<a class='example_link' href='#2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> B <span class='curlybracket'>{</span> <span class='comment'>/* ... */</span> <span class='curlybracket'>}</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> D <span class='operator'>:</span> <span class='keyword'>public</span> B<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span> <span class='comment'>/* ... */</span> <span class='curlybracket'>}</span>;

<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='keyword'>void</span><span class='operator'>*</span><span class='parenthesis'>)</span>;
<span class='keyword'>void</span> f<span class='parenthesis'>(</span>B<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='operator'>*</span><span class='parenthesis'>)</span>;

<span class='keyword'>void</span> g<span class='parenthesis'>(</span>D<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='operator'>*</span> p, D<span class='anglebracket'>&lt;</span><span class='keyword'>char</span><span class='anglebracket'>&gt;</span><span class='operator'>*</span> pp, D<span class='anglebracket'>&lt;</span><span class='keyword'>double</span><span class='anglebracket'>&gt;</span><span class='operator'>*</span> ppp<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  f<span class='parenthesis'>(</span>p<span class='parenthesis'>)</span>;             <span class='comment'>// instantiation of <span class='tcode_in_codeblock'>D&lt;int&gt;</span> required: call <span class='tcode_in_codeblock'>f(B&lt;int&gt;*)</span></span>
  B<span class='anglebracket'>&lt;</span><span class='keyword'>char</span><span class='anglebracket'>&gt;</span><span class='operator'>*</span> q <span class='operator'>=</span> pp;  <span class='comment'>// instantiation of <span class='tcode_in_codeblock'>D&lt;char&gt;</span> required: convert <span class='tcode_in_codeblock'>D&lt;char&gt;*</span> to <span class='tcode_in_codeblock'>B&lt;char&gt;*</span></span>
  <span class='keyword'>delete</span> ppp;       <span class='comment'>// instantiation of <span class='tcode_in_codeblock'>D&lt;double&gt;</span> required</span>
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div>  <div id='2.sentence-4' class='sentence'>
If a class template has been declared, but not defined,
at the <a href='temp.point'>point of instantiation</a>,
the instantiation yields an incomplete class type (<a href='basic.types'>[basic.types]</a>)<a class='hidden_link' href='#2.sentence-4'>.</a></div> <div id='2.example-2' class='example'>[&nbsp;<a class='example_link' href='#2.example-2'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> X;
X<span class='anglebracket'>&lt;</span><span class='keyword'>char</span><span class='anglebracket'>&gt;</span> ch;         <span class='comment'>// error: incomplete type <span class='tcode_in_codeblock'>X&lt;char&gt;</span></span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div>  <div id='2.note-2' class='note'>[&nbsp;<a class='note_link' href='#2.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='2.sentence-5' class='sentence'>Within a template declaration,
a <a href='class.local'>local class</a> or enumeration and the members of
a local class are never considered to be entities that can be separately
instantiated (this includes their default arguments,
<a class='grammarterm' href='except.spec#nt:noexcept-specifier'>noexcept-specifier</a><span class='textit'>s</span>, and non-static data member
initializers, if any,
but not their <a class='grammarterm' href='temp.param#nt:type-constraint'>type-constraint</a><span class='textit'>s</span> or <a class='grammarterm' href='temp.pre#nt:requires-clause'>requires-clause</a><span class='textit'>s</span>)<a class='hidden_link' href='#2.sentence-5'>.</a></div> <div id='2.sentence-6' class='sentence'>As a result, the dependent names are looked up, the
semantic constraints are checked, and any templates used are instantiated as
part of the instantiation of the entity within which the local class or
enumeration is declared<a class='hidden_link' href='#2.sentence-6'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/templates.tex#L6158'>#</a></div><div id='3.sentence-1' class='sentence'>The implicit instantiation of a class template specialization causes
<ul class='itemize'><li id='3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.1'>(3.1)</a></div>the implicit instantiation of the declarations, but not of the definitions,
  of the non-deleted
  class member functions,
  member classes,
  scoped member enumerations,
  static data members,
  member templates, and
  friends; and</li><li id='3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.2'>(3.2)</a></div>the implicit instantiation of the definitions of
  deleted member functions,
  unscoped member enumerations, and
  member anonymous unions<a class='hidden_link' href='#3.sentence-1'>.</a></li></ul></div> <div id='3.sentence-2' class='sentence'>
The implicit instantiation of a class template specialization
does not cause the implicit instantiation of
default arguments or <a class='grammarterm' href='except.spec#nt:noexcept-specifier'>noexcept-specifier</a><span class='textit'>s</span>
of the class member functions<a class='hidden_link' href='#3.sentence-2'>.</a></div> <div id='3.example-1' class='example'>[&nbsp;<a class='example_link' href='#3.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span>
<span class='keyword'>struct</span> C <span class='curlybracket'>{</span>
  <span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> T x; <span class='curlybracket'>}</span>
  <span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
<span class='curlybracket'>}</span>;
C<span class='anglebracket'>&lt;</span><span class='keyword'>void</span><span class='anglebracket'>&gt;</span> c;                      <span class='comment'>// OK, definition of <span class='tcode_in_codeblock'>C&lt;void&gt;&#x200b;::&#x200b;f</span> is not instantiated at this point</span>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> C<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='operator'>::</span>g<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span> <span class='comment'>// error: redefinition of <span class='tcode_in_codeblock'>C&lt;int&gt;&#x200b;::&#x200b;g</span></span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div>  <div id='3.sentence-3' class='sentence'>
However, for the purpose of determining whether an instantiated redeclaration
is valid according to <a href='basic.def.odr'>[basic.def.odr]</a> and <a href='class.mem'>[class.mem]</a>,
a declaration that corresponds to a definition in the template
is considered to be a definition<a class='hidden_link' href='#3.sentence-3'>.</a></div> <div id='3.example-2' class='example'>[&nbsp;<a class='example_link' href='#3.example-2'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T, <span class='keyword'>class</span> U<span class='anglebracket'>&gt;</span>
<span class='keyword'>struct</span> Outer <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> X, <span class='keyword'>class</span> Y<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> Inner;
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Y<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> Inner<span class='anglebracket'>&lt;</span>T, Y<span class='anglebracket'>&gt;</span>;         <span class='comment'>// #1a</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Y<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> Inner<span class='anglebracket'>&lt;</span>T, Y<span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;     <span class='comment'>// #1b; OK: valid redeclaration of #1a</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Y<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> Inner<span class='anglebracket'>&lt;</span>U, Y<span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;     <span class='comment'>// #2</span>
<span class='curlybracket'>}</span>;

Outer<span class='anglebracket'>&lt;</span><span class='keyword'>int</span>, <span class='keyword'>int</span><span class='anglebracket'>&gt;</span> outer;                          <span class='comment'>// error at #2</span>
</pre><div id='3.sentence-4' class='sentence'><span class='texttt'>Outer<span class='anglebracket'>&lt;</span><span class='keyword'>int</span>, <span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='operator'>&#x200b;::&#x200b;</span>Inner<span class='anglebracket'>&lt;</span><span class='keyword'>int</span>, Y<span class='anglebracket'>&gt;</span></span> is redeclared at #1b<a class='hidden_link' href='#3.sentence-4'>.</a></div> <div id='3.sentence-5' class='sentence'>(It is not defined
but noted as being associated with a definition in <span class='texttt'>Outer<span class='anglebracket'>&lt;</span>T, U<span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#3.sentence-5'>.</a>)</div> <div id='3.sentence-6' class='sentence'>#2
is also a redeclaration of #1a<a class='hidden_link' href='#3.sentence-6'>.</a></div> <div id='3.sentence-7' class='sentence'>It is noted as associated with a definition,
so it is an invalid redeclaration of the same partial specialization<a class='hidden_link' href='#3.sentence-7'>.</a></div><pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> Friendly <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> U<span class='anglebracket'>&gt;</span> <span class='keyword'>friend</span> <span class='keyword'>int</span> f<span class='parenthesis'>(</span>U<span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='keyword'>sizeof</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>
<span class='curlybracket'>}</span>;
Friendly<span class='anglebracket'>&lt;</span><span class='keyword'>char</span><span class='anglebracket'>&gt;</span> fc;
Friendly<span class='anglebracket'>&lt;</span><span class='keyword'>float</span><span class='anglebracket'>&gt;</span> ff;                             <span class='comment'>// error: produces second definition of <span class='tcode_in_codeblock'>f(U)</span></span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/templates.tex#L6222'>#</a></div><div id='4.sentence-1' class='sentence'>Unless a member of a class template or a member template
is a declared specialization,
the specialization of the member is implicitly instantiated when the
specialization is referenced in a context that requires the member definition
to exist or
if the existence of the definition of the member
affects the semantics of the program;
in particular, the initialization (and any associated side effects) of a
static data member does not occur unless the static data member is itself used
in a way that requires the definition of the static data member to exist<a class='hidden_link' href='#4.sentence-1'>.</a></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/templates.tex#L6234'>#</a></div><div id='5.sentence-1' class='sentence'>Unless a function template specialization is a declared specialization,
the function template specialization is implicitly instantiated when the
specialization is referenced in a context that requires a function definition
to exist or
if the existence of the definition affects the semantics of the program<a class='hidden_link' href='#5.sentence-1'>.</a></div> <div id='5.sentence-2' class='sentence'>A function whose declaration was instantiated from a friend function definition is
implicitly instantiated when it is referenced in a context that
requires a function definition to exist or
if the existence of the definition affects the semantics of the program<a class='hidden_link' href='#5.sentence-2'>.</a></div> <div id='5.sentence-3' class='sentence'>Unless a call is to a function template explicit specialization or
to a member function of an explicitly specialized class template,
a default argument for a function template or a member function of a
class template is implicitly instantiated when the function is
called in a context that requires the value of the default argument<a class='hidden_link' href='#5.sentence-3'>.</a></div> <div id='5.note-1' class='note'>[&nbsp;<a class='note_link' href='#5.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='5.sentence-4' class='sentence'>An inline function
that is the subject of an explicit instantiation declaration
is not a declared specialization;
the intent is that it still be implicitly instantiated
when odr-used (<a href='basic.def.odr'>[basic.def.odr]</a>)
so that the body can be considered for inlining,
but that no out-of-line copy of it be generated in the translation unit<a class='hidden_link' href='#5.sentence-4'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/templates.tex#L6259'>#</a></div><div id='6.example-1' class='example'>[&nbsp;<a class='example_link' href='#6.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> Z <span class='curlybracket'>{</span>
  <span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;

<span class='keyword'>void</span> h<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  Z<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span> a;         <span class='comment'>// instantiation of class <span class='tcode_in_codeblock'>Z&lt;int&gt;</span> required</span>
  Z<span class='anglebracket'>&lt;</span><span class='keyword'>char</span><span class='anglebracket'>&gt;</span><span class='operator'>*</span> p;       <span class='comment'>// instantiation of class <span class='tcode_in_codeblock'>Z&lt;char&gt;</span> not required</span>
  Z<span class='anglebracket'>&lt;</span><span class='keyword'>double</span><span class='anglebracket'>&gt;</span><span class='operator'>*</span> q;     <span class='comment'>// instantiation of class <span class='tcode_in_codeblock'>Z&lt;double&gt;</span> not required</span>

  a<span class='operator'>.</span>f<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;            <span class='comment'>// instantiation of <span class='tcode_in_codeblock'>Z&lt;int&gt;&#x200b;::&#x200b;f()</span> required</span>
  p<span class='operator'>-</span><span class='anglebracket'>&gt;</span>g<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;           <span class='comment'>// instantiation of class <span class='tcode_in_codeblock'>Z&lt;char&gt;</span> required, and</span>
                    <span class='comment'>// instantiation of <span class='tcode_in_codeblock'>Z&lt;char&gt;&#x200b;::&#x200b;g()</span> required</span>
<span class='curlybracket'>}</span>
</pre><div id='6.sentence-1' class='sentence'>Nothing in this example requires
<span class='texttt'><span class='keyword'>class</span></span>
<span class='texttt'>Z<span class='anglebracket'>&lt;</span><span class='keyword'>double</span><span class='anglebracket'>&gt;</span></span>,
<span class='texttt'>Z<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='operator'>&#x200b;::&#x200b;</span>g<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>,
or
<span class='texttt'>Z<span class='anglebracket'>&lt;</span><span class='keyword'>char</span><span class='anglebracket'>&gt;</span><span class='operator'>&#x200b;::&#x200b;</span>f<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
to be implicitly instantiated<a class='hidden_link' href='#6.sentence-1'>.</a></div> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/templates.tex#L6287'>#</a></div><div id='7.sentence-1' class='sentence'>Unless a variable template specialization is a declared specialization,
the variable template specialization is implicitly instantiated
when it is referenced in a context
that requires a variable definition to exist or
if the existence of the definition affects the semantics of the program<a class='hidden_link' href='#7.sentence-1'>.</a></div> <div id='7.sentence-2' class='sentence'>A default template argument for a variable template is implicitly instantiated
when the variable template is referenced in a context
that requires the value of the default argument<a class='hidden_link' href='#7.sentence-2'>.</a></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/templates.tex#L6297'>#</a></div><div id='8.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':definition,program_semantics_affected_by'></a></span><span class='indexparent'><a class='index' id=':variable,program_semantics_affected_by_the_existence_of_a_variable_definition'></a></span><span class='indexparent'><a class='index' id=':function,program_semantics_affected_by_the_existence_of_a_function_definition'></a></span><span class='indexparent'><a class='index' id=':program_semantics,affected_by_the_existence_of_a_variable_or_function_definition'></a></span>The existence of a definition of a variable or function
is considered to affect the semantics of the program
if the variable or function
is needed for constant evaluation by an expression (<a href='expr.const'>[expr.const]</a>),
even if constant evaluation of the expression is not required or
if constant expression evaluation does not use the definition<a class='hidden_link' href='#8.sentence-1'>.</a></div><div style='height:0.6em;display:block'></div><div id='8.example-1' class='example'>[&nbsp;<a class='example_link' href='#8.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>constexpr</span> <span class='keyword'>int</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> T<span class='operator'>::</span>value; <span class='curlybracket'>}</span>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>bool</span> B, <span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='keyword'>decltype</span><span class='parenthesis'>(</span>B <span class='operator'>?</span> f<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>:</span> <span class='literal'>0</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>bool</span> B, <span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>bool</span> B, <span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> h<span class='parenthesis'>(</span><span class='keyword'>decltype</span><span class='parenthesis'>(</span><span class='keyword'>int</span><span class='curlybracket'>{</span>B <span class='operator'>?</span> f<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>:</span> <span class='literal'>0</span><span class='curlybracket'>}</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>bool</span> B, <span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> h<span class='parenthesis'>(</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>;
<span class='keyword'>void</span> x<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  g<span class='anglebracket'>&lt;</span><span class='literal'>false</span>, <span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>; <span class='comment'>// OK, <span class='tcode_in_codeblock'>B ? f&lt;T&gt;() :&nbsp;0</span> is not potentially constant evaluated</span>
  h<span class='anglebracket'>&lt;</span><span class='literal'>false</span>, <span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span>; <span class='comment'>// error, instantiates <span class='tcode_in_codeblock'>f&lt;int&gt;</span> even though <span class='tcode_in_codeblock'>B</span> evaluates to <span class='tcode_in_codeblock'>false</span> and</span>
                    <span class='comment'>// list-initialization of <span class='tcode_in_codeblock'>int</span> from <span class='tcode_in_codeblock'>int</span> cannot be narrowing</span>
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/templates.tex#L6324'>#</a></div><div id='9.sentence-1' class='sentence'>If the function selected by <a href='over.match'>overload resolution</a>
can be determined without instantiating a class template definition,
it is unspecified whether that instantiation actually takes place<a class='hidden_link' href='#9.sentence-1'>.</a></div> <div id='9.example-1' class='example'>[&nbsp;<a class='example_link' href='#9.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span> <span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> S <span class='curlybracket'>{</span>
  <span class='keyword'>operator</span> <span class='keyword'>int</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;

<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span>;
<span class='keyword'>void</span> f<span class='parenthesis'>(</span>S<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span>;
<span class='keyword'>void</span> f<span class='parenthesis'>(</span>S<span class='anglebracket'>&lt;</span><span class='keyword'>float</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span>;

<span class='keyword'>void</span> g<span class='parenthesis'>(</span>S<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> sr<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  f<span class='parenthesis'>(</span>sr<span class='parenthesis'>)</span>;            <span class='comment'>// instantiation of <span class='tcode_in_codeblock'>S&lt;int&gt;</span> allowed but not required</span>
                    <span class='comment'>// instantiation of <span class='tcode_in_codeblock'>S&lt;float&gt;</span> allowed but not required</span>
<span class='curlybracket'>}</span>;
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/templates.tex#L6345'>#</a></div><div id='10.sentence-1' class='sentence'>If a function template or a member function template specialization is used in
a way that involves overload resolution,
a declaration of the specialization is implicitly instantiated (<a href='temp.over'>[temp.over]</a>)<a class='hidden_link' href='#10.sentence-1'>.</a></div></div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/templates.tex#L6350'>#</a></div><div id='11.sentence-1' class='sentence'>An implementation shall not implicitly instantiate a function template,
a variable template,
a member template, a non-virtual member function, a member class, a
static data member of a class template, or a substatement of a constexpr if
statement (<a href='stmt.if'>[stmt.if]</a>), unless such instantiation is required<a class='hidden_link' href='#11.sentence-1'>.</a></div> <div id='11.note-1' class='note'>[&nbsp;<a class='note_link' href='#11.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='11.sentence-2' class='sentence'>The instantiation of a generic lambda
does not require instantiation of
substatements of a constexpr if statement
within its <a class='grammarterm' href='stmt.block#nt:compound-statement'>compound-statement</a>
unless the call operator template is instantiated<a class='hidden_link' href='#11.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='11.sentence-3' class='sentence'>
It is unspecified whether or not an implementation implicitly instantiates a
virtual member function of a class template if the virtual member function would
not otherwise be instantiated<a class='hidden_link' href='#11.sentence-3'>.</a></div> <div id='11.sentence-4' class='sentence'>The use of a template specialization in a default argument
shall not cause the template to be implicitly instantiated except that a
class template may be instantiated where its complete type is needed to determine
the correctness of the default argument<a class='hidden_link' href='#11.sentence-4'>.</a></div> <div id='11.sentence-5' class='sentence'>The use of a default argument in a
function call causes specializations in the default argument to be implicitly
instantiated<a class='hidden_link' href='#11.sentence-5'>.</a></div></div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/templates.tex#L6374'>#</a></div><div id='12.sentence-1' class='sentence'>Implicitly instantiated class, function, and variable template specializations
are placed in the namespace where the template is defined<a class='hidden_link' href='#12.sentence-1'>.</a></div> <div id='12.sentence-2' class='sentence'>Implicitly instantiated specializations for members of a class template are
placed in the namespace where the enclosing class template is defined<a class='hidden_link' href='#12.sentence-2'>.</a></div> <div id='12.sentence-3' class='sentence'>Implicitly instantiated member templates are placed in the namespace where the
enclosing class or class template is defined<a class='hidden_link' href='#12.sentence-3'>.</a></div> <div id='12.example-1' class='example'>[&nbsp;<a class='example_link' href='#12.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>namespace</span> N <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> List <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    T<span class='operator'>*</span> get<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> K, <span class='keyword'>class</span> V<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> Map <span class='curlybracket'>{</span>
<span class='keyword'>public</span><span class='operator'>:</span>
  N<span class='operator'>::</span>List<span class='anglebracket'>&lt;</span>V<span class='anglebracket'>&gt;</span> lt;
  V get<span class='parenthesis'>(</span>K<span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;

<span class='keyword'>void</span> g<span class='parenthesis'>(</span>Map<span class='anglebracket'>&lt;</span><span class='keyword'>const</span> <span class='keyword'>char</span><span class='operator'>*</span>,<span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> m<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> i <span class='operator'>=</span> m<span class='operator'>.</span>get<span class='parenthesis'>(</span><span class='literal'>"Nicholas"</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
</pre><div id='12.sentence-4' class='sentence'>A call of
<span class='texttt'>lt<span class='operator'>.</span>get<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
from
<span class='texttt'>Map<span class='anglebracket'>&lt;</span><span class='keyword'>const</span> <span class='keyword'>char</span><span class='operator'>*</span>,<span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='operator'>&#x200b;::&#x200b;</span>get<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
would place
<span class='texttt'>List<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='operator'>&#x200b;::&#x200b;</span>get<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
in the namespace
<span class='texttt'>N</span>
rather than in the global namespace<a class='hidden_link' href='#12.sentence-4'>.</a></div> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='13'><div class='marginalizedparent'><a class='marginalized' href='#13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/templates.tex#L6412'>#</a></div><div id='13.sentence-1' class='sentence'>If a function template
<span class='texttt'>f</span>
is called in a way that requires a default argument to be used,
the dependent names are looked up, the semantics constraints are checked,
and the instantiation of any template used in the default argument
is done as if the default argument had been
an initializer used in a function template specialization with the same scope,
the same template parameters and the same access as that of the function template
<span class='texttt'>f</span>
used at that point, except that the scope in which a closure type is
declared (<a href='expr.prim.lambda.closure'>[expr.prim.lambda.closure]</a>) – and therefore its associated namespaces –
remain as determined from the context of the definition for the default
argument<a class='hidden_link' href='#13.sentence-1'>.</a></div> <div id='13.sentence-2' class='sentence'>This analysis is called
<a class='hidden_link' href='#def:default_argument_instantiation' id='def:default_argument_instantiation'><i >default argument instantiation</i></a><a class='hidden_link' href='#13.sentence-2'>.</a></div> <div id='13.sentence-3' class='sentence'>The instantiated default argument is then used as the argument of
<span class='texttt'>f</span><a class='hidden_link' href='#13.sentence-3'>.</a></div></div><div class='para' id='14'><div class='marginalizedparent'><a class='marginalized' href='#14'>14</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/templates.tex#L6431'>#</a></div><div id='14.sentence-1' class='sentence'>Each default argument is instantiated independently<a class='hidden_link' href='#14.sentence-1'>.</a></div> <div id='14.example-1' class='example'>[&nbsp;<a class='example_link' href='#14.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> f<span class='parenthesis'>(</span>T x, T y <span class='operator'>=</span> ydef<span class='parenthesis'>(</span>T<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>, T z <span class='operator'>=</span> zdef<span class='parenthesis'>(</span>T<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;

<span class='keyword'>class</span>  A <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;

A zdef<span class='parenthesis'>(</span>A<span class='parenthesis'>)</span>;

<span class='keyword'>void</span> g<span class='parenthesis'>(</span>A a, A b, A c<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  f<span class='parenthesis'>(</span>a, b, c<span class='parenthesis'>)</span>;       <span class='comment'>// no default argument instantiation</span>
  f<span class='parenthesis'>(</span>a, b<span class='parenthesis'>)</span>;          <span class='comment'>// default argument <span class='tcode_in_codeblock'>z = zdef(T())</span> instantiated</span>
  f<span class='parenthesis'>(</span>a<span class='parenthesis'>)</span>;             <span class='comment'>// error: <span class='tcode_in_codeblock'>ydef</span> is not declared</span>
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='15'><div class='marginalizedparent'><a class='marginalized' href='#15'>15</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/templates.tex#L6449'>#</a></div><div id='15.sentence-1' class='sentence'>The <a class='grammarterm' href='except.spec#nt:noexcept-specifier'>noexcept-specifier</a> of a function template specialization
is not instantiated along with the function declaration; it is instantiated
when needed (<a href='except.spec'>[except.spec]</a>)<a class='hidden_link' href='#15.sentence-1'>.</a></div> <div id='15.sentence-2' class='sentence'>If such an
<a class='grammarterm' href='except.spec#nt:noexcept-specifier'>noexcept-specifier</a> is needed but has not yet been
instantiated, the dependent names are looked up, the semantics constraints are
checked, and the instantiation of any template used in the
<a class='grammarterm' href='except.spec#nt:noexcept-specifier'>noexcept-specifier</a> is done as if it were being done as part
of instantiating the declaration of the specialization at that point<a class='hidden_link' href='#15.sentence-2'>.</a></div></div><div class='para' id='16'><div class='marginalizedparent'><a class='marginalized' href='#16'>16</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/templates.tex#L6459'>#</a></div><div id='16.note-1' class='note'>[&nbsp;<a class='note_link' href='#16.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='16.sentence-1' class='sentence'><a href='temp.point'>[temp.point]</a> defines the point of instantiation of a template specialization<a class='hidden_link' href='#16.sentence-1'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='17'><div class='marginalizedparent'><a class='marginalized' href='#17'>17</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/templates.tex#L6464'>#</a></div><div id='17.sentence-1' class='sentence'>There is an <span class='indexparent'><a class='index' id=':maximum_depth_of_recursive_template_instantiations'></a></span>implementation-defined quantity
that specifies the limit on the total depth of recursive instantiations (<a href='implimits'>[implimits]</a>),
which could involve more than one template<a class='hidden_link' href='#17.sentence-1'>.</a></div> <div id='17.sentence-2' class='sentence'>The result of an infinite recursion in instantiation is undefined<a class='hidden_link' href='#17.sentence-2'>.</a></div> <div id='17.example-1' class='example'>[&nbsp;<a class='example_link' href='#17.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> X <span class='curlybracket'>{</span>
  X<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span><span class='operator'>*</span> p;          <span class='comment'>// OK</span>
  X<span class='anglebracket'>&lt;</span>T<span class='operator'>*</span><span class='anglebracket'>&gt;</span> a;          <span class='comment'>// implicit generation of <span class='tcode_in_codeblock'>X&lt;T&gt;</span> requires</span>
                    <span class='comment'>// the implicit instantiation of <span class='tcode_in_codeblock'>X&lt;T*&gt;</span> which requires</span>
                    <span class='comment'>// the implicit instantiation of <span class='tcode_in_codeblock'>X&lt;T**&gt;</span> which &hellip;</span>
<span class='curlybracket'>}</span>;
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='18'><div class='marginalizedparent'><a class='marginalized' href='#18'>18</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/templates.tex#L6480'>#</a></div><div id='18.sentence-1' class='sentence'>The <a class='grammarterm' href='temp.param#nt:type-constraint'>type-constraint</a><span class='textit'>s</span> and <a class='grammarterm' href='temp.pre#nt:requires-clause'>requires-clause</a>
of a template specialization or member function
are not instantiated along with the specialization or function itself,
even for a member function of a local class;
substitution into the atomic constraints formed from them is instead performed
as specified in <a href='temp.constr.decl'>[temp.constr.decl]</a> and <a href='temp.constr.atomic'>[temp.constr.atomic]</a>
when determining whether the constraints are satisfied
or as specified in <a href='temp.constr.decl'>[temp.constr.decl]</a> when comparing declarations<a class='hidden_link' href='#18.sentence-1'>.</a></div> <div id='18.note-1' class='note'>[&nbsp;<a class='note_link' href='#18.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='18.sentence-2' class='sentence'>The satisfaction of constraints is determined during
template argument deduction (<a href='temp.deduct'>[temp.deduct]</a>) and
overload resolution (<a href='over.match'>[over.match]</a>)<a class='hidden_link' href='#18.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='18.example-1' class='example'>[&nbsp;<a class='example_link' href='#18.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>concept</span> C <span class='operator'>=</span> <span class='keyword'>sizeof</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span> <span class='anglebracket'>&gt;</span> <span class='literal'>2</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>concept</span> D <span class='operator'>=</span> C<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span> <span class='operator'>&amp;</span><span class='operator'>&amp;</span> <span class='keyword'>sizeof</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span> <span class='anglebracket'>&gt;</span> <span class='literal'>4</span>;

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> S <span class='curlybracket'>{</span>
  S<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>requires</span> C<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>         <span class='comment'>// #1</span>
  S<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>requires</span> D<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>         <span class='comment'>// #2</span>
<span class='curlybracket'>}</span>;

S<span class='anglebracket'>&lt;</span><span class='keyword'>char</span><span class='anglebracket'>&gt;</span> s1;                     <span class='comment'>// error: no matching constructor</span>
S<span class='anglebracket'>&lt;</span><span class='keyword'>char</span><span class='squarebracket'>[</span><span class='literal'>8</span><span class='squarebracket'>]</span><span class='anglebracket'>&gt;</span> s2;                  <span class='comment'>// OK, calls #2</span>
</pre> <div id='18.sentence-3' class='sentence'>
When <span class='texttt'>S<span class='anglebracket'>&lt;</span><span class='keyword'>char</span><span class='anglebracket'>&gt;</span></span> is instantiated, both constructors are part of the
specialization<a class='hidden_link' href='#18.sentence-3'>.</a></div> <div id='18.sentence-4' class='sentence'>Their constraints are not satisfied, and
they suppress the implicit declaration of a default constructor for
<span class='texttt'>S<span class='anglebracket'>&lt;</span><span class='keyword'>char</span><span class='anglebracket'>&gt;</span></span> (<a href='class.default.ctor'>[class.default.ctor]</a>), so there is no viable constructor
for <span class='texttt'>s1</span><a class='hidden_link' href='#18.sentence-4'>.</a></div> —&nbsp;<i>end example</i></div>&nbsp;]</div>  <div id='18.example-2' class='example'>[&nbsp;<a class='example_link' href='#18.example-2'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> S1 <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> U<span class='anglebracket'>&gt;</span>
    <span class='keyword'>requires</span> <span class='literal'>false</span>
  <span class='keyword'>struct</span> Inner1;                <span class='comment'>// ill-formed, no diagnostic required</span>
<span class='curlybracket'>}</span>;

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> S2 <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> U<span class='anglebracket'>&gt;</span>
    <span class='keyword'>requires</span> <span class='parenthesis'>(</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span>T<span class='squarebracket'>[</span><span class='operator'>-</span><span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span><span class='squarebracket'>]</span><span class='parenthesis'>)</span> <span class='anglebracket'>&gt;</span> <span class='literal'>1</span><span class='parenthesis'>)</span>
  <span class='keyword'>struct</span> Inner2;                <span class='comment'>// ill-formed, no diagnostic required</span>
<span class='curlybracket'>}</span>;
</pre> <div id='18.sentence-5' class='sentence'>
The class <span class='texttt'>S1<span class='anglebracket'>&lt;</span>T<span class='anglebracket'>&gt;</span><span class='operator'>&#x200b;::&#x200b;</span>Inner1</span> is ill-formed, no diagnostic required, because
it has no valid specializations<a class='hidden_link' href='#18.sentence-5'>.</a></div> <div id='18.sentence-6' class='sentence'><span class='texttt'>S2</span> is ill-formed, no diagnostic required, since no substitution into
the constraints of its <span class='texttt'>Inner2</span> template would result in a valid
expression<a class='hidden_link' href='#18.sentence-6'>.</a></div> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div></div></body></html>