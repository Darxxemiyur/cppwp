<!DOCTYPE html><html lang='en'><head><title>[basic.stc]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>6</a> Basics <a class='abbr_ref' href='./#basic'>[basic]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>6.7</a> Memory and objects <a class='abbr_ref' href='basic.memobj#basic.stc'>[basic.memobj]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>6.7.5</a> Storage duration <a class='abbr_ref'>[basic.stc]</a></h3><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L3734'>#</a></div><div id='1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':storage_duration'></a></span>The <a class='hidden_link' href='#def:storage_duration' id='def:storage_duration'><i >storage duration</i></a> is the property of an object that defines the minimum
potential lifetime of the storage containing the object<a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>The storage
duration is determined by the construct used to create the object and is
one of the following:
<ul class='itemize'><li id='1.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#1.1'>(1.1)</a></div>static storage duration</li><li id='1.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#1.2'>(1.2)</a></div>thread storage duration</li><li id='1.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#1.3'>(1.3)</a></div>automatic storage duration</li><li id='1.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#1.4'>(1.4)</a></div>dynamic storage duration</li></ul></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L3747'>#</a></div><div id='2.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':storage_duration,static'></a></span><span class='indexparent'><a class='index' id=':storage_duration,thread'></a></span><span class='indexparent'><a class='index' id=':storage_duration,automatic'></a></span><span class='indexparent'><a class='index' id=':storage_duration,dynamic'></a></span>Static, thread, and automatic storage durations are associated with objects
introduced by declarations (<a href='basic.def'>[basic.def]</a>) and <a href='class.temporary'>implicitly created by
the implementation</a><a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'>The dynamic storage duration
is associated with objects created by a
<a class='grammarterm' href='expr.new#nt:new-expression'>new-expression</a><a class='hidden_link' href='#2.sentence-2'>.</a></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L3758'>#</a></div><div id='3.sentence-1' class='sentence'>The storage duration categories apply to references as well<a class='hidden_link' href='#3.sentence-1'>.</a></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L3761'>#</a></div><div id='4.sentence-1' class='sentence'>When the end of the duration of a region of storage is reached,
the values of all pointers
representing the address of any part of that region of storage
become <a href='basic.compound#def:value,invalid_pointer'>invalid pointer values</a><a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='4.sentence-2' class='sentence'>Indirection through an invalid pointer value and
passing an invalid pointer value to a deallocation function
have undefined behavior<a class='hidden_link' href='#4.sentence-2'>.</a></div> <div id='4.sentence-3' class='sentence'>Any other use of an invalid pointer value has
<span class='indexparent'><a class='index' id=':any_use_of_an_invalid_pointer_other_than_to_perform_indirection_or_deallocate'></a></span>implementation-defined
behavior<a class='hidden_link' href='#4.sentence-3'>.</a><a class='footnotenum' href='#footnote-31' id='footnoteref-31'>31</a></div></div><div class='footnote' id='footnote-31'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-31'>31)</a></div><div id='footnote-31.sentence-1' class='sentence'>Some implementations might define that
copying an invalid pointer value
causes a system-generated runtime fault<a class='hidden_link' href='#footnote-31.sentence-1'>.</a></div> <a href='#footnoteref-31'>⮥</a></div><div id='static' class='section'><h4 ><a class='secnum' href='#static' style='min-width:118pt'>6.7.5.1</a> Static storage duration <a class='abbr_ref' href='basic.stc.static'>[basic.stc.static]</a></h4><div class='para' id='static-1'><div class='marginalizedparent'><a class='marginalized' href='#static-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L3777'>#</a></div><div id='static-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':storage_duration,static_'></a></span>All variables which do not have dynamic storage duration, do not have thread
storage duration, and are not local
have <a class='hidden_link' href='#def:static_storage_duration' id='def:static_storage_duration'><i >static storage duration</i></a><a class='hidden_link' href='#static-1.sentence-1'>.</a></div> <div id='static-1.sentence-2' class='sentence'>The
storage for these entities lasts for the duration of the
program (<a href='basic.start.static'>[basic.start.static]</a>, <a href='basic.start.term'>[basic.start.term]</a>)<a class='hidden_link' href='#static-1.sentence-2'>.</a></div></div><div class='para' id='static-2'><div class='marginalizedparent'><a class='marginalized' href='#static-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L3785'>#</a></div><div id='static-2.sentence-1' class='sentence'>If a variable with static storage duration has initialization or a
destructor with side effects, it shall not be eliminated even if it
appears to be unused, except that a class object or its copy/move may be
eliminated as specified in <a href='class.copy.elision'>[class.copy.elision]</a><a class='hidden_link' href='#static-2.sentence-1'>.</a></div></div><div class='para' id='static-3'><div class='marginalizedparent'><a class='marginalized' href='#static-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L3791'>#</a></div><div id='static-3.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':object,local_static'></a></span>The keyword <span class='texttt'><span class='keyword'>static</span></span> can be used to declare a local variable with
static storage duration<a class='hidden_link' href='#static-3.sentence-1'>.</a></div> <div id='static-3.note-1' class='note'>[&nbsp;<a class='note_link' href='#static-3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='static-3.sentence-2' class='sentence'><a href='stmt.dcl'>[stmt.dcl]</a> describes the
initialization of local <span class='texttt'><span class='keyword'>static</span></span> variables; <a href='basic.start.term'>[basic.start.term]</a>
describes the destruction of local <span class='texttt'><span class='keyword'>static</span></span> variables<a class='hidden_link' href='#static-3.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='static-4'><div class='marginalizedparent'><a class='marginalized' href='#static-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L3801'>#</a></div><div id='static-4.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':member,class_static'></a></span>The keyword <span class='texttt'><span class='keyword'>static</span></span> applied to a class data member in a class
definition gives the data member static storage duration<a class='hidden_link' href='#static-4.sentence-1'>.</a></div></div></div><div id='thread' class='section'><h4 ><a class='secnum' href='#thread' style='min-width:118pt'>6.7.5.2</a> Thread storage duration <a class='abbr_ref' href='basic.stc.thread'>[basic.stc.thread]</a></h4><div class='para' id='thread-1'><div class='marginalizedparent'><a class='marginalized' href='#thread-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L3808'>#</a></div><div id='thread-1.sentence-1' class='sentence'>All variables declared with the <span class='texttt'><span class='keyword'>thread_&shy;local</span></span> keyword have
<a class='hidden_link' href='#def:storage_duration,thread' id='def:storage_duration,thread'><i >thread storage duration</i></a><a class='hidden_link' href='#thread-1.sentence-1'>.</a></div> <div id='thread-1.sentence-2' class='sentence'>The storage for these entities lasts for the duration of
the thread in which they are created<a class='hidden_link' href='#thread-1.sentence-2'>.</a></div> <div id='thread-1.sentence-3' class='sentence'>There is a distinct object or reference
per thread, and use of the declared name refers to the entity associated with
the current thread<a class='hidden_link' href='#thread-1.sentence-3'>.</a></div></div><div class='para' id='thread-2'><div class='marginalizedparent'><a class='marginalized' href='#thread-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L3816'>#</a></div><div id='thread-2.note-1' class='note'>[&nbsp;<a class='note_link' href='#thread-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='thread-2.sentence-1' class='sentence'>A variable with thread storage duration is initialized as specified
in <a href='basic.start.static'>[basic.start.static]</a>, <a href='basic.start.dynamic'>[basic.start.dynamic]</a>, and <a href='stmt.dcl'>[stmt.dcl]</a>
and, if constructed, is destroyed on thread exit (<a href='basic.start.term'>[basic.start.term]</a>)<a class='hidden_link' href='#thread-2.sentence-1'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div></div><div id='auto' class='section'><h4 ><a class='secnum' href='#auto' style='min-width:118pt'>6.7.5.3</a> Automatic storage duration <a class='abbr_ref' href='basic.stc.auto'>[basic.stc.auto]</a></h4><div class='para' id='auto-1'><div class='marginalizedparent'><a class='marginalized' href='#auto-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L3825'>#</a></div><div id='auto-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':storage_duration,local_object'></a></span>Block-scope variables
not explicitly declared <span class='texttt'><span class='keyword'>static</span></span>, <span class='texttt'><span class='keyword'>thread_&shy;local</span></span>, or <span class='texttt'><span class='keyword'>extern</span></span> have
<a class='hidden_link' href='#def:storage_duration,automatic' id='def:storage_duration,automatic'><i >automatic storage duration</i></a><a class='hidden_link' href='#auto-1.sentence-1'>.</a></div> <div id='auto-1.sentence-2' class='sentence'>The storage
for these entities lasts until the block in which they are created exits<a class='hidden_link' href='#auto-1.sentence-2'>.</a></div></div><div class='para' id='auto-2'><div class='marginalizedparent'><a class='marginalized' href='#auto-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L3832'>#</a></div><div id='auto-2.note-1' class='note'>[&nbsp;<a class='note_link' href='#auto-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='auto-2.sentence-1' class='sentence'>These variables are initialized and destroyed as described in <a href='stmt.dcl'>[stmt.dcl]</a><a class='hidden_link' href='#auto-2.sentence-1'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='auto-3'><div class='marginalizedparent'><a class='marginalized' href='#auto-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L3837'>#</a></div><div id='auto-3.sentence-1' class='sentence'>If a variable with automatic storage duration has initialization or a destructor with side
effects, an implementation shall not destroy it before the end of its block
nor eliminate it as an optimization, even if it appears to be
unused, except that a class object or its copy/move may be eliminated as
specified in <a href='class.copy.elision'>[class.copy.elision]</a><a class='hidden_link' href='#auto-3.sentence-1'>.</a></div></div></div><div id='dynamic' class='section'><h4 ><a class='secnum' href='#dynamic' style='min-width:118pt'>6.7.5.4</a> Dynamic storage duration <a class='abbr_ref' href='basic.stc.dynamic'>[basic.stc.dynamic]</a></h4><span class='indexparent'><a class='index' id=':storage_duration,dynamic_'></a></span><div class='para' id='dynamic-1'><div class='marginalizedparent'><a class='marginalized' href='#dynamic-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L3847'>#</a></div><div id='dynamic-1.sentence-1' class='sentence'>Objects can be created dynamically during <a href='intro.execution'>program
execution</a>, using
<span class='indexparent'><a class='index' id=':new'></a></span><a class='grammarterm' href='expr.new#nt:new-expression'>new-expression</a><span class='textit'>s</span>, and destroyed using
<span class='indexparent'><a class='index' id=':delete'></a></span><a class='grammarterm' href='expr.delete#nt:delete-expression'>delete-expression</a><span class='textit'>s</span><a class='hidden_link' href='#dynamic-1.sentence-1'>.</a></div> <div id='dynamic-1.sentence-2' class='sentence'>A C++ implementation
provides access to, and management of, dynamic storage via the global
<a class='hidden_link' href='#def:allocation_functions' id='def:allocation_functions'><i >allocation functions</i></a> <span class='texttt'><span class='keyword'>operator</span> <span class='keyword'>new</span></span> and <span class='texttt'><span class='keyword'>operator</span>
<span class='keyword'>new</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span></span> and the global <a class='hidden_link' href='#def:deallocation_functions' id='def:deallocation_functions'><i >deallocation functions</i></a> <span class='texttt'><span class='keyword'>operator</span>
<span class='keyword'>delete</span></span> and <span class='texttt'><span class='keyword'>operator</span> <span class='keyword'>delete</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span></span><a class='hidden_link' href='#dynamic-1.sentence-2'>.</a></div> <div id='dynamic-1.note-1' class='note'>[&nbsp;<a class='note_link' href='#dynamic-1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='dynamic-1.sentence-3' class='sentence'>The non-allocating forms described in <a href='new.delete.placement'>[new.delete.placement]</a>
do not perform allocation or deallocation<a class='hidden_link' href='#dynamic-1.sentence-3'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='dynamic-2'><div class='marginalizedparent'><a class='marginalized' href='#dynamic-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L3863'>#</a></div><div id='dynamic-2.sentence-1' class='sentence'>The library provides default definitions for the global allocation and
deallocation functions<a class='hidden_link' href='#dynamic-2.sentence-1'>.</a></div> <div id='dynamic-2.sentence-2' class='sentence'>Some global allocation and deallocation
functions are replaceable (<a href='new.delete'>[new.delete]</a>)<a class='hidden_link' href='#dynamic-2.sentence-2'>.</a></div> <div id='dynamic-2.sentence-3' class='sentence'>A C++ program shall
provide at most one definition of a replaceable allocation or
deallocation function<a class='hidden_link' href='#dynamic-2.sentence-3'>.</a></div> <div id='dynamic-2.sentence-4' class='sentence'>Any such function definition replaces the default
version provided in the library (<a href='replacement.functions'>[replacement.functions]</a>)<a class='hidden_link' href='#dynamic-2.sentence-4'>.</a></div> <div id='dynamic-2.sentence-5' class='sentence'>The
following allocation and deallocation functions (<a href='support.dynamic'>[support.dynamic]</a>)
are implicitly declared in global scope in each translation unit of a
program<a class='hidden_link' href='#dynamic-2.sentence-5'>.</a></div><pre class='codeblock'>
<span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='keyword'>void</span><span class='operator'>*</span> <span class='keyword'>operator</span> <span class='keyword'>new</span><span class='parenthesis'>(</span>std<span class='operator'>::</span>size_t<span class='parenthesis'>)</span>;
<span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='keyword'>void</span><span class='operator'>*</span> <span class='keyword'>operator</span> <span class='keyword'>new</span><span class='parenthesis'>(</span>std<span class='operator'>::</span>size_t, std<span class='operator'>::</span>align_val_t<span class='parenthesis'>)</span>;

<span class='keyword'>void</span> <span class='keyword'>operator</span> <span class='keyword'>delete</span><span class='parenthesis'>(</span><span class='keyword'>void</span><span class='operator'>*</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
<span class='keyword'>void</span> <span class='keyword'>operator</span> <span class='keyword'>delete</span><span class='parenthesis'>(</span><span class='keyword'>void</span><span class='operator'>*</span>, std<span class='operator'>::</span>size_t<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
<span class='keyword'>void</span> <span class='keyword'>operator</span> <span class='keyword'>delete</span><span class='parenthesis'>(</span><span class='keyword'>void</span><span class='operator'>*</span>, std<span class='operator'>::</span>align_val_t<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
<span class='keyword'>void</span> <span class='keyword'>operator</span> <span class='keyword'>delete</span><span class='parenthesis'>(</span><span class='keyword'>void</span><span class='operator'>*</span>, std<span class='operator'>::</span>size_t, std<span class='operator'>::</span>align_val_t<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

<span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='keyword'>void</span><span class='operator'>*</span> <span class='keyword'>operator</span> <span class='keyword'>new</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span>std<span class='operator'>::</span>size_t<span class='parenthesis'>)</span>;
<span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='keyword'>void</span><span class='operator'>*</span> <span class='keyword'>operator</span> <span class='keyword'>new</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span>std<span class='operator'>::</span>size_t, std<span class='operator'>::</span>align_val_t<span class='parenthesis'>)</span>;

<span class='keyword'>void</span> <span class='keyword'>operator</span> <span class='keyword'>delete</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>void</span><span class='operator'>*</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
<span class='keyword'>void</span> <span class='keyword'>operator</span> <span class='keyword'>delete</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>void</span><span class='operator'>*</span>, std<span class='operator'>::</span>size_t<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
<span class='keyword'>void</span> <span class='keyword'>operator</span> <span class='keyword'>delete</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>void</span><span class='operator'>*</span>, std<span class='operator'>::</span>align_val_t<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
<span class='keyword'>void</span> <span class='keyword'>operator</span> <span class='keyword'>delete</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>void</span><span class='operator'>*</span>, std<span class='operator'>::</span>size_t, std<span class='operator'>::</span>align_val_t<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</pre><div id='dynamic-2.sentence-6' class='sentence'>These implicit declarations introduce only the function names
<span class='texttt'><span class='keyword'>operator</span></span> <span class='texttt'><span class='keyword'>new</span></span>, <span class='texttt'><span class='keyword'>operator</span></span> <span class='texttt'><span class='keyword'>new</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span></span>,
<span class='texttt'>operator</span> <span class='texttt'><span class='keyword'>delete</span></span>, and <span class='texttt'><span class='keyword'>operator</span></span>
<span class='texttt'><span class='keyword'>delete</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span></span><a class='hidden_link' href='#dynamic-2.sentence-6'>.</a></div> <div id='dynamic-2.note-1' class='note'>[&nbsp;<a class='note_link' href='#dynamic-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='dynamic-2.sentence-7' class='sentence'>The implicit declarations do not introduce
the names <span class='texttt'>std</span>,
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>size_&shy;t</span>,
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>align_&shy;val_&shy;t</span>,
or any other names that the library uses to
declare these names<a class='hidden_link' href='#dynamic-2.sentence-7'>.</a></div> <div id='dynamic-2.sentence-8' class='sentence'>Thus, a <a class='grammarterm' href='expr.new#nt:new-expression'>new-expression</a>,
<a class='grammarterm' href='expr.delete#nt:delete-expression'>delete-expression</a>, or function call that refers to one of
these functions without importing or including the header <span class='indexparent'><a class='index' id=':<new>'></a></span><span class='texttt'><span class='anglebracket'>&lt;</span><span class='keyword'>new</span><span class='anglebracket'>&gt;</span></span> (<a href='new.syn'>[new.syn]</a>) is
well-formed<a class='hidden_link' href='#dynamic-2.sentence-8'>.</a></div> <div id='dynamic-2.sentence-9' class='sentence'>However, referring to <span class='texttt'>std</span>
or <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>size_&shy;t</span>
or <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>align_&shy;val_&shy;t</span>
is ill-formed unless the name has been declared
by importing or including the appropriate header<a class='hidden_link' href='#dynamic-2.sentence-9'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='dynamic-2.sentence-10' class='sentence'>
Allocation and/or
deallocation functions may also be declared and defined for any
class (<a href='class.free'>[class.free]</a>)<a class='hidden_link' href='#dynamic-2.sentence-10'>.</a></div></div><div class='para' id='dynamic-3'><div class='marginalizedparent'><a class='marginalized' href='#dynamic-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L3915'>#</a></div><div id='dynamic-3.sentence-1' class='sentence'>If the behavior of an allocation or deallocation function
does not satisfy the semantic constraints
specified in <a href='#dynamic.allocation'>[basic.stc.dynamic.allocation]</a>
and <a href='#dynamic.deallocation'>[basic.stc.dynamic.deallocation]</a>,
the behavior is undefined<a class='hidden_link' href='#dynamic-3.sentence-1'>.</a></div></div><div id='dynamic.allocation' class='section'><h4 ><a class='secnum' href='#dynamic.allocation' style='min-width:133pt'>6.7.5.4.1</a> Allocation functions <a class='abbr_ref' href='basic.stc.dynamic.allocation'>[basic.stc.dynamic.allocation]</a></h4><div class='para' id='dynamic.allocation-1'><div class='marginalizedparent'><a class='marginalized' href='#dynamic.allocation-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L3924'>#</a></div><div id='dynamic.allocation-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':function,allocation'></a></span>An allocation function shall be a class member function or a global
function; a program is ill-formed if an allocation function is declared
in a namespace scope other than global scope or declared static in
global scope<a class='hidden_link' href='#dynamic.allocation-1.sentence-1'>.</a></div> <div id='dynamic.allocation-1.sentence-2' class='sentence'>The return type shall be <span class='texttt'><span class='keyword'>void</span><span class='operator'>*</span></span><a class='hidden_link' href='#dynamic.allocation-1.sentence-2'>.</a></div> <div id='dynamic.allocation-1.sentence-3' class='sentence'>The first
parameter shall have type <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>size_&shy;t</span> (<a href='support.types'>[support.types]</a>)<a class='hidden_link' href='#dynamic.allocation-1.sentence-3'>.</a></div> <div id='dynamic.allocation-1.sentence-4' class='sentence'>The
first parameter shall not have an associated default
argument (<a href='dcl.fct.default'>[dcl.fct.default]</a>)<a class='hidden_link' href='#dynamic.allocation-1.sentence-4'>.</a></div> <div id='dynamic.allocation-1.sentence-5' class='sentence'>The value of the first parameter
is interpreted as the requested size of the allocation<a class='hidden_link' href='#dynamic.allocation-1.sentence-5'>.</a></div> <div id='dynamic.allocation-1.sentence-6' class='sentence'>An allocation
function can be a function template<a class='hidden_link' href='#dynamic.allocation-1.sentence-6'>.</a></div> <div id='dynamic.allocation-1.sentence-7' class='sentence'>Such a template shall declare its
return type and first parameter as specified above (that is, template
parameter types shall not be used in the return type and first parameter
type)<a class='hidden_link' href='#dynamic.allocation-1.sentence-7'>.</a></div> <div id='dynamic.allocation-1.sentence-8' class='sentence'>Template allocation functions shall have two or more parameters<a class='hidden_link' href='#dynamic.allocation-1.sentence-8'>.</a></div></div><div class='para' id='dynamic.allocation-2'><div class='marginalizedparent'><a class='marginalized' href='#dynamic.allocation-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L3939'>#</a></div><div id='dynamic.allocation-2.sentence-1' class='sentence'>An allocation function attempts to allocate the requested amount of
storage<a class='hidden_link' href='#dynamic.allocation-2.sentence-1'>.</a></div> <div id='dynamic.allocation-2.sentence-2' class='sentence'>If it is successful, it returns the address of the start
of a block of storage whose length in bytes is at least as large
as the requested size<a class='hidden_link' href='#dynamic.allocation-2.sentence-2'>.</a></div> <div id='dynamic.allocation-2.sentence-3' class='sentence'>The order,
contiguity, and initial value of storage allocated by successive calls
to an allocation function are unspecified<a class='hidden_link' href='#dynamic.allocation-2.sentence-3'>.</a></div> <div id='dynamic.allocation-2.sentence-4' class='sentence'>Even if the size of the space
requested is zero, the request can fail<a class='hidden_link' href='#dynamic.allocation-2.sentence-4'>.</a></div> <div id='dynamic.allocation-2.sentence-5' class='sentence'>If the request succeeds, the
value returned by a replaceable allocation function
is a non-null pointer value (<a href='basic.compound'>[basic.compound]</a>)
<span class='texttt'>p0</span> different from any previously returned value <span class='texttt'>p1</span>,
unless that value <span class='texttt'>p1</span> was subsequently passed to a
replaceable deallocation function<a class='hidden_link' href='#dynamic.allocation-2.sentence-5'>.</a></div> <div id='dynamic.allocation-2.sentence-6' class='sentence'>Furthermore, for the library allocation functions
in <a href='new.delete.single'>[new.delete.single]</a> and <a href='new.delete.array'>[new.delete.array]</a>,
<span class='texttt'>p0</span> represents the address of a block of storage disjoint from the storage
for any other object accessible to the caller<a class='hidden_link' href='#dynamic.allocation-2.sentence-6'>.</a></div> <div id='dynamic.allocation-2.sentence-7' class='sentence'>The effect of indirecting through a pointer
returned from a request for zero size is undefined<a class='hidden_link' href='#dynamic.allocation-2.sentence-7'>.</a><a class='footnotenum' href='#footnote-32' id='footnoteref-32'>32</a></div></div><div class='para' id='dynamic.allocation-3'><div class='marginalizedparent'><a class='marginalized' href='#dynamic.allocation-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L3965'>#</a></div><div id='dynamic.allocation-3.sentence-1' class='sentence'>For an allocation function other than
a reserved placement allocation function (<a href='new.delete.placement'>[new.delete.placement]</a>),
the pointer returned on a successful call
shall represent the address of storage that is aligned as follows:
<ul class='itemize'><li id='dynamic.allocation-3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic.allocation-3.1'>(3.1)</a></div>If the allocation function takes an argument
  of type <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>align_&shy;val_&shy;t</span>,
  the storage will have the alignment specified
  by the value of this argument.</li><li id='dynamic.allocation-3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic.allocation-3.2'>(3.2)</a></div>Otherwise, if the allocation function is named <span class='texttt'><span class='keyword'>operator</span> <span class='keyword'>new</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span></span>,
  the storage is aligned for any object that
  does not have new-extended alignment (<a href='basic.align'>[basic.align]</a>) and
  is no larger than the requested size.</li><li id='dynamic.allocation-3.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic.allocation-3.3'>(3.3)</a></div>Otherwise, the storage is aligned for any object that
  does not have new-extended alignment and is of the requested size.</li></ul></div></div><div class='para' id='dynamic.allocation-4'><div class='marginalizedparent'><a class='marginalized' href='#dynamic.allocation-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L3986'>#</a></div><div id='dynamic.allocation-4.sentence-1' class='sentence'>An allocation function that fails to allocate storage can invoke the
currently installed new-handler function (<a href='new.handler'>[new.handler]</a>), if any<a class='hidden_link' href='#dynamic.allocation-4.sentence-1'>.</a></div> <div id='dynamic.allocation-4.note-1' class='note'>[&nbsp;<a class='note_link' href='#dynamic.allocation-4.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='dynamic.allocation-4.sentence-2' class='sentence'><span class='indexparent'><a class='index' id=':new_handler'></a></span>A program-supplied allocation function can obtain the address of the
currently installed <span class='texttt'>new_&shy;handler</span> using the
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>get_&shy;new_&shy;handler</span> function (<a href='get.new.handler'>[get.new.handler]</a>)<a class='hidden_link' href='#dynamic.allocation-4.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='dynamic.allocation-4.sentence-3' class='sentence'>
An allocation function that has a non-throwing
exception specification (<a href='except.spec'>[except.spec]</a>)
indicates failure by returning
a null pointer value<a class='hidden_link' href='#dynamic.allocation-4.sentence-3'>.</a></div> <div id='dynamic.allocation-4.sentence-4' class='sentence'>Any other allocation function
never returns a null pointer value and
indicates failure only by throwing an exception (<a href='except.throw'>[except.throw]</a>) of a type
that would match a handler (<a href='except.handle'>[except.handle]</a>) of type
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>bad_&shy;alloc</span> (<a href='bad.alloc'>[bad.alloc]</a>)<a class='hidden_link' href='#dynamic.allocation-4.sentence-4'>.</a></div></div><div class='para' id='dynamic.allocation-5'><div class='marginalizedparent'><a class='marginalized' href='#dynamic.allocation-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L4005'>#</a></div><div id='dynamic.allocation-5.sentence-1' class='sentence'>A global allocation function is only called as the result of a <a href='expr.new'>new
expression</a>, or called directly using the <a href='expr.call'>function call</a>
syntax, or called indirectly to allocate storage for
a coroutine state (<a href='dcl.fct.def.coroutine'>[dcl.fct.def.coroutine]</a>),
or called indirectly through calls to the
functions in the C++ standard library<a class='hidden_link' href='#dynamic.allocation-5.sentence-1'>.</a></div> <div id='dynamic.allocation-5.note-1' class='note'>[&nbsp;<a class='note_link' href='#dynamic.allocation-5.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='dynamic.allocation-5.sentence-2' class='sentence'>In particular, a
global allocation function is not called to allocate storage for objects
with <a href='#static'>static storage duration</a>, for objects or references
with <a href='#thread'>thread storage duration</a>, for objects of
type <a href='expr.typeid'><span class='texttt'>std&#x200b;::&#x200b;type_&shy;info</span></a>, or for an
<a href='except.throw'>exception object</a><a class='hidden_link' href='#dynamic.allocation-5.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='footnote' id='footnote-32'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-32'>32)</a></div><div id='footnote-32.sentence-1' class='sentence'>The intent is
to have <span class='texttt'><span class='keyword'>operator</span> <span class='keyword'>new</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> implementable by
calling <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>malloc<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> or <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>calloc<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, so the rules are
substantially the same<a class='hidden_link' href='#footnote-32.sentence-1'>.</a></div> <div id='footnote-32.sentence-2' class='sentence'>C++ differs from C in requiring a zero request
to return a non-null pointer<a class='hidden_link' href='#footnote-32.sentence-2'>.</a></div> <a href='#footnoteref-32'>⮥</a></div></div><div id='dynamic.deallocation' class='section'><h4 ><a class='secnum' href='#dynamic.deallocation' style='min-width:133pt'>6.7.5.4.2</a> Deallocation functions <a class='abbr_ref' href='basic.stc.dynamic.deallocation'>[basic.stc.dynamic.deallocation]</a></h4><div class='para' id='dynamic.deallocation-1'><div class='marginalizedparent'><a class='marginalized' href='#dynamic.deallocation-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L4023'>#</a></div><div id='dynamic.deallocation-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':function,deallocation'></a></span>Deallocation functions shall be class member functions or global
functions; a program is ill-formed if deallocation functions are
declared in a namespace scope other than global scope or declared static
in global scope<a class='hidden_link' href='#dynamic.deallocation-1.sentence-1'>.</a></div></div><div class='para' id='dynamic.deallocation-2'><div class='marginalizedparent'><a class='marginalized' href='#dynamic.deallocation-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L4030'>#</a></div><div id='dynamic.deallocation-2.sentence-1' class='sentence'>A deallocation function
is a <a class='hidden_link' href='#def:operator_delete,destroying' id='def:operator_delete,destroying'><i >destroying operator delete</i></a>
if it has at least two parameters
and its second parameter
is of type <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>destroying_&shy;delete_&shy;t</span><a class='hidden_link' href='#dynamic.deallocation-2.sentence-1'>.</a></div> <div id='dynamic.deallocation-2.sentence-2' class='sentence'>A destroying operator delete
shall be a class member function named <span class='texttt'><span class='keyword'>operator</span> <span class='keyword'>delete</span></span><a class='hidden_link' href='#dynamic.deallocation-2.sentence-2'>.</a></div> <div id='dynamic.deallocation-2.note-1' class='note'>[&nbsp;<a class='note_link' href='#dynamic.deallocation-2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='dynamic.deallocation-2.sentence-3' class='sentence'>Array deletion cannot use a destroying operator delete<a class='hidden_link' href='#dynamic.deallocation-2.sentence-3'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='dynamic.deallocation-3'><div class='marginalizedparent'><a class='marginalized' href='#dynamic.deallocation-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L4042'>#</a></div><div id='dynamic.deallocation-3.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':delete,overloading_and'></a></span>Each deallocation function shall return <span class='texttt'><span class='keyword'>void</span></span><a class='hidden_link' href='#dynamic.deallocation-3.sentence-1'>.</a></div> <div id='dynamic.deallocation-3.sentence-2' class='sentence'>If the function is a destroying operator delete
declared in class type <span class='texttt'>C</span>,
the type of its first parameter shall be <span class='texttt'>C<span class='operator'>*</span></span>;
otherwise, the type of its first
parameter shall be <span class='texttt'><span class='keyword'>void</span><span class='operator'>*</span></span><a class='hidden_link' href='#dynamic.deallocation-3.sentence-2'>.</a></div> <div id='dynamic.deallocation-3.sentence-3' class='sentence'>A deallocation function may have more
than one parameter<a class='hidden_link' href='#dynamic.deallocation-3.sentence-3'>.</a></div> <div id='dynamic.deallocation-3.sentence-4' class='sentence'><span class='indexparent'><a class='index' id=':deallocation_function,usual'></a></span>A <a class='hidden_link' href='#def:usual_deallocation_function' id='def:usual_deallocation_function'><i >usual deallocation function</i></a> is a deallocation function
whose parameters after the first are
<ul class='itemize'><li id='dynamic.deallocation-3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic.deallocation-3.1'>(3.1)</a></div>optionally, a parameter of type <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>destroying_&shy;delete_&shy;t</span>, then</li><li id='dynamic.deallocation-3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic.deallocation-3.2'>(3.2)</a></div>optionally, a parameter of type <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>size_&shy;t</span><a class='footnotenum' href='#footnote-33' id='footnoteref-33'>33</a>, then</li><li id='dynamic.deallocation-3.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic.deallocation-3.3'>(3.3)</a></div>optionally, a parameter of type <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>align_&shy;val_&shy;t</span><a class='hidden_link' href='#dynamic.deallocation-3.sentence-4'>.</a></li></ul></div> <div id='dynamic.deallocation-3.sentence-5' class='sentence'>
A destroying operator delete shall be a usual deallocation function<a class='hidden_link' href='#dynamic.deallocation-3.sentence-5'>.</a></div> <div id='dynamic.deallocation-3.sentence-6' class='sentence'>A deallocation function may be an instance of a function
template<a class='hidden_link' href='#dynamic.deallocation-3.sentence-6'>.</a></div> <div id='dynamic.deallocation-3.sentence-7' class='sentence'>Neither the first parameter nor the return type shall depend
on a template parameter<a class='hidden_link' href='#dynamic.deallocation-3.sentence-7'>.</a></div> <div id='dynamic.deallocation-3.sentence-8' class='sentence'>A deallocation
function template shall have two or more function parameters<a class='hidden_link' href='#dynamic.deallocation-3.sentence-8'>.</a></div> <div id='dynamic.deallocation-3.sentence-9' class='sentence'>A template
instance is never a usual deallocation function, regardless of its
signature<a class='hidden_link' href='#dynamic.deallocation-3.sentence-9'>.</a></div></div><div class='para' id='dynamic.deallocation-4'><div class='marginalizedparent'><a class='marginalized' href='#dynamic.deallocation-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L4075'>#</a></div><div id='dynamic.deallocation-4.sentence-1' class='sentence'>If a deallocation function terminates by throwing an exception, the behavior is undefined<a class='hidden_link' href='#dynamic.deallocation-4.sentence-1'>.</a></div> <div id='dynamic.deallocation-4.sentence-2' class='sentence'>The value of the first argument supplied to a deallocation function may
be a null pointer value; if so, and if the deallocation function is one
supplied in the standard library, the call has no effect<a class='hidden_link' href='#dynamic.deallocation-4.sentence-2'>.</a></div></div><div class='para' id='dynamic.deallocation-5'><div class='marginalizedparent'><a class='marginalized' href='#dynamic.deallocation-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L4081'>#</a></div><div id='dynamic.deallocation-5.sentence-1' class='sentence'>If the argument given to a deallocation function in the standard library
is a pointer that is not the null pointer value (<a href='basic.compound'>[basic.compound]</a>), the
deallocation function shall deallocate the storage referenced by the
pointer, ending the duration of the region of storage<a class='hidden_link' href='#dynamic.deallocation-5.sentence-1'>.</a></div></div><div class='footnote' id='footnote-33'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-33'>33)</a></div><div id='footnote-33.sentence-1' class='sentence'>The global <span class='texttt'><span class='keyword'>operator</span> <span class='keyword'>delete</span><span class='parenthesis'>(</span><span class='keyword'>void</span><span class='operator'>*</span>, std<span class='operator'>&#x200b;::&#x200b;</span>size_&shy;t<span class='parenthesis'>)</span></span>
precludes use of an
allocation function <span class='texttt'><span class='keyword'>void</span> <span class='keyword'>operator</span> <span class='keyword'>new</span><span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>size_&shy;t, std<span class='operator'>&#x200b;::&#x200b;</span>size_&shy;t<span class='parenthesis'>)</span></span> as a placement
allocation function (<a href='diff.cpp11.basic'>[diff.cpp11.basic]</a>)<a class='hidden_link' href='#footnote-33.sentence-1'>.</a></div> <a href='#footnoteref-33'>⮥</a></div></div><div id='dynamic.safety' class='section'><h4 ><a class='secnum' href='#dynamic.safety' style='min-width:133pt'>6.7.5.4.3</a> Safely-derived pointers <a class='abbr_ref' href='basic.stc.dynamic.safety'>[basic.stc.dynamic.safety]</a></h4><div class='para' id='dynamic.safety-1'><div class='marginalizedparent'><a class='marginalized' href='#dynamic.safety-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L4089'>#</a></div><div id='dynamic.safety-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':pointer,safely-derived'></a></span><span class='indexparent'><a class='index' id=':pointer,to_traceable_object'></a></span>A <a class='hidden_link' href='#def:traceable_pointer_object' id='def:traceable_pointer_object'><i >traceable pointer object</i></a> is
<ul class='itemize'><li id='dynamic.safety-1.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic.safety-1.1'>(1.1)</a></div>an object of an <a href='basic.compound#def:object_pointer_type'>object pointer type</a>, or</li><li id='dynamic.safety-1.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic.safety-1.2'>(1.2)</a></div>an object of an integral type that is at least as large as <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>intptr_&shy;t</span>,
or</li><li id='dynamic.safety-1.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic.safety-1.3'>(1.3)</a></div>a sequence of elements in an array of
<a href='basic.fundamental#def:type,narrow_character'>narrow character type</a>, where the size and alignment of the sequence
match those of some object pointer type<a class='hidden_link' href='#dynamic.safety-1.sentence-1'>.</a></li></ul></div></div><div class='para' id='dynamic.safety-2'><div class='marginalizedparent'><a class='marginalized' href='#dynamic.safety-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L4102'>#</a></div><div id='dynamic.safety-2.sentence-1' class='sentence'>A pointer value is a <a class='hidden_link' href='#def:safely-derived_pointer' id='def:safely-derived_pointer'><i >safely-derived pointer</i></a> to an object with dynamic storage duration
only if the pointer value has an object pointer type
and is one of the following:
<ul class='itemize'><li id='dynamic.safety-2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic.safety-2.1'>(2.1)</a></div>the value returned by a call to the C++ standard library implementation of
<span class='texttt'><span class='operator'>&#x200b;::&#x200b;</span><span class='keyword'>operator</span> <span class='keyword'>new</span><span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>&#x200b;size_&shy;t<span class='parenthesis'>)</span></span> or
<span class='texttt'><span class='operator'>&#x200b;::&#x200b;</span><span class='keyword'>operator</span> <span class='keyword'>new</span><span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>size_&shy;t, std<span class='operator'>&#x200b;::&#x200b;</span>align_&shy;val_&shy;t<span class='parenthesis'>)</span></span>;<a class='footnotenum' href='#footnote-34' id='footnoteref-34'>34</a></li><li id='dynamic.safety-2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic.safety-2.2'>(2.2)</a></div>the result of taking the address of an object (or one of its
  subobjects) designated by an lvalue resulting from indirection
  through a safely-derived pointer value;</li><li id='dynamic.safety-2.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic.safety-2.3'>(2.3)</a></div>the result of well-defined pointer arithmetic (<a href='expr.add'>[expr.add]</a>) using a safely-derived pointer
value;</li><li id='dynamic.safety-2.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic.safety-2.4'>(2.4)</a></div>the result of a well-defined pointer
conversion (<a href='conv.ptr'>[conv.ptr]</a>, <a href='expr.type.conv'>[expr.type.conv]</a>, <a href='expr.static.cast'>[expr.static.cast]</a>,
<a href='expr.cast'>[expr.cast]</a>) of a safely-derived pointer value;</li><li id='dynamic.safety-2.5'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic.safety-2.5'>(2.5)</a></div>the result of a <span class='texttt'><span class='keyword'>reinterpret_&shy;cast</span></span> of a safely-derived pointer value;</li><li id='dynamic.safety-2.6'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic.safety-2.6'>(2.6)</a></div>the result of a <span class='texttt'><span class='keyword'>reinterpret_&shy;cast</span></span> of an integer representation of a
safely-derived pointer value;</li><li id='dynamic.safety-2.7'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic.safety-2.7'>(2.7)</a></div>the value of an object whose value was copied from a traceable pointer object,
where at the time of the copy the source object contained a copy of a safely-derived
pointer value<a class='hidden_link' href='#dynamic.safety-2.sentence-1'>.</a></li></ul></div></div><div class='para' id='dynamic.safety-3'><div class='marginalizedparent'><a class='marginalized' href='#dynamic.safety-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L4137'>#</a></div><div id='dynamic.safety-3.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':integer_representation'></a></span><span class='indexparent'><a class='index' id=':pointer,integer_representation_of_safely-derived'></a></span>An integer value is an <a class='hidden_link' href='#def:safely-derived_pointer,integer_representation' id='def:safely-derived_pointer,integer_representation'><i >integer representation of a safely-derived pointer</i></a>
only if its type is at least as large as <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>intptr_&shy;t</span> and it is one of the
following:
<ul class='itemize'><li id='dynamic.safety-3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic.safety-3.1'>(3.1)</a></div>the result of a <span class='texttt'><span class='keyword'>reinterpret_&shy;cast</span></span> of a safely-derived pointer value;</li><li id='dynamic.safety-3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic.safety-3.2'>(3.2)</a></div>the result of a valid conversion of an integer representation of a safely-derived
pointer value;</li><li id='dynamic.safety-3.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic.safety-3.3'>(3.3)</a></div>the value of an object whose value was copied from a traceable pointer object,
where at the time of the copy the source object contained an integer representation of a
safely-derived pointer value;</li><li id='dynamic.safety-3.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#dynamic.safety-3.4'>(3.4)</a></div>the result of an additive or bitwise operation, one of whose operands is an
integer representation of a safely-derived pointer value <span class='texttt'>P</span>, if that result
converted by <span class='texttt'><span class='keyword'>reinterpret_&shy;cast</span><span class='anglebracket'>&lt;</span><span class='keyword'>void</span><span class='operator'>*</span><span class='anglebracket'>&gt;</span></span> would compare equal to a safely-derived
pointer computable from <span class='texttt'><span class='keyword'>reinterpret_&shy;cast</span><span class='anglebracket'>&lt;</span><span class='keyword'>void</span><span class='operator'>*</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>P<span class='parenthesis'>)</span></span><a class='hidden_link' href='#dynamic.safety-3.sentence-1'>.</a></li></ul></div></div><div class='para' id='dynamic.safety-4'><div class='marginalizedparent'><a class='marginalized' href='#dynamic.safety-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L4159'>#</a></div><div id='dynamic.safety-4.sentence-1' class='sentence'>An implementation may have <a class='hidden_link' href='#def:relaxed_pointer_safety' id='def:relaxed_pointer_safety'><i >relaxed pointer safety</i></a>, in which case the
validity of a pointer value does not depend on whether it is a safely-derived
pointer value<a class='hidden_link' href='#dynamic.safety-4.sentence-1'>.</a></div> <div id='dynamic.safety-4.sentence-2' class='sentence'>Alternatively, an implementation may have <a class='hidden_link' href='#def:strict_pointer_safety' id='def:strict_pointer_safety'><i >strict pointer
safety</i></a>, in which case a pointer value referring to an object with dynamic
storage duration that is not a safely-derived pointer
value is an invalid pointer value unless
the referenced complete object has previously been declared
reachable (<a href='util.dynamic.safety'>[util.dynamic.safety]</a>)<a class='hidden_link' href='#dynamic.safety-4.sentence-2'>.</a></div> <div id='dynamic.safety-4.note-1' class='note'>[&nbsp;<a class='note_link' href='#dynamic.safety-4.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='dynamic.safety-4.sentence-3' class='sentence'>The effect of using an invalid pointer value (including passing it to a
deallocation function) is undefined, see <a href='#basic.stc'>[basic.stc]</a><a class='hidden_link' href='#dynamic.safety-4.sentence-3'>.</a></div> <div id='dynamic.safety-4.sentence-4' class='sentence'>This is true even if the unsafely-derived pointer value might compare equal to
some safely-derived pointer value<a class='hidden_link' href='#dynamic.safety-4.sentence-4'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='dynamic.safety-4.sentence-5' class='sentence'>
It is
<span class='indexparent'><a class='index' id=':whether_an_implementation_has_relaxed_or_strict_pointer_safety'></a></span>implementation-defined whether an implementation has relaxed or strict pointer safety<a class='hidden_link' href='#dynamic.safety-4.sentence-5'>.</a></div> </div><div class='footnote' id='footnote-34'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-34'>34)</a></div><div id='footnote-34.sentence-1' class='sentence'>This subclause does not impose restrictions
on indirection through pointers to memory not allocated by <span class='texttt'><span class='operator'>&#x200b;::&#x200b;</span><span class='keyword'>operator</span> <span class='keyword'>new</span></span><a class='hidden_link' href='#footnote-34.sentence-1'>.</a></div> <div id='footnote-34.sentence-2' class='sentence'>This
maintains the ability of many C++ implementations to use binary libraries and
components written in other languages<a class='hidden_link' href='#footnote-34.sentence-2'>.</a></div> <div id='footnote-34.sentence-3' class='sentence'>In particular, this applies to C binaries,
because indirection through pointers to memory allocated by <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>malloc</span> is not restricted<a class='hidden_link' href='#footnote-34.sentence-3'>.</a></div> <a href='#footnoteref-34'>⮥</a></div></div></div><div id='inherit' class='section'><h4 ><a class='secnum' href='#inherit' style='min-width:118pt'>6.7.5.5</a> Duration of subobjects <a class='abbr_ref' href='basic.stc.inherit'>[basic.stc.inherit]</a></h4><div class='para' id='inherit-1'><div class='marginalizedparent'><a class='marginalized' href='#inherit-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/basic.tex#L4182'>#</a></div><div id='inherit-1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':storage_duration,class_member'></a></span>The storage duration of subobjects and reference members
is that of their complete object (<a href='intro.object'>[intro.object]</a>)<a class='hidden_link' href='#inherit-1.sentence-1'>.</a></div> </div></div></div></body></html>