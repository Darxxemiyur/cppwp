<!DOCTYPE html><html lang='en'><head><title>[format.formatter]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>20</a> General utilities library <a class='abbr_ref' href='./#utilities'>[utilities]</a></h1><h2 ><a class='secnum' style='min-width:65pt'>20.20</a> Formatting <a class='abbr_ref' href='format#formatter'>[format]</a></h2><h3 ><a class='secnum' style='min-width:80pt'>20.20.5</a> Formatter <a class='abbr_ref'>[format.formatter]</a></h3><div id='formatter.requirements' class='section'><h4 ><a class='secnum' href='#formatter.requirements' style='min-width:95pt'>20.20.5.1</a> Formatter requirements <a class='abbr_ref' href='formatter.requirements'>[formatter.requirements]</a></h4><div class='para' id='formatter.requirements-1'><div class='marginalizedparent'><a class='marginalized' href='#formatter.requirements-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20156'>#</a></div><div class='texpara'><div id='formatter.requirements-1.sentence-1' class='sentence'>A type <span class='texttt'>F</span> meets the <a class='index' id='def:Formatter'></a><i >Formatter</i> requirements if:
<ul class='itemize'><li id='formatter.requirements-1.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#formatter.requirements-1.1'>(1.1)</a></div>it meets the
<ul class='itemize'><li id='formatter.requirements-1.1.1'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#formatter.requirements-1.1.1'>(1.1.1)</a></div><i >Cpp17DefaultConstructible</i> (Table <a href='utility.arg.requirements#tab:cpp17.defaultconstructible' title='Table 29: Cpp17DefaultConstructible requirements'>29</a>),</li><li id='formatter.requirements-1.1.2'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#formatter.requirements-1.1.2'>(1.1.2)</a></div><i >Cpp17CopyConstructible</i> (Table <a href='utility.arg.requirements#tab:cpp17.copyconstructible' title='Table 31: Cpp17CopyConstructible requirements (in addition to Cpp17MoveConstructible)'>31</a>),</li><li id='formatter.requirements-1.1.3'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#formatter.requirements-1.1.3'>(1.1.3)</a></div><i >Cpp17CopyAssignable</i> (Table <a href='utility.arg.requirements#tab:cpp17.copyassignable' title='Table 33: Cpp17CopyAssignable requirements (in addition to Cpp17MoveAssignable)'>33</a>), and</li><li id='formatter.requirements-1.1.4'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#formatter.requirements-1.1.4'>(1.1.4)</a></div><i >Cpp17Destructible</i> (Table <a href='utility.arg.requirements#tab:cpp17.destructible' title='Table 34: Cpp17Destructible requirements'>34</a>)</li></ul>
requirements,</li><li id='formatter.requirements-1.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#formatter.requirements-1.2'>(1.2)</a></div>it is swappable (<a href='swappable.requirements' title='16.4.4.3&emsp;Swappable requirements'>[swappable.<span class='shy'></span>requirements]</a>) for lvalues, and</li><li id='formatter.requirements-1.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#formatter.requirements-1.3'>(1.3)</a></div>the expressions shown in Table <a href='#tab:formatter' title='Table 69: Formatter requirements'>69</a> are valid and
have the indicated semantics<a class='hidden_link' href='#formatter.requirements-1.sentence-1'>.</a></li></ul></div></div></div><div class='para' id='formatter.requirements-2'><div class='marginalizedparent'><a class='marginalized' href='#formatter.requirements-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20177'>#</a></div><div class='texpara'><div id='formatter.requirements-2.sentence-1' class='sentence'>Given character type <span class='texttt'>charT</span>, output iterator type
<span class='texttt'>Out</span>, and formatting argument type <span class='texttt'>T</span>,
in Table <a href='#tab:formatter' title='Table 69: Formatter requirements'>69</a>:
<ul class='itemize'><li id='formatter.requirements-2.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#formatter.requirements-2.1'>(2.1)</a></div><span class='texttt'>f</span> is a value of type <span class='texttt'>F</span>,</li><li id='formatter.requirements-2.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#formatter.requirements-2.2'>(2.2)</a></div><span class='texttt'>u</span> is an lvalue of type <span class='texttt'>T</span>,</li><li id='formatter.requirements-2.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#formatter.requirements-2.3'>(2.3)</a></div><span class='texttt'>t</span> is a value of a type convertible to (possibly const) <span class='texttt'>T</span>,</li><li id='formatter.requirements-2.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#formatter.requirements-2.4'>(2.4)</a></div><span class='texttt'>PC</span> is <span class='texttt'>basic_&shy;format_&shy;parse_&shy;context<span class='anglebracket'>&lt;</span>charT<span class='anglebracket'>&gt;</span></span>,</li><li id='formatter.requirements-2.5'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#formatter.requirements-2.5'>(2.5)</a></div><span class='texttt'>FC</span> is <span class='texttt'>basic_&shy;format_&shy;context<span class='anglebracket'>&lt;</span>Out, charT<span class='anglebracket'>&gt;</span></span>,</li><li id='formatter.requirements-2.6'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#formatter.requirements-2.6'>(2.6)</a></div><span class='texttt'>pc</span> is an lvalue of type <span class='texttt'>PC</span>, and</li><li id='formatter.requirements-2.7'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#formatter.requirements-2.7'>(2.7)</a></div><span class='texttt'>fc</span> is an lvalue of type <span class='texttt'>FC</span><a class='hidden_link' href='#formatter.requirements-2.sentence-1'>.</a></li></ul></div> <div id='formatter.requirements-2.sentence-2' class='sentence'><span class='texttt'>pc<span class='operator'>.</span>begin<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> points to the beginning of the
<span class='textsf'><i >format-spec</i></span> (<a href='format.string' title='20.20.2&emsp;Format string'>[format.<span class='shy'></span>string]</a>)
of the replacement field being formatted
in the format string<a class='hidden_link' href='#formatter.requirements-2.sentence-2'>.</a></div> <div id='formatter.requirements-2.sentence-3' class='sentence'>If <span class='textsf'><i >format-spec</i></span> is empty then either
<span class='texttt'>pc<span class='operator'>.</span>begin<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> pc<span class='operator'>.</span>end<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> or
<span class='texttt'><span class='operator'>*</span>pc<span class='operator'>.</span>begin<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>'}'</span></span><a class='hidden_link' href='#formatter.requirements-2.sentence-3'>.</a></div></div><div class='texpara'><div class='numberedTable' id='tab:formatter'>Table <a href='#tab:formatter'>69</a>: <i >Formatter</i> requirements&emsp;<a href='./tab:formatter'>[tab:formatter]</a><br><table ><tr id='tab:formatter-row-1' class='rowsep'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:formatter-row-1'>ðŸ”—</a></div></td><td class='justify' style='width:1.2in'><div class='texpara'><div id='tab:formatter-row-1-column-1-sentence-1' class='sentence'><b>Expression</b></div></div></td><td class='justify' style='width:1in'><div class='texpara'><div id='tab:formatter-row-1-column-2-sentence-1' class='sentence'><b>Return type</b></div></div></td><td class='justify' style='width:2.9in'><div class='texpara'><div id='tab:formatter-row-1-column-3-sentence-1' class='sentence'><b>Requirement</b></div></div></td></tr><tr id='tab:formatter-row-2' class='capsep'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:formatter-row-2'>ðŸ”—</a></div></td><td class='justify' style='width:1.2in'><div class='texpara'><div id='tab:formatter-row-2-column-1-sentence-1' class='sentence'><span class='texttt'>f<span class='operator'>.</span>parse<span class='parenthesis'>(</span>pc<span class='parenthesis'>)</span></span></div></div></td><td class='justify' style='width:1in'><div class='texpara'><div id='tab:formatter-row-2-column-2-sentence-1' class='sentence'><span class='texttt'>PC<span class='operator'>&#x200b;::&#x200b;</span>iterator</span></div></div></td><td class='justify' style='width:2.9in'><div class='texpara'><div id='tab:formatter-row-2-column-3-sentence-1' class='sentence'>Parses <span class='textsf'><i >format-spec</i></span> (<a href='format.string' title='20.20.2&emsp;Format string'>[format.<span class='shy'></span>string]</a>)
for type <span class='texttt'>T</span>
in the range [<span class='texttt'>pc<span class='operator'>.</span>begin<span class='parenthesis'>(</span><span class='parenthesis'>)</span>, pc<span class='operator'>.</span>end<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>)
until the first unmatched character<a class='hidden_link' href='#tab:formatter-row-2-column-3-sentence-1'>.</a></div> <div id='tab:formatter-row-2-column-3-sentence-2' class='sentence'>Throws <span class='texttt'>format_&shy;error</span> unless the whole range is parsed
or the unmatched character is <span class='texttt'><span class='curlybracket'>}</span></span><a class='hidden_link' href='#tab:formatter-row-2-column-3-sentence-2'>.</a></div> <div id='tab:formatter-row-2-column-3-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#tab:formatter-row-2-column-3-note-1'>1</a></i>: <div id='tab:formatter-row-2-column-3-sentence-3' class='sentence'>This allows formatters to emit meaningful error messages<a class='hidden_link' href='#tab:formatter-row-2-column-3-sentence-3'>.</a></div> â€”&nbsp;<i>end note</i>]</div></div> <div id='tab:formatter-row-2-column-3-sentence-4' class='sentence'>
Stores the parsed format specifiers in <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> and
returns an iterator past the end of the parsed range<a class='hidden_link' href='#tab:formatter-row-2-column-3-sentence-4'>.</a></div></div></td></tr><tr id='tab:formatter-row-3' class='rowsep'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:formatter-row-3'>ðŸ”—</a></div></td><td class='justify' style='width:1.2in'><div class='texpara'><div id='tab:formatter-row-3-column-1-sentence-1' class='sentence'><span class='texttt'>f<span class='operator'>.</span>format<span class='parenthesis'>(</span>t, fc<span class='parenthesis'>)</span></span></div></div></td><td class='justify' style='width:1in'><div class='texpara'><div id='tab:formatter-row-3-column-2-sentence-1' class='sentence'><span class='texttt'>FC<span class='operator'>&#x200b;::&#x200b;</span>iterator</span></div></div></td><td class='justify' style='width:2.9in'><div class='texpara'><div id='tab:formatter-row-3-column-3-sentence-1' class='sentence'>Formats <span class='texttt'>t</span> according to the specifiers stored in <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span>,
writes the output to <span class='texttt'>fc<span class='operator'>.</span>out<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> and
returns an iterator past the end of the output range<a class='hidden_link' href='#tab:formatter-row-3-column-3-sentence-1'>.</a></div> <div id='tab:formatter-row-3-column-3-sentence-2' class='sentence'>The output shall only depend on
<span class='texttt'>t</span>,
<span class='texttt'>fc<span class='operator'>.</span>locale<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>,
and the range [<span class='texttt'>pc<span class='operator'>.</span>begin<span class='parenthesis'>(</span><span class='parenthesis'>)</span>, pc<span class='operator'>.</span>end<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>)
from the last call to <span class='texttt'>f<span class='operator'>.</span>parse<span class='parenthesis'>(</span>pc<span class='parenthesis'>)</span></span><a class='hidden_link' href='#tab:formatter-row-3-column-3-sentence-2'>.</a></div></div></td></tr><tr id='tab:formatter-row-4' class='rowsep'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:formatter-row-4'>ðŸ”—</a></div></td><td class='justify' style='width:1.2in'><div class='texpara'><div id='tab:formatter-row-4-column-1-sentence-1' class='sentence'><span class='texttt'>f<span class='operator'>.</span>format<span class='parenthesis'>(</span>u, fc<span class='parenthesis'>)</span></span></div></div></td><td class='justify' style='width:1in'><div class='texpara'><div id='tab:formatter-row-4-column-2-sentence-1' class='sentence'><span class='texttt'>FC<span class='operator'>&#x200b;::&#x200b;</span>iterator</span></div></div></td><td class='justify' style='width:2.9in'><div class='texpara'><div id='tab:formatter-row-4-column-3-sentence-1' class='sentence'>As above, but does not modify <span class='texttt'>u</span><a class='hidden_link' href='#tab:formatter-row-4-column-3-sentence-1'>.</a></div></div></td></tr></table></div></div></div></div><div id='spec' class='section'><h4 ><a class='secnum' href='#spec' style='min-width:95pt'>20.20.5.2</a> Formatter specializations <a class='abbr_ref' href='format.formatter.spec'>[format.formatter.spec]</a></h4><div class='texpara'><a class='index' id='lib:formatter'></a></div><div class='para' id='spec-1'><div class='marginalizedparent'><a class='marginalized' href='#spec-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20236'>#</a></div><div class='texpara'><div id='spec-1.sentence-1' class='sentence'>The functions defined in <a href='format.functions' title='20.20.4&emsp;Formatting functions'>[format.<span class='shy'></span>functions]</a> use
specializations of the class template <span class='texttt'>formatter</span> to format
individual arguments<a class='hidden_link' href='#spec-1.sentence-1'>.</a></div></div></div><div class='para' id='spec-2'><div class='marginalizedparent'><a class='marginalized' href='#spec-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20242'>#</a></div><div class='texpara'><div id='spec-2.sentence-1' class='sentence'>Let <span class='texttt'>charT</span> be either <span class='texttt'><span class='keyword'>char</span></span> or <span class='texttt'><span class='keyword'>wchar_&shy;t</span></span><a class='hidden_link' href='#spec-2.sentence-1'>.</a></div> <div id='spec-2.sentence-2' class='sentence'>Each specialization of <span class='texttt'>formatter</span> is either enabled or disabled,
as described below<a class='hidden_link' href='#spec-2.sentence-2'>.</a></div> <div id='spec-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#spec-note-1'>1</a></i>: <div id='spec-2.sentence-3' class='sentence'>Enabled specializations meet the <i >Formatter</i> requirements,
and disabled specializations do not<a class='hidden_link' href='#spec-2.sentence-3'>.</a></div> â€”&nbsp;<i>end note</i>]</div></div> <div id='spec-2.sentence-4' class='sentence'>
Each header that declares the template <span class='texttt'>formatter</span>
provides the following enabled specializations:
<ul class='itemize'><li id='spec-2.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#spec-2.1'>(2.1)</a></div><a class='index' id='lib:formatter,specializations,character_types'></a>The specializations
<span class='codeblock'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> formatter<span class='anglebracket'>&lt;</span><span class='keyword'>char</span>, <span class='keyword'>char</span><span class='anglebracket'>&gt;</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> formatter<span class='anglebracket'>&lt;</span><span class='keyword'>char</span>, <span class='keyword'>wchar_t</span><span class='anglebracket'>&gt;</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> formatter<span class='anglebracket'>&lt;</span><span class='keyword'>wchar_t</span>, <span class='keyword'>wchar_t</span><span class='anglebracket'>&gt;</span>;
</span></li><li id='spec-2.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#spec-2.2'>(2.2)</a></div><a class='index' id='lib:formatter,specializations,string_types'></a>For each <span class='texttt'>charT</span>,
the string type specializations
<span class='codeblock'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> formatter<span class='anglebracket'>&lt;</span>charT<span class='operator'>*</span>, charT<span class='anglebracket'>&gt;</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> formatter<span class='anglebracket'>&lt;</span><span class='keyword'>const</span> charT<span class='operator'>*</span>, charT<span class='anglebracket'>&gt;</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span>size_t N<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> formatter<span class='anglebracket'>&lt;</span><span class='keyword'>const</span> charT<span class='squarebracket'>[</span>N<span class='squarebracket'>]</span>, charT<span class='anglebracket'>&gt;</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> traits, <span class='keyword'>class</span> Allocator<span class='anglebracket'>&gt;</span>
  <span class='keyword'>struct</span> formatter<span class='anglebracket'>&lt;</span>basic_string<span class='anglebracket'>&lt;</span>charT, traits, Allocator<span class='anglebracket'>&gt;</span>, charT<span class='anglebracket'>&gt;</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> traits<span class='anglebracket'>&gt;</span>
  <span class='keyword'>struct</span> formatter<span class='anglebracket'>&lt;</span>basic_string_view<span class='anglebracket'>&lt;</span>charT, traits<span class='anglebracket'>&gt;</span>, charT<span class='anglebracket'>&gt;</span>;
</span></li><li id='spec-2.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#spec-2.3'>(2.3)</a></div><a class='index' id='lib:formatter,specializations,arithmetic_types'></a>For each <span class='texttt'>charT</span>,
for each cv-unqualified arithmetic type <span class='texttt'>ArithmeticT</span>
other than
<span class='texttt'><span class='keyword'>char</span></span>,
<span class='texttt'><span class='keyword'>wchar_&shy;t</span></span>,
<span class='texttt'><span class='keyword'>char8_&shy;t</span></span>,
<span class='texttt'><span class='keyword'>char16_&shy;t</span></span>, or
<span class='texttt'><span class='keyword'>char32_&shy;t</span></span>,
a specialization
<span class='codeblock'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> formatter<span class='anglebracket'>&lt;</span>ArithmeticT, charT<span class='anglebracket'>&gt;</span>;
</span></li><li id='spec-2.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#spec-2.4'>(2.4)</a></div><a class='index' id='lib:formatter,specializations,pointer_types'></a><a class='index' id='lib:formatter,specializations,nullptr_t'></a>For each <span class='texttt'>charT</span>,
the pointer type specializations
<span class='codeblock'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> formatter<span class='anglebracket'>&lt;</span>nullptr_t, charT<span class='anglebracket'>&gt;</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> formatter<span class='anglebracket'>&lt;</span><span class='keyword'>void</span><span class='operator'>*</span>, charT<span class='anglebracket'>&gt;</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> formatter<span class='anglebracket'>&lt;</span><span class='keyword'>const</span> <span class='keyword'>void</span><span class='operator'>*</span>, charT<span class='anglebracket'>&gt;</span>;
</span></li></ul>
The <span class='texttt'>parse</span> member functions of these formatters
interpret the format specification
as a <span class='textsf'><i >std-format-spec</i></span>
as described in <a href='format.string.std' title='20.20.2.2&emsp;Standard format specifiers'>[format.<span class='shy'></span>string.<span class='shy'></span>std]</a><a class='hidden_link' href='#spec-2.sentence-4'>.</a></div> <div id='spec-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#spec-note-2'>2</a></i>: <div id='spec-2.sentence-5' class='sentence'>Specializations such as <span class='texttt'>formatter<span class='anglebracket'>&lt;</span><span class='keyword'>wchar_&shy;t</span>, <span class='keyword'>char</span><span class='anglebracket'>&gt;</span></span>
and <span class='texttt'>formatter<span class='anglebracket'>&lt;</span><span class='keyword'>const</span> <span class='keyword'>char</span><span class='operator'>*</span>, <span class='keyword'>wchar_&shy;t</span><span class='anglebracket'>&gt;</span></span>
that would require implicit
multibyte / wide string or character conversion are disabled<a class='hidden_link' href='#spec-2.sentence-5'>.</a></div> â€”&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='spec-3'><div class='marginalizedparent'><a class='marginalized' href='#spec-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20313'>#</a></div><div class='texpara'><div id='spec-3.sentence-1' class='sentence'>For any types <span class='texttt'>T</span> and <span class='texttt'>charT</span> for which
neither the library nor the user provides
an explicit or partial specialization of
the class template <span class='texttt'>formatter</span>,
<span class='texttt'>formatter<span class='anglebracket'>&lt;</span>T, charT<span class='anglebracket'>&gt;</span></span> is disabled<a class='hidden_link' href='#spec-3.sentence-1'>.</a></div></div></div><div class='para' id='spec-4'><div class='marginalizedparent'><a class='marginalized' href='#spec-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20320'>#</a></div><div class='texpara'><div id='spec-4.sentence-1' class='sentence'>If the library provides an explicit or partial specialization of
<span class='texttt'>formatter<span class='anglebracket'>&lt;</span>T, charT<span class='anglebracket'>&gt;</span></span>, that specialization is enabled
except as noted otherwise<a class='hidden_link' href='#spec-4.sentence-1'>.</a></div></div></div><div class='para' id='spec-5'><div class='marginalizedparent'><a class='marginalized' href='#spec-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20325'>#</a></div><div class='texpara'><div id='spec-5.sentence-1' class='sentence'>If <span class='texttt'>F</span> is a disabled specialization of <span class='texttt'>formatter</span>, these
values are <span class='texttt'><span class='literal'>false</span></span>:
<ul class='itemize'><li id='spec-5.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#spec-5.1'>(5.1)</a></div><span class='texttt'>is_&shy;default_&shy;constructible_&shy;v<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span></span>,</li><li id='spec-5.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#spec-5.2'>(5.2)</a></div><span class='texttt'>is_&shy;copy_&shy;constructible_&shy;v<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span></span>,</li><li id='spec-5.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#spec-5.3'>(5.3)</a></div><span class='texttt'>is_&shy;move_&shy;constructible_&shy;v<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span></span>,</li><li id='spec-5.4'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#spec-5.4'>(5.4)</a></div><span class='texttt'>is_&shy;copy_&shy;assignable_&shy;v<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span></span>, and</li><li id='spec-5.5'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#spec-5.5'>(5.5)</a></div><span class='texttt'>is_&shy;move_&shy;assignable_&shy;v<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#spec-5.sentence-1'>.</a></li></ul></div></div></div><div class='para' id='spec-6'><div class='marginalizedparent'><a class='marginalized' href='#spec-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20336'>#</a></div><div class='texpara'><div id='spec-6.sentence-1' class='sentence'>An enabled specialization <span class='texttt'>formatter<span class='anglebracket'>&lt;</span>T, charT<span class='anglebracket'>&gt;</span></span> meets the
<i >Formatter</i> requirements (<a href='#formatter.requirements' title='20.20.5.1&emsp;Formatter requirements'>[formatter.<span class='shy'></span>requirements]</a>)<a class='hidden_link' href='#spec-6.sentence-1'>.</a></div> <div id='spec-example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#spec-example-1'>1</a></i>: <span class='codeblock'><span class='preprocessordirective'>#include</span> <span class='anglebracket'>&lt;</span>format<span class='anglebracket'>&gt;</span>

<span class='keyword'>enum</span> color <span class='curlybracket'>{</span> red, green, blue <span class='curlybracket'>}</span>;
<span class='keyword'>const</span> <span class='keyword'>char</span><span class='operator'>*</span> color_names<span class='squarebracket'>[</span><span class='squarebracket'>]</span> <span class='operator'>=</span> <span class='curlybracket'>{</span> <span class='literal'>"red"</span>, <span class='literal'>"green"</span>, <span class='literal'>"blue"</span> <span class='curlybracket'>}</span>;

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> std<span class='operator'>::</span>formatter<span class='anglebracket'>&lt;</span>color<span class='anglebracket'>&gt;</span> <span class='operator'>:</span> std<span class='operator'>::</span>formatter<span class='anglebracket'>&lt;</span><span class='keyword'>const</span> <span class='keyword'>char</span><span class='operator'>*</span><span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span>
  <span class='keyword'>auto</span> format<span class='parenthesis'>(</span>color c, format_context<span class='operator'>&amp;</span> ctx<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
    <span class='keyword'>return</span> formatter<span class='anglebracket'>&lt;</span><span class='keyword'>const</span> <span class='keyword'>char</span><span class='operator'>*</span><span class='anglebracket'>&gt;</span><span class='operator'>::</span>format<span class='parenthesis'>(</span>color_names<span class='squarebracket'>[</span>c<span class='squarebracket'>]</span>, ctx<span class='parenthesis'>)</span>;
  <span class='curlybracket'>}</span>
<span class='curlybracket'>}</span>;

<span class='keyword'>struct</span> err <span class='curlybracket'>{</span><span class='curlybracket'>}</span>;

std<span class='operator'>::</span>string s0 <span class='operator'>=</span> std<span class='operator'>::</span>format<span class='parenthesis'>(</span><span class='literal'>"{}"</span>, <span class='literal'>42</span><span class='parenthesis'>)</span>;         <span class='comment'>// OK, library-provided formatter</span>
std<span class='operator'>::</span>string s1 <span class='operator'>=</span> std<span class='operator'>::</span>format<span class='parenthesis'>(</span><span class='literal'>"{}"</span>, <span class='literal'>L"foo"</span><span class='parenthesis'>)</span>;     <span class='comment'>// error: disabled formatter</span>
std<span class='operator'>::</span>string s2 <span class='operator'>=</span> std<span class='operator'>::</span>format<span class='parenthesis'>(</span><span class='literal'>"{}"</span>, red<span class='parenthesis'>)</span>;        <span class='comment'>// OK, user-provided formatter</span>
std<span class='operator'>::</span>string s3 <span class='operator'>=</span> std<span class='operator'>::</span>format<span class='parenthesis'>(</span><span class='literal'>"{}"</span>, err<span class='curlybracket'>{</span><span class='curlybracket'>}</span><span class='parenthesis'>)</span>;      <span class='comment'>// error: disabled formatter</span>
</span> â€”&nbsp;<i>end example</i>]</div></div></div></div></div><div id='format.parse.ctx' class='section'><h4 ><a class='secnum' href='#format.parse.ctx' style='min-width:95pt'>20.20.5.3</a> Class template <span class='texttt'>basic_&shy;format_&shy;parse_&shy;context</span> <a class='abbr_ref' href='format.parse.ctx'>[format.parse.ctx]</a></h4><div class='texpara'><span id='lib:basic_format_parse_context,iterator'><span id='lib:iterator,basic_format_parse_context'><span id='lib:basic_format_parse_context,const_iterator'><span id='lib:const_iterator,basic_format_parse_context'><span id='lib:basic_format_parse_context,char_type'><span id='lib:char_type,basic_format_parse_context'><span id='lib:basic_format_parse_context'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:basic_format_parse_context'>ðŸ”—</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> charT<span class='anglebracket'>&gt;</span>
  <span class='keyword'>class</span> basic_format_parse_context <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    <span class='keyword'>using</span> char_type <span class='operator'>=</span> charT;
    <span class='keyword'>using</span> const_iterator <span class='operator'>=</span> <span class='keyword'>typename</span> basic_string_view<span class='anglebracket'>&lt;</span>charT<span class='anglebracket'>&gt;</span><span class='operator'>::</span>const_iterator;
    <span class='keyword'>using</span> iterator <span class='operator'>=</span> const_iterator;

  <span class='keyword'>private</span><span class='operator'>:</span>
    iterator begin_;                                    <span class='comment'>// <i >exposition only</i></span>
    iterator end_;                                      <span class='comment'>// <i >exposition only</i></span>
    <span class='keyword'>enum</span> indexing <span class='curlybracket'>{</span> unknown, manual, automatic <span class='curlybracket'>}</span>;       <span class='comment'>// <i >exposition only</i></span>
    indexing indexing_;                                 <span class='comment'>// <i >exposition only</i></span>
    size_t next_arg_id_;                                <span class='comment'>// <i >exposition only</i></span>
    size_t num_args_;                                   <span class='comment'>// <i >exposition only</i></span>

  <span class='keyword'>public</span><span class='operator'>:</span>
    <span class='keyword'>constexpr</span> <span class='keyword'>explicit</span> basic_format_parse_context<span class='parenthesis'>(</span>basic_string_view<span class='anglebracket'>&lt;</span>charT<span class='anglebracket'>&gt;</span> fmt,
                                                  size_t num_args <span class='operator'>=</span> <span class='literal'>0</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    basic_format_parse_context<span class='parenthesis'>(</span><span class='keyword'>const</span> basic_format_parse_context<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    basic_format_parse_context<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> basic_format_parse_context<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;

    <span class='keyword'>constexpr</span> const_iterator begin<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>constexpr</span> const_iterator end<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>constexpr</span> <span class='keyword'>void</span> advance_to<span class='parenthesis'>(</span>const_iterator it<span class='parenthesis'>)</span>;

    <span class='keyword'>constexpr</span> size_t next_arg_id<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>constexpr</span> <span class='keyword'>void</span> check_arg_id<span class='parenthesis'>(</span>size_t id<span class='parenthesis'>)</span>;
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></span></span></span></span></span></span></div><div class='para' id='format.parse.ctx-1'><div class='marginalizedparent'><a class='marginalized' href='#format.parse.ctx-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20400'>#</a></div><div class='texpara'><div id='format.parse.ctx-1.sentence-1' class='sentence'>An instance of <span class='texttt'>basic_&shy;format_&shy;parse_&shy;context</span> holds
the format string parsing state consisting of
the format string range being parsed and
the argument counter for automatic indexing<a class='hidden_link' href='#format.parse.ctx-1.sentence-1'>.</a></div></div></div><div class='texpara'><div id='lib:basic_format_parse_context,constructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:basic_format_parse_context,constructor'>ðŸ”—</a></div><code class='itemdeclcode'><span class='keyword'>constexpr</span> <span class='keyword'>explicit</span> basic_format_parse_context<span class='parenthesis'>(</span>basic_string_view<span class='anglebracket'>&lt;</span>charT<span class='anglebracket'>&gt;</span> fmt,
                                              size_t num_args <span class='operator'>=</span> <span class='literal'>0</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='format.parse.ctx-2'><div class='marginalizedparent'><a class='marginalized' href='#format.parse.ctx-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20413'>#</a></div><div class='texpara'><div id='format.parse.ctx-2.sentence-1' class='sentence'><i >Effects</i>: Initializes
<span class='texttt'>begin_&shy;</span> with <span class='texttt'>fmt<span class='operator'>.</span>begin<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>,
<span class='texttt'>end_&shy;</span> with <span class='texttt'>fmt<span class='operator'>.</span>end<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>,
<span class='texttt'>indexing_&shy;</span> with <span class='texttt'>unknown</span>,
<span class='texttt'>next_&shy;arg_&shy;id_&shy;</span> with <span class='texttt'><span class='literal'>0</span></span>, and
<span class='texttt'>num_&shy;args_&shy;</span> with <span class='texttt'>num_&shy;args</span><a class='hidden_link' href='#format.parse.ctx-2.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:basic_format_parse_context,begin'><div id='lib:begin,basic_format_parse_context'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:begin,basic_format_parse_context'>ðŸ”—</a></div><code class='itemdeclcode'><span class='keyword'>constexpr</span> const_iterator begin<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='format.parse.ctx-3'><div class='marginalizedparent'><a class='marginalized' href='#format.parse.ctx-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20429'>#</a></div><div class='texpara'><div id='format.parse.ctx-3.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>begin_&shy;</span><a class='hidden_link' href='#format.parse.ctx-3.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:basic_format_parse_context,end'><div id='lib:end,basic_format_parse_context'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:end,basic_format_parse_context'>ðŸ”—</a></div><code class='itemdeclcode'><span class='keyword'>constexpr</span> const_iterator end<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='format.parse.ctx-4'><div class='marginalizedparent'><a class='marginalized' href='#format.parse.ctx-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20440'>#</a></div><div class='texpara'><div id='format.parse.ctx-4.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>end_&shy;</span><a class='hidden_link' href='#format.parse.ctx-4.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:basic_format_parse_context,advance_to'><div id='lib:advance_to,basic_format_parse_context'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:advance_to,basic_format_parse_context'>ðŸ”—</a></div><code class='itemdeclcode'><span class='keyword'>constexpr</span> <span class='keyword'>void</span> advance_to<span class='parenthesis'>(</span>const_iterator it<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='format.parse.ctx-5'><div class='marginalizedparent'><a class='marginalized' href='#format.parse.ctx-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20451'>#</a></div><div class='texpara'><div id='format.parse.ctx-5.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'>end<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is reachable from <span class='texttt'>it</span><a class='hidden_link' href='#format.parse.ctx-5.sentence-1'>.</a></div></div></div></div><div class='para' id='format.parse.ctx-6'><div class='marginalizedparent'><a class='marginalized' href='#format.parse.ctx-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20455'>#</a></div><div class='texpara'><div id='format.parse.ctx-6.sentence-1' class='sentence'><i >Effects</i>: Equivalent to: <span class='texttt'>begin_&shy; <span class='operator'>=</span> it;</span></div></div></div></div><div class='texpara'><div id='lib:basic_format_parse_context,next_arg_id'><div id='lib:next_arg_id,basic_format_parse_context'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:next_arg_id,basic_format_parse_context'>ðŸ”—</a></div><code class='itemdeclcode'><span class='keyword'>constexpr</span> size_t next_arg_id<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='format.parse.ctx-7'><div class='marginalizedparent'><a class='marginalized' href='#format.parse.ctx-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20466'>#</a></div><div class='texpara'><div id='format.parse.ctx-7.sentence-1' class='sentence'><i >Effects</i>: If <span class='texttt'>indexing_&shy; <span class='operator'>!</span><span class='operator'>=</span> manual</span>, equivalent to:
<span class='codeblock'><span class='keyword'>if</span> <span class='parenthesis'>(</span>indexing_ <span class='operator'>=</span><span class='operator'>=</span> unknown<span class='parenthesis'>)</span>
  indexing_ <span class='operator'>=</span> automatic;
<span class='keyword'>return</span> next_arg_id_<span class='operator'>+</span><span class='operator'>+</span>;
</span></div></div></div></div><div class='para' id='format.parse.ctx-8'><div class='marginalizedparent'><a class='marginalized' href='#format.parse.ctx-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20475'>#</a></div><div class='texpara'><div id='format.parse.ctx-8.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>format_&shy;error</span> if <span class='texttt'>indexing_&shy; <span class='operator'>=</span><span class='operator'>=</span> manual</span>
which indicates mixing of automatic and manual argument indexing<a class='hidden_link' href='#format.parse.ctx-8.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:basic_format_parse_context,check_arg_id'><div id='lib:check_arg_id,basic_format_parse_context'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:check_arg_id,basic_format_parse_context'>ðŸ”—</a></div><code class='itemdeclcode'><span class='keyword'>constexpr</span> <span class='keyword'>void</span> check_arg_id<span class='parenthesis'>(</span>size_t id<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='format.parse.ctx-9'><div class='marginalizedparent'><a class='marginalized' href='#format.parse.ctx-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20487'>#</a></div><div class='texpara'><div id='format.parse.ctx-9.sentence-1' class='sentence'><i >Effects</i>: If <span class='texttt'>indexing_&shy; <span class='operator'>!</span><span class='operator'>=</span> automatic</span>, equivalent to:
<span class='codeblock'><span class='keyword'>if</span> <span class='parenthesis'>(</span>indexing_ <span class='operator'>=</span><span class='operator'>=</span> unknown<span class='parenthesis'>)</span>
  indexing_ <span class='operator'>=</span> manual;
</span></div></div></div></div><div class='para' id='format.parse.ctx-10'><div class='marginalizedparent'><a class='marginalized' href='#format.parse.ctx-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20495'>#</a></div><div class='texpara'><div id='format.parse.ctx-10.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>format_&shy;error</span> if
<span class='texttt'>indexing_&shy; <span class='operator'>=</span><span class='operator'>=</span> automatic</span> which indicates mixing of automatic and
manual argument indexing<a class='hidden_link' href='#format.parse.ctx-10.sentence-1'>.</a></div></div></div></div><div class='para' id='format.parse.ctx-11'><div class='marginalizedparent'><a class='marginalized' href='#format.parse.ctx-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20501'>#</a></div><div class='texpara'><div id='format.parse.ctx-11.sentence-1' class='sentence'><i >Remarks</i>: Call expressions where <span class='texttt'>id <span class='anglebracket'>&gt;</span><span class='operator'>=</span> num_&shy;args_&shy;</span> are not
core constant expressions (<a href='expr.const' title='7.7&emsp;Constant expressions'>[expr.<span class='shy'></span>const]</a>)<a class='hidden_link' href='#format.parse.ctx-11.sentence-1'>.</a></div></div></div></div></div><div id='format.context' class='section'><h4 ><a class='secnum' href='#format.context' style='min-width:95pt'>20.20.5.4</a> Class template <span class='texttt'>basic_&shy;format_&shy;context</span> <a class='abbr_ref' href='format.context'>[format.context]</a></h4><div class='texpara'><span id='lib:basic_format_context,formatter_type'><span id='lib:formatter_type,basic_format_context'><span id='lib:basic_format_context,char_type'><span id='lib:char_type,basic_format_context'><span id='lib:basic_format_context,iterator'><span id='lib:iterator,basic_format_context'><span id='lib:basic_format_context'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:basic_format_context'>ðŸ”—</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Out, <span class='keyword'>class</span> charT<span class='anglebracket'>&gt;</span>
  <span class='keyword'>class</span> basic_format_context <span class='curlybracket'>{</span>
    basic_format_args<span class='anglebracket'>&lt;</span>basic_format_context<span class='anglebracket'>&gt;</span> args_;      <span class='comment'>// <i >exposition only</i></span>
    Out out_;                                           <span class='comment'>// <i >exposition only</i></span>

  <span class='keyword'>public</span><span class='operator'>:</span>
    <span class='keyword'>using</span> iterator <span class='operator'>=</span> Out;
    <span class='keyword'>using</span> char_type <span class='operator'>=</span> charT;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>using</span> formatter_type <span class='operator'>=</span> formatter<span class='anglebracket'>&lt;</span>T, charT<span class='anglebracket'>&gt;</span>;

    basic_format_arg<span class='anglebracket'>&lt;</span>basic_format_context<span class='anglebracket'>&gt;</span> arg<span class='parenthesis'>(</span>size_t id<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
    std<span class='operator'>::</span>locale locale<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    iterator out<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>void</span> advance_to<span class='parenthesis'>(</span>iterator it<span class='parenthesis'>)</span>;
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></span></span></span></span></span></span></div><div class='para' id='format.context-1'><div class='marginalizedparent'><a class='marginalized' href='#format.context-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20534'>#</a></div><div class='texpara'><div id='format.context-1.sentence-1' class='sentence'>An instance of <span class='texttt'>basic_&shy;format_&shy;context</span> holds formatting state
consisting of the formatting arguments and the output iterator<a class='hidden_link' href='#format.context-1.sentence-1'>.</a></div></div></div><div class='para' id='format.context-2'><div class='marginalizedparent'><a class='marginalized' href='#format.context-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20538'>#</a></div><div class='texpara'><div id='format.context-2.sentence-1' class='sentence'><span class='texttt'>Out</span> shall model <span class='texttt'><a href='iterator.concept.output#concept:output_iterator' title='23.3.4.10&emsp;Concept output_&shy;iterator&emsp;[iterator.concept.output]'><span id='conceptref:output_iterator'><span class='texttt'>output_&shy;iterator</span></span></a><span class='anglebracket'>&lt;</span><span class='keyword'>const</span> charT<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#format.context-2.sentence-1'>.</a></div></div></div><div class='para' id='format.context-3'><div class='marginalizedparent'><a class='marginalized' href='#format.context-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20541'>#</a></div><div class='texpara'><div id='format.context-3.sentence-1' class='sentence'><a class='index' id='lib:format_context'></a><span class='texttt'>format_&shy;context</span> is an alias for
a specialization of <span class='texttt'>basic_&shy;format_&shy;context</span>
with an output iterator
that appends to <span class='texttt'>string</span>,
such as <span class='texttt'>back_&shy;insert_&shy;iterator<span class='anglebracket'>&lt;</span>string<span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#format.context-3.sentence-1'>.</a></div> <div id='format.context-3.sentence-2' class='sentence'><a class='index' id='lib:wformat_context'></a>Similarly, <span class='texttt'>wformat_&shy;context</span> is an alias for
a specialization of <span class='texttt'>basic_&shy;format_&shy;context</span>
with an output iterator
that appends to <span class='texttt'>wstring</span><a class='hidden_link' href='#format.context-3.sentence-2'>.</a></div></div></div><div class='para nonNormativeOnly' id='format.context-4'><div class='marginalizedparent'><a class='marginalized' href='#format.context-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20554'>#</a></div><div class='texpara'><div id='format.context-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#format.context-note-1'>1</a></i>: <div id='format.context-4.sentence-1' class='sentence'>For a given type <span class='texttt'>charT</span>,
implementations are encouraged to provide
a single instantiation of <span class='texttt'>basic_&shy;format_&shy;context</span>
for appending to
<span class='texttt'>basic_&shy;string<span class='anglebracket'>&lt;</span>charT<span class='anglebracket'>&gt;</span></span>,
<span class='texttt'>vector<span class='anglebracket'>&lt;</span>charT<span class='anglebracket'>&gt;</span></span>,
or any other container with contiguous storage
by wrapping those in temporary objects with a uniform interface
(such as a <span class='texttt'>span<span class='anglebracket'>&lt;</span>charT<span class='anglebracket'>&gt;</span></span>) and polymorphic reallocation<a class='hidden_link' href='#format.context-4.sentence-1'>.</a></div> â€”&nbsp;<i>end note</i>]</div></div></div></div><div class='texpara'><div id='lib:basic_format_context,arg'><div id='lib:arg,basic_format_context'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:arg,basic_format_context'>ðŸ”—</a></div><code class='itemdeclcode'>basic_format_arg<span class='anglebracket'>&lt;</span>basic_format_context<span class='anglebracket'>&gt;</span> arg<span class='parenthesis'>(</span>size_t id<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div></div></div><div class='para' id='format.context-5'><div class='marginalizedparent'><a class='marginalized' href='#format.context-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20573'>#</a></div><div class='texpara'><div id='format.context-5.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>args_&shy;<span class='operator'>.</span>get<span class='parenthesis'>(</span>id<span class='parenthesis'>)</span></span><a class='hidden_link' href='#format.context-5.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:basic_format_context,locale'><div id='lib:locale,basic_format_context'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:locale,basic_format_context'>ðŸ”—</a></div><code class='itemdeclcode'>std<span class='operator'>::</span>locale locale<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='format.context-6'><div class='marginalizedparent'><a class='marginalized' href='#format.context-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20584'>#</a></div><div class='texpara'><div id='format.context-6.sentence-1' class='sentence'><i >Returns</i>: The locale passed to the formatting function
if the latter takes one,
and <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>locale<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> otherwise<a class='hidden_link' href='#format.context-6.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:basic_format_context,out'><div id='lib:out,basic_format_context'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:out,basic_format_context'>ðŸ”—</a></div><code class='itemdeclcode'>iterator out<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='format.context-7'><div class='marginalizedparent'><a class='marginalized' href='#format.context-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20597'>#</a></div><div class='texpara'><div id='format.context-7.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>out_&shy;</span><a class='hidden_link' href='#format.context-7.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:basic_format_context,advance_to'><div id='lib:advance_to,basic_format_context'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:advance_to,basic_format_context'>ðŸ”—</a></div><code class='itemdeclcode'><span class='keyword'>void</span> advance_to<span class='parenthesis'>(</span>iterator it<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='format.context-8'><div class='marginalizedparent'><a class='marginalized' href='#format.context-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/aecc22a58b2a3489ce2cd7504c7ffd5d957f6917/source/utilities.tex#L20608'>#</a></div><div class='texpara'><div id='format.context-8.sentence-1' class='sentence'><i >Effects</i>: Equivalent to: <span class='texttt'>out_&shy; <span class='operator'>=</span> it;</span></div></div></div></div><div class='texpara'><a class='index' id=':left-pad'></a><div id='format.context-example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#format.context-example-1'>1</a></i>: <span class='codeblock'><span class='keyword'>struct</span> S <span class='curlybracket'>{</span> <span class='keyword'>int</span> value; <span class='curlybracket'>}</span>;

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> std<span class='operator'>::</span>formatter<span class='anglebracket'>&lt;</span>S<span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span>
  size_t width_arg_id <span class='operator'>=</span> <span class='literal'>0</span>;

  <span class='comment'>// Parses a width argument id in the format <span class='tcode_in_codeblock'>{</span> <span class='textsf'><i >digit</i></span> <span class='tcode_in_codeblock'>}</span>.</span>
  <span class='keyword'>constexpr</span> <span class='keyword'>auto</span> parse<span class='parenthesis'>(</span>format_parse_context<span class='operator'>&amp;</span> ctx<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
    <span class='keyword'>auto</span> iter <span class='operator'>=</span> ctx<span class='operator'>.</span>begin<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>auto</span> get_char <span class='operator'>=</span> <span class='squarebracket'>[</span><span class='operator'>&amp;</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> iter <span class='operator'>!</span><span class='operator'>=</span> ctx<span class='operator'>.</span>end<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>?</span> <span class='operator'>*</span>iter <span class='operator'>:</span> <span class='literal'>0</span>; <span class='curlybracket'>}</span>;
    <span class='keyword'>if</span> <span class='parenthesis'>(</span>get_char<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>!</span><span class='operator'>=</span> <span class='literal'>'{'</span><span class='parenthesis'>)</span>
      <span class='keyword'>return</span> iter;
    <span class='operator'>+</span><span class='operator'>+</span>iter;
    <span class='keyword'>char</span> c <span class='operator'>=</span> get_char<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>if</span> <span class='parenthesis'>(</span><span class='operator'>!</span>isdigit<span class='parenthesis'>(</span>c<span class='parenthesis'>)</span> <span class='operator'>|</span><span class='operator'>|</span> <span class='parenthesis'>(</span><span class='operator'>+</span><span class='operator'>+</span>iter, get_char<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span> <span class='operator'>!</span><span class='operator'>=</span> <span class='literal'>'}'</span><span class='parenthesis'>)</span>
      <span class='keyword'>throw</span> format_error<span class='parenthesis'>(</span><span class='literal'>"invalid format"</span><span class='parenthesis'>)</span>;
    width_arg_id <span class='operator'>=</span> c <span class='operator'>-</span> <span class='literal'>'0'</span>;
    ctx<span class='operator'>.</span>check_arg_id<span class='parenthesis'>(</span>width_arg_id<span class='parenthesis'>)</span>;
    <span class='keyword'>return</span> <span class='operator'>+</span><span class='operator'>+</span>iter;
  <span class='curlybracket'>}</span>

  <span class='comment'>// Formats an <span class='tcode_in_codeblock'>S</span> with width given by the argument <span class='tcode_in_codeblock'>width_&shy;arg_&shy;id</span>.</span>
  <span class='keyword'>auto</span> format<span class='parenthesis'>(</span>S s, format_context<span class='operator'>&amp;</span> ctx<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
    <span class='keyword'>int</span> width <span class='operator'>=</span> visit_format_arg<span class='parenthesis'>(</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>auto</span> value<span class='parenthesis'>)</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> <span class='keyword'>int</span> <span class='curlybracket'>{</span>
      <span class='keyword'>if</span> <span class='keyword'>constexpr</span> <span class='parenthesis'>(</span><span class='operator'>!</span>is_integral_v<span class='anglebracket'>&lt;</span><span class='keyword'>decltype</span><span class='parenthesis'>(</span>value<span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span>
        <span class='keyword'>throw</span> format_error<span class='parenthesis'>(</span><span class='literal'>"width is not integral"</span><span class='parenthesis'>)</span>;
      <span class='keyword'>else</span> <span class='keyword'>if</span> <span class='parenthesis'>(</span>value <span class='anglebracket'>&lt;</span> <span class='literal'>0</span> <span class='operator'>|</span><span class='operator'>|</span> value <span class='anglebracket'>&gt;</span> numeric_limits<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='operator'>::</span>max<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>
        <span class='keyword'>throw</span> format_error<span class='parenthesis'>(</span><span class='literal'>"invalid width"</span><span class='parenthesis'>)</span>;
      <span class='keyword'>else</span>
        <span class='keyword'>return</span> value;
      <span class='curlybracket'>}</span>, ctx<span class='operator'>.</span>arg<span class='parenthesis'>(</span>width_arg_id<span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
    <span class='keyword'>return</span> format_to<span class='parenthesis'>(</span>ctx<span class='operator'>.</span>out<span class='parenthesis'>(</span><span class='parenthesis'>)</span>, <span class='literal'>"{0:x&lt;{1}}"</span>, s<span class='operator'>.</span>value, width<span class='parenthesis'>)</span>;
  <span class='curlybracket'>}</span>
<span class='curlybracket'>}</span>;

std<span class='operator'>::</span>string s <span class='operator'>=</span> std<span class='operator'>::</span>format<span class='parenthesis'>(</span><span class='literal'>"{0:{1}}"</span>, S<span class='curlybracket'>{</span><span class='literal'>42</span><span class='curlybracket'>}</span>, <span class='literal'>10</span><span class='parenthesis'>)</span>;  <span class='comment'>// value of <span class='tcode_in_codeblock'>s</span> is <span class='tcode_in_codeblock'>"xxxxxxxx42"</span></span>
</span> â€”&nbsp;<i>end example</i>]</div></div></div></div></div></body></html>