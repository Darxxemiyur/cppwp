<!DOCTYPE html><html lang='en'><head><title>[class.conv]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>11</a> Classes <a class='abbr_ref' href='./#class'>[class]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>11.4</a> Class members <a class='abbr_ref' href='class.mem#class.conv'>[class.mem]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>11.4.7</a> Conversions <a class='abbr_ref'>[class.conv]</a></h3><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/classes.tex#L2457'>#</a></div><div id='1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':conversion,class'></a></span><span class='indexparent'><a class='index' id=':conversion,implicit'></a></span>Type conversions of class objects can be specified by constructors and
by conversion functions<a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>These conversions are called
<a class='hidden_link' href='#def:conversion,user-defined' title='11.4.7&emsp;Conversions&emsp;[class.conv]'><span id='def:conversion,user-defined'><span class='textit'>user-defined conversions</span></span></a>
and are used for implicit type conversions (<a href='conv' title='7.3&emsp;Standard conversions'>[conv]</a>),
for initialization (<a href='dcl.init' title='9.4&emsp;Initializers'>[dcl.<span class='shy'></span>init]</a>),
and for explicit type conversions (<a href='expr.type.conv' title='7.6.1.3&emsp;Explicit type conversion (functional notation)'>[expr.<span class='shy'></span>type.<span class='shy'></span>conv]</a>, <a href='expr.cast' title='7.6.3&emsp;Explicit type conversion (cast notation)'>[expr.<span class='shy'></span>cast]</a>,
<a href='expr.static.cast' title='7.6.1.8&emsp;Static cast'>[expr.<span class='shy'></span>static.<span class='shy'></span>cast]</a>)<a class='hidden_link' href='#1.sentence-2'>.</a></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/classes.tex#L2471'>#</a></div><div id='2.sentence-1' class='sentence'>User-defined conversions are applied only where they are unambiguous (<a href='class.member.lookup' title='11.8&emsp;Member name lookup'>[class.<span class='shy'></span>member.<span class='shy'></span>lookup]</a>, <a href='#fct' title='11.4.7.2&emsp;Conversion functions'>[class.<span class='shy'></span>conv.<span class='shy'></span>fct]</a>)<a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'>Conversions obey the access control rules (<a href='class.access' title='11.9&emsp;Member access control'>[class.<span class='shy'></span>access]</a>)<a class='hidden_link' href='#2.sentence-2'>.</a></div> <div id='2.sentence-3' class='sentence'>Access control is applied after ambiguity resolution (<a href='basic.lookup' title='6.5&emsp;Name lookup'>[basic.<span class='shy'></span>lookup]</a>)<a class='hidden_link' href='#2.sentence-3'>.</a></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/classes.tex#L2476'>#</a></div><div id='3.note-1' class='note'>[<a class='note_link' href='#3.note-1'><span class='textit'>Note</span></a><span class='textit'>:</span> <div id='3.sentence-1' class='sentence'>See <a href='over.match' title='12.4&emsp;Overload resolution'>[over.<span class='shy'></span>match]</a> for a discussion of the use of conversions in function calls
as well as examples below<a class='hidden_link' href='#3.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div> </div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/classes.tex#L2482'>#</a></div><div id='4.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':conversion,implicit_user-defined'></a></span>At most one user-defined conversion (constructor or conversion function)
is implicitly applied to a single value<a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='4.example-1' class='example'>[<a class='example_link' href='#4.example-1'><span class='textit'>Example</span></a><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>struct</span> X <span class='curlybracket'>{</span>
  <span class='keyword'>operator</span> <span class='keyword'>int</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;

<span class='keyword'>struct</span> Y <span class='curlybracket'>{</span>
  <span class='keyword'>operator</span> X<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;

Y a;
<span class='keyword'>int</span> b <span class='operator'>=</span> a;          <span class='comment'>// error: no viable conversion (<span class='tcode_in_codeblock'>a.operator X().operator int()</span> not considered)</span>
<span class='keyword'>int</span> c <span class='operator'>=</span> X<span class='parenthesis'>(</span>a<span class='parenthesis'>)</span>;       <span class='comment'>// OK: <span class='tcode_in_codeblock'>a.operator X().operator int()</span></span>
</pre> —&nbsp;<i>end example</i>]</div> </div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/classes.tex#L2502'>#</a></div><div id='5.sentence-1' class='sentence'>User-defined conversions are used implicitly only if they are unambiguous<a class='hidden_link' href='#5.sentence-1'>.</a></div> <div id='5.sentence-2' class='sentence'><span class='indexparent'><a class='index' id=':name_hiding,user-defined_conversion_and'></a></span>A conversion function in a derived class does not hide a conversion function
in a base class unless the two functions convert to the same type<a class='hidden_link' href='#5.sentence-2'>.</a></div> <div id='5.sentence-3' class='sentence'>Function overload resolution (<a href='over.match.best' title='12.4.3&emsp;Best viable function'>[over.<span class='shy'></span>match.<span class='shy'></span>best]</a>) selects the best
conversion function to perform the conversion<a class='hidden_link' href='#5.sentence-3'>.</a></div> <div id='5.example-1' class='example'>[<a class='example_link' href='#5.example-1'><span class='textit'>Example</span></a><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>struct</span> X <span class='curlybracket'>{</span>
  <span class='keyword'>operator</span> <span class='keyword'>int</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;

<span class='keyword'>struct</span> Y <span class='operator'>:</span> X <span class='curlybracket'>{</span>
    <span class='keyword'>operator</span> <span class='keyword'>char</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;

<span class='keyword'>void</span> f<span class='parenthesis'>(</span>Y<span class='operator'>&amp;</span> a<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>if</span> <span class='parenthesis'>(</span>a<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>          <span class='comment'>// error: ambiguous between <span class='tcode_in_codeblock'>X&#x200b;::&#x200b;operator int()</span> and <span class='tcode_in_codeblock'>Y&#x200b;::&#x200b;operator char()</span></span>
  <span class='curlybracket'>}</span>
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i>]</div> </div><div id='ctor' class='section'><h4 ><a class='secnum' href='#ctor' style='min-width:118pt'>11.4.7.1</a> Conversion by constructor <a class='abbr_ref' href='class.conv.ctor'>[class.conv.ctor]</a></h4><span class='indexparent'><a class='index' id=':conversion,user-defined'></a></span><div class='para' id='ctor-1'><div class='marginalizedparent'><a class='marginalized' href='#ctor-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/classes.tex#L2529'>#</a></div><div id='ctor-1.sentence-1' class='sentence'>A constructor that is not explicit (<a href='dcl.fct.spec' title='9.2.2&emsp;Function specifiers'>[dcl.<span class='shy'></span>fct.<span class='shy'></span>spec]</a>)
specifies a conversion from
the types of its parameters (if any)
to the type of its class<a class='hidden_link' href='#ctor-1.sentence-1'>.</a></div> <div id='ctor-1.sentence-2' class='sentence'>Such a constructor is called a
<a class='hidden_link' href='#def:constructor,converting' title='11.4.7.1&emsp;Conversion by constructor&emsp;[class.conv.ctor]'><span id='def:constructor,converting'><span class='textit'>converting constructor</span></span></a><a class='hidden_link' href='#ctor-1.sentence-2'>.</a></div> <div id='ctor-1.example-1' class='example'>[<a class='example_link' href='#ctor-1.example-1'><span class='textit'>Example</span></a><span class='textit'>:</span> <span class='indexparent'><a class='index' id=':Jessie'></a></span><pre class='codeblock'>
<span class='keyword'>struct</span> X <span class='curlybracket'>{</span>
    X<span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span>;
    X<span class='parenthesis'>(</span><span class='keyword'>const</span> <span class='keyword'>char</span><span class='operator'>*</span>, <span class='keyword'>int</span> <span class='operator'>=</span><span class='literal'>0</span><span class='parenthesis'>)</span>;
    X<span class='parenthesis'>(</span><span class='keyword'>int</span>, <span class='keyword'>int</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;

<span class='keyword'>void</span> f<span class='parenthesis'>(</span>X arg<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  X a <span class='operator'>=</span> <span class='literal'>1</span>;          <span class='comment'>// <span class='tcode_in_codeblock'>a = X(1)</span></span>
  X b <span class='operator'>=</span> <span class='literal'>"Jessie"</span>;   <span class='comment'>// <span class='tcode_in_codeblock'>b = X("Jessie",0)</span></span>
  a <span class='operator'>=</span> <span class='literal'>2</span>;            <span class='comment'>// <span class='tcode_in_codeblock'>a = X(2)</span></span>
  f<span class='parenthesis'>(</span><span class='literal'>3</span><span class='parenthesis'>)</span>;             <span class='comment'>// <span class='tcode_in_codeblock'>f(X(3))</span></span>
  f<span class='parenthesis'>(</span><span class='curlybracket'>{</span><span class='literal'>1</span>, <span class='literal'>2</span><span class='curlybracket'>}</span><span class='parenthesis'>)</span>;        <span class='comment'>// <span class='tcode_in_codeblock'>f(X(1,2))</span></span>
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i>]</div> </div><div class='para' id='ctor-2'><div class='marginalizedparent'><a class='marginalized' href='#ctor-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/classes.tex#L2555'>#</a></div><div id='ctor-2.note-1' class='note'>[<a class='note_link' href='#ctor-2.note-1'><span class='textit'>Note</span></a><span class='textit'>:</span> <div id='ctor-2.sentence-1' class='sentence'>An explicit constructor constructs objects just like non-explicit
constructors, but does so only where the direct-initialization syntax (<a href='dcl.init' title='9.4&emsp;Initializers'>[dcl.<span class='shy'></span>init]</a>)
or where casts (<a href='expr.static.cast' title='7.6.1.8&emsp;Static cast'>[expr.<span class='shy'></span>static.<span class='shy'></span>cast]</a>, <a href='expr.cast' title='7.6.3&emsp;Explicit type conversion (cast notation)'>[expr.<span class='shy'></span>cast]</a>) are explicitly
used; see also <a href='over.match.copy' title='12.4.1.4&emsp;Copy-initialization of class by user-defined conversion'>[over.<span class='shy'></span>match.<span class='shy'></span>copy]</a><a class='hidden_link' href='#ctor-2.sentence-1'>.</a></div> <div id='ctor-2.sentence-2' class='sentence'>A default constructor may be an explicit constructor; such a constructor
will be used to perform default-initialization
or value-initialization (<a href='dcl.init' title='9.4&emsp;Initializers'>[dcl.<span class='shy'></span>init]</a>)<a class='hidden_link' href='#ctor-2.sentence-2'>.</a></div> <div id='ctor-2.example-1' class='example'>[<a class='example_link' href='#ctor-2.example-1'><span class='textit'>Example</span></a><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>struct</span> Z <span class='curlybracket'>{</span>
  <span class='keyword'>explicit</span> Z<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='keyword'>explicit</span> Z<span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span>;
  <span class='keyword'>explicit</span> Z<span class='parenthesis'>(</span><span class='keyword'>int</span>, <span class='keyword'>int</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;

Z a;                            <span class='comment'>// OK: default-initialization performed</span>
Z b<span class='curlybracket'>{</span><span class='curlybracket'>}</span>;                          <span class='comment'>// OK: direct initialization syntax used</span>
Z c <span class='operator'>=</span> <span class='curlybracket'>{</span><span class='curlybracket'>}</span>;                       <span class='comment'>// error: copy-list-initialization</span>
Z a1 <span class='operator'>=</span> <span class='literal'>1</span>;                       <span class='comment'>// error: no implicit conversion</span>
Z a3 <span class='operator'>=</span> Z<span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span>;                    <span class='comment'>// OK: direct initialization syntax used</span>
Z a2<span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span>;                        <span class='comment'>// OK: direct initialization syntax used</span>
Z<span class='operator'>*</span> p <span class='operator'>=</span> <span class='keyword'>new</span> Z<span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span>;                <span class='comment'>// OK: direct initialization syntax used</span>
Z a4 <span class='operator'>=</span> <span class='parenthesis'>(</span>Z<span class='parenthesis'>)</span><span class='literal'>1</span>;                    <span class='comment'>// OK: explicit cast used</span>
Z a5 <span class='operator'>=</span> <span class='keyword'>static_cast</span><span class='anglebracket'>&lt;</span>Z<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span>;       <span class='comment'>// OK: explicit cast used</span>
Z a6 <span class='operator'>=</span> <span class='curlybracket'>{</span> <span class='literal'>3</span>, <span class='literal'>4</span> <span class='curlybracket'>}</span>;                <span class='comment'>// error: no implicit conversion</span>
</pre> —&nbsp;<i>end example</i>]</div>  —&nbsp;<i>end note</i>]</div> </div><div class='para' id='ctor-3'><div class='marginalizedparent'><a class='marginalized' href='#ctor-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/classes.tex#L2586'>#</a></div><div id='ctor-3.sentence-1' class='sentence'>A non-explicit copy/move constructor (<a href='class.copy.ctor' title='11.4.4.2&emsp;Copy/move constructors'>[class.<span class='shy'></span>copy.<span class='shy'></span>ctor]</a>) is
a converting constructor<a class='hidden_link' href='#ctor-3.sentence-1'>.</a></div> <div id='ctor-3.note-1' class='note'>[<a class='note_link' href='#ctor-3.note-1'><span class='textit'>Note</span></a><span class='textit'>:</span> <div id='ctor-3.sentence-2' class='sentence'>An implicitly-declared copy/move constructor is not an explicit constructor;
it may be called for implicit type conversions<a class='hidden_link' href='#ctor-3.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div> </div></div><div id='fct' class='section'><h4 ><a class='secnum' href='#fct' style='min-width:118pt'>11.4.7.2</a> Conversion functions <a class='abbr_ref' href='class.conv.fct'>[class.conv.fct]</a></h4><span class='indexparent'><a class='index' id=':function,conversion'></a></span><span class='indexparent'><a class='index' id=':conversion,user-defined_'></a></span><div class='para' id='fct-1'><div class='marginalizedparent'><a class='marginalized' href='#fct-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/classes.tex#L2599'>#</a></div><div id='fct-1.sentence-1' class='sentence'>A member function of a class <span class='texttt'>X</span> having no parameters with a name of the form
<div class='bnf' id='nt:conversion-function-id'>
<a class='hidden_link' href='#nt:conversion-function-id' title='11.4.7.2&emsp;Conversion functions&emsp;[class.conv.fct]'><span id='nt:conversion-function-id'><span id=':conversion-function-id'>conversion-function-id<span class='textnormal'>:</span></span></span></a><br/><span class='texttt'><span class='keyword'>operator</span></span><span class='indexparent'><a class='index' id=':operator'></a></span> <a href='#nt:conversion-type-id' title='11.4.7.2&emsp;Conversion functions&emsp;[class.conv.fct]'><span id='ntref:conversion-type-id'><span class='textsf'><span class='textit'>conversion-type-id</span></span></span></a>
</div></div><div class='bnf' id='nt:conversion-type-id'>
<a class='hidden_link' href='#nt:conversion-type-id' title='11.4.7.2&emsp;Conversion functions&emsp;[class.conv.fct]'><span id='nt:conversion-type-id'><span id=':conversion-type-id'>conversion-type-id<span class='textnormal'>:</span></span></span></a><br/><a href='dcl.type#nt:type-specifier-seq' title='9.2.8&emsp;Type specifiers&emsp;[dcl.type]'><span id='ntref:type-specifier-seq'><span class='textsf'><span class='textit'>type-specifier-seq</span></span></span></a> <a href='#nt:conversion-declarator' title='11.4.7.2&emsp;Conversion functions&emsp;[class.conv.fct]'><span id='ntref:conversion-declarator'><span class='textsf'><span class='textit'>conversion-declarator</span></span></span></a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span>
</div><div id='fct-1.sentence-2' class='sentence'><div class='bnf' id='nt:conversion-declarator'>
<a class='hidden_link' href='#nt:conversion-declarator' title='11.4.7.2&emsp;Conversion functions&emsp;[class.conv.fct]'><span id='nt:conversion-declarator'><span id=':conversion-declarator'>conversion-declarator<span class='textnormal'>:</span></span></span></a><br/><a href='dcl.decl#nt:ptr-operator' title='9.3&emsp;Declarators&emsp;[dcl.decl]'><span id='ntref:ptr-operator'><span class='textsf'><span class='textit'>ptr-operator</span></span></span></a> <a href='#nt:conversion-declarator' title='11.4.7.2&emsp;Conversion functions&emsp;[class.conv.fct]'><span id='ntref:conversion-declarator_'><span class='textsf'><span class='textit'>conversion-declarator</span></span></span></a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span>
</div>
specifies a conversion from
<span class='texttt'>X</span>
to the type specified by the
<a href='#nt:conversion-type-id' title='11.4.7.2&emsp;Conversion functions&emsp;[class.conv.fct]'><span id='ntref:conversion-type-id_'><span class='textsf'><span class='textit'>conversion-type-id</span></span></span></a><a class='hidden_link' href='#fct-1.sentence-2'>.</a></div> <div id='fct-1.sentence-3' class='sentence'>Such functions are called <a class='hidden_link' href='#def:conversion_function' title='11.4.7.2&emsp;Conversion functions&emsp;[class.conv.fct]'><span id='def:conversion_function'><span class='textit'>conversion functions</span></span></a><a class='hidden_link' href='#fct-1.sentence-3'>.</a></div> <div id='fct-1.sentence-4' class='sentence'>A <a href='dcl.spec#nt:decl-specifier' title='9.2&emsp;Specifiers&emsp;[dcl.spec]'><span id='ntref:decl-specifier'><span class='textsf'><span class='textit'>decl-specifier</span></span></span></a> in the <a href='dcl.spec#nt:decl-specifier-seq' title='9.2&emsp;Specifiers&emsp;[dcl.spec]'><span id='ntref:decl-specifier-seq'><span class='textsf'><span class='textit'>decl-specifier-seq</span></span></span></a>
of a conversion function (if any) shall be neither
a <a href='dcl.type#nt:defining-type-specifier' title='9.2.8&emsp;Type specifiers&emsp;[dcl.type]'><span id='ntref:defining-type-specifier'><span class='textsf'><span class='textit'>defining-type-specifier</span></span></span></a> nor <span class='texttt'><span class='keyword'>static</span></span><a class='hidden_link' href='#fct-1.sentence-4'>.</a></div> <div id='fct-1.sentence-5' class='sentence'><span class='indexparent'><a class='index' id=':conversion,type_of'></a></span>The type of the conversion function (<a href='dcl.fct' title='9.3.3.5&emsp;Functions'>[dcl.<span class='shy'></span>fct]</a>) is
“function taking no parameter returning
<a href='#nt:conversion-type-id' title='11.4.7.2&emsp;Conversion functions&emsp;[class.conv.fct]'><span id='ntref:conversion-type-id__'><span class='textsf'><span class='textit'>conversion-type-id</span></span></span></a>”<a class='hidden_link' href='#fct-1.sentence-5'>.</a></div> <div id='fct-1.sentence-6' class='sentence'>A conversion function is never used to convert a (possibly cv-qualified) object
to the (possibly cv-qualified) same object type (or a reference to it),
to a (possibly cv-qualified) base class of that type (or a reference to it),
or to <span class='mathit'>cv</span> <span class='texttt'><span class='keyword'>void</span></span><a class='hidden_link' href='#fct-1.sentence-6'>.</a><a class='footnotenum' href='#footnote-106' id='footnoteref-106' title='These conversions are considered as standard conversions for the purposes of overload resolution ([over.best.ics], [over.ics.ref]) and therefore initialization ([dcl.init]) and explicit casts ([expr.static.cast]). A conversion to void does not invoke any conversion function ([expr.static.cast]). Even though never directly called to perform a conversion, such conversion functions can be declared and can potentially be reached through a call to a virtual conversion function in a base class.'>106</a></div> <div id='fct-1.example-1' class='example'>[<a class='example_link' href='#fct-1.example-1'><span class='textit'>Example</span></a><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>struct</span> X <span class='curlybracket'>{</span>
  <span class='keyword'>operator</span> <span class='keyword'>int</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='keyword'>operator</span> <span class='keyword'>auto</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> <span class='keyword'>short</span>;     <span class='comment'>// error: trailing return type</span>
<span class='curlybracket'>}</span>;

<span class='keyword'>void</span> f<span class='parenthesis'>(</span>X a<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> i <span class='operator'>=</span> <span class='keyword'>int</span><span class='parenthesis'>(</span>a<span class='parenthesis'>)</span>;
  i <span class='operator'>=</span> <span class='parenthesis'>(</span><span class='keyword'>int</span><span class='parenthesis'>)</span>a;
  i <span class='operator'>=</span> a;
<span class='curlybracket'>}</span>
</pre> <div id='fct-1.sentence-7' class='sentence'>
In all three cases the value assigned will be converted by
<span class='texttt'>X<span class='operator'>&#x200b;::&#x200b;</span><span class='keyword'>operator</span> <span class='keyword'>int</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#fct-1.sentence-7'>.</a></div> —&nbsp;<i>end example</i>]</div> </div><div class='para' id='fct-2'><div class='marginalizedparent'><a class='marginalized' href='#fct-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/classes.tex#L2652'>#</a></div><div id='fct-2.sentence-1' class='sentence'>A conversion function may be explicit (<a href='dcl.fct.spec' title='9.2.2&emsp;Function specifiers'>[dcl.<span class='shy'></span>fct.<span class='shy'></span>spec]</a>), in which case it is only considered as a user-defined conversion for direct-initialization (<a href='dcl.init' title='9.4&emsp;Initializers'>[dcl.<span class='shy'></span>init]</a>)<a class='hidden_link' href='#fct-2.sentence-1'>.</a></div> <div id='fct-2.sentence-2' class='sentence'>Otherwise, user-defined conversions are not restricted to use in assignments and initializations<a class='hidden_link' href='#fct-2.sentence-2'>.</a></div> <div id='fct-2.example-1' class='example'>[<a class='example_link' href='#fct-2.example-1'><span class='textit'>Example</span></a><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>class</span> Y <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
<span class='keyword'>struct</span> Z <span class='curlybracket'>{</span>
  <span class='keyword'>explicit</span> <span class='keyword'>operator</span> Y<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span>;
<span class='curlybracket'>}</span>;

<span class='keyword'>void</span> h<span class='parenthesis'>(</span>Z z<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  Y y1<span class='parenthesis'>(</span>z<span class='parenthesis'>)</span>;          <span class='comment'>// OK: direct-initialization</span>
  Y y2 <span class='operator'>=</span> z;         <span class='comment'>// error: no conversion function candidate for copy-initialization</span>
  Y y3 <span class='operator'>=</span> <span class='parenthesis'>(</span>Y<span class='parenthesis'>)</span>z;      <span class='comment'>// OK: cast notation</span>
<span class='curlybracket'>}</span>

<span class='keyword'>void</span> g<span class='parenthesis'>(</span>X a, X b<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>int</span> i <span class='operator'>=</span> <span class='parenthesis'>(</span>a<span class='parenthesis'>)</span> <span class='operator'>?</span> <span class='literal'>1</span><span class='operator'>+</span>a <span class='operator'>:</span> <span class='literal'>0</span>;
  <span class='keyword'>int</span> j <span class='operator'>=</span> <span class='parenthesis'>(</span>a<span class='operator'>&amp;</span><span class='operator'>&amp;</span>b<span class='parenthesis'>)</span> <span class='operator'>?</span> a<span class='operator'>+</span>b <span class='operator'>:</span> i;
  <span class='keyword'>if</span> <span class='parenthesis'>(</span>a<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='curlybracket'>}</span>
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i>]</div> </div><div class='para' id='fct-3'><div class='marginalizedparent'><a class='marginalized' href='#fct-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/classes.tex#L2676'>#</a></div><div id='fct-3.sentence-1' class='sentence'>The
<a href='#nt:conversion-type-id' title='11.4.7.2&emsp;Conversion functions&emsp;[class.conv.fct]'><span id='ntref:conversion-type-id___'><span class='textsf'><span class='textit'>conversion-type-id</span></span></span></a>
shall not represent a function type nor an array type<a class='hidden_link' href='#fct-3.sentence-1'>.</a></div> <div id='fct-3.sentence-2' class='sentence'>The
<a href='#nt:conversion-type-id' title='11.4.7.2&emsp;Conversion functions&emsp;[class.conv.fct]'><span id='ntref:conversion-type-id____'><span class='textsf'><span class='textit'>conversion-type-id</span></span></span></a>
in a
<a href='#nt:conversion-function-id' title='11.4.7.2&emsp;Conversion functions&emsp;[class.conv.fct]'><span id='ntref:conversion-function-id'><span class='textsf'><span class='textit'>conversion-function-id</span></span></span></a>
is the longest sequence of
tokens that could possibly form a <a href='#nt:conversion-type-id' title='11.4.7.2&emsp;Conversion functions&emsp;[class.conv.fct]'><span id='ntref:conversion-type-id_____'><span class='textsf'><span class='textit'>conversion-type-id</span></span></span></a><a class='hidden_link' href='#fct-3.sentence-2'>.</a></div> <div id='fct-3.note-1' class='note'>[<a class='note_link' href='#fct-3.note-1'><span class='textit'>Note</span></a><span class='textit'>:</span> <div id='fct-3.sentence-3' class='sentence'>This prevents ambiguities between the declarator operator <span class='texttt'><span class='operator'>*</span></span> and its expression
counterparts<a class='hidden_link' href='#fct-3.sentence-3'>.</a></div> <div id='fct-3.example-1' class='example'>[<a class='example_link' href='#fct-3.example-1'><span class='textit'>Example</span></a><span class='textit'>:</span> <pre class='codeblock'>
<span class='operator'>&amp;</span>ac<span class='operator'>.</span><span class='keyword'>operator</span> <span class='keyword'>int</span><span class='operator'>*</span>i; <span class='comment'>// syntax error:</span>
                    <span class='comment'>// parsed as: <span class='tcode_in_codeblock'>&amp;(ac.operator int *)i</span></span>
                    <span class='comment'>// not as: <span class='tcode_in_codeblock'>&amp;(ac.operator int)*i</span></span>
</pre> <div id='fct-3.sentence-4' class='sentence'>
The <span class='texttt'><span class='operator'>*</span></span> is the pointer declarator and not the multiplication operator<a class='hidden_link' href='#fct-3.sentence-4'>.</a></div> —&nbsp;<i>end example</i>]</div>  <div id='fct-3.sentence-5' class='sentence'>
This rule also prevents ambiguities for attributes<a class='hidden_link' href='#fct-3.sentence-5'>.</a></div> <div id='fct-3.example-2' class='example'>[<a class='example_link' href='#fct-3.example-2'><span class='textit'>Example</span></a><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>operator</span> <span class='keyword'>int</span> <span class='squarebracket'>[</span><span class='squarebracket'>[</span>noreturn<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='parenthesis'>(</span><span class='parenthesis'>)</span>;   <span class='comment'>// error: <span class='tcode_in_codeblock'>noreturn</span> attribute applied to a type</span>
</pre> —&nbsp;<i>end example</i>]</div>  —&nbsp;<i>end note</i>]</div> </div><div class='para' id='fct-4'><div class='marginalizedparent'><a class='marginalized' href='#fct-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/classes.tex#L2705'>#</a></div><div id='fct-4.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':conversion,inheritance_of_user-defined'></a></span>Conversion functions are inherited<a class='hidden_link' href='#fct-4.sentence-1'>.</a></div></div><div class='para' id='fct-5'><div class='marginalizedparent'><a class='marginalized' href='#fct-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/classes.tex#L2709'>#</a></div><div id='fct-5.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':conversion,virtual_user-defined'></a></span>Conversion functions can be virtual<a class='hidden_link' href='#fct-5.sentence-1'>.</a></div></div><div class='para' id='fct-6'><div class='marginalizedparent'><a class='marginalized' href='#fct-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/classes.tex#L2713'>#</a></div><div id='fct-6.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':conversion,deduced_return_type_of_user-defined'></a></span>A conversion function template shall not have a
deduced return type (<a href='dcl.spec.auto' title='9.2.8.5&emsp;Placeholder type specifiers'>[dcl.<span class='shy'></span>spec.<span class='shy'></span>auto]</a>)<a class='hidden_link' href='#fct-6.sentence-1'>.</a></div> <div id='fct-6.example-1' class='example'>[<a class='example_link' href='#fct-6.example-1'><span class='textit'>Example</span></a><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>struct</span> S <span class='curlybracket'>{</span>
  <span class='keyword'>operator</span> <span class='keyword'>auto</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='literal'>10</span>; <span class='curlybracket'>}</span>      <span class='comment'>// OK</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span>
  <span class='keyword'>operator</span> <span class='keyword'>auto</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='curlybracket'>{</span> <span class='keyword'>return</span> <span class='literal'>1.2</span>; <span class='curlybracket'>}</span>     <span class='comment'>// error: conversion function template</span>
<span class='curlybracket'>}</span>;
</pre> —&nbsp;<i>end example</i>]</div> </div><div class='footnote' id='footnote-106'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-106'>106)</a></div><div id='footnote-106.sentence-1' class='sentence'>These conversions are considered
as standard conversions for the purposes of overload resolution (<a href='over.best.ics' title='12.4.3.1&emsp;Implicit conversion sequences'>[over.<span class='shy'></span>best.<span class='shy'></span>ics]</a>, <a href='over.ics.ref' title='12.4.3.1.4&emsp;Reference binding'>[over.<span class='shy'></span>ics.<span class='shy'></span>ref]</a>) and therefore initialization (<a href='dcl.init' title='9.4&emsp;Initializers'>[dcl.<span class='shy'></span>init]</a>) and explicit casts (<a href='expr.static.cast' title='7.6.1.8&emsp;Static cast'>[expr.<span class='shy'></span>static.<span class='shy'></span>cast]</a>)<a class='hidden_link' href='#footnote-106.sentence-1'>.</a></div> <div id='footnote-106.sentence-2' class='sentence'>A conversion to <span class='texttt'><span class='keyword'>void</span></span> does not invoke any conversion function (<a href='expr.static.cast' title='7.6.1.8&emsp;Static cast'>[expr.<span class='shy'></span>static.<span class='shy'></span>cast]</a>)<a class='hidden_link' href='#footnote-106.sentence-2'>.</a></div> <div id='footnote-106.sentence-3' class='sentence'>Even though never directly called to perform a conversion,
such conversion functions can be declared and can potentially
be reached through a call to a virtual conversion function in a base class<a class='hidden_link' href='#footnote-106.sentence-3'>.</a></div> <a href='#footnoteref-106'>⮥</a></div></div></div></body></html>