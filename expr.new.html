<!DOCTYPE html><html lang='en'><head><title>[expr.new]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>7</a> Expressions <a class='abbr_ref' href='./#expr'>[expr]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>7.6</a> Compound expressions <a class='abbr_ref' href='expr.compound#expr.new'>[expr.compound]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>7.6.2</a> Unary expressions <a class='abbr_ref' href='expr.unary#expr.new'>[expr.unary]</a></h3><h4 ><a class='secnum' style='min-width:118pt'>7.6.2.7</a> New <a class='abbr_ref'>[expr.new]</a></h4><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L4656'>#</a></div><div id='1.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':expression,new'></a></span><span class='indexparent'><a class='index' id=':new'></a></span>The <a class='grammarterm' href='#nt:new-expression'>new-expression</a> attempts to create an object of the
<a class='grammarterm' href='dcl.name#nt:type-id'>type-id</a> or <a class='grammarterm' href='#nt:new-type-id'>new-type-id</a> to which
it is applied<a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>The type of that object is the <a class='hidden_link' href='#def:type,allocated' id='def:type,allocated'><i >allocated type</i></a><a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='1.sentence-3' class='sentence'><span class='indexparent'><a class='index' id=':type,incomplete'></a></span>This type shall be a complete object type, but not an abstract class
type or array
thereof (<a href='intro.object'>[intro.object]</a>, <a href='basic.types'>[basic.types]</a>, <a href='class.abstract'>[class.abstract]</a>)<a class='hidden_link' href='#1.sentence-3'>.</a></div> <div id='1.note-1' class='note'>[&nbsp;<a class='note_link' href='#1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='1.sentence-4' class='sentence'>Because references are not objects, references cannot be created by
<a class='grammarterm' href='#nt:new-expression'>new-expression</a><span class='textit'>s</span><a class='hidden_link' href='#1.sentence-4'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='1.note-2' class='note'>[&nbsp;<a class='note_link' href='#1.note-2'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='1.sentence-5' class='sentence'>The <a class='grammarterm' href='dcl.name#nt:type-id'>type-id</a> may be a cv-qualified type, in which case the
object created by the <a class='grammarterm' href='#nt:new-expression'>new-expression</a> has a cv-qualified type<a class='hidden_link' href='#1.sentence-5'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> <pre class='bnf'><a class='nontermdef' href='#nt:new-expression' id='nt:new-expression'>new-expression</a><span class='ntdefcolon'>:</span>
&#9;<span class='terminal'><span class='operator'>::</span></span><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='texttt'><span class='keyword'>new</span></span><span class='indexparent'><a class='index' id=':new_'></a></span> <a class='grammarterm' href='#nt:new-placement'>new-placement</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <a class='grammarterm' href='#nt:new-type-id'>new-type-id</a> <a class='grammarterm' href='#nt:new-initializer'>new-initializer</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> 
&#9;<span class='terminal'><span class='operator'>::</span></span><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='texttt'><span class='keyword'>new</span></span><span class='indexparent'><a class='index' id=':new__'></a></span> <a class='grammarterm' href='#nt:new-placement'>new-placement</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'><span class='parenthesis'>(</span></span> <a class='grammarterm' href='dcl.name#nt:type-id'>type-id</a> <span class='terminal'><span class='parenthesis'>)</span></span> <a class='grammarterm' href='#nt:new-initializer'>new-initializer</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span>
</pre><span class='indexparent'><a class='index' id=':new,storage_allocation'></a></span><pre class='bnf'><a class='nontermdef' href='#nt:new-placement' id='nt:new-placement'>new-placement</a><span class='ntdefcolon'>:</span>
&#9;<span class='terminal'><span class='parenthesis'>(</span></span> <a class='grammarterm' href='expr.post#nt:expression-list'>expression-list</a> <span class='terminal'><span class='parenthesis'>)</span></span>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:new-type-id' id='nt:new-type-id'>new-type-id</a><span class='ntdefcolon'>:</span>
&#9;<a class='grammarterm' href='dcl.type#nt:type-specifier-seq'>type-specifier-seq</a> <a class='grammarterm' href='#nt:new-declarator'>new-declarator</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:new-declarator' id='nt:new-declarator'>new-declarator</a><span class='ntdefcolon'>:</span>
&#9;<a class='grammarterm' href='dcl.decl#nt:ptr-operator'>ptr-operator</a> <a class='grammarterm' href='#nt:new-declarator'>new-declarator</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> 
&#9;<a class='grammarterm' href='#nt:noptr-new-declarator'>noptr-new-declarator</a>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:noptr-new-declarator' id='nt:noptr-new-declarator'>noptr-new-declarator</a><span class='ntdefcolon'>:</span>
&#9;<span class='terminal'><span class='squarebracket'>[</span></span> <a class='grammarterm' href='expr.comma#nt:expression'>expression</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'><span class='squarebracket'>]</span></span> <a class='grammarterm' href='dcl.attr.grammar#nt:attribute-specifier-seq'>attribute-specifier-seq</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span>
&#9;<a class='grammarterm' href='#nt:noptr-new-declarator'>noptr-new-declarator</a> <span class='terminal'><span class='squarebracket'>[</span></span> <a class='grammarterm' href='expr.const#nt:constant-expression'>constant-expression</a> <span class='terminal'><span class='squarebracket'>]</span></span> <a class='grammarterm' href='dcl.attr.grammar#nt:attribute-specifier-seq'>attribute-specifier-seq</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span>
</pre><pre class='bnf'><a class='nontermdef' href='#nt:new-initializer' id='nt:new-initializer'>new-initializer</a><span class='ntdefcolon'>:</span>
&#9;<span class='terminal'><span class='parenthesis'>(</span></span> <a class='grammarterm' href='expr.post#nt:expression-list'>expression-list</a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span> <span class='terminal'><span class='parenthesis'>)</span></span>
&#9;<a class='grammarterm' href='dcl.init#nt:braced-init-list'>braced-init-list</a>
</pre></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L4714'>#</a></div><div id='2.sentence-1' class='sentence'>If a <a href='dcl.spec.auto'>placeholder type</a> appears in the
<a class='grammarterm' href='dcl.type#nt:type-specifier-seq'>type-specifier-seq</a> of a <a class='grammarterm' href='#nt:new-type-id'>new-type-id</a> or
<a class='grammarterm' href='dcl.name#nt:type-id'>type-id</a> of a <a class='grammarterm' href='#nt:new-expression'>new-expression</a>,
the allocated type is deduced as follows:
Let
<span class='textit'>init</span> be the <a class='grammarterm' href='#nt:new-initializer'>new-initializer</a>, if any,
and
<span class='texttt'>T</span> be the <a class='grammarterm' href='#nt:new-type-id'>new-type-id</a> or <a class='grammarterm' href='dcl.name#nt:type-id'>type-id</a> of
the <a class='grammarterm' href='#nt:new-expression'>new-expression</a>, then the allocated type is the type
deduced for the variable <span class='texttt'>x</span> in the invented
declaration (<a href='dcl.spec.auto'>[dcl.spec.auto]</a>):</div><pre class='codeblock'>
T x <span class='textrm'><span class='textit'>init</span></span> ;
</pre><div id='2.example-1' class='example'>[&nbsp;<a class='example_link' href='#2.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>new</span> <span class='keyword'>auto</span><span class='parenthesis'>(</span><span class='literal'>1</span><span class='parenthesis'>)</span>;                    <span class='comment'>// allocated type is <span class='tcode_in_codeblock'>int</span></span>
<span class='keyword'>auto</span> x <span class='operator'>=</span> <span class='keyword'>new</span> <span class='keyword'>auto</span><span class='parenthesis'>(</span><span class='literal'>'a'</span><span class='parenthesis'>)</span>;         <span class='comment'>// allocated type is <span class='tcode_in_codeblock'>char</span>, <span class='tcode_in_codeblock'>x</span> is of type <span class='tcode_in_codeblock'>char*</span></span>

<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> A <span class='curlybracket'>{</span> A<span class='parenthesis'>(</span>T, T<span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>;
<span class='keyword'>auto</span> y <span class='operator'>=</span> <span class='keyword'>new</span> A<span class='curlybracket'>{</span><span class='literal'>1</span>, <span class='literal'>2</span><span class='curlybracket'>}</span>;           <span class='comment'>// allocated type is <span class='tcode_in_codeblock'>A&lt;int&gt;</span></span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L4741'>#</a></div><div id='3.sentence-1' class='sentence'>The <a class='grammarterm' href='#nt:new-type-id'>new-type-id</a> in a <a class='grammarterm' href='#nt:new-expression'>new-expression</a> is the longest
possible sequence of <a class='grammarterm' href='#nt:new-declarator'>new-declarator</a><span class='textit'>s</span><a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='3.note-1' class='note'>[&nbsp;<a class='note_link' href='#3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='3.sentence-2' class='sentence'>This prevents ambiguities between the declarator operators <span class='texttt'><span class='operator'>&amp;</span></span>, <span class='texttt'><span class='operator'>&amp;</span><span class='operator'>&amp;</span></span>,
<span class='texttt'><span class='operator'>*</span></span>, and <span class='texttt'><span class='squarebracket'>[</span><span class='squarebracket'>]</span></span> and their expression counterparts<a class='hidden_link' href='#3.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='3.example-1' class='example'>[&nbsp;<a class='example_link' href='#3.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>new</span> <span class='keyword'>int</span> <span class='operator'>*</span> i;                    <span class='comment'>// syntax error: parsed as <span class='tcode_in_codeblock'>(new int*) i</span>, not as <span class='tcode_in_codeblock'>(new int)*i</span></span>
</pre> <div id='3.sentence-3' class='sentence'>
The <span class='texttt'><span class='operator'>*</span></span> is the pointer declarator and not the multiplication
operator<a class='hidden_link' href='#3.sentence-3'>.</a></div> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L4756'>#</a></div><div id='4.note-1' class='note'>[&nbsp;<a class='note_link' href='#4.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='4.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':ambiguity,parentheses_and'></a></span>Parentheses in a <a class='grammarterm' href='#nt:new-type-id'>new-type-id</a> of a <a class='grammarterm' href='#nt:new-expression'>new-expression</a>
can have surprising effects<a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='4.example-1' class='example'>[&nbsp;<a class='example_link' href='#4.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='4.sentence-2' class='sentence'><pre class='codeblock'>
<span class='keyword'>new</span> <span class='keyword'>int</span><span class='parenthesis'>(</span><span class='operator'>*</span><span class='squarebracket'>[</span><span class='literal'>10</span><span class='squarebracket'>]</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;               <span class='comment'>// error</span>
</pre>
is ill-formed because the binding is
<pre class='codeblock'>
<span class='parenthesis'>(</span><span class='keyword'>new</span> <span class='keyword'>int</span><span class='parenthesis'>)</span> <span class='parenthesis'>(</span><span class='operator'>*</span><span class='squarebracket'>[</span><span class='literal'>10</span><span class='squarebracket'>]</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;            <span class='comment'>// error</span>
</pre></div><div id='4.sentence-3' class='sentence'>Instead, the explicitly parenthesized version of the <span class='texttt'><span class='keyword'>new</span></span>
operator can be used to create objects of <a href='basic.compound'>compound
types</a>:
<pre class='codeblock'>
<span class='keyword'>new</span> <span class='parenthesis'>(</span><span class='keyword'>int</span> <span class='parenthesis'>(</span><span class='operator'>*</span><span class='squarebracket'>[</span><span class='literal'>10</span><span class='squarebracket'>]</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
</pre>
allocates an array of <span class='texttt'><span class='literal'>10</span></span> pointers to functions (taking no
argument and returning <span class='texttt'><span class='keyword'>int</span></span>)<a class='hidden_link' href='#4.sentence-3'>.</a></div> —&nbsp;<i>end example</i></div>&nbsp;]</div>  —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L4781'>#</a></div><div id='5.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':storage_duration,dynamic'></a></span>Objects created by a <a class='grammarterm' href='#nt:new-expression'>new-expression</a> have dynamic storage
duration (<a href='basic.stc.dynamic'>[basic.stc.dynamic]</a>)<a class='hidden_link' href='#5.sentence-1'>.</a></div> <div id='5.note-1' class='note'>[&nbsp;<a class='note_link' href='#5.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='5.sentence-2' class='sentence'><span class='indexparent'><a class='index' id=':new,scoping_and'></a></span>The lifetime of such an object is not necessarily restricted to the
scope in which it is created<a class='hidden_link' href='#5.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='5.sentence-3' class='sentence'>
When the allocated object is not an array, the result of the <a class='grammarterm' href='#nt:new-expression'>new-expression</a>
is a pointer to the object created<a class='hidden_link' href='#5.sentence-3'>.</a></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L4793'>#</a></div><div id='6.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':array,new'></a></span>When the allocated object is an array (that is, the
<a class='grammarterm' href='#nt:noptr-new-declarator'>noptr-new-declarator</a> syntax is used or the
<a class='grammarterm' href='#nt:new-type-id'>new-type-id</a> or <a class='grammarterm' href='dcl.name#nt:type-id'>type-id</a> denotes an array type), the
<a class='grammarterm' href='#nt:new-expression'>new-expression</a> yields a pointer to the initial element (if
any) of the array<a class='hidden_link' href='#6.sentence-1'>.</a></div> <div id='6.note-1' class='note'>[&nbsp;<a class='note_link' href='#6.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='6.sentence-2' class='sentence'>Both <span class='texttt'><span class='keyword'>new</span> <span class='keyword'>int</span></span> and <span class='texttt'><span class='keyword'>new</span> <span class='keyword'>int</span><span class='squarebracket'>[</span><span class='literal'>10</span><span class='squarebracket'>]</span></span> have type <span class='texttt'><span class='keyword'>int</span><span class='operator'>*</span></span> and
the type of <span class='texttt'><span class='keyword'>new</span> <span class='keyword'>int</span><span class='squarebracket'>[</span>i<span class='squarebracket'>]</span><span class='squarebracket'>[</span><span class='literal'>10</span><span class='squarebracket'>]</span></span> is <span class='texttt'><span class='keyword'>int</span> <span class='parenthesis'>(</span><span class='operator'>*</span><span class='parenthesis'>)</span><span class='squarebracket'>[</span><span class='literal'>10</span><span class='squarebracket'>]</span></span></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='6.sentence-3' class='sentence'>
The <a class='grammarterm' href='dcl.attr.grammar#nt:attribute-specifier-seq'>attribute-specifier-seq</a> in a <a class='grammarterm' href='#nt:noptr-new-declarator'>noptr-new-declarator</a> appertains
to the associated array type<a class='hidden_link' href='#6.sentence-3'>.</a></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L4807'>#</a></div><div id='7.sentence-1' class='sentence'>Every <a class='grammarterm' href='expr.const#nt:constant-expression'>constant-expression</a> in a
<a class='grammarterm' href='#nt:noptr-new-declarator'>noptr-new-declarator</a> shall be a converted constant
expression (<a href='expr.const'>[expr.const]</a>) of type <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>size_&shy;t</span> and
its value shall be greater than zero<a class='hidden_link' href='#7.sentence-1'>.</a></div> <div id='7.example-1' class='example'>[&nbsp;<a class='example_link' href='#7.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <div id='7.sentence-2' class='sentence'>Given the definition <span class='texttt'><span class='keyword'>int</span> n <span class='operator'>=</span> <span class='literal'>42</span></span>,
<span class='texttt'><span class='keyword'>new</span> <span class='keyword'>float</span><span class='squarebracket'>[</span>n<span class='squarebracket'>]</span><span class='squarebracket'>[</span><span class='literal'>5</span><span class='squarebracket'>]</span></span> is well-formed (because <span class='texttt'>n</span> is the
<a class='grammarterm' href='expr.comma#nt:expression'>expression</a> of a <a class='grammarterm' href='#nt:noptr-new-declarator'>noptr-new-declarator</a>), but
<span class='texttt'><span class='keyword'>new</span> <span class='keyword'>float</span><span class='squarebracket'>[</span><span class='literal'>5</span><span class='squarebracket'>]</span><span class='squarebracket'>[</span>n<span class='squarebracket'>]</span></span> is ill-formed (because <span class='texttt'>n</span> is not a
constant expression)<a class='hidden_link' href='#7.sentence-2'>.</a></div> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L4820'>#</a></div><div id='8.sentence-1' class='sentence'>If the <a class='grammarterm' href='dcl.name#nt:type-id'>type-id</a> or <a class='grammarterm' href='#nt:new-type-id'>new-type-id</a>
denotes an array type of unknown bound (<a href='dcl.array'>[dcl.array]</a>),
the <a class='grammarterm' href='#nt:new-initializer'>new-initializer</a> shall not be omitted;
the allocated object is an array with <span class='texttt'>n</span> elements,
where <span class='texttt'>n</span> is determined from the number of initial elements
supplied in
the <a class='grammarterm' href='#nt:new-initializer'>new-initializer</a> (<a href='dcl.init.aggr'>[dcl.init.aggr]</a>, <a href='dcl.init.string'>[dcl.init.string]</a>)<a class='hidden_link' href='#8.sentence-1'>.</a></div></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L4829'>#</a></div><div id='9.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':new___'></a></span>If the <a class='grammarterm' href='expr.comma#nt:expression'>expression</a> in a <a class='grammarterm' href='#nt:noptr-new-declarator'>noptr-new-declarator</a>
is present, it is implicitly converted to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>size_&shy;t</span><a class='hidden_link' href='#9.sentence-1'>.</a></div> <div id='9.sentence-2' class='sentence'><span class='indexparent'><a class='index' id=':function,allocation'></a></span>The <a class='grammarterm' href='expr.comma#nt:expression'>expression</a> is erroneous if:
<ul class='itemize'><li id='9.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#9.1'>(9.1)</a></div>the expression is of non-class type and its value before converting to
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>size_&shy;t</span> is less than zero;</li><li id='9.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#9.2'>(9.2)</a></div>the expression is of class type and its value before application of the second
standard conversion (<a href='over.ics.user'>[over.ics.user]</a>)<a class='footnotenum' href='#footnote-70' id='footnoteref-70'>70</a> is less than zero;</li><li id='9.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#9.3'>(9.3)</a></div>its value is such that the size of the allocated object would exceed the
<span class='indexparent'><a class='index' id=':maximum_size_of_an_allocated_object'></a></span>implementation-defined <a href='implimits'>limit</a>; or</li><li id='9.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#9.4'>(9.4)</a></div>the <a class='grammarterm' href='#nt:new-initializer'>new-initializer</a> is a <a class='grammarterm' href='dcl.init#nt:braced-init-list'>braced-init-list</a> and the
number of array elements for which initializers are provided (including the
terminating <span class='texttt'><span class='literal'>'\0'</span></span> in a <a class='grammarterm' href='lex.string#nt:string-literal'>string-literal</a>) exceeds the
number of elements to initialize<a class='hidden_link' href='#9.sentence-2'>.</a></li></ul></div><div id='9.sentence-3' class='sentence'>If the <a class='grammarterm' href='expr.comma#nt:expression'>expression</a> is erroneous after converting to <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>size_&shy;t</span>:
<ul class='itemize'><li id='9.5'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#9.5'>(9.5)</a></div>if the <a class='grammarterm' href='expr.comma#nt:expression'>expression</a> is a core constant expression,
the program is ill-formed;</li><li id='9.6'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#9.6'>(9.6)</a></div>otherwise, an allocation function is not called; instead
<ul class='itemize'><li id='9.6.1'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#9.6.1'>(9.6.1)</a></div>if the allocation function that would have been called
has a non-throwing exception specification (<a href='except.spec'>[except.spec]</a>),
the value of the <a class='grammarterm' href='#nt:new-expression'>new-expression</a>
is the null pointer value of the required result type;</li><li id='9.6.2'><div class='marginalizedparent' style='left:-9em'><a class='marginalized' href='#9.6.2'>(9.6.2)</a></div>otherwise, the <a class='grammarterm' href='#nt:new-expression'>new-expression</a> terminates by throwing an
exception of a type that would match a handler (<a href='except.handle'>[except.handle]</a>) of type
<a href='new.badlength'><span class='texttt'>std&#x200b;::&#x200b;bad_&shy;array_&shy;new_&shy;length</span></a><a class='hidden_link' href='#9.sentence-3'>.</a></li></ul></li></ul></div> <div id='9.sentence-4' class='sentence'>
When the value of the <a class='grammarterm' href='expr.comma#nt:expression'>expression</a> is zero, the allocation
function is called to allocate an array with no elements<a class='hidden_link' href='#9.sentence-4'>.</a></div></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L4880'>#</a></div><div id='10.sentence-1' class='sentence'>A <a class='grammarterm' href='#nt:new-expression'>new-expression</a> may obtain storage for the object by calling an
allocation function (<a href='basic.stc.dynamic.allocation'>[basic.stc.dynamic.allocation]</a>)<a class='hidden_link' href='#10.sentence-1'>.</a></div> <div id='10.sentence-2' class='sentence'>If
the <a class='grammarterm' href='#nt:new-expression'>new-expression</a> terminates by throwing an exception, it
may release storage by calling a <a href='basic.stc.dynamic.deallocation'>deallocation
function</a><a class='hidden_link' href='#10.sentence-2'>.</a></div> <div id='10.sentence-3' class='sentence'>If the allocated type
is a non-array type, the allocation function's name is
<span class='indexparent'><a class='index' id=':operator_new'></a></span><span class='indexparent'><a class='index' id=':operator_delete'></a></span><span class='texttt'><span class='keyword'>operator</span> <span class='keyword'>new</span></span> and the deallocation function's name is
<span class='texttt'><span class='keyword'>operator</span> <span class='keyword'>delete</span></span><a class='hidden_link' href='#10.sentence-3'>.</a></div> <div id='10.sentence-4' class='sentence'>If the allocated type is an array type, the
allocation function's name is
<span class='indexparent'><a class='index' id=':operator_new_'></a></span><span class='indexparent'><a class='index' id=':operator_delete_'></a></span><span class='texttt'><span class='keyword'>operator</span> <span class='keyword'>new</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span></span>
and the deallocation function's name is
<span class='texttt'><span class='keyword'>operator</span> <span class='keyword'>delete</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span></span><a class='hidden_link' href='#10.sentence-4'>.</a></div> <div id='10.note-1' class='note'>[&nbsp;<a class='note_link' href='#10.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='10.sentence-5' class='sentence'>An implementation is required to provide default definitions for the global
allocation
functions (<a href='basic.stc.dynamic'>[basic.stc.dynamic]</a>, <a href='new.delete.single'>[new.delete.single]</a>, <a href='new.delete.array'>[new.delete.array]</a>)<a class='hidden_link' href='#10.sentence-5'>.</a></div> <div id='10.sentence-6' class='sentence'>A C++ program can provide alternative definitions of
these functions (<a href='replacement.functions'>[replacement.functions]</a>) and/or class-specific
versions (<a href='class.free'>[class.free]</a>)<a class='hidden_link' href='#10.sentence-6'>.</a></div> <div id='10.sentence-7' class='sentence'>The set of allocation and deallocation functions that may be called
by a <a class='grammarterm' href='#nt:new-expression'>new-expression</a>
may include functions that do not perform allocation or deallocation;
for example, see <a href='new.delete.placement'>[new.delete.placement]</a><a class='hidden_link' href='#10.sentence-7'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L4910'>#</a></div><div id='11.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':operator,scope_resolution'></a></span>If the <a class='grammarterm' href='#nt:new-expression'>new-expression</a> begins with a unary <span class='texttt'><span class='operator'>&#x200b;::&#x200b;</span></span>
operator, the allocation function's name is looked up in the global
scope<a class='hidden_link' href='#11.sentence-1'>.</a></div> <div id='11.sentence-2' class='sentence'>Otherwise, if the allocated type is a class type <span class='texttt'>T</span> or
array thereof, the allocation function's name is looked up in the scope
of <span class='texttt'>T</span><a class='hidden_link' href='#11.sentence-2'>.</a></div> <div id='11.sentence-3' class='sentence'>If this lookup fails to find the name, or if the allocated
type is not a class type, the allocation function's name is looked up in
the global scope<a class='hidden_link' href='#11.sentence-3'>.</a></div></div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L4920'>#</a></div><div id='12.sentence-1' class='sentence'>An implementation is allowed to omit a call to a replaceable global allocation
function (<a href='new.delete.single'>[new.delete.single]</a>, <a href='new.delete.array'>[new.delete.array]</a>)<a class='hidden_link' href='#12.sentence-1'>.</a></div> <div id='12.sentence-2' class='sentence'>When it does so,
the storage is instead provided by the implementation or provided by extending
the allocation of another <a class='grammarterm' href='#nt:new-expression'>new-expression</a><a class='hidden_link' href='#12.sentence-2'>.</a></div></div><div class='para' id='13'><div class='marginalizedparent'><a class='marginalized' href='#13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L4926'>#</a></div><div id='13.sentence-1' class='sentence'>During an evaluation of a constant expression,
a call to an allocation function is always omitted<a class='hidden_link' href='#13.sentence-1'>.</a></div> <div id='13.note-1' class='note'>[&nbsp;<a class='note_link' href='#13.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='13.sentence-2' class='sentence'>Only <a class='grammarterm' href='#nt:new-expression'>new-expression</a><span class='textit'>s</span> that would otherwise result in
a call to a replaceable global allocation function
can be evaluated in constant expressions (<a href='expr.const'>[expr.const]</a>)<a class='hidden_link' href='#13.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='14'><div class='marginalizedparent'><a class='marginalized' href='#14'>14</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L4935'>#</a></div><div id='14.sentence-1' class='sentence'>The implementation may
extend the allocation of a <a class='grammarterm' href='#nt:new-expression'>new-expression</a> <span class='texttt'>e1</span> to provide
storage for a <a class='grammarterm' href='#nt:new-expression'>new-expression</a> <span class='texttt'>e2</span> if the
following would be true were the allocation not extended:
<ul class='itemize'><li id='14.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#14.1'>(14.1)</a></div>the evaluation of <span class='texttt'>e1</span> is sequenced before the evaluation of
<span class='texttt'>e2</span>, and</li><li id='14.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#14.2'>(14.2)</a></div><span class='texttt'>e2</span> is evaluated whenever <span class='texttt'>e1</span> obtains storage, and</li><li id='14.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#14.3'>(14.3)</a></div>both <span class='texttt'>e1</span> and <span class='texttt'>e2</span> invoke the same replaceable global
allocation function, and</li><li id='14.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#14.4'>(14.4)</a></div>if the allocation function invoked by <span class='texttt'>e1</span> and <span class='texttt'>e2</span> is
throwing, any exceptions thrown in the evaluation of either <span class='texttt'>e1</span> or
<span class='texttt'>e2</span> would be first caught in the same handler, and</li><li id='14.5'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#14.5'>(14.5)</a></div>the pointer values produced by <span class='texttt'>e1</span> and <span class='texttt'>e2</span> are operands to
evaluated <a class='grammarterm' href='expr.delete#nt:delete-expression'>delete-expression</a><span class='textit'>s</span>, and</li><li id='14.6'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#14.6'>(14.6)</a></div>the evaluation of <span class='texttt'>e2</span> is sequenced before the evaluation of the
<a class='grammarterm' href='expr.delete#nt:delete-expression'>delete-expression</a> whose operand is the pointer value produced
by <span class='texttt'>e1</span><a class='hidden_link' href='#14.sentence-1'>.</a></li></ul></div><div id='14.example-1' class='example'>[&nbsp;<a class='example_link' href='#14.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>void</span> can_merge<span class='parenthesis'>(</span><span class='keyword'>int</span> x<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='comment'>// These allocations are safe for merging:</span>
  std<span class='operator'>::</span>unique_ptr<span class='anglebracket'>&lt;</span><span class='keyword'>char</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='anglebracket'>&gt;</span> a<span class='curlybracket'>{</span><span class='keyword'>new</span> <span class='parenthesis'>(</span>std<span class='operator'>::</span>nothrow<span class='parenthesis'>)</span> <span class='keyword'>char</span><span class='squarebracket'>[</span><span class='literal'>8</span><span class='squarebracket'>]</span><span class='curlybracket'>}</span>;
  std<span class='operator'>::</span>unique_ptr<span class='anglebracket'>&lt;</span><span class='keyword'>char</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='anglebracket'>&gt;</span> b<span class='curlybracket'>{</span><span class='keyword'>new</span> <span class='parenthesis'>(</span>std<span class='operator'>::</span>nothrow<span class='parenthesis'>)</span> <span class='keyword'>char</span><span class='squarebracket'>[</span><span class='literal'>8</span><span class='squarebracket'>]</span><span class='curlybracket'>}</span>;
  std<span class='operator'>::</span>unique_ptr<span class='anglebracket'>&lt;</span><span class='keyword'>char</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='anglebracket'>&gt;</span> c<span class='curlybracket'>{</span><span class='keyword'>new</span> <span class='parenthesis'>(</span>std<span class='operator'>::</span>nothrow<span class='parenthesis'>)</span> <span class='keyword'>char</span><span class='squarebracket'>[</span>x<span class='squarebracket'>]</span><span class='curlybracket'>}</span>;

  g<span class='parenthesis'>(</span>a<span class='operator'>.</span>get<span class='parenthesis'>(</span><span class='parenthesis'>)</span>, b<span class='operator'>.</span>get<span class='parenthesis'>(</span><span class='parenthesis'>)</span>, c<span class='operator'>.</span>get<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>

<span class='keyword'>void</span> cannot_merge<span class='parenthesis'>(</span><span class='keyword'>int</span> x<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  std<span class='operator'>::</span>unique_ptr<span class='anglebracket'>&lt;</span><span class='keyword'>char</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='anglebracket'>&gt;</span> a<span class='curlybracket'>{</span><span class='keyword'>new</span> <span class='keyword'>char</span><span class='squarebracket'>[</span><span class='literal'>8</span><span class='squarebracket'>]</span><span class='curlybracket'>}</span>;
  <span class='keyword'>try</span> <span class='curlybracket'>{</span>
    <span class='comment'>// Merging this allocation would change its catch handler.</span>
    std<span class='operator'>::</span>unique_ptr<span class='anglebracket'>&lt;</span><span class='keyword'>char</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='anglebracket'>&gt;</span> b<span class='curlybracket'>{</span><span class='keyword'>new</span> <span class='keyword'>char</span><span class='squarebracket'>[</span>x<span class='squarebracket'>]</span><span class='curlybracket'>}</span>;
  <span class='curlybracket'>}</span> <span class='keyword'>catch</span> <span class='parenthesis'>(</span><span class='keyword'>const</span> std<span class='operator'>::</span>bad_alloc<span class='operator'>&amp;</span> e<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
    std<span class='operator'>::</span>cerr <span class='anglebracket'>&lt;</span><span class='anglebracket'>&lt;</span> <span class='literal'>"Allocation failed: "</span> <span class='anglebracket'>&lt;</span><span class='anglebracket'>&lt;</span> e<span class='operator'>.</span>what<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='anglebracket'>&lt;</span><span class='anglebracket'>&lt;</span> std<span class='operator'>::</span>endl;
    <span class='keyword'>throw</span>;
  <span class='curlybracket'>}</span>
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='15'><div class='marginalizedparent'><a class='marginalized' href='#15'>15</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L4985'>#</a></div><div id='15.sentence-1' class='sentence'>When a <a class='grammarterm' href='#nt:new-expression'>new-expression</a> calls an allocation function and that
allocation has not been extended, the
<a class='grammarterm' href='#nt:new-expression'>new-expression</a> passes the amount of space requested to the
allocation function as the first argument of type
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>size_&shy;t</span><a class='hidden_link' href='#15.sentence-1'>.</a></div> <div id='15.sentence-2' class='sentence'>That argument shall be no less than the size
of the object being created; it may be greater than the size of the
object being created only if the object is an array and
the allocation function is not a non-allocating form (<a href='new.delete.placement'>[new.delete.placement]</a>)<a class='hidden_link' href='#15.sentence-2'>.</a></div> <div id='15.sentence-3' class='sentence'>For arrays of
<span class='texttt'><span class='keyword'>char</span></span>, <span class='texttt'><span class='keyword'>unsigned</span> <span class='keyword'>char</span></span>, and <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>byte</span>,
the difference between the
result of the <a class='grammarterm' href='#nt:new-expression'>new-expression</a> and the address returned by the
allocation function shall be an integral multiple of the
strictest fundamental
<a href='basic.align'>alignment requirement</a> of any object type whose size
is no greater than the size of the array being created<a class='hidden_link' href='#15.sentence-3'>.</a></div> <div id='15.note-1' class='note'>[&nbsp;<a class='note_link' href='#15.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='15.sentence-4' class='sentence'><span class='indexparent'><a class='index' id=':allocation,alignment_storage'></a></span>Because allocation functions are assumed to return pointers to storage
that is appropriately aligned for objects of any type
with fundamental alignment, this constraint
on array allocation overhead permits the common idiom of allocating
character arrays into which objects of other types will later be placed<a class='hidden_link' href='#15.sentence-4'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='16'><div class='marginalizedparent'><a class='marginalized' href='#16'>16</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L5011'>#</a></div><div id='16.sentence-1' class='sentence'>When a <a class='grammarterm' href='#nt:new-expression'>new-expression</a> calls an allocation function and that
allocation has been extended, the size argument to the allocation call shall
be no greater than the sum of the sizes for the omitted calls as specified
above, plus the size for the extended call had it not been extended, plus any
padding necessary to align the allocated objects within the allocated memory<a class='hidden_link' href='#16.sentence-1'>.</a></div></div><div class='para' id='17'><div class='marginalizedparent'><a class='marginalized' href='#17'>17</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L5018'>#</a></div><div id='17.sentence-1' class='sentence'>The <a class='grammarterm' href='#nt:new-placement'>new-placement</a> syntax is used to supply additional
arguments to an allocation function; such an expression is called
a <a class='hidden_link' href='#def:new-expression,placement' id='def:new-expression,placement'><i >placement <span class='grammarterm'>new-expression</span></i></a><a class='hidden_link' href='#17.sentence-1'>.</a></div></div><div class='para' id='18'><div class='marginalizedparent'><a class='marginalized' href='#18'>18</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L5024'>#</a></div><div id='18.sentence-1' class='sentence'>Overload resolution is
performed on a function call created by assembling an argument list<a class='hidden_link' href='#18.sentence-1'>.</a></div> <div id='18.sentence-2' class='sentence'>The first argument is
the amount of space requested,
and has type <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>size_&shy;t</span><a class='hidden_link' href='#18.sentence-2'>.</a></div> <div id='18.sentence-3' class='sentence'>If the type of the allocated object has new-extended alignment,
the next argument is
the type's alignment,
and has type <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>align_&shy;val_&shy;t</span><a class='hidden_link' href='#18.sentence-3'>.</a></div> <div id='18.sentence-4' class='sentence'>If the <a class='grammarterm' href='#nt:new-placement'>new-placement</a> syntax is used,
the <a class='grammarterm' href='dcl.init#nt:initializer-clause'>initializer-clause</a><span class='textit'>s</span>
in its <a class='grammarterm' href='expr.post#nt:expression-list'>expression-list</a>
are the succeeding arguments<a class='hidden_link' href='#18.sentence-4'>.</a></div> <div id='18.sentence-5' class='sentence'>If no matching function is found then
<ul class='itemize'><li id='18.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#18.1'>(18.1)</a></div>if the allocated object type has new-extended alignment,
the alignment argument is removed from the argument list;</li><li id='18.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#18.2'>(18.2)</a></div>otherwise, an argument that
is the type's alignment and has type <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>align_&shy;val_&shy;t</span>
is added into the argument list immediately after the first argument;</li></ul>
and then overload resolution is performed again<a class='hidden_link' href='#18.sentence-5'>.</a></div></div><div class='para' id='19'><div class='marginalizedparent'><a class='marginalized' href='#19'>19</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L5053'>#</a></div><div id='19.example-1' class='example'>[&nbsp;<a class='example_link' href='#19.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <ul class='itemize'><li ><div id='19.sentence-1' class='sentence'><span class='texttt'><span class='keyword'>new</span> T</span> results in one of the following calls:
<pre class='codeblock'>
<span class='keyword'>operator</span> <span class='keyword'>new</span><span class='parenthesis'>(</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span><span class='parenthesis'>)</span>
<span class='keyword'>operator</span> <span class='keyword'>new</span><span class='parenthesis'>(</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span>, std<span class='operator'>::</span>align_val_t<span class='parenthesis'>(</span><span class='keyword'>alignof</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>
</pre></div></li><li ><div id='19.sentence-1' class='sentence'><span class='texttt'><span class='keyword'>new</span><span class='parenthesis'>(</span><span class='literal'>2</span>,f<span class='parenthesis'>)</span> T</span> results in one of the following calls:
<pre class='codeblock'>
<span class='keyword'>operator</span> <span class='keyword'>new</span><span class='parenthesis'>(</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span>, <span class='literal'>2</span>, f<span class='parenthesis'>)</span>
<span class='keyword'>operator</span> <span class='keyword'>new</span><span class='parenthesis'>(</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span>, std<span class='operator'>::</span>align_val_t<span class='parenthesis'>(</span><span class='keyword'>alignof</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span><span class='parenthesis'>)</span>, <span class='literal'>2</span>, f<span class='parenthesis'>)</span>
</pre></div></li><li ><div id='19.sentence-1' class='sentence'><span class='texttt'><span class='keyword'>new</span> T<span class='squarebracket'>[</span><span class='literal'>5</span><span class='squarebracket'>]</span></span> results in one of the following calls:
<pre class='codeblock'>
<span class='keyword'>operator</span> <span class='keyword'>new</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span> <span class='operator'>*</span> <span class='literal'>5</span> <span class='operator'>+</span> x<span class='parenthesis'>)</span>
<span class='keyword'>operator</span> <span class='keyword'>new</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span> <span class='operator'>*</span> <span class='literal'>5</span> <span class='operator'>+</span> x, std<span class='operator'>::</span>align_val_t<span class='parenthesis'>(</span><span class='keyword'>alignof</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>
</pre></div></li><li ><div id='19.sentence-1' class='sentence'><span class='texttt'><span class='keyword'>new</span><span class='parenthesis'>(</span><span class='literal'>2</span>,f<span class='parenthesis'>)</span> T<span class='squarebracket'>[</span><span class='literal'>5</span><span class='squarebracket'>]</span></span> results in one of the following calls:
<pre class='codeblock'>
<span class='keyword'>operator</span> <span class='keyword'>new</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span> <span class='operator'>*</span> <span class='literal'>5</span> <span class='operator'>+</span> x, <span class='literal'>2</span>, f<span class='parenthesis'>)</span>
<span class='keyword'>operator</span> <span class='keyword'>new</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span><span class='keyword'>sizeof</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span> <span class='operator'>*</span> <span class='literal'>5</span> <span class='operator'>+</span> x, std<span class='operator'>::</span>align_val_t<span class='parenthesis'>(</span><span class='keyword'>alignof</span><span class='parenthesis'>(</span>T<span class='parenthesis'>)</span><span class='parenthesis'>)</span>, <span class='literal'>2</span>, f<span class='parenthesis'>)</span>
</pre></div></li></ul>
Here, each instance of <span class='texttt'>x</span> is a non-negative unspecified value
representing array allocation overhead; the result of the
<a class='grammarterm' href='#nt:new-expression'>new-expression</a> will be offset by this amount from the value
returned by <span class='texttt'><span class='keyword'>operator</span> <span class='keyword'>new</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span></span>. <div id='19.sentence-1' class='sentence'>This overhead may be applied in all
array <a class='grammarterm' href='#nt:new-expression'>new-expression</a><span class='textit'>s</span>, including those referencing
a placement allocation function, except when referencing
the library function <span class='texttt'><span class='keyword'>operator</span> <span class='keyword'>new</span><span class='squarebracket'>[</span><span class='squarebracket'>]</span><span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>size_&shy;t, <span class='keyword'>void</span><span class='operator'>*</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#19.sentence-1'>.</a></div> <div id='19.sentence-2' class='sentence'>The amount of overhead may vary from one
invocation of <span class='texttt'><span class='keyword'>new</span></span> to another<a class='hidden_link' href='#19.sentence-2'>.</a></div> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='20'><div class='marginalizedparent'><a class='marginalized' href='#20'>20</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L5088'>#</a></div><div id='20.note-1' class='note'>[&nbsp;<a class='note_link' href='#20.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='20.sentence-1' class='sentence'>Unless an allocation function has a non-throwing
<a href='except.spec'>exception specification</a>,
it indicates failure to allocate storage by throwing a
<span class='indexparent'><a class='index' id=':bad_alloc'></a></span><span class='indexparent'><a class='index' id='lib:bad_alloc'></a></span><span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>bad_&shy;alloc</span> exception (<a href='basic.stc.dynamic.allocation'>[basic.stc.dynamic.allocation]</a>,
<a href='except'>[except]</a>, <a href='bad.alloc'>[bad.alloc]</a>);
it returns a non-null pointer otherwise<a class='hidden_link' href='#20.sentence-1'>.</a></div> <div id='20.sentence-2' class='sentence'>If the allocation function
has a non-throwing exception specification,
it returns null to indicate failure to allocate storage
and a non-null pointer otherwise<a class='hidden_link' href='#20.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='20.sentence-3' class='sentence'>
If the allocation function is a non-allocating
form (<a href='new.delete.placement'>[new.delete.placement]</a>) that returns null,
the behavior is undefined<a class='hidden_link' href='#20.sentence-3'>.</a></div> <div id='20.sentence-4' class='sentence'>Otherwise,
if the allocation function returns null, initialization shall not be
done, the deallocation function shall not be called, and the value of
the <a class='grammarterm' href='#nt:new-expression'>new-expression</a> shall be null<a class='hidden_link' href='#20.sentence-4'>.</a></div></div><div class='para' id='21'><div class='marginalizedparent'><a class='marginalized' href='#21'>21</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L5110'>#</a></div><div id='21.note-1' class='note'>[&nbsp;<a class='note_link' href='#21.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='21.sentence-1' class='sentence'>When the allocation function returns a value other than null, it must be
a pointer to a block of storage in which space for the object has been
reserved<a class='hidden_link' href='#21.sentence-1'>.</a></div> <div id='21.sentence-2' class='sentence'>The block of storage is assumed to be appropriately aligned
and of the requested size<a class='hidden_link' href='#21.sentence-2'>.</a></div> <div id='21.sentence-3' class='sentence'>The address of the created object will not
necessarily be the same as that of the block if the object is an array<a class='hidden_link' href='#21.sentence-3'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='22'><div class='marginalizedparent'><a class='marginalized' href='#22'>22</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L5119'>#</a></div><div id='22.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':new,array_of_class_objects_and'></a></span><span class='indexparent'><a class='index' id=':new,initialization_and'></a></span><span class='indexparent'><a class='index' id=':new,constructor_and'></a></span><span class='indexparent'><a class='index' id=':new,default_constructor_and'></a></span>A <a class='grammarterm' href='#nt:new-expression'>new-expression</a> that creates an object of type <span class='texttt'>T</span>
initializes that object as follows:</div><ul class='itemize'><li id='22.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#22.1'>(22.1)</a></div><div id='22.1.sentence-1' class='sentence'>If the <a class='grammarterm' href='#nt:new-initializer'>new-initializer</a> is omitted, the object is
default-initialized (<a href='dcl.init'>[dcl.init]</a>)<a class='hidden_link' href='#22.1.sentence-1'>.</a></div> <div id='22.1.note-1' class='note'>[&nbsp;<a class='note_link' href='#22.1.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='22.1.sentence-2' class='sentence'>If no initialization
is performed, the object has an indeterminate value<a class='hidden_link' href='#22.1.sentence-2'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </li><li id='22.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#22.2'>(22.2)</a></div><div id='22.2.sentence-1' class='sentence'>Otherwise, the <a class='grammarterm' href='#nt:new-initializer'>new-initializer</a> is interpreted according to
the initialization rules of <a href='dcl.init'>[dcl.init]</a> for direct-initialization<a class='hidden_link' href='#22.2.sentence-1'>.</a></div></li></ul></div><div class='para' id='23'><div class='marginalizedparent'><a class='marginalized' href='#23'>23</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L5139'>#</a></div><div id='23.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':new,unspecified_order_of_evaluation'></a></span><span class='indexparent'><a class='index' id=':new,unspecified_constructor_and'></a></span>The invocation of the allocation function is sequenced before
the evaluations of expressions in the <a class='grammarterm' href='#nt:new-initializer'>new-initializer</a><a class='hidden_link' href='#23.sentence-1'>.</a></div> <div id='23.sentence-2' class='sentence'>Initialization of
the allocated object is sequenced before the
<span class='indexparent'><a class='index' id=':value_computation'></a></span>value computation of the
<a class='grammarterm' href='#nt:new-expression'>new-expression</a><a class='hidden_link' href='#23.sentence-2'>.</a></div></div><div class='para' id='24'><div class='marginalizedparent'><a class='marginalized' href='#24'>24</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L5149'>#</a></div><div id='24.sentence-1' class='sentence'>If the <a class='grammarterm' href='#nt:new-expression'>new-expression</a> creates an object or an array of
objects of class type, access and ambiguity control are done for the
allocation function, the deallocation function (<a href='class.free'>[class.free]</a>), and
the constructor (<a href='class.ctor'>[class.ctor]</a>) selected for the initialization (if any)<a class='hidden_link' href='#24.sentence-1'>.</a></div> <div id='24.sentence-2' class='sentence'>If the <a class='grammarterm' href='#nt:new-expression'>new-expression</a>
creates an array of objects of class type, the destructor is potentially
invoked (<a href='class.dtor'>[class.dtor]</a>)<a class='hidden_link' href='#24.sentence-2'>.</a></div></div><div class='para' id='25'><div class='marginalizedparent'><a class='marginalized' href='#25'>25</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L5158'>#</a></div><div id='25.sentence-1' class='sentence'><span class='indexparent'><a class='index' id=':new,exception_and'></a></span>If any part of the object initialization described above<a class='footnotenum' href='#footnote-71' id='footnoteref-71'>71</a>
terminates by throwing an exception and a suitable deallocation function
can be found, the deallocation function is called to free the memory in
which the object was being constructed, after which the exception
continues to propagate in the context of the <a class='grammarterm' href='#nt:new-expression'>new-expression</a><a class='hidden_link' href='#25.sentence-1'>.</a></div> <div id='25.sentence-2' class='sentence'>If no unambiguous matching deallocation function can be found,
propagating the exception does not cause the object's memory to be
freed<a class='hidden_link' href='#25.sentence-2'>.</a></div> <div id='25.note-1' class='note'>[&nbsp;<a class='note_link' href='#25.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='25.sentence-3' class='sentence'>This is appropriate when the called allocation function does not
allocate memory; otherwise, it is likely to result in a memory leak<a class='hidden_link' href='#25.sentence-3'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div> </div><div class='para' id='26'><div class='marginalizedparent'><a class='marginalized' href='#26'>26</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L5175'>#</a></div><div id='26.sentence-1' class='sentence'>If the <a class='grammarterm' href='#nt:new-expression'>new-expression</a> begins with a unary <span class='texttt'><span class='operator'>&#x200b;::&#x200b;</span></span>
operator, the deallocation function's name is looked up in the global
scope<a class='hidden_link' href='#26.sentence-1'>.</a></div> <div id='26.sentence-2' class='sentence'>Otherwise, if the allocated type is a class type <span class='texttt'>T</span> or an
array thereof, the deallocation function's name is looked up in the
scope of <span class='texttt'>T</span><a class='hidden_link' href='#26.sentence-2'>.</a></div> <div id='26.sentence-3' class='sentence'>If this lookup fails to find the name, or if the
allocated type is not a class type or array thereof, the deallocation
function's name is looked up in the global scope<a class='hidden_link' href='#26.sentence-3'>.</a></div></div><div class='para' id='27'><div class='marginalizedparent'><a class='marginalized' href='#27'>27</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L5184'>#</a></div><div id='27.sentence-1' class='sentence'>A declaration of a placement deallocation function matches the
declaration of a placement allocation function if it has the same number
of parameters and, after parameter transformations (<a href='dcl.fct'>[dcl.fct]</a>), all
parameter types except the first are identical<a class='hidden_link' href='#27.sentence-1'>.</a></div> <div id='27.sentence-2' class='sentence'>If
the lookup finds a single matching deallocation function, that function
will be called; otherwise, no deallocation function will be called<a class='hidden_link' href='#27.sentence-2'>.</a></div> <div id='27.sentence-3' class='sentence'>If
the lookup finds a usual deallocation
function
and that function,
considered as a placement deallocation function, would have been
selected as a match for the allocation function, the program is
ill-formed<a class='hidden_link' href='#27.sentence-3'>.</a></div> <div id='27.sentence-4' class='sentence'>For a non-placement allocation function, the normal deallocation
function lookup is used to find the matching deallocation
function (<a href='expr.delete'>[expr.delete]</a>)<a class='hidden_link' href='#27.sentence-4'>.</a></div> <div id='27.example-1' class='example'>[&nbsp;<a class='example_link' href='#27.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>struct</span> S <span class='curlybracket'>{</span>
  <span class='comment'>// Placement allocation function:</span>
  <span class='keyword'>static</span> <span class='keyword'>void</span><span class='operator'>*</span> <span class='keyword'>operator</span> <span class='keyword'>new</span><span class='parenthesis'>(</span>std<span class='operator'>::</span>size_t, std<span class='operator'>::</span>size_t<span class='parenthesis'>)</span>;

  <span class='comment'>// Usual (non-placement) deallocation function:</span>
  <span class='keyword'>static</span> <span class='keyword'>void</span> <span class='keyword'>operator</span> <span class='keyword'>delete</span><span class='parenthesis'>(</span><span class='keyword'>void</span><span class='operator'>*</span>, std<span class='operator'>::</span>size_t<span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;

S<span class='operator'>*</span> p <span class='operator'>=</span> <span class='keyword'>new</span> <span class='parenthesis'>(</span><span class='literal'>0</span><span class='parenthesis'>)</span> S;   <span class='comment'>// error: non-placement deallocation function matches</span>
                    <span class='comment'>// placement allocation function</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='28'><div class='marginalizedparent'><a class='marginalized' href='#28'>28</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0869f240e1b791a7c040d64ea44c435bfb67a237/source/expressions.tex#L5215'>#</a></div><div id='28.sentence-1' class='sentence'>If a <a class='grammarterm' href='#nt:new-expression'>new-expression</a> calls a deallocation function, it passes
the value returned from the allocation function call as the first
argument of type <span class='texttt'><span class='keyword'>void</span><span class='operator'>*</span></span><a class='hidden_link' href='#28.sentence-1'>.</a></div> <div id='28.sentence-2' class='sentence'>If a placement deallocation function is
called, it is passed the same additional arguments as were passed to the
placement allocation function, that is, the same arguments as those
specified with the <a class='grammarterm' href='#nt:new-placement'>new-placement</a> syntax<a class='hidden_link' href='#28.sentence-2'>.</a></div> <div id='28.sentence-3' class='sentence'>If the implementation is allowed
to introduce a temporary object or make a copy of any argument
as part of the call to the allocation function,
it is unspecified whether the same object is used in the call
to both the allocation and deallocation functions<a class='hidden_link' href='#28.sentence-3'>.</a></div></div><div class='footnote' id='footnote-70'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-70'>70)</a></div><div id='footnote-70.sentence-1' class='sentence'>If the conversion function
returns a signed integer type, the second standard conversion converts to the
unsigned type <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>size_&shy;t</span> and thus thwarts any attempt to detect a
negative value afterwards<a class='hidden_link' href='#footnote-70.sentence-1'>.</a></div> <a href='#footnoteref-70'>⮥</a></div><div class='footnote' id='footnote-71'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-71'>71)</a></div><div id='footnote-71.sentence-1' class='sentence'>This may
include evaluating a <a class='grammarterm' href='#nt:new-initializer'>new-initializer</a> and/or calling
a constructor<a class='hidden_link' href='#footnote-71.sentence-1'>.</a></div> <a href='#footnoteref-71'>⮥</a></div></div></body></html>