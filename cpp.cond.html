<!DOCTYPE html><html lang='en'><head><title>[cpp.cond]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>15</a> Preprocessing directives <a class='abbr_ref' href='./#cpp'>[cpp]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>15.2</a> Conditional inclusion <a class='abbr_ref'>[cpp.cond]</a></h2><span class='indexparent'><a class='index' id=':preprocessing_directive,conditional_inclusion'></a></span><div class='bnf' id='nt:defined-macro-expression'>
<a class='hidden_link' href='#nt:defined-macro-expression' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='nt:defined-macro-expression'><span id=':defined-macro-expression'>defined-macro-expression<span class='textnormal'>:</span></span></span></a><br/><span class='texttt'><span class='preprocessordirective'>defined</span></span><span class='indexparent'><a class='index' id=':defined'></a></span> <a href='lex.name#nt:identifier' title='5.10&emsp;Identifiers&emsp;[lex.name]'><span id='ntref:identifier'><span class='textsf'><span class='textit'>identifier</span></span></span></a><br/><span class='terminal'><span class='preprocessordirective'>defined</span> <span class='parenthesis'>(</span></span> <a href='lex.name#nt:identifier' title='5.10&emsp;Identifiers&emsp;[lex.name]'><span id='ntref:identifier_'><span class='textsf'><span class='textit'>identifier</span></span></span></a> <span class='terminal'><span class='parenthesis'>)</span></span>
</div><div class='bnf' id='nt:h-preprocessing-token'>
<a class='hidden_link' href='#nt:h-preprocessing-token' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='nt:h-preprocessing-token'><span id=':h-preprocessing-token'>h-preprocessing-token<span class='textnormal'>:</span></span></span></a><br/><span class='textnormal'>any <a href='lex.pptoken#nt:preprocessing-token' title='5.4&emsp;Preprocessing tokens&emsp;[lex.pptoken]'><span id='ntref:preprocessing-token'><span class='textsf'><span class='textit'>preprocessing-token</span></span></span></a> other than <span class='terminal'><span class='anglebracket'>&gt;</span></span></span>
</div><div class='bnf' id='nt:h-pp-tokens'>
<a class='hidden_link' href='#nt:h-pp-tokens' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='nt:h-pp-tokens'><span id=':h-pp-tokens'>h-pp-tokens<span class='textnormal'>:</span></span></span></a><br/><a href='#nt:h-preprocessing-token' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='ntref:h-preprocessing-token'><span class='textsf'><span class='textit'>h-preprocessing-token</span></span></span></a><br/><a href='#nt:h-pp-tokens' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='ntref:h-pp-tokens'><span class='textsf'><span class='textit'>h-pp-tokens</span></span></span></a> <a href='#nt:h-preprocessing-token' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='ntref:h-preprocessing-token_'><span class='textsf'><span class='textit'>h-preprocessing-token</span></span></span></a>
</div><div class='bnf' id='nt:header-name-tokens'>
<a class='hidden_link' href='#nt:header-name-tokens' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='nt:header-name-tokens'><span id=':header-name-tokens'>header-name-tokens<span class='textnormal'>:</span></span></span></a><br/><a href='lex.string#nt:string-literal' title='5.13.5&emsp;String literals&emsp;[lex.string]'><span id='ntref:string-literal'><span class='textsf'><span class='textit'>string-literal</span></span></span></a><br/><span class='terminal'><span class='anglebracket'>&lt;</span></span> <a href='#nt:h-pp-tokens' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='ntref:h-pp-tokens_'><span class='textsf'><span class='textit'>h-pp-tokens</span></span></span></a> <span class='terminal'><span class='anglebracket'>&gt;</span></span>
</div><span class='indexparent'><a class='index' id=':__has_include'></a></span><div class='bnf' id='nt:has-include-expression'>
<a class='hidden_link' href='#nt:has-include-expression' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='nt:has-include-expression'><span id=':has-include-expression'>has-include-expression<span class='textnormal'>:</span></span></span></a><br/><span class='terminal'><span class='texttt'><span class='preprocessordirective'>__has_&shy;include</span></span></span> <span class='terminal'><span class='parenthesis'>(</span></span> <a href='lex.header#nt:header-name' title='5.8&emsp;Header names&emsp;[lex.header]'><span id='ntref:header-name'><span class='textsf'><span class='textit'>header-name</span></span></span></a> <span class='terminal'><span class='parenthesis'>)</span></span><br/><span class='terminal'><span class='texttt'><span class='preprocessordirective'>__has_&shy;include</span></span></span> <span class='terminal'><span class='parenthesis'>(</span></span> <a href='#nt:header-name-tokens' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='ntref:header-name-tokens'><span class='textsf'><span class='textit'>header-name-tokens</span></span></span></a> <span class='terminal'><span class='parenthesis'>)</span></span>
</div><span class='indexparent'><a class='index' id=':__has_cpp_attribute'></a></span><div class='bnf' id='nt:has-attribute-expression'>
<a class='hidden_link' href='#nt:has-attribute-expression' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='nt:has-attribute-expression'><span id=':has-attribute-expression'>has-attribute-expression<span class='textnormal'>:</span></span></span></a><br/><span class='terminal'><span class='texttt'><span class='preprocessordirective'>__has_&shy;cpp_&shy;attribute</span></span> <span class='parenthesis'>(</span></span> <a href='cpp.pre#nt:pp-tokens' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:pp-tokens'><span class='textsf'><span class='textit'>pp-tokens</span></span></span></a> <span class='terminal'><span class='parenthesis'>)</span></span>
</div><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/preprocessor.tex#L309'>#</a></div><div id='1.sentence-1' class='sentence'>The expression that controls conditional inclusion
shall be an integral constant expression except that
identifiers
(including those lexically identical to keywords)
are interpreted as described below<a class='footnotenum' href='#footnote-142' id='footnoteref-142' title='Because the controlling constant expression is evaluated during translation phase 4, all identifiers either are or are not macro names â€” there simply are no keywords, enumeration constants, etc.'>142</a>
and it may contain zero or more <a href='#nt:defined-macro-expression' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='ntref:defined-macro-expression'><span class='textsf'><span class='textit'>defined-macro-expression</span></span></span></a><span class='textit'>s</span> and/or
<a href='#nt:has-include-expression' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='ntref:has-include-expression'><span class='textsf'><span class='textit'>has-include-expression</span></span></span></a><span class='textit'>s</span> and/or
<a href='#nt:has-attribute-expression' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='ntref:has-attribute-expression'><span class='textsf'><span class='textit'>has-attribute-expression</span></span></span></a><span class='textit'>s</span> as unary operator expressions<a class='hidden_link' href='#1.sentence-1'>.</a></div></div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/preprocessor.tex#L322'>#</a></div><div id='2.sentence-1' class='sentence'>A <a href='#nt:defined-macro-expression' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='ntref:defined-macro-expression_'><span class='textsf'><span class='textit'>defined-macro-expression</span></span></span></a> evaluates to <span class='texttt'><span class='literal'>1</span></span>
if the identifier is currently defined
as a macro name
(that is, if it is predefined
or if it has one or more active macro definitions (<a href='cpp.import' title='15.5&emsp;Header unit importation'>[cpp.<span class='shy'></span>import]</a>),
for example because
it has been the subject of a
<span class='texttt'><span class='preprocessordirective'>#define</span></span>
preprocessing directive
without an intervening
<span class='texttt'><span class='preprocessordirective'>#undef</span></span>
directive with the same subject identifier), <span class='texttt'><span class='literal'>0</span></span> if it is not<a class='hidden_link' href='#2.sentence-1'>.</a></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/preprocessor.tex#L336'>#</a></div><div id='3.sentence-1' class='sentence'>The second form of <a href='#nt:has-include-expression' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='ntref:has-include-expression_'><span class='textsf'><span class='textit'>has-include-expression</span></span></span></a>
is considered only if the first form does not match,
in which case the preprocessing tokens are processed just as in normal text<a class='hidden_link' href='#3.sentence-1'>.</a></div></div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/preprocessor.tex#L341'>#</a></div><div id='4.sentence-1' class='sentence'>The header or source file identified by
the parenthesized preprocessing token sequence
in each contained <a href='#nt:has-include-expression' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='ntref:has-include-expression__'><span class='textsf'><span class='textit'>has-include-expression</span></span></span></a>
is searched for as if that preprocessing token sequence
were the <a href='cpp.pre#nt:pp-tokens' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:pp-tokens_'><span class='textsf'><span class='textit'>pp-tokens</span></span></span></a> in a <span class='texttt'><span class='preprocessordirective'>#include</span></span> directive,
except that no further macro expansion is performed<a class='hidden_link' href='#4.sentence-1'>.</a></div> <div id='4.sentence-2' class='sentence'>If such a directive would not satisfy the syntactic requirements
of a <span class='texttt'><span class='preprocessordirective'>#include</span></span> directive, the program is ill-formed<a class='hidden_link' href='#4.sentence-2'>.</a></div> <div id='4.sentence-3' class='sentence'>The <a href='#nt:has-include-expression' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='ntref:has-include-expression___'><span class='textsf'><span class='textit'>has-include-expression</span></span></span></a> evaluates
to <span class='texttt'><span class='literal'>1</span></span> if the search for the source file succeeds, and
to <span class='texttt'><span class='literal'>0</span></span> if the search fails<a class='hidden_link' href='#4.sentence-3'>.</a></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/preprocessor.tex#L354'>#</a></div><div id='5.sentence-1' class='sentence'>Each <a href='#nt:has-attribute-expression' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='ntref:has-attribute-expression_'><span class='textsf'><span class='textit'>has-attribute-expression</span></span></span></a> is replaced by
a non-zero <a href='lex.ppnumber#nt:pp-number' title='5.9&emsp;Preprocessing numbers&emsp;[lex.ppnumber]'><span id='ntref:pp-number'><span class='textsf'><span class='textit'>pp-number</span></span></span></a>
matching the form of an <a href='lex.icon#nt:integer-literal' title='5.13.2&emsp;Integer literals&emsp;[lex.icon]'><span id='ntref:integer-literal'><span class='textsf'><span class='textit'>integer-literal</span></span></span></a>
if the implementation supports an attribute
with the name specified by interpreting
the <a href='cpp.pre#nt:pp-tokens' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:pp-tokens__'><span class='textsf'><span class='textit'>pp-tokens</span></span></span></a>, after macro expansion,
as an <a href='dcl.attr.grammar#nt:attribute-token' title='9.12.1&emsp;Attribute syntax and semantics&emsp;[dcl.attr.grammar]'><span id='ntref:attribute-token'><span class='textsf'><span class='textit'>attribute-token</span></span></span></a>,
and by <span class='texttt'><span class='literal'>0</span></span> otherwise<a class='hidden_link' href='#5.sentence-1'>.</a></div> <div id='5.sentence-2' class='sentence'>The program is ill-formed if the <a href='cpp.pre#nt:pp-tokens' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:pp-tokens___'><span class='textsf'><span class='textit'>pp-tokens</span></span></span></a>
do not match the form of an <a href='dcl.attr.grammar#nt:attribute-token' title='9.12.1&emsp;Attribute syntax and semantics&emsp;[dcl.attr.grammar]'><span id='ntref:attribute-token_'><span class='textsf'><span class='textit'>attribute-token</span></span></span></a><a class='hidden_link' href='#5.sentence-2'>.</a></div></div><div class='para' id='6'><div class='marginalizedparent'><a class='marginalized' href='#6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/preprocessor.tex#L366'>#</a></div><div id='6.sentence-1' class='sentence'>For an attribute specified in this document,
the value of the <a href='#nt:has-attribute-expression' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='ntref:has-attribute-expression__'><span class='textsf'><span class='textit'>has-attribute-expression</span></span></span></a>
is given by Table <a href='#tab:cpp.cond.ha' title='Table 18: __has_&shy;cpp_&shy;attribute values &emsp;&ensp;[tab:cpp.cond.ha]'>18</a><a class='hidden_link' href='#6.sentence-1'>.</a></div> <div id='6.sentence-2' class='sentence'>For other attributes recognized by the implementation,
the value is
<span class='indexparent'><a class='index' id=':value_of_has-attribute-expression_for_non-standard_attributes'></a></span>implementation-defined<a class='hidden_link' href='#6.sentence-2'>.</a></div> <div id='6.note-1' class='note'>[<a class='note_link' href='#6.note-1'><span class='textit'>Note</span></a><span class='textit'>:</span> <div id='6.sentence-3' class='sentence'>It is expected
that the availability of an attribute can be detected by any non-zero result<a class='hidden_link' href='#6.sentence-3'>.</a></div> â€”&nbsp;<i>end note</i>]</div> <div class='numberedTable' id='tab:cpp.cond.ha'>Table <a href='#tab:cpp.cond.ha'>18</a>: <span class='texttt'><span class='preprocessordirective'>__has_&shy;cpp_&shy;attribute</span></span> values &emsp;&ensp;[tab:cpp.cond.ha]<br><table ><tr class='rowsep'><td class='center'><div id='6.sentence-4' class='sentence'><b>Attribute</b></div></td><td class='center'><div id='6.sentence-5' class='sentence'><b>Value</b></div></td></tr><tr class='rowsep'><td class='left'><div id='6.sentence-6' class='sentence'><span class='texttt'>carries_&shy;dependency</span></div></td><td class='left'><div id='6.sentence-7' class='sentence'><span class='texttt'><span class='literal'>200809L</span></span></div></td></tr><tr ><td class='left'><div id='6.sentence-8' class='sentence'><span class='texttt'>deprecated</span></div></td><td class='left'><div id='6.sentence-9' class='sentence'><span class='texttt'><span class='literal'>201309L</span></span></div></td></tr><tr ><td class='left'><div id='6.sentence-10' class='sentence'><span class='texttt'>fallthrough</span></div></td><td class='left'><div id='6.sentence-11' class='sentence'><span class='texttt'><span class='literal'>201603L</span></span></div></td></tr><tr ><td class='left'><div id='6.sentence-12' class='sentence'><span class='texttt'>likely</span></div></td><td class='left'><div id='6.sentence-13' class='sentence'><span class='texttt'><span class='literal'>201803L</span></span></div></td></tr><tr ><td class='left'><div id='6.sentence-14' class='sentence'><span class='texttt'>maybe_&shy;unused</span></div></td><td class='left'><div id='6.sentence-15' class='sentence'><span class='texttt'><span class='literal'>201603L</span></span></div></td></tr><tr ><td class='left'><div id='6.sentence-16' class='sentence'><span class='texttt'>no_&shy;unique_&shy;address</span></div></td><td class='left'><div id='6.sentence-17' class='sentence'><span class='texttt'><span class='literal'>201803L</span></span></div></td></tr><tr ><td class='left'><div id='6.sentence-18' class='sentence'><span class='texttt'>nodiscard</span></div></td><td class='left'><div id='6.sentence-19' class='sentence'><span class='texttt'><span class='literal'>201907L</span></span></div></td></tr><tr ><td class='left'><div id='6.sentence-20' class='sentence'><span class='texttt'>noreturn</span></div></td><td class='left'><div id='6.sentence-21' class='sentence'><span class='texttt'><span class='literal'>200809L</span></span></div></td></tr><tr ><td class='left'><div id='6.sentence-22' class='sentence'><span class='texttt'>unlikely</span></div></td><td class='left'><div id='6.sentence-23' class='sentence'><span class='texttt'><span class='literal'>201803L</span></span></div></td></tr></table></div></div><div class='para' id='7'><div class='marginalizedparent'><a class='marginalized' href='#7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/preprocessor.tex#L394'>#</a></div><div id='7.sentence-1' class='sentence'>The <span class='texttt'><span class='preprocessordirective'>#ifdef</span></span> and <span class='texttt'><span class='preprocessordirective'>#ifndef</span></span> directives, and
the <span class='texttt'><span class='preprocessordirective'>defined</span></span> conditional inclusion operator,
shall treat <span class='texttt'><span class='preprocessordirective'>__has_&shy;include</span></span> and <span class='texttt'><span class='preprocessordirective'>__has_&shy;cpp_&shy;attribute</span></span>
as if they were the names of defined macros<a class='hidden_link' href='#7.sentence-1'>.</a></div> <div id='7.sentence-2' class='sentence'>The identifiers <span class='texttt'><span class='preprocessordirective'>__has_&shy;include</span></span> and <span class='texttt'><span class='preprocessordirective'>__has_&shy;cpp_&shy;attribute</span></span>
shall not appear in any context not mentioned in this subclause<a class='hidden_link' href='#7.sentence-2'>.</a></div></div><div class='para' id='8'><div class='marginalizedparent'><a class='marginalized' href='#8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/preprocessor.tex#L402'>#</a></div><div id='8.sentence-1' class='sentence'>Each preprocessing token that remains (in the list of preprocessing tokens that
will become the controlling expression)
after all macro replacements have occurred
shall be in the lexical form of a <a href='lex.token' title='5.6&emsp;Tokens&emsp;[lex.token]'>token</a><a class='hidden_link' href='#8.sentence-1'>.</a></div></div><div class='para' id='9'><div class='marginalizedparent'><a class='marginalized' href='#9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/preprocessor.tex#L408'>#</a></div><div id='9.sentence-1' class='sentence'>Preprocessing directives of the forms
<div class='ncsimplebnf'><span class='indexparent'><a class='index' id=':#if'></a></span><span class='terminal'><span class='preprocessordirective'># if</span>     </span> <a href='expr.const#nt:constant-expression' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='ntref:constant-expression'><span class='textsf'><span class='textit'>constant-expression</span></span></span></a> <a href='cpp.pre#nt:new-line' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:new-line'><span class='textsf'><span class='textit'>new-line</span></span></span></a> <a href='cpp.pre#nt:group' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:group'><span class='textsf'><span class='textit'>group</span></span></span></a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span><br/><span class='indexparent'><a class='index' id=':#elif'></a></span><span class='terminal'><span class='preprocessordirective'># elif</span>   </span> <a href='expr.const#nt:constant-expression' title='7.7&emsp;Constant expressions&emsp;[expr.const]'><span id='ntref:constant-expression_'><span class='textsf'><span class='textit'>constant-expression</span></span></span></a> <a href='cpp.pre#nt:new-line' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:new-line_'><span class='textsf'><span class='textit'>new-line</span></span></span></a> <a href='cpp.pre#nt:group' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:group_'><span class='textsf'><span class='textit'>group</span></span></span></a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span>
</div>
check whether the controlling constant expression evaluates to nonzero<a class='hidden_link' href='#9.sentence-1'>.</a></div></div><div class='para' id='10'><div class='marginalizedparent'><a class='marginalized' href='#10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/preprocessor.tex#L418'>#</a></div><div id='10.sentence-1' class='sentence'>Prior to evaluation,
macro invocations in the list of preprocessing tokens
that will become the controlling constant expression
are replaced
(except for those macro names modified by the
<span class='texttt'><span class='preprocessordirective'>defined</span></span>
unary operator),
just as in normal text<a class='hidden_link' href='#10.sentence-1'>.</a></div> <div id='10.sentence-2' class='sentence'>If the token
<span class='texttt'><span class='preprocessordirective'>defined</span></span>
is generated as a result of this replacement process
or use of the
<span class='texttt'><span class='preprocessordirective'>defined</span></span>
unary operator does not match one of the two specified forms
prior to macro replacement,
the behavior is undefined<a class='hidden_link' href='#10.sentence-2'>.</a></div></div><div class='para' id='11'><div class='marginalizedparent'><a class='marginalized' href='#11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/preprocessor.tex#L436'>#</a></div><div id='11.sentence-1' class='sentence'>After all replacements due to macro expansion and
evaluations of
<a href='#nt:defined-macro-expression' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='ntref:defined-macro-expression__'><span class='textsf'><span class='textit'>defined-macro-expression</span></span></span></a>s,
<a href='#nt:has-include-expression' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='ntref:has-include-expression____'><span class='textsf'><span class='textit'>has-include-expression</span></span></span></a>s, and
<a href='#nt:has-attribute-expression' title='15.2&emsp;Conditional inclusion&emsp;[cpp.cond]'><span id='ntref:has-attribute-expression___'><span class='textsf'><span class='textit'>has-attribute-expression</span></span></span></a>s
have been performed,
all remaining identifiers and keywords,
except for
<span class='texttt'><span class='literal'>true</span></span>
and
<span class='texttt'><span class='literal'>false</span></span>,
are replaced with the <a href='lex.ppnumber#nt:pp-number' title='5.9&emsp;Preprocessing numbers&emsp;[lex.ppnumber]'><span id='ntref:pp-number_'><span class='textsf'><span class='textit'>pp-number</span></span></span></a>
<span class='texttt'><span class='literal'>0</span></span>,
and then each preprocessing token is converted into a token<a class='hidden_link' href='#11.sentence-1'>.</a></div> <div id='11.note-1' class='note'>[<a class='note_link' href='#11.note-1'><span class='textit'>Note</span></a><span class='textit'>:</span> <div id='11.sentence-2' class='sentence'>An <a href='lex.digraph' title='5.5&emsp;Alternative tokens&emsp;[lex.digraph]'>alternative
token</a> is not an identifier,
even when its spelling consists entirely of letters and underscores<a class='hidden_link' href='#11.sentence-2'>.</a></div> <div id='11.sentence-3' class='sentence'>Therefore it is not subject to this replacement<a class='hidden_link' href='#11.sentence-3'>.</a></div> â€”&nbsp;<i>end note</i>]</div> </div><div class='para' id='12'><div class='marginalizedparent'><a class='marginalized' href='#12'>12</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/preprocessor.tex#L458'>#</a></div><div id='12.sentence-1' class='sentence'>The resulting tokens comprise the controlling constant expression
which is evaluated according to the rules of <a href='expr.const' title='7.7&emsp;Constant expressions'>[expr.<span class='shy'></span>const]</a>
using arithmetic that has at least the ranges specified
in <a href='support.limits' title='17.3&emsp;Implementation properties'>[support.<span class='shy'></span>limits]</a><a class='hidden_link' href='#12.sentence-1'>.</a></div> <div id='12.sentence-2' class='sentence'>For the purposes of this token conversion and evaluation
all signed and unsigned integer types
act as if they have the same representation as, respectively,
<span class='texttt'>intmax_&shy;t</span> or <span class='texttt'>uintmax_&shy;t</span> (<a href='cstdint' title='17.4&emsp;Integer types'>[cstdint]</a>)<a class='hidden_link' href='#12.sentence-2'>.</a></div> <div id='12.note-1' class='note'>[<a class='note_link' href='#12.note-1'><span class='textit'>Note</span></a><span class='textit'>:</span> <div id='12.sentence-3' class='sentence'>Thus on an
implementation where <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>numeric_&shy;limits<span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='operator'>&#x200b;::&#x200b;</span>max<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>0x7FFF</span></span>
and <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>numeric_&shy;limits<span class='anglebracket'>&lt;</span><span class='keyword'>unsigned</span> <span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='operator'>&#x200b;::&#x200b;</span>max<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>0xFFFF</span></span>,
the integer literal <span class='texttt'><span class='literal'>0x8000</span></span> is signed and positive within a <span class='texttt'><span class='preprocessordirective'>#if</span></span>
expression even though it is unsigned in <a href='lex.phases' title='5.2&emsp;Phases of translation&emsp;[lex.phases]'>translation phase
7</a><a class='hidden_link' href='#12.sentence-3'>.</a></div> â€”&nbsp;<i>end note</i>]</div>  <div id='12.sentence-4' class='sentence'>
This includes interpreting <a href='lex.ccon#nt:character-literal' title='5.13.3&emsp;Character literals&emsp;[lex.ccon]'><span id='ntref:character-literal'><span class='textsf'><span class='textit'>character-literal</span></span></span></a>s, which may involve
converting escape sequences into execution character set members<a class='hidden_link' href='#12.sentence-4'>.</a></div> <div id='12.sentence-5' class='sentence'>Whether the numeric value for these <a href='lex.ccon#nt:character-literal' title='5.13.3&emsp;Character literals&emsp;[lex.ccon]'><span id='ntref:character-literal_'><span class='textsf'><span class='textit'>character-literal</span></span></span></a>s
matches the value obtained when an identical <a href='lex.ccon#nt:character-literal' title='5.13.3&emsp;Character literals&emsp;[lex.ccon]'><span id='ntref:character-literal__'><span class='textsf'><span class='textit'>character-literal</span></span></span></a>
occurs in an expression
(other than within a
<span class='texttt'><span class='preprocessordirective'>#if</span></span>
or
<span class='texttt'><span class='preprocessordirective'>#elif</span></span>
directive)
is <span class='indexparent'><a class='index' id=':numeric_values_of_character-literals_in_#if_directives'></a></span>implementation-defined<a class='hidden_link' href='#12.sentence-5'>.</a></div> <div id='12.note-2' class='note'>[<a class='note_link' href='#12.note-2'><span class='textit'>Note</span></a><span class='textit'>:</span> <div id='12.sentence-6' class='sentence'>Thus, the constant expression in the following
<span class='texttt'><span class='preprocessordirective'>#if</span></span>
directive and
<span class='texttt'><span class='keyword'>if</span></span> statement (<a href='stmt.if' title='8.5.1&emsp;The if statement'>[stmt.<span class='shy'></span>if]</a>)
is not guaranteed to evaluate to the same value in these two
contexts:
<pre class='codeblock'>
<span class='preprocessordirective'>#if</span> <span class='literal'>'z'</span> <span class='operator'>-</span> <span class='literal'>'a'</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>25</span>
<span class='keyword'>if</span> <span class='parenthesis'>(</span><span class='literal'>'z'</span> <span class='operator'>-</span> <span class='literal'>'a'</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>25</span><span class='parenthesis'>)</span>
</pre></div> â€”&nbsp;<i>end note</i>]</div>  <div id='12.sentence-7' class='sentence'>
Also, whether a single-character <a href='lex.ccon#nt:character-literal' title='5.13.3&emsp;Character literals&emsp;[lex.ccon]'><span id='ntref:character-literal___'><span class='textsf'><span class='textit'>character-literal</span></span></span></a> may have a negative
value is <span class='indexparent'><a class='index' id=':negative_value_of_character-literal_in_preprocessor'></a></span>implementation-defined<a class='hidden_link' href='#12.sentence-7'>.</a></div> <div id='12.sentence-8' class='sentence'>Each subexpression with type
<span class='texttt'><span class='keyword'>bool</span></span>
is subjected to integral promotion before processing continues<a class='hidden_link' href='#12.sentence-8'>.</a></div></div><div class='para' id='13'><div class='marginalizedparent'><a class='marginalized' href='#13'>13</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/preprocessor.tex#L504'>#</a></div><div id='13.sentence-1' class='sentence'>Preprocessing directives of the forms
<div class='ncsimplebnf'><span class='terminal'><span class='preprocessordirective'># ifdef</span>  </span> <a href='lex.name#nt:identifier' title='5.10&emsp;Identifiers&emsp;[lex.name]'><span id='ntref:identifier__'><span class='textsf'><span class='textit'>identifier</span></span></span></a> <a href='cpp.pre#nt:new-line' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:new-line__'><span class='textsf'><span class='textit'>new-line</span></span></span></a> <a href='cpp.pre#nt:group' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:group__'><span class='textsf'><span class='textit'>group</span></span></span></a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span><br/><span class='indexparent'><a class='index' id=':#ifdef'></a></span><span class='terminal'><span class='preprocessordirective'># ifndef</span> </span> <a href='lex.name#nt:identifier' title='5.10&emsp;Identifiers&emsp;[lex.name]'><span id='ntref:identifier___'><span class='textsf'><span class='textit'>identifier</span></span></span></a> <a href='cpp.pre#nt:new-line' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:new-line___'><span class='textsf'><span class='textit'>new-line</span></span></span></a> <a href='cpp.pre#nt:group' title='15.1&emsp;Preamble&emsp;[cpp.pre]'><span id='ntref:group___'><span class='textsf'><span class='textit'>group</span></span></span></a><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span>
<span class='indexparent'><a class='index' id=':#ifndef'></a></span></div>
check whether the identifier is or is not currently defined as a macro name<a class='hidden_link' href='#13.sentence-1'>.</a></div> <div id='13.sentence-2' class='sentence'>Their conditions are equivalent to
<span class='texttt'><span class='preprocessordirective'>#if</span></span>
<span class='texttt'><span class='preprocessordirective'>defined</span></span>
<a href='lex.name#nt:identifier' title='5.10&emsp;Identifiers&emsp;[lex.name]'><span id='ntref:identifier____'><span class='textsf'><span class='textit'>identifier</span></span></span></a>
and
<span class='texttt'><span class='preprocessordirective'>#if</span></span>
<span class='texttt'><span class='operator'>!</span><span class='preprocessordirective'>defined</span></span>
<a href='lex.name#nt:identifier' title='5.10&emsp;Identifiers&emsp;[lex.name]'><span id='ntref:identifier_____'><span class='textsf'><span class='textit'>identifier</span></span></span></a>
respectively<a class='hidden_link' href='#13.sentence-2'>.</a></div></div><div class='para' id='14'><div class='marginalizedparent'><a class='marginalized' href='#14'>14</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/preprocessor.tex#L523'>#</a></div><div id='14.sentence-1' class='sentence'>Each directive's condition is checked in order<a class='hidden_link' href='#14.sentence-1'>.</a></div> <div id='14.sentence-2' class='sentence'>If it evaluates to false (zero),
the group that it controls is skipped:
directives are processed only through the name that determines
the directive in order to keep track of the level
of nested conditionals;
the rest of the directives' preprocessing tokens are ignored,
as are the other preprocessing tokens in the group<a class='hidden_link' href='#14.sentence-2'>.</a></div> <div id='14.sentence-3' class='sentence'>Only the first group
whose control condition evaluates to true (nonzero) is processed;
any following groups are skipped and their controlling directives
are processed as if they were in a group that is skipped<a class='hidden_link' href='#14.sentence-3'>.</a></div> <div id='14.sentence-4' class='sentence'>If none of the conditions evaluates to true,
and there is a
<span class='texttt'><span class='preprocessordirective'>#else</span></span>
<span class='indexparent'><a class='index' id=':#else'></a></span>directive,
the group controlled by the
<span class='texttt'><span class='preprocessordirective'>#else</span></span>
is processed; lacking a
<span class='texttt'><span class='preprocessordirective'>#else</span></span>
directive, all the groups until the
<span class='texttt'><span class='preprocessordirective'>#endif</span></span>
<span class='indexparent'><a class='index' id=':#endif'></a></span>are skipped<a class='hidden_link' href='#14.sentence-4'>.</a><a class='footnotenum' href='#footnote-143' id='footnoteref-143' title='As indicated by the syntax, a preprocessing token shall not follow a #else or #endif directive before the terminating new-line character. However, comments may appear anywhere in a source file, including within a preprocessing directive.'>143</a></div></div><div class='para' id='15'><div class='marginalizedparent'><a class='marginalized' href='#15'>15</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/preprocessor.tex#L558'>#</a></div><div id='15.example-1' class='example'>[<a class='example_link' href='#15.example-1'><span class='textit'>Example</span></a><span class='textit'>:</span> <div id='15.sentence-1' class='sentence'>This demonstrates a way to include a library <span class='texttt'>optional</span> facility
only if it is available:
<pre class='codeblock'>
<span class='preprocessordirective'>#if</span> <span class='preprocessordirective'>__has_include</span><span class='parenthesis'>(</span><span class='anglebracket'>&lt;</span>optional<span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span>
<span class='preprocessordirective'>#  include</span> <span class='anglebracket'>&lt;</span>optional<span class='anglebracket'>&gt;</span>
<span class='preprocessordirective'>#  if</span> __cpp_lib_optional <span class='anglebracket'>&gt;</span><span class='operator'>=</span> <span class='literal'>201603</span>
<span class='preprocessordirective'>#    define</span> have_optional <span class='literal'>1</span>
<span class='preprocessordirective'>#  endif</span>
<span class='preprocessordirective'>#elif</span> <span class='preprocessordirective'>__has_include</span><span class='parenthesis'>(</span><span class='anglebracket'>&lt;</span>experimental<span class='operator'>/</span>optional<span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span>
<span class='preprocessordirective'>#  include</span> <span class='anglebracket'>&lt;</span>experimental<span class='operator'>/</span>optional<span class='anglebracket'>&gt;</span>
<span class='preprocessordirective'>#  if</span> __cpp_lib_experimental_optional <span class='anglebracket'>&gt;</span><span class='operator'>=</span> <span class='literal'>201411</span>
<span class='preprocessordirective'>#    define</span> have_optional <span class='literal'>1</span>
<span class='preprocessordirective'>#    define</span> experimental_optional <span class='literal'>1</span>
<span class='preprocessordirective'>#  endif</span>
<span class='preprocessordirective'>#endif</span>
<span class='preprocessordirective'>#ifndef</span> have_optional
<span class='preprocessordirective'>#  define</span> have_optional <span class='literal'>0</span>
<span class='preprocessordirective'>#endif</span>
</pre></div> â€”&nbsp;<i>end example</i>]</div> </div><div class='para' id='16'><div class='marginalizedparent'><a class='marginalized' href='#16'>16</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/0b54fd56b85dc886854b1297d620569582a82e63/source/preprocessor.tex#L581'>#</a></div><div id='16.example-1' class='example'>[<a class='example_link' href='#16.example-1'><span class='textit'>Example</span></a><span class='textit'>:</span> <div id='16.sentence-1' class='sentence'>This demonstrates a way to use the attribute <span class='texttt'><span class='squarebracket'>[</span><span class='squarebracket'>[</span>acme<span class='operator'>&#x200b;::&#x200b;</span>deprecated<span class='squarebracket'>]</span><span class='squarebracket'>]</span></span>
only if it is available<a class='hidden_link' href='#16.sentence-1'>.</a></div> <pre class='codeblock'>
<span class='preprocessordirective'>#if</span> <span class='preprocessordirective'>__has_cpp_attribute</span><span class='parenthesis'>(</span>acme<span class='operator'>::</span>deprecated<span class='parenthesis'>)</span>
<span class='preprocessordirective'>#  define</span> ATTR_DEPRECATED<span class='parenthesis'>(</span>msg<span class='parenthesis'>)</span> <span class='squarebracket'>[</span><span class='squarebracket'>[</span>acme<span class='operator'>::</span>deprecated<span class='parenthesis'>(</span>msg<span class='parenthesis'>)</span><span class='squarebracket'>]</span><span class='squarebracket'>]</span>
<span class='preprocessordirective'>#else</span>
<span class='preprocessordirective'>#  define</span> ATTR_DEPRECATED<span class='parenthesis'>(</span>msg<span class='parenthesis'>)</span> <span class='squarebracket'>[</span><span class='squarebracket'>[</span>deprecated<span class='parenthesis'>(</span>msg<span class='parenthesis'>)</span><span class='squarebracket'>]</span><span class='squarebracket'>]</span>
<span class='preprocessordirective'>#endif</span>
ATTR_DEPRECATED<span class='parenthesis'>(</span><span class='literal'>"This function is deprecated"</span><span class='parenthesis'>)</span> <span class='keyword'>void</span> anvil<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</pre> â€”&nbsp;<i>end example</i>]</div> </div><div class='footnote' id='footnote-142'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-142'>142)</a></div><div id='footnote-142.sentence-1' class='sentence'>Because the controlling constant expression is evaluated
during translation phase 4,
all identifiers either are or are not macro names â€”
there simply are no keywords, enumeration constants, etc<a class='hidden_link' href='#footnote-142.sentence-1'>.</a></div> <a href='#footnoteref-142'>â®¥</a></div><div class='footnote' id='footnote-143'><div class='footnoteNumberParent'><a class='marginalized' href='#footnote-143'>143)</a></div><div id='footnote-143.sentence-1' class='sentence'>As indicated by the syntax,
a preprocessing token shall not follow a
<span class='texttt'><span class='preprocessordirective'>#else</span></span>
or
<span class='texttt'><span class='preprocessordirective'>#endif</span></span>
directive before the terminating new-line character<a class='hidden_link' href='#footnote-143.sentence-1'>.</a></div> <div id='footnote-143.sentence-2' class='sentence'>However,
comments may appear anywhere in a source file,
including within a preprocessing directive<a class='hidden_link' href='#footnote-143.sentence-2'>.</a></div> <a href='#footnoteref-143'>â®¥</a></div></div></body></html>