<!DOCTYPE html><html lang='en'><head><title>[thread]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Normal'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='alternate stylesheet' type='text/css' href='normative-only.css' title='Notes and examples hidden'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:50pt'>32</a> Thread support library <a class='abbr_ref' href='./#thread'>[thread]</a></h1><div id='general' class='section'><h2 ><a class='secnum' href='#general' style='min-width:65pt'>32.1</a> General <a class='abbr_ref' href='thread.general'>[thread.general]</a></h2><div class='para' id='general-1'><div class='marginalizedparent'><a class='marginalized' href='#general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6'>#</a></div><div class='texpara'><div id='general-1.sentence-1' class='sentence'>The following subclauses describe components to create and manage
<a href='intro.multithread#def:thread' title='6.9.2&emsp;Multi-threaded executions and data races&emsp;[intro.multithread]'>threads</a>, perform mutual exclusion, and communicate conditions
and values
between threads, as summarized in Table <a href='#tab:thread.summary' title='Table 148: Thread support library summary'>148</a><a class='hidden_link' href='#general-1.sentence-1'>.</a></div></div><div class='texpara'><div class='numberedTable' id='tab:thread.summary'>Table <a href='#tab:thread.summary'>148</a>: Thread support library summary&emsp;<a href='./tab:thread.summary'>[tab:thread.summary]</a><br><table ><tr id='tab:thread.summary-row-1' class='rowsep'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:thread.summary-row-1'>🔗</a></div></td><td class='empty left'></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-1-column-2-sentence-1' class='sentence'><b>Subclause</b></div></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-1-column-3-sentence-1' class='sentence'><b>Header</b></div></div></td></tr><tr id='tab:thread.summary-row-2' class='capsep'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:thread.summary-row-2'>🔗</a></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-2-column-1-sentence-1' class='sentence'><a href='#req' title='32.2&emsp;Requirements'>[thread.<span class='shy'></span>req]</a></div></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-2-column-2-sentence-1' class='sentence'>Requirements</div></div></td><td class='empty left'></td></tr><tr id='tab:thread.summary-row-3' class='rowsep'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:thread.summary-row-3'>🔗</a></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-3-column-1-sentence-1' class='sentence'><a href='#stoptoken' title='32.3&emsp;Stop tokens'>[thread.<span class='shy'></span>stoptoken]</a></div></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-3-column-2-sentence-1' class='sentence'>Stop tokens</div></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-3-column-3-sentence-1' class='sentence'><span class='texttt'><span class='anglebracket'>&lt;</span>stop_&shy;token<span class='anglebracket'>&gt;</span></span></div></div></td></tr><tr id='tab:thread.summary-row-4' class='rowsep'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:thread.summary-row-4'>🔗</a></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-4-column-1-sentence-1' class='sentence'><a href='#threads' title='32.4&emsp;Threads'>[thread.<span class='shy'></span>threads]</a></div></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-4-column-2-sentence-1' class='sentence'>Threads</div></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-4-column-3-sentence-1' class='sentence'><span class='texttt'><span class='anglebracket'>&lt;</span>thread<span class='anglebracket'>&gt;</span></span></div></div></td></tr><tr id='tab:thread.summary-row-5' class='rowsep'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:thread.summary-row-5'>🔗</a></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-5-column-1-sentence-1' class='sentence'><a href='#mutex' title='32.5&emsp;Mutual exclusion'>[thread.<span class='shy'></span>mutex]</a></div></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-5-column-2-sentence-1' class='sentence'>Mutual exclusion</div></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-5-column-3-sentence-1' class='sentence'><span class='texttt'><span class='anglebracket'>&lt;</span>mutex<span class='anglebracket'>&gt;</span></span>, <span class='texttt'><span class='anglebracket'>&lt;</span>shared_&shy;mutex<span class='anglebracket'>&gt;</span></span></div></div></td></tr><tr id='tab:thread.summary-row-6' class='rowsep'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:thread.summary-row-6'>🔗</a></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-6-column-1-sentence-1' class='sentence'><a href='#condition' title='32.6&emsp;Condition variables'>[thread.<span class='shy'></span>condition]</a></div></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-6-column-2-sentence-1' class='sentence'>Condition variables</div></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-6-column-3-sentence-1' class='sentence'><span class='texttt'><span class='anglebracket'>&lt;</span>condition_&shy;variable<span class='anglebracket'>&gt;</span></span></div></div></td></tr><tr id='tab:thread.summary-row-7' class='rowsep'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:thread.summary-row-7'>🔗</a></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-7-column-1-sentence-1' class='sentence'><a href='#sema' title='32.7&emsp;Semaphore'>[thread.<span class='shy'></span>sema]</a></div></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-7-column-2-sentence-1' class='sentence'>Semaphores</div></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-7-column-3-sentence-1' class='sentence'><span class='texttt'><span class='anglebracket'>&lt;</span>semaphore<span class='anglebracket'>&gt;</span></span></div></div></td></tr><tr id='tab:thread.summary-row-8' class='rowsep'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:thread.summary-row-8'>🔗</a></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-8-column-1-sentence-1' class='sentence'><a href='#coord' title='32.8&emsp;Coordination types'>[thread.<span class='shy'></span>coord]</a></div></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-8-column-2-sentence-1' class='sentence'>Coordination types</div></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-8-column-3-sentence-1' class='sentence'><span class='texttt'><span class='anglebracket'>&lt;</span>latch<span class='anglebracket'>&gt;</span></span> <span class='texttt'><span class='anglebracket'>&lt;</span>barrier<span class='anglebracket'>&gt;</span></span></div></div></td></tr><tr id='tab:thread.summary-row-9' class='rowsep'><td class='hidden'><div class='marginalizedparent'><a class='itemDeclLink' href='#tab:thread.summary-row-9'>🔗</a></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-9-column-1-sentence-1' class='sentence'><a href='#futures' title='32.9&emsp;Futures'>[futures]</a></div></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-9-column-2-sentence-1' class='sentence'>Futures</div></div></td><td class='left'><div class='texpara'><div id='tab:thread.summary-row-9-column-3-sentence-1' class='sentence'><span class='texttt'><span class='anglebracket'>&lt;</span>future<span class='anglebracket'>&gt;</span></span></div></div></td></tr></table></div></div></div></div><div id='req' class='section'><h2 ><a class='secnum' href='#req' style='min-width:65pt'>32.2</a> Requirements <a class='abbr_ref' href='thread.req'>[thread.req]</a></h2><div id='req.paramname' class='section'><h3 ><a class='secnum' href='#req.paramname' style='min-width:80pt'>32.2.1</a> Template parameter names <a class='abbr_ref' href='thread.req.paramname'>[thread.req.paramname]</a></h3><div class='para' id='req.paramname-1'><div class='marginalizedparent'><a class='marginalized' href='#req.paramname-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L28'>#</a></div><div class='texpara'><div id='req.paramname-1.sentence-1' class='sentence'>Throughout this Clause, the names of template parameters are used to express type
requirements<a class='hidden_link' href='#req.paramname-1.sentence-1'>.</a></div> <div id='req.paramname-1.sentence-2' class='sentence'>If a template parameter is named <span class='texttt'>Predicate</span>, <span class='texttt'><span class='keyword'>operator</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> applied to
the template argument shall return a value that is convertible to <span class='texttt'><span class='keyword'>bool</span></span><a class='hidden_link' href='#req.paramname-1.sentence-2'>.</a></div> <div id='req.paramname-1.sentence-3' class='sentence'>If a template parameter is named <span class='texttt'>Clock</span>,
the corresponding template argument shall be a type <span class='texttt'>C</span>
for which <span class='texttt'>is_&shy;clock_&shy;v<span class='anglebracket'>&lt;</span>C<span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>true</span></span>;
otherwise the program is ill-formed<a class='hidden_link' href='#req.paramname-1.sentence-3'>.</a></div></div></div></div><div id='req.exception' class='section'><h3 ><a class='secnum' href='#req.exception' style='min-width:80pt'>32.2.2</a> Exceptions <a class='abbr_ref' href='thread.req.exception'>[thread.req.exception]</a></h3><div class='para' id='req.exception-1'><div class='marginalizedparent'><a class='marginalized' href='#req.exception-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L40'>#</a></div><div class='texpara'><div id='req.exception-1.sentence-1' class='sentence'>Some functions described in this Clause are specified to throw exceptions of type
<span class='texttt'>system_&shy;error</span> (<a href='syserr.syserr' title='19.5.8&emsp;Class system_&shy;error'>[syserr.<span class='shy'></span>syserr]</a>)<a class='hidden_link' href='#req.exception-1.sentence-1'>.</a></div> <div id='req.exception-1.sentence-2' class='sentence'>Such exceptions are thrown if
any of the function's error conditions is detected or
a call to
an operating system or other underlying API results in an error that prevents the
library function from
meeting its specifications<a class='hidden_link' href='#req.exception-1.sentence-2'>.</a></div> <div id='req.exception-1.sentence-3' class='sentence'>Failure to allocate storage is reported as described
in <a href='res.on.exception.handling' title='16.4.6.13&emsp;Restrictions on exception handling'>[res.<span class='shy'></span>on.<span class='shy'></span>exception.<span class='shy'></span>handling]</a><a class='hidden_link' href='#req.exception-1.sentence-3'>.</a></div></div><div class='texpara'><div id='req.exception-example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#req.exception-example-1'>1</a></i>: <div id='req.exception-1.sentence-4' class='sentence'>Consider a function in this Clause that is specified to throw exceptions of type
<span class='texttt'>system_&shy;error</span> and specifies error conditions that include
<span class='texttt'>operation_&shy;not_&shy;permitted</span> for a thread that does not have the privilege to
perform the operation<a class='hidden_link' href='#req.exception-1.sentence-4'>.</a></div> <div id='req.exception-1.sentence-5' class='sentence'>Assume that, during the execution of this function, an <span class='texttt'>errno</span>
of <span class='texttt'>EPERM</span> is reported by a POSIX API call used by the implementation<a class='hidden_link' href='#req.exception-1.sentence-5'>.</a></div> <div id='req.exception-1.sentence-6' class='sentence'>Since POSIX
specifies an <span class='texttt'>errno</span> of <span class='texttt'>EPERM</span> when “the caller does not have the privilege
to perform the operation”, the implementation maps <span class='texttt'>EPERM</span> to an
<span class='texttt'>error_&shy;condition</span> of <span class='texttt'>operation_&shy;not_&shy;permitted</span> (<a href='syserr' title='19.5&emsp;System error support'>[syserr]</a>) and an exception
of type <span class='texttt'>system_&shy;error</span> is thrown<a class='hidden_link' href='#req.exception-1.sentence-6'>.</a></div> —&nbsp;<i>end example</i>]</div></div></div></div><div class='para' id='req.exception-2'><div class='marginalizedparent'><a class='marginalized' href='#req.exception-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L62'>#</a></div><div class='texpara'><div id='req.exception-2.sentence-1' class='sentence'>The <span class='texttt'>error_&shy;code</span> reported by such an exception's <span class='texttt'>code<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> member function
compares equal to one of the conditions specified in the function's error condition
element<a class='hidden_link' href='#req.exception-2.sentence-1'>.</a></div></div></div></div><div id='req.native' class='section'><h3 ><a class='secnum' href='#req.native' style='min-width:80pt'>32.2.3</a> Native handles <a class='abbr_ref' href='thread.req.native'>[thread.req.native]</a></h3><div class='para' id='req.native-1'><div class='marginalizedparent'><a class='marginalized' href='#req.native-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L69'>#</a></div><div class='texpara'><div id='req.native-1.sentence-1' class='sentence'>Several classes described in this Clause have members <span class='texttt'>native_&shy;handle_&shy;type</span> and
<span class='texttt'>native_&shy;handle</span><a class='hidden_link' href='#req.native-1.sentence-1'>.</a></div> <div id='req.native-1.sentence-2' class='sentence'>The presence of these members and their semantics is
<a class='index' id=':presence_and_meaning_of_native_handle_type_and_native_handle'></a>implementation-defined<a class='hidden_link' href='#req.native-1.sentence-2'>.</a></div> <div id='req.native-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#req.native-note-1'>1</a></i>: <div id='req.native-1.sentence-3' class='sentence'>These members allow implementations to provide access
to implementation details<a class='hidden_link' href='#req.native-1.sentence-3'>.</a></div> <div id='req.native-1.sentence-4' class='sentence'>Their names are specified to facilitate portable compile-time
detection<a class='hidden_link' href='#req.native-1.sentence-4'>.</a></div> <div id='req.native-1.sentence-5' class='sentence'>Actual use of these members is inherently non-portable<a class='hidden_link' href='#req.native-1.sentence-5'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div id='req.timing' class='section'><h3 ><a class='secnum' href='#req.timing' style='min-width:80pt'>32.2.4</a> Timing specifications <a class='abbr_ref' href='thread.req.timing'>[thread.req.timing]</a></h3><div class='para' id='req.timing-1'><div class='marginalizedparent'><a class='marginalized' href='#req.timing-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L81'>#</a></div><div class='texpara'><div id='req.timing-1.sentence-1' class='sentence'>Several functions described in this Clause take an argument to specify a timeout<a class='hidden_link' href='#req.timing-1.sentence-1'>.</a></div> <div id='req.timing-1.sentence-2' class='sentence'>These
timeouts are specified as either a <span class='texttt'>duration</span> or a <span class='texttt'>time_&shy;point</span> type as
specified in <a href='time' title='27&emsp;Time library'>[time]</a><a class='hidden_link' href='#req.timing-1.sentence-2'>.</a></div></div></div><div class='para' id='req.timing-2'><div class='marginalizedparent'><a class='marginalized' href='#req.timing-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L86'>#</a></div><div class='texpara'><div id='req.timing-2.sentence-1' class='sentence'>Implementations necessarily have some delay in returning from a timeout<a class='hidden_link' href='#req.timing-2.sentence-1'>.</a></div> <div id='req.timing-2.sentence-2' class='sentence'>Any overhead in
interrupt response, function return, and scheduling induces a “quality of implementation”
delay, expressed as duration <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span></span></span></span><a class='hidden_link' href='#req.timing-2.sentence-2'>.</a></div> <div id='req.timing-2.sentence-3' class='sentence'>Ideally, this delay would be zero<a class='hidden_link' href='#req.timing-2.sentence-3'>.</a></div> <div id='req.timing-2.sentence-4' class='sentence'>Further, any contention for
processor and memory resources induces a “quality of management” delay, expressed as duration
<span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">m</span></span></span></span></span></span></span><a class='hidden_link' href='#req.timing-2.sentence-4'>.</a></div> <div id='req.timing-2.sentence-5' class='sentence'>The delay durations may vary from timeout to timeout, but in all cases shorter is better<a class='hidden_link' href='#req.timing-2.sentence-5'>.</a></div></div></div><div class='para' id='req.timing-3'><div class='marginalizedparent'><a class='marginalized' href='#req.timing-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L93'>#</a></div><div class='texpara'><div id='req.timing-3.sentence-1' class='sentence'>The functions whose names end in <span class='texttt'>_&shy;for</span> take an argument that
specifies a duration<a class='hidden_link' href='#req.timing-3.sentence-1'>.</a></div> <div id='req.timing-3.sentence-2' class='sentence'>These functions produce relative timeouts<a class='hidden_link' href='#req.timing-3.sentence-2'>.</a></div> <div id='req.timing-3.sentence-3' class='sentence'>Implementations
should use a steady clock to measure time for these functions<a class='hidden_link' href='#req.timing-3.sentence-3'>.</a><a class='footnoteref' href='#footnote-319' id='footnoteref-319' title='Implementations for which standard time units are meaningful will typically have a steady clock within their hardware implementation.'>319</a></div> <div id='req.timing-3.sentence-4' class='sentence'>
Given a duration
argument <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span>, the real-time duration of the timeout is <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">m</span></span></span></span></span></span></span><a class='hidden_link' href='#req.timing-3.sentence-4'>.</a></div></div></div><div class='para' id='req.timing-4'><div class='marginalizedparent'><a class='marginalized' href='#req.timing-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L104'>#</a></div><div class='texpara'><div id='req.timing-4.sentence-1' class='sentence'>The functions whose names end in <span class='texttt'>_&shy;until</span> take an argument that specifies a time
point<a class='hidden_link' href='#req.timing-4.sentence-1'>.</a></div> <div id='req.timing-4.sentence-2' class='sentence'>These functions produce absolute timeouts<a class='hidden_link' href='#req.timing-4.sentence-2'>.</a></div> <div id='req.timing-4.sentence-3' class='sentence'>Implementations should use the clock
specified in the time point to measure time for these functions<a class='hidden_link' href='#req.timing-4.sentence-3'>.</a></div> <div id='req.timing-4.sentence-4' class='sentence'>Given a clock time point
argument <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span>, the clock time point of the return from timeout should be <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">m</span></span></span></span></span></span></span>
when the clock is not adjusted during the timeout<a class='hidden_link' href='#req.timing-4.sentence-4'>.</a></div> <div id='req.timing-4.sentence-5' class='sentence'>If the clock is adjusted to the time <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span></span></span></span>
during the timeout, the behavior should be as follows:
<ul class='itemize'><li id='req.timing-4.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#req.timing-4.1'>(4.1)</a></div><div class='texpara'><div id='req.timing-4.1.sentence-1' class='sentence'>If <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.225em; padding-bottom: 0.372em;">&gt;</span></span><span class="mjx-msubsup MJXc-space3"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span>, the waiting function should wake as soon as possible, i.e., <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">m</span></span></span></span></span></span></span>,
since the timeout is already satisfied<a class='hidden_link' href='#req.timing-4.1.sentence-1'>.</a></div> <div id='req.timing-4.1.sentence-2' class='sentence'>This specification may result in the total
duration of the wait decreasing when measured against a steady clock<a class='hidden_link' href='#req.timing-4.1.sentence-2'>.</a></div></div></li><li id='req.timing-4.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#req.timing-4.2'>(4.2)</a></div><div class='texpara'><div id='req.timing-4.2.sentence-1' class='sentence'>If <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">a</span></span></span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.446em;">≤</span></span><span class="mjx-texatom MJXc-space3"><span class="mjx-mrow"></span></span><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span>, the waiting function should not time out until <span class='texttt'>Clock<span class='operator'>&#x200b;::&#x200b;</span>now<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns a
time <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">n</span></span></span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.446em;">≥</span></span><span class="mjx-texatom MJXc-space3"><span class="mjx-mrow"></span></span><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span>, i.e., waking at <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">i</span></span></span></span><span class="mjx-mo MJXc-space2"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.298em; padding-bottom: 0.446em;">+</span></span><span class="mjx-msubsup MJXc-space2"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em;">D</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">m</span></span></span></span></span></span></span><a class='hidden_link' href='#req.timing-4.2.sentence-1'>.</a></div> <div id='req.timing-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#req.timing-note-1'>1</a></i>: <div id='req.timing-4.2.sentence-2' class='sentence'>When the clock is adjusted
backwards, this specification can result in the total duration of the wait increasing when
measured against a steady clock<a class='hidden_link' href='#req.timing-4.2.sentence-2'>.</a></div> <div id='req.timing-4.2.sentence-3' class='sentence'>When the clock is adjusted forwards, this specification can
result in the total duration of the wait decreasing when measured against a steady clock<a class='hidden_link' href='#req.timing-4.2.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></li></ul></div></div><div class='texpara'><div id='req.timing-4.sentence-6' class='sentence'>An implementation returns from such a timeout at any point from the time specified above to
the time it would return from a steady-clock relative timeout on the difference between <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base" style="margin-right: -0.045em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.519em; padding-bottom: 0.298em; padding-right: 0.045em;">C</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span>
and the time point of the call to the <span class='texttt'>_&shy;until</span> function<a class='hidden_link' href='#req.timing-4.sentence-6'>.</a></div></div><div class='texpara'><div id='req.timing-4.sentence-7' class='sentence'><i >Recommended practice</i>: Implementations
should decrease the duration of the wait when the clock is adjusted forwards<a class='hidden_link' href='#req.timing-4.sentence-7'>.</a></div></div></div><div class='para nonNormativeOnly' id='req.timing-5'><div class='marginalizedparent'><a class='marginalized' href='#req.timing-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L137'>#</a></div><div class='texpara'><div id='req.timing-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#req.timing-note-2'>2</a></i>: <div id='req.timing-5.sentence-1' class='sentence'>If the clock is not synchronized with a steady clock, e.g., a CPU time clock, these
timeouts can fail to provide useful functionality<a class='hidden_link' href='#req.timing-5.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='req.timing-6'><div class='marginalizedparent'><a class='marginalized' href='#req.timing-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L143'>#</a></div><div class='texpara'><div id='req.timing-6.sentence-1' class='sentence'>The resolution of timing provided by an implementation depends on both operating system
and hardware<a class='hidden_link' href='#req.timing-6.sentence-1'>.</a></div> <div id='req.timing-6.sentence-2' class='sentence'>The finest resolution provided by an implementation is called the
<a class='hidden_link' href='#def:native_resolution' id='def:native_resolution'><i>native resolution</i></a><a class='hidden_link' href='#req.timing-6.sentence-2'>.</a></div></div></div><div class='para' id='req.timing-7'><div class='marginalizedparent'><a class='marginalized' href='#req.timing-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L148'>#</a></div><div class='texpara'><div id='req.timing-7.sentence-1' class='sentence'>Implementation-provided clocks that are used for these functions meet the
<i >Cpp17TrivialClock</i> requirements (<a href='time.clock.req' title='27.3&emsp;Cpp17Clock requirements'>[time.<span class='shy'></span>clock.<span class='shy'></span>req]</a>)<a class='hidden_link' href='#req.timing-7.sentence-1'>.</a></div></div></div><div class='para' id='req.timing-8'><div class='marginalizedparent'><a class='marginalized' href='#req.timing-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L152'>#</a></div><div class='texpara'><div id='req.timing-8.sentence-1' class='sentence'>A function that takes an argument which specifies a timeout will throw if,
during its execution, a clock, time point, or time duration throws an exception<a class='hidden_link' href='#req.timing-8.sentence-1'>.</a></div> <div id='req.timing-8.sentence-2' class='sentence'>Such exceptions are referred to as <a class='hidden_link' href='#def:timeout-related_exceptions' id='def:timeout-related_exceptions'><i>timeout-related exceptions</i></a><a class='hidden_link' href='#req.timing-8.sentence-2'>.</a></div> <div id='req.timing-note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#req.timing-note-3'>3</a></i>: <div id='req.timing-8.sentence-3' class='sentence'>Instantiations of clock, time point and duration types supplied by
the implementation as specified in <a href='time.clock' title='27.7&emsp;Clocks'>[time.<span class='shy'></span>clock]</a> do not throw exceptions<a class='hidden_link' href='#req.timing-8.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='footnoteSeparator'></div><div class='footnote' id='footnote-319'><div class='texpara'><a class='footnotenum' href='#footnote-319'>319)</a><a class='footnoteBacklink' href='#footnoteref-319'>319)</a> <div id='footnote-319.sentence-1' class='sentence'>Implementations for which standard time units are meaningful will typically
have a steady clock within their hardware implementation<a class='hidden_link' href='#footnote-319.sentence-1'>.</a></div></div></div></div><div id='req.lockable' class='section'><h3 ><a class='secnum' href='#req.lockable' style='min-width:80pt'>32.2.5</a> Requirements for <i >Cpp17Lockable</i> types <a class='abbr_ref' href='thread.req.lockable'>[thread.req.lockable]</a></h3><div id='req.lockable.general' class='section'><h4 ><a class='secnum' href='#req.lockable.general' style='min-width:95pt'>32.2.5.1</a> In general <a class='abbr_ref' href='thread.req.lockable.general'>[thread.req.lockable.general]</a></h4><div class='para' id='req.lockable.general-1'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L165'>#</a></div><div class='texpara'><div id='req.lockable.general-1.sentence-1' class='sentence'>An <a class='hidden_link' href='#def:execution_agent' title='32.2.5.1&emsp;In general&emsp;[thread.req.lockable.general]'><span id='def:execution_agent'><i >execution agent</i></span></a> is an entity such as a thread that may perform work in parallel with
other execution agents<a class='hidden_link' href='#req.lockable.general-1.sentence-1'>.</a></div> <div id='req.lockable.general-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#req.lockable.general-note-1'>1</a></i>: <div id='req.lockable.general-1.sentence-2' class='sentence'>Implementations or users can introduce other kinds of
agents such as processes or thread-pool tasks<a class='hidden_link' href='#req.lockable.general-1.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='req.lockable.general-1.sentence-3' class='sentence'>
The calling agent is determined by
context, e.g., the calling thread that contains the call, and so on<a class='hidden_link' href='#req.lockable.general-1.sentence-3'>.</a></div></div></div><div class='para nonNormativeOnly' id='req.lockable.general-2'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.general-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L175'>#</a></div><div class='texpara'><div id='req.lockable.general-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#req.lockable.general-note-2'>2</a></i>: <div id='req.lockable.general-2.sentence-1' class='sentence'>Some lockable objects are “agent oblivious” in that they work for any
execution agent model because they do not determine or store the agent's ID (e.g., an
ordinary spin lock)<a class='hidden_link' href='#req.lockable.general-2.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='req.lockable.general-3'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.general-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L182'>#</a></div><div class='texpara'><div id='req.lockable.general-3.sentence-1' class='sentence'>The standard library templates <span class='texttt'>unique_&shy;lock</span> (<a href='#lock.unique' title='32.5.5.4&emsp;Class template unique_&shy;lock'>[thread.<span class='shy'></span>lock.<span class='shy'></span>unique]</a>),
<span class='texttt'>shared_&shy;lock</span> (<a href='#lock.shared' title='32.5.5.5&emsp;Class template shared_&shy;lock'>[thread.<span class='shy'></span>lock.<span class='shy'></span>shared]</a>),
<span class='texttt'>scoped_&shy;lock</span> (<a href='#lock.scoped' title='32.5.5.3&emsp;Class template scoped_&shy;lock'>[thread.<span class='shy'></span>lock.<span class='shy'></span>scoped]</a>),
<span class='texttt'>lock_&shy;guard</span> (<a href='#lock.guard' title='32.5.5.2&emsp;Class template lock_&shy;guard'>[thread.<span class='shy'></span>lock.<span class='shy'></span>guard]</a>), <span class='texttt'>lock</span>,
<span class='texttt'>try_&shy;lock</span> (<a href='#lock.algorithm' title='32.5.6&emsp;Generic locking algorithms'>[thread.<span class='shy'></span>lock.<span class='shy'></span>algorithm]</a>), and
<span class='texttt'>condition_&shy;variable_&shy;any</span> (<a href='#condition.condvarany' title='32.6.5&emsp;Class condition_&shy;variable_&shy;any'>[thread.<span class='shy'></span>condition.<span class='shy'></span>condvarany]</a>) all operate on user-supplied
lockable objects<a class='hidden_link' href='#req.lockable.general-3.sentence-1'>.</a></div> <div id='req.lockable.general-3.sentence-2' class='sentence'>The <i >Cpp17BasicLockable</i> requirements, the <i >Cpp17Lockable</i> requirements,
and the <i >Cpp17TimedLockable</i> requirements list the requirements imposed by these library types
in order to acquire or release ownership of a <span class='texttt'>lock</span> by a given execution agent<a class='hidden_link' href='#req.lockable.general-3.sentence-2'>.</a></div> <div id='req.lockable.general-note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#req.lockable.general-note-3'>3</a></i>: <div id='req.lockable.general-3.sentence-3' class='sentence'>The nature of any lock ownership and any synchronization it entails are not part
of these requirements<a class='hidden_link' href='#req.lockable.general-3.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div id='req.lockable.basic' class='section'><h4 ><a class='secnum' href='#req.lockable.basic' style='min-width:95pt'>32.2.5.2</a> <i >Cpp17BasicLockable</i> requirements <a class='abbr_ref' href='thread.req.lockable.basic'>[thread.req.lockable.basic]</a></h4><div class='para' id='req.lockable.basic-1'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.basic-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L199'>#</a></div><div class='texpara'><div id='req.lockable.basic-1.sentence-1' class='sentence'>A type <span class='texttt'>L</span> meets the <i >Cpp17BasicLockable</i> requirements if the following expressions are
well-formed and have the specified semantics (<span class='texttt'>m</span> denotes a value of type <span class='texttt'>L</span>)<a class='hidden_link' href='#req.lockable.basic-1.sentence-1'>.</a></div></div></div><div class='texpara'><div class='itemdecl' id='req.lockable.basic-itemdecl:1'><div class='marginalizedparent'><a class='itemDeclLink' href='#req.lockable.basic-itemdecl:1'>🔗</a></div><code class='itemdeclcode'>m<span class='operator'>.</span>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>
</code></div></div><div class='para' id='req.lockable.basic-2'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.basic-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L208'>#</a></div><div class='texpara'><div id='req.lockable.basic-2.sentence-1' class='sentence'><a class='index' id=':block_(execution)'></a><i >Effects</i>: Blocks until a lock can be acquired for the current execution agent<a class='hidden_link' href='#req.lockable.basic-2.sentence-1'>.</a></div> <div id='req.lockable.basic-2.sentence-2' class='sentence'>If an exception
is thrown then a lock shall not have been acquired for the current execution agent<a class='hidden_link' href='#req.lockable.basic-2.sentence-2'>.</a></div></div></div></div><div class='texpara'><div class='itemdecl' id='req.lockable.basic-itemdecl:2'><div class='marginalizedparent'><a class='itemDeclLink' href='#req.lockable.basic-itemdecl:2'>🔗</a></div><code class='itemdeclcode'>m<span class='operator'>.</span>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>
</code></div></div><div class='para' id='req.lockable.basic-3'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.basic-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L220'>#</a></div><div class='texpara'><div id='req.lockable.basic-3.sentence-1' class='sentence'><i >Preconditions</i>: The current execution agent holds a lock on <span class='texttt'>m</span><a class='hidden_link' href='#req.lockable.basic-3.sentence-1'>.</a></div></div></div></div><div class='para' id='req.lockable.basic-4'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.basic-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L224'>#</a></div><div class='texpara'><div id='req.lockable.basic-4.sentence-1' class='sentence'><i >Effects</i>: Releases a lock on <span class='texttt'>m</span> held by the current execution agent<a class='hidden_link' href='#req.lockable.basic-4.sentence-1'>.</a></div></div></div></div><div class='para' id='req.lockable.basic-5'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.basic-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L228'>#</a></div><div class='texpara'><div id='req.lockable.basic-5.sentence-1' class='sentence'><i >Throws</i>: Nothing<a class='hidden_link' href='#req.lockable.basic-5.sentence-1'>.</a></div></div></div></div></div><div id='req.lockable.req' class='section'><h4 ><a class='secnum' href='#req.lockable.req' style='min-width:95pt'>32.2.5.3</a> <i >Cpp17Lockable</i> requirements <a class='abbr_ref' href='thread.req.lockable.req'>[thread.req.lockable.req]</a></h4><div class='para' id='req.lockable.req-1'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.req-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L235'>#</a></div><div class='texpara'><div id='req.lockable.req-1.sentence-1' class='sentence'>A type <span class='texttt'>L</span> meets the <i >Cpp17Lockable</i> requirements if it meets the <i >Cpp17BasicLockable</i>
requirements and the following expressions are well-formed and have the specified semantics
(<span class='texttt'>m</span> denotes a value of type <span class='texttt'>L</span>)<a class='hidden_link' href='#req.lockable.req-1.sentence-1'>.</a></div></div></div><div class='texpara'><div class='itemdecl' id='req.lockable.req-itemdecl:1'><div class='marginalizedparent'><a class='itemDeclLink' href='#req.lockable.req-itemdecl:1'>🔗</a></div><code class='itemdeclcode'>m<span class='operator'>.</span>try_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>
</code></div></div><div class='para' id='req.lockable.req-2'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.req-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L245'>#</a></div><div class='texpara'><div id='req.lockable.req-2.sentence-1' class='sentence'><i >Effects</i>: Attempts to acquire a lock for the current execution agent without blocking<a class='hidden_link' href='#req.lockable.req-2.sentence-1'>.</a></div> <div id='req.lockable.req-2.sentence-2' class='sentence'>If an
exception is thrown then a lock shall not have been acquired for the current execution agent<a class='hidden_link' href='#req.lockable.req-2.sentence-2'>.</a></div></div></div></div><div class='para' id='req.lockable.req-3'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.req-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L250'>#</a></div><div class='texpara'><div id='req.lockable.req-3.sentence-1' class='sentence'><i >Return type</i>: <span class='texttt'><span class='keyword'>bool</span></span><a class='hidden_link' href='#req.lockable.req-3.sentence-1'>.</a></div></div></div></div><div class='para' id='req.lockable.req-4'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.req-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L253'>#</a></div><div class='texpara'><div id='req.lockable.req-4.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>true</span></span> if the lock was acquired, otherwise <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#req.lockable.req-4.sentence-1'>.</a></div></div></div></div></div><div id='req.lockable.timed' class='section'><h4 ><a class='secnum' href='#req.lockable.timed' style='min-width:95pt'>32.2.5.4</a> <i >Cpp17TimedLockable</i> requirements <a class='abbr_ref' href='thread.req.lockable.timed'>[thread.req.lockable.timed]</a></h4><div class='para' id='req.lockable.timed-1'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.timed-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L260'>#</a></div><div class='texpara'><div id='req.lockable.timed-1.sentence-1' class='sentence'>A type <span class='texttt'>L</span> meets the <i >Cpp17TimedLockable</i> requirements if it meets the <i >Cpp17Lockable</i>
requirements and the following expressions are well-formed and have the specified semantics
(<span class='texttt'>m</span> denotes a value of type <span class='texttt'>L</span>, <span class='texttt'>rel_&shy;time</span> denotes a value of an
instantiation of <a href='time.duration' title='27.5&emsp;Class template duration&emsp;[time.duration]'><span class='texttt'>duration</span></a>, and <span class='texttt'>abs_&shy;time</span> denotes a value
of an instantiation of <a href='time.point' title='27.6&emsp;Class template time_&shy;point&emsp;[time.point]'><span class='texttt'>time_&shy;point</span></a>)<a class='hidden_link' href='#req.lockable.timed-1.sentence-1'>.</a></div></div></div><div class='texpara'><div class='itemdecl' id='req.lockable.timed-itemdecl:1'><div class='marginalizedparent'><a class='itemDeclLink' href='#req.lockable.timed-itemdecl:1'>🔗</a></div><code class='itemdeclcode'>m<span class='operator'>.</span>try_lock_for<span class='parenthesis'>(</span>rel_time<span class='parenthesis'>)</span>
</code></div></div><div class='para' id='req.lockable.timed-2'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.timed-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L272'>#</a></div><div class='texpara'><div id='req.lockable.timed-2.sentence-1' class='sentence'><i >Effects</i>: Attempts to acquire a lock for the current execution agent within the relative
timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>) specified by <span class='texttt'>rel_&shy;time</span><a class='hidden_link' href='#req.lockable.timed-2.sentence-1'>.</a></div> <div id='req.lockable.timed-2.sentence-2' class='sentence'>The function will not return
within the timeout specified by <span class='texttt'>rel_&shy;time</span> unless it has obtained a lock on <span class='texttt'>m</span>
for the current execution agent<a class='hidden_link' href='#req.lockable.timed-2.sentence-2'>.</a></div> <div id='req.lockable.timed-2.sentence-3' class='sentence'>If an exception is thrown then a lock has not been
acquired for the current execution agent<a class='hidden_link' href='#req.lockable.timed-2.sentence-3'>.</a></div></div></div></div><div class='para' id='req.lockable.timed-3'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.timed-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L280'>#</a></div><div class='texpara'><div id='req.lockable.timed-3.sentence-1' class='sentence'><i >Return type</i>: <span class='texttt'><span class='keyword'>bool</span></span><a class='hidden_link' href='#req.lockable.timed-3.sentence-1'>.</a></div></div></div></div><div class='para' id='req.lockable.timed-4'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.timed-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L283'>#</a></div><div class='texpara'><div id='req.lockable.timed-4.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>true</span></span> if the lock was acquired, otherwise <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#req.lockable.timed-4.sentence-1'>.</a></div></div></div></div><div class='texpara'><div class='itemdecl' id='req.lockable.timed-itemdecl:2'><div class='marginalizedparent'><a class='itemDeclLink' href='#req.lockable.timed-itemdecl:2'>🔗</a></div><code class='itemdeclcode'>m<span class='operator'>.</span>try_lock_until<span class='parenthesis'>(</span>abs_time<span class='parenthesis'>)</span>
</code></div></div><div class='para' id='req.lockable.timed-5'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.timed-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L293'>#</a></div><div class='texpara'><div id='req.lockable.timed-5.sentence-1' class='sentence'><i >Effects</i>: Attempts to acquire a lock for the current execution agent before the absolute
timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>) specified by <span class='texttt'>abs_&shy;time</span><a class='hidden_link' href='#req.lockable.timed-5.sentence-1'>.</a></div> <div id='req.lockable.timed-5.sentence-2' class='sentence'>The function will not return
before the timeout specified by <span class='texttt'>abs_&shy;time</span> unless it has obtained a lock on <span class='texttt'>m</span> for
the current execution agent<a class='hidden_link' href='#req.lockable.timed-5.sentence-2'>.</a></div> <div id='req.lockable.timed-5.sentence-3' class='sentence'>If an exception is thrown then a lock has not been acquired
for the current execution agent<a class='hidden_link' href='#req.lockable.timed-5.sentence-3'>.</a></div></div></div></div><div class='para' id='req.lockable.timed-6'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.timed-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L301'>#</a></div><div class='texpara'><div id='req.lockable.timed-6.sentence-1' class='sentence'><i >Return type</i>: <span class='texttt'><span class='keyword'>bool</span></span><a class='hidden_link' href='#req.lockable.timed-6.sentence-1'>.</a></div></div></div></div><div class='para' id='req.lockable.timed-7'><div class='marginalizedparent'><a class='marginalized' href='#req.lockable.timed-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L304'>#</a></div><div class='texpara'><div id='req.lockable.timed-7.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>true</span></span> if the lock was acquired, otherwise <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#req.lockable.timed-7.sentence-1'>.</a></div></div></div></div></div></div></div><div id='stoptoken' class='section'><h2 ><a class='secnum' href='#stoptoken' style='min-width:65pt'>32.3</a> Stop tokens <a class='abbr_ref' href='thread.stoptoken'>[thread.stoptoken]</a></h2><div id='stoptoken.intro' class='section'><h3 ><a class='secnum' href='#stoptoken.intro' style='min-width:80pt'>32.3.1</a> Introduction <a class='abbr_ref' href='thread.stoptoken.intro'>[thread.stoptoken.intro]</a></h3><div class='para' id='stoptoken.intro-1'><div class='marginalizedparent'><a class='marginalized' href='#stoptoken.intro-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L313'>#</a></div><div class='texpara'><div id='stoptoken.intro-1.sentence-1' class='sentence'>Subclause <a href='#stoptoken' title='32.3&emsp;Stop tokens'>[thread.<span class='shy'></span>stoptoken]</a> describes components that can be used
to asynchronously request that an operation stops execution in a timely manner,
typically because the result is no longer required<a class='hidden_link' href='#stoptoken.intro-1.sentence-1'>.</a></div> <div id='stoptoken.intro-1.sentence-2' class='sentence'>Such a request is called a <a class='hidden_link' href='#def:stop_request' title='32.3.1&emsp;Introduction&emsp;[thread.stoptoken.intro]'><span id='def:stop_request'><i >stop request</i></span></a><a class='hidden_link' href='#stoptoken.intro-1.sentence-2'>.</a></div></div></div><div class='para' id='stoptoken.intro-2'><div class='marginalizedparent'><a class='marginalized' href='#stoptoken.intro-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L319'>#</a></div><div class='texpara'><div id='stoptoken.intro-2.sentence-1' class='sentence'><span class='texttt'>stop_&shy;source</span>, <span class='texttt'>stop_&shy;token</span>, and <span class='texttt'>stop_&shy;callback</span>
implement semantics of shared ownership of a <a class='hidden_link' href='#def:stop_state' title='32.3.1&emsp;Introduction&emsp;[thread.stoptoken.intro]'><span id='def:stop_state'><i >stop state</i></span></a><a class='hidden_link' href='#stoptoken.intro-2.sentence-1'>.</a></div> <div id='stoptoken.intro-2.sentence-2' class='sentence'>Any <span class='texttt'>stop_&shy;source</span>, <span class='texttt'>stop_&shy;token</span>, or <span class='texttt'>stop_&shy;callback</span>
that shares ownership of the same stop state is an <a class='hidden_link' href='#def:associated' title='32.3.1&emsp;Introduction&emsp;[thread.stoptoken.intro]'><span id='def:associated'><i >associated</i></span></a>
<span class='texttt'>stop_&shy;source</span>, <span class='texttt'>stop_&shy;token</span>, or <span class='texttt'>stop_&shy;callback</span>, respectively<a class='hidden_link' href='#stoptoken.intro-2.sentence-2'>.</a></div> <div id='stoptoken.intro-2.sentence-3' class='sentence'>The last remaining owner of the stop state automatically
releases the resources associated with the stop state<a class='hidden_link' href='#stoptoken.intro-2.sentence-3'>.</a></div></div></div><div class='para' id='stoptoken.intro-3'><div class='marginalizedparent'><a class='marginalized' href='#stoptoken.intro-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L328'>#</a></div><div class='texpara'><div id='stoptoken.intro-3.sentence-1' class='sentence'>A <span class='texttt'>stop_&shy;token</span> can be passed to an operation which can either
<ul class='itemize'><li id='stoptoken.intro-3.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#stoptoken.intro-3.1'>(3.1)</a></div>actively poll the token to check if there has been a stop request, or</li><li id='stoptoken.intro-3.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#stoptoken.intro-3.2'>(3.2)</a></div>register a callback using the <span class='texttt'>stop_&shy;callback</span> class template which
        will be called in the event that a stop request is made<a class='hidden_link' href='#stoptoken.intro-3.sentence-1'>.</a></li></ul></div> <div id='stoptoken.intro-3.sentence-2' class='sentence'>
A stop request made via a <span class='texttt'>stop_&shy;source</span> will be visible to all
associated <span class='texttt'>stop_&shy;token</span> and <span class='texttt'>stop_&shy;source</span> objects<a class='hidden_link' href='#stoptoken.intro-3.sentence-2'>.</a></div> <div id='stoptoken.intro-3.sentence-3' class='sentence'>Once a stop request has been made it cannot be withdrawn
(a subsequent stop request has no effect)<a class='hidden_link' href='#stoptoken.intro-3.sentence-3'>.</a></div></div></div><div class='para' id='stoptoken.intro-4'><div class='marginalizedparent'><a class='marginalized' href='#stoptoken.intro-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L340'>#</a></div><div class='texpara'><div id='stoptoken.intro-4.sentence-1' class='sentence'>Callbacks registered via a <span class='texttt'>stop_&shy;callback</span> object are called when
a stop request is first made by any associated <span class='texttt'>stop_&shy;source</span> object<a class='hidden_link' href='#stoptoken.intro-4.sentence-1'>.</a></div></div></div><div class='para' id='stoptoken.intro-5'><div class='marginalizedparent'><a class='marginalized' href='#stoptoken.intro-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L344'>#</a></div><div class='texpara'><div id='stoptoken.intro-5.sentence-1' class='sentence'>Calls to the functions <span class='texttt'>request_&shy;stop</span>, <span class='texttt'>stop_&shy;requested</span>,
and <span class='texttt'>stop_&shy;possible</span>
do not introduce data races<a class='hidden_link' href='#stoptoken.intro-5.sentence-1'>.</a></div> <div id='stoptoken.intro-5.sentence-2' class='sentence'>A call to <span class='texttt'>request_&shy;stop</span> that returns <span class='texttt'><span class='literal'>true</span></span>
synchronizes with a call to <span class='texttt'>stop_&shy;requested</span>
on an associated <span class='texttt'>stop_&shy;token</span> or <span class='texttt'>stop_&shy;source</span> object
that returns <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#stoptoken.intro-5.sentence-2'>.</a></div> <div id='stoptoken.intro-5.sentence-3' class='sentence'>Registration of a callback synchronizes with the invocation of that callback<a class='hidden_link' href='#stoptoken.intro-5.sentence-3'>.</a></div></div></div></div><div id='stoptoken.syn' class='section'><h3 ><a class='secnum' href='#stoptoken.syn' style='min-width:80pt'>32.3.2</a> Header <span class='texttt'>&lt;stop_&shy;token&gt;</span> synopsis <a class='abbr_ref' href='thread.stoptoken.syn'>[thread.stoptoken.syn]</a></h3><div class='texpara'><span id='header:<stop_token>'><div class='marginalizedparent'><a class='itemDeclLink' href='#header:%3cstop_token%3e'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='comment'>// <a href='#stoptoken' title='32.3.3&emsp;Class stop_&shy;token'>[stoptoken]</a>, class <span class='tcode_in_codeblock'>stop_&shy;token</span></span>
  <span class='keyword'>class</span> stop_token;

  <span class='comment'>// <a href='#stopsource' title='32.3.4&emsp;Class stop_&shy;source'>[stopsource]</a>, class <span class='tcode_in_codeblock'>stop_&shy;source</span></span>
  <span class='keyword'>class</span> stop_source;

  <span class='comment'>// no-shared-stop-state indicator</span>
  <span class='keyword'>struct</span> nostopstate_t <span class='curlybracket'>{</span>
    <span class='keyword'>explicit</span> nostopstate_t<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>default</span>;
  <span class='curlybracket'>}</span>;
  <span class='keyword'>inline</span> <span class='keyword'>constexpr</span> nostopstate_t nostopstate<span class='curlybracket'>{</span><span class='curlybracket'>}</span>;

  <span class='comment'>// <a href='#stopcallback' title='32.3.5&emsp;Class template stop_&shy;callback'>[stopcallback]</a>, class <span class='tcode_in_codeblock'>stop_&shy;callback</span></span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Callback<span class='anglebracket'>&gt;</span>
  <span class='keyword'>class</span> stop_callback;
<span class='curlybracket'>}</span>
</span></span></div></div><div id='stoptoken' class='section'><h3 ><a class='secnum' href='#stoptoken' style='min-width:80pt'>32.3.3</a> Class <span class='texttt'>stop_&shy;token</span> <a class='abbr_ref' href='stoptoken'>[stoptoken]</a></h3><div class='texpara'><a class='index' id='lib:stop_token'></a></div><div id='stoptoken.general' class='section'><h4 ><a class='secnum' href='#stoptoken.general' style='min-width:95pt'>32.3.3.1</a> General <a class='abbr_ref' href='stoptoken.general'>[stoptoken.general]</a></h4><div class='para' id='stoptoken.general-1'><div class='marginalizedparent'><a class='marginalized' href='#stoptoken.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L384'>#</a></div><div class='texpara'><div id='stoptoken.general-1.sentence-1' class='sentence'><a class='index' id='lib:stop_token_'></a>The class <span class='texttt'>stop_&shy;token</span> provides an interface for querying whether
a stop request has been made (<span class='texttt'>stop_&shy;requested</span>)
or can ever be made (<span class='texttt'>stop_&shy;possible</span>)
using an associated <span class='texttt'>stop_&shy;source</span> object (<a href='#stopsource' title='32.3.4&emsp;Class stop_&shy;source'>[stopsource]</a>)<a class='hidden_link' href='#stoptoken.general-1.sentence-1'>.</a></div> <div id='stoptoken.general-1.sentence-2' class='sentence'>A <span class='texttt'>stop_&shy;token</span> can also be passed to a
<span class='texttt'>stop_&shy;callback</span> (<a href='#stopcallback' title='32.3.5&emsp;Class template stop_&shy;callback'>[stopcallback]</a>) constructor
to register a callback to be called when a stop request has been made
from an associated <span class='texttt'>stop_&shy;source</span><a class='hidden_link' href='#stoptoken.general-1.sentence-2'>.</a></div></div><div class='texpara'><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>class</span> stop_token <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    <span class='comment'>// <a href='#stoptoken.cons' title='32.3.3.2&emsp;Constructors, copy, and assignment'>[stoptoken.<span class='shy'></span>cons]</a>, constructors, copy, and assignment</span>
    stop_token<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    stop_token<span class='parenthesis'>(</span><span class='keyword'>const</span> stop_token<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    stop_token<span class='parenthesis'>(</span>stop_token<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    stop_token<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> stop_token<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    stop_token<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>stop_token<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='operator'>~</span>stop_token<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>stop_token<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    <span class='comment'>// <a href='#stoptoken.mem' title='32.3.3.3&emsp;Members'>[stoptoken.<span class='shy'></span>mem]</a>, stop handling</span>
    <span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='keyword'>bool</span> stop_requested<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
    <span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='keyword'>bool</span> stop_possible<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;

    <span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='keyword'>friend</span> <span class='keyword'>bool</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> stop_token<span class='operator'>&amp;</span> lhs, <span class='keyword'>const</span> stop_token<span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>friend</span> <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>stop_token<span class='operator'>&amp;</span> lhs, stop_token<span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></div></div></div><div id='stoptoken.cons' class='section'><h4 ><a class='secnum' href='#stoptoken.cons' style='min-width:95pt'>32.3.3.2</a> Constructors, copy, and assignment <a class='abbr_ref' href='stoptoken.cons'>[stoptoken.cons]</a></h4><div class='texpara'><div id='lib:stop_token,constructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:stop_token,constructor'>🔗</a></div><code class='itemdeclcode'>stop_token<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='stoptoken.cons-1'><div class='marginalizedparent'><a class='marginalized' href='#stoptoken.cons-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L428'>#</a></div><div class='texpara'><div id='stoptoken.cons-1.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>stop_&shy;possible<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>false</span></span> and
<span class='texttt'>stop_&shy;requested<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#stoptoken.cons-1.sentence-1'>.</a></div> <div id='stoptoken.cons-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#stoptoken.cons-note-1'>1</a></i>: <div id='stoptoken.cons-1.sentence-2' class='sentence'>Because the created <span class='texttt'>stop_&shy;token</span> object can never receive a stop request,
no resources are allocated for a stop state<a class='hidden_link' href='#stoptoken.cons-1.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='texpara'><div id='lib:stop_token,constructor_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:stop_token,constructor_'>🔗</a></div><code class='itemdeclcode'>stop_token<span class='parenthesis'>(</span><span class='keyword'>const</span> stop_token<span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='stoptoken.cons-2'><div class='marginalizedparent'><a class='marginalized' href='#stoptoken.cons-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L444'>#</a></div><div class='texpara'><div id='stoptoken.cons-2.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span> <span class='operator'>=</span><span class='operator'>=</span> rhs</span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#stoptoken.cons-2.sentence-1'>.</a></div> <div id='stoptoken.cons-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#stoptoken.cons-note-2'>2</a></i>: <div id='stoptoken.cons-2.sentence-2' class='sentence'><span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> and <span class='texttt'>rhs</span> share the ownership of the same stop state,
if any<a class='hidden_link' href='#stoptoken.cons-2.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='texpara'><div id='lib:stop_token,constructor__'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:stop_token,constructor__'>🔗</a></div><code class='itemdeclcode'>stop_token<span class='parenthesis'>(</span>stop_token<span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='stoptoken.cons-3'><div class='marginalizedparent'><a class='marginalized' href='#stoptoken.cons-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L458'>#</a></div><div class='texpara'><div id='stoptoken.cons-3.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> contains the value of <span class='texttt'>rhs</span>
prior to the start of construction
and <span class='texttt'>rhs<span class='operator'>.</span>stop_&shy;possible<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#stoptoken.cons-3.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:stop_token,destructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:stop_token,destructor'>🔗</a></div><code class='itemdeclcode'><span class='operator'>~</span>stop_token<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='stoptoken.cons-4'><div class='marginalizedparent'><a class='marginalized' href='#stoptoken.cons-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L471'>#</a></div><div class='texpara'><div id='stoptoken.cons-4.sentence-1' class='sentence'><i >Effects</i>: Releases ownership of the stop state, if any<a class='hidden_link' href='#stoptoken.cons-4.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:stop_token,operator='><div id='lib:operator=,stop_token'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:operator=,stop_token'>🔗</a></div><code class='itemdeclcode'>stop_token<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> stop_token<span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='stoptoken.cons-5'><div class='marginalizedparent'><a class='marginalized' href='#stoptoken.cons-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L482'>#</a></div><div class='texpara'><div id='stoptoken.cons-5.sentence-1' class='sentence'><i >Effects</i>: Equivalent to: <span class='texttt'>stop_&shy;token<span class='parenthesis'>(</span>rhs<span class='parenthesis'>)</span><span class='operator'>.</span>swap<span class='parenthesis'>(</span><span class='operator'>*</span><span class='keyword'>this</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#stoptoken.cons-5.sentence-1'>.</a></div></div></div></div><div class='para' id='stoptoken.cons-6'><div class='marginalizedparent'><a class='marginalized' href='#stoptoken.cons-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L486'>#</a></div><div class='texpara'><div id='stoptoken.cons-6.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#stoptoken.cons-6.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:stop_token,operator=_'><div id='lib:operator=,stop_token_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:operator=,stop_token_'>🔗</a></div><code class='itemdeclcode'>stop_token<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>stop_token<span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='stoptoken.cons-7'><div class='marginalizedparent'><a class='marginalized' href='#stoptoken.cons-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L497'>#</a></div><div class='texpara'><div id='stoptoken.cons-7.sentence-1' class='sentence'><i >Effects</i>: Equivalent to: <span class='texttt'>stop_&shy;token<span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>move<span class='parenthesis'>(</span>rhs<span class='parenthesis'>)</span><span class='parenthesis'>)</span><span class='operator'>.</span>swap<span class='parenthesis'>(</span><span class='operator'>*</span><span class='keyword'>this</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#stoptoken.cons-7.sentence-1'>.</a></div></div></div></div><div class='para' id='stoptoken.cons-8'><div class='marginalizedparent'><a class='marginalized' href='#stoptoken.cons-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L501'>#</a></div><div class='texpara'><div id='stoptoken.cons-8.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#stoptoken.cons-8.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:stop_token,swap'><div id='lib:swap,stop_token'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:swap,stop_token'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> swap<span class='parenthesis'>(</span>stop_token<span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='stoptoken.cons-9'><div class='marginalizedparent'><a class='marginalized' href='#stoptoken.cons-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L512'>#</a></div><div class='texpara'><div id='stoptoken.cons-9.sentence-1' class='sentence'><i >Effects</i>: Exchanges the values of <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> and <span class='texttt'>rhs</span><a class='hidden_link' href='#stoptoken.cons-9.sentence-1'>.</a></div></div></div></div></div><div id='stoptoken.mem' class='section'><h4 ><a class='secnum' href='#stoptoken.mem' style='min-width:95pt'>32.3.3.3</a> Members <a class='abbr_ref' href='stoptoken.mem'>[stoptoken.mem]</a></h4><div class='texpara'><div id='lib:stop_token,stop_requested'><div id='lib:stop_requested,stop_token'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:stop_requested,stop_token'>🔗</a></div><code class='itemdeclcode'><span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='keyword'>bool</span> stop_requested<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='stoptoken.mem-1'><div class='marginalizedparent'><a class='marginalized' href='#stoptoken.mem-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L525'>#</a></div><div class='texpara'><div id='stoptoken.mem-1.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>true</span></span> if <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> has ownership of a stop state
that has received a stop request;
otherwise, <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#stoptoken.mem-1.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:stop_token,stop_possible'><div id='lib:stop_possible,stop_token'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:stop_possible,stop_token'>🔗</a></div><code class='itemdeclcode'><span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='keyword'>bool</span> stop_possible<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='stoptoken.mem-2'><div class='marginalizedparent'><a class='marginalized' href='#stoptoken.mem-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L538'>#</a></div><div class='texpara'><div id='stoptoken.mem-2.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>false</span></span> if:
<ul class='itemize'><li id='stoptoken.mem-2.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#stoptoken.mem-2.1'>(2.1)</a></div><span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> does not have ownership of a stop state, or</li><li id='stoptoken.mem-2.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#stoptoken.mem-2.2'>(2.2)</a></div>a stop request was not made
      and there are no associated <span class='texttt'>stop_&shy;source</span> objects;</li></ul>
otherwise, <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#stoptoken.mem-2.sentence-1'>.</a></div></div></div></div></div><div id='stoptoken.nonmembers' class='section'><h4 ><a class='secnum' href='#stoptoken.nonmembers' style='min-width:95pt'>32.3.3.4</a> Non-member functions <a class='abbr_ref' href='stoptoken.nonmembers'>[stoptoken.nonmembers]</a></h4><div class='texpara'><div id='lib:stop_token,operator=='><div id='lib:operator==,stop_token'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:operator==,stop_token'>🔗</a></div><code class='itemdeclcode'><span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='keyword'>bool</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> stop_token<span class='operator'>&amp;</span> lhs, <span class='keyword'>const</span> stop_token<span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='stoptoken.nonmembers-1'><div class='marginalizedparent'><a class='marginalized' href='#stoptoken.nonmembers-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L557'>#</a></div><div class='texpara'><div id='stoptoken.nonmembers-1.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>true</span></span> if <span class='texttt'>lhs</span> and <span class='texttt'>rhs</span> have ownership of the same stop state
or if both <span class='texttt'>lhs</span> and <span class='texttt'>rhs</span> do not have ownership of a stop state;
otherwise <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#stoptoken.nonmembers-1.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:stop_token,swap_'><div id='lib:swap,stop_token_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:swap,stop_token_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>friend</span> <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>stop_token<span class='operator'>&amp;</span> x, stop_token<span class='operator'>&amp;</span> y<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='stoptoken.nonmembers-2'><div class='marginalizedparent'><a class='marginalized' href='#stoptoken.nonmembers-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L570'>#</a></div><div class='texpara'><div id='stoptoken.nonmembers-2.sentence-1' class='sentence'><i >Effects</i>: Equivalent to: <span class='texttt'>x<span class='operator'>.</span>swap<span class='parenthesis'>(</span>y<span class='parenthesis'>)</span></span><a class='hidden_link' href='#stoptoken.nonmembers-2.sentence-1'>.</a></div></div></div></div></div></div><div id='stopsource' class='section'><h3 ><a class='secnum' href='#stopsource' style='min-width:80pt'>32.3.4</a> Class <span class='texttt'>stop_&shy;source</span> <a class='abbr_ref' href='stopsource'>[stopsource]</a></h3><div class='texpara'><a class='index' id='lib:stop_source'></a></div><div id='stopsource.general' class='section'><h4 ><a class='secnum' href='#stopsource.general' style='min-width:95pt'>32.3.4.1</a> General <a class='abbr_ref' href='stopsource.general'>[stopsource.general]</a></h4><div class='para' id='stopsource.general-1'><div class='marginalizedparent'><a class='marginalized' href='#stopsource.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L580'>#</a></div><div class='texpara'><div id='stopsource.general-1.sentence-1' class='sentence'><a class='index' id='lib:stop_source_'></a>The class <span class='texttt'>stop_&shy;source</span> implements the semantics of making a stop request<a class='hidden_link' href='#stopsource.general-1.sentence-1'>.</a></div> <div id='stopsource.general-1.sentence-2' class='sentence'>A stop request made on a <span class='texttt'>stop_&shy;source</span> object is visible to all
associated <span class='texttt'>stop_&shy;source</span> and <span class='texttt'>stop_&shy;token</span> (<a href='#stoptoken' title='32.3.3&emsp;Class stop_&shy;token'>[stoptoken]</a>) objects<a class='hidden_link' href='#stopsource.general-1.sentence-2'>.</a></div> <div id='stopsource.general-1.sentence-3' class='sentence'>Once a stop request has been made it cannot be withdrawn
(a subsequent stop request has no effect)<a class='hidden_link' href='#stopsource.general-1.sentence-3'>.</a></div></div><div class='texpara'><a class='index' id='lib:nostopstate_t'></a><a class='index' id='lib:nostopstate'></a>
<span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='comment'>// no-shared-stop-state indicator</span>
  <span class='keyword'>struct</span> nostopstate_t <span class='curlybracket'>{</span>
    <span class='keyword'>explicit</span> nostopstate_t<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>default</span>;
  <span class='curlybracket'>}</span>;
  <span class='keyword'>inline</span> <span class='keyword'>constexpr</span> nostopstate_t nostopstate<span class='curlybracket'>{</span><span class='curlybracket'>}</span>;

  <span class='keyword'>class</span> stop_source <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    <span class='comment'>// <a href='#stopsource.cons' title='32.3.4.2&emsp;Constructors, copy, and assignment'>[stopsource.<span class='shy'></span>cons]</a>, constructors, copy, and assignment</span>
    stop_source<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>explicit</span> stop_source<span class='parenthesis'>(</span>nostopstate_t<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    stop_source<span class='parenthesis'>(</span><span class='keyword'>const</span> stop_source<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    stop_source<span class='parenthesis'>(</span>stop_source<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    stop_source<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> stop_source<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    stop_source<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>stop_source<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='operator'>~</span>stop_source<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>stop_source<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    <span class='comment'>// <a href='#stopsource.mem' title='32.3.4.3&emsp;Members'>[stopsource.<span class='shy'></span>mem]</a>, stop handling</span>
    <span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> stop_token get_token<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
    <span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='keyword'>bool</span> stop_possible<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
    <span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='keyword'>bool</span> stop_requested<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>bool</span> request_stop<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    <span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='keyword'>friend</span> <span class='keyword'>bool</span>
      <span class='keyword'>operator</span><span class='operator'>=</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> stop_source<span class='operator'>&amp;</span> lhs, <span class='keyword'>const</span> stop_source<span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>friend</span> <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>stop_source<span class='operator'>&amp;</span> lhs, stop_source<span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></div></div></div><div id='stopsource.cons' class='section'><h4 ><a class='secnum' href='#stopsource.cons' style='min-width:95pt'>32.3.4.2</a> Constructors, copy, and assignment <a class='abbr_ref' href='stopsource.cons'>[stopsource.cons]</a></h4><div class='texpara'><div id='lib:stop_source,constructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:stop_source,constructor'>🔗</a></div><code class='itemdeclcode'>stop_source<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='stopsource.cons-1'><div class='marginalizedparent'><a class='marginalized' href='#stopsource.cons-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L633'>#</a></div><div class='texpara'><div id='stopsource.cons-1.sentence-1' class='sentence'><i >Effects</i>: Initialises <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> to have ownership of a new stop state<a class='hidden_link' href='#stopsource.cons-1.sentence-1'>.</a></div></div></div></div><div class='para' id='stopsource.cons-2'><div class='marginalizedparent'><a class='marginalized' href='#stopsource.cons-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L637'>#</a></div><div class='texpara'><div id='stopsource.cons-2.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>stop_&shy;possible<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span>
and <span class='texttt'>stop_&shy;requested<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#stopsource.cons-2.sentence-1'>.</a></div></div></div></div><div class='para' id='stopsource.cons-3'><div class='marginalizedparent'><a class='marginalized' href='#stopsource.cons-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L642'>#</a></div><div class='texpara'><div id='stopsource.cons-3.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>bad_&shy;alloc</span> if memory cannot be allocated for the stop state<a class='hidden_link' href='#stopsource.cons-3.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:stop_source,constructor_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:stop_source,constructor_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>explicit</span> stop_source<span class='parenthesis'>(</span>nostopstate_t<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='stopsource.cons-4'><div class='marginalizedparent'><a class='marginalized' href='#stopsource.cons-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L653'>#</a></div><div class='texpara'><div id='stopsource.cons-4.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>stop_&shy;possible<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>false</span></span> and
<span class='texttt'>stop_&shy;requested<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#stopsource.cons-4.sentence-1'>.</a></div> <div id='stopsource.cons-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#stopsource.cons-note-1'>1</a></i>: <div id='stopsource.cons-4.sentence-2' class='sentence'>No resources are allocated for the state<a class='hidden_link' href='#stopsource.cons-4.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='texpara'><div id='lib:stop_source,constructor__'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:stop_source,constructor__'>🔗</a></div><code class='itemdeclcode'>stop_source<span class='parenthesis'>(</span><span class='keyword'>const</span> stop_source<span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='stopsource.cons-5'><div class='marginalizedparent'><a class='marginalized' href='#stopsource.cons-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L668'>#</a></div><div class='texpara'><div id='stopsource.cons-5.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span> <span class='operator'>=</span><span class='operator'>=</span> rhs</span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#stopsource.cons-5.sentence-1'>.</a></div> <div id='stopsource.cons-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#stopsource.cons-note-2'>2</a></i>: <div id='stopsource.cons-5.sentence-2' class='sentence'><span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> and <span class='texttt'>rhs</span> share the ownership of the same stop state,
if any<a class='hidden_link' href='#stopsource.cons-5.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='texpara'><div id='lib:stop_source,constructor___'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:stop_source,constructor___'>🔗</a></div><code class='itemdeclcode'>stop_source<span class='parenthesis'>(</span>stop_source<span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='stopsource.cons-6'><div class='marginalizedparent'><a class='marginalized' href='#stopsource.cons-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L683'>#</a></div><div class='texpara'><div id='stopsource.cons-6.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> contains the value of <span class='texttt'>rhs</span>
prior to the start of construction
and <span class='texttt'>rhs<span class='operator'>.</span>stop_&shy;possible<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#stopsource.cons-6.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:stop_source,destructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:stop_source,destructor'>🔗</a></div><code class='itemdeclcode'><span class='operator'>~</span>stop_source<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='stopsource.cons-7'><div class='marginalizedparent'><a class='marginalized' href='#stopsource.cons-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L696'>#</a></div><div class='texpara'><div id='stopsource.cons-7.sentence-1' class='sentence'><i >Effects</i>: Releases ownership of the stop state, if any<a class='hidden_link' href='#stopsource.cons-7.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:stop_source,operator='><div id='lib:operator=,stop_source'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:operator=,stop_source'>🔗</a></div><code class='itemdeclcode'>stop_source<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> stop_source<span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='stopsource.cons-8'><div class='marginalizedparent'><a class='marginalized' href='#stopsource.cons-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L707'>#</a></div><div class='texpara'><div id='stopsource.cons-8.sentence-1' class='sentence'><i >Effects</i>: Equivalent to: <span class='texttt'>stop_&shy;source<span class='parenthesis'>(</span>rhs<span class='parenthesis'>)</span><span class='operator'>.</span>swap<span class='parenthesis'>(</span><span class='operator'>*</span><span class='keyword'>this</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#stopsource.cons-8.sentence-1'>.</a></div></div></div></div><div class='para' id='stopsource.cons-9'><div class='marginalizedparent'><a class='marginalized' href='#stopsource.cons-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L711'>#</a></div><div class='texpara'><div id='stopsource.cons-9.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#stopsource.cons-9.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:stop_source,operator=_'><div id='lib:operator=,stop_source_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:operator=,stop_source_'>🔗</a></div><code class='itemdeclcode'>stop_source<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>stop_source<span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='stopsource.cons-10'><div class='marginalizedparent'><a class='marginalized' href='#stopsource.cons-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L722'>#</a></div><div class='texpara'><div id='stopsource.cons-10.sentence-1' class='sentence'><i >Effects</i>: Equivalent to: <span class='texttt'>stop_&shy;source<span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>move<span class='parenthesis'>(</span>rhs<span class='parenthesis'>)</span><span class='parenthesis'>)</span><span class='operator'>.</span>swap<span class='parenthesis'>(</span><span class='operator'>*</span><span class='keyword'>this</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#stopsource.cons-10.sentence-1'>.</a></div></div></div></div><div class='para' id='stopsource.cons-11'><div class='marginalizedparent'><a class='marginalized' href='#stopsource.cons-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L726'>#</a></div><div class='texpara'><div id='stopsource.cons-11.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#stopsource.cons-11.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:stop_source,swap'><div id='lib:swap,stop_source'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:swap,stop_source'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> swap<span class='parenthesis'>(</span>stop_source<span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='stopsource.cons-12'><div class='marginalizedparent'><a class='marginalized' href='#stopsource.cons-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L737'>#</a></div><div class='texpara'><div id='stopsource.cons-12.sentence-1' class='sentence'><i >Effects</i>: Exchanges the values of <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> and <span class='texttt'>rhs</span><a class='hidden_link' href='#stopsource.cons-12.sentence-1'>.</a></div></div></div></div></div><div id='stopsource.mem' class='section'><h4 ><a class='secnum' href='#stopsource.mem' style='min-width:95pt'>32.3.4.3</a> Members <a class='abbr_ref' href='stopsource.mem'>[stopsource.mem]</a></h4><div class='texpara'><div id='lib:stop_source_sc,get_token'><div id='lib:get_token,stop_source_sc'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:get_token,stop_source_sc'>🔗</a></div><code class='itemdeclcode'><span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> stop_token get_token<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='stopsource.mem-1'><div class='marginalizedparent'><a class='marginalized' href='#stopsource.mem-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L750'>#</a></div><div class='texpara'><div id='stopsource.mem-1.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>stop_&shy;token<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> if <span class='texttt'>stop_&shy;possible<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>false</span></span>;
otherwise a new associated <span class='texttt'>stop_&shy;token</span> object<a class='hidden_link' href='#stopsource.mem-1.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:stop_source,stop_possible'><div id='lib:stop_possible,stop_source'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:stop_possible,stop_source'>🔗</a></div><code class='itemdeclcode'><span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='keyword'>bool</span> stop_possible<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='stopsource.mem-2'><div class='marginalizedparent'><a class='marginalized' href='#stopsource.mem-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L762'>#</a></div><div class='texpara'><div id='stopsource.mem-2.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>true</span></span> if <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> has ownership of a stop state;
otherwise, <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#stopsource.mem-2.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:stop_source,stop_requested'><div id='lib:stop_requested,stop_source'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:stop_requested,stop_source'>🔗</a></div><code class='itemdeclcode'><span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='keyword'>bool</span> stop_requested<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='stopsource.mem-3'><div class='marginalizedparent'><a class='marginalized' href='#stopsource.mem-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L774'>#</a></div><div class='texpara'><div id='stopsource.mem-3.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>true</span></span> if <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> has ownership of a stop state
that has received a stop request;
otherwise, <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#stopsource.mem-3.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:stop_source,request_stop'><div id='lib:request_stop,stop_source'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:request_stop,stop_source'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>bool</span> request_stop<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='stopsource.mem-4'><div class='marginalizedparent'><a class='marginalized' href='#stopsource.mem-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L787'>#</a></div><div class='texpara'><div id='stopsource.mem-4.sentence-1' class='sentence'><i >Effects</i>: If <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> does not have ownership of a stop state, returns <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#stopsource.mem-4.sentence-1'>.</a></div> <div id='stopsource.mem-4.sentence-2' class='sentence'>Otherwise, atomically determines whether the owned stop state
has received a stop request,
and if not, makes a stop request<a class='hidden_link' href='#stopsource.mem-4.sentence-2'>.</a></div> <div id='stopsource.mem-4.sentence-3' class='sentence'>The determination and making of the stop request are an
atomic read-modify-write operation (<a href='intro.races' title='6.9.2.2&emsp;Data races'>[intro.<span class='shy'></span>races]</a>)<a class='hidden_link' href='#stopsource.mem-4.sentence-3'>.</a></div> <div id='stopsource.mem-4.sentence-4' class='sentence'>If the request was made,
the callbacks registered by associated <span class='texttt'>stop_&shy;callback</span> objects
are synchronously called<a class='hidden_link' href='#stopsource.mem-4.sentence-4'>.</a></div> <div id='stopsource.mem-4.sentence-5' class='sentence'>If an invocation of a callback exits via an exception
then <span class='texttt'>terminate</span> is invoked (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#stopsource.mem-4.sentence-5'>.</a></div> <div id='stopsource.mem-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#stopsource.mem-note-1'>1</a></i>: <div id='stopsource.mem-4.sentence-6' class='sentence'>A stop request includes notifying all condition variables
of type <span class='texttt'>condition_&shy;variable_&shy;any</span>
temporarily registered during
an interruptible wait (<a href='#condvarany.intwait' title='32.6.5.3&emsp;Interruptible waits'>[thread.<span class='shy'></span>condvarany.<span class='shy'></span>intwait]</a>)<a class='hidden_link' href='#stopsource.mem-4.sentence-6'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='stopsource.mem-5'><div class='marginalizedparent'><a class='marginalized' href='#stopsource.mem-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L807'>#</a></div><div class='texpara'><div id='stopsource.mem-5.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>stop_&shy;possible<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>false</span></span>
or <span class='texttt'>stop_&shy;requested<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#stopsource.mem-5.sentence-1'>.</a></div></div></div></div><div class='para' id='stopsource.mem-6'><div class='marginalizedparent'><a class='marginalized' href='#stopsource.mem-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L812'>#</a></div><div class='texpara'><div id='stopsource.mem-6.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>true</span></span> if this call made a stop request;
otherwise <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#stopsource.mem-6.sentence-1'>.</a></div></div></div></div></div><div id='stopsource.nonmembers' class='section'><h4 ><a class='secnum' href='#stopsource.nonmembers' style='min-width:95pt'>32.3.4.4</a> Non-member functions <a class='abbr_ref' href='stopsource.nonmembers'>[stopsource.nonmembers]</a></h4><div class='texpara'><div id='lib:stop_source,operator=='><div id='lib:operator==,stop_source'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:operator==,stop_source'>🔗</a></div><code class='itemdeclcode'><span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='keyword'>friend</span> <span class='keyword'>bool</span>
  <span class='keyword'>operator</span><span class='operator'>=</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> stop_source<span class='operator'>&amp;</span> lhs, <span class='keyword'>const</span> stop_source<span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='stopsource.nonmembers-1'><div class='marginalizedparent'><a class='marginalized' href='#stopsource.nonmembers-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L827'>#</a></div><div class='texpara'><div id='stopsource.nonmembers-1.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>true</span></span> if <span class='texttt'>lhs</span> and <span class='texttt'>rhs</span> have ownership
of the same stop state
or if both <span class='texttt'>lhs</span> and <span class='texttt'>rhs</span> do not have ownership of a stop state;
otherwise <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#stopsource.nonmembers-1.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:stop_source,swap_'><div id='lib:swap,stop_source_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:swap,stop_source_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>friend</span> <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>stop_source<span class='operator'>&amp;</span> x, stop_source<span class='operator'>&amp;</span> y<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='stopsource.nonmembers-2'><div class='marginalizedparent'><a class='marginalized' href='#stopsource.nonmembers-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L841'>#</a></div><div class='texpara'><div id='stopsource.nonmembers-2.sentence-1' class='sentence'><i >Effects</i>: Equivalent to: <span class='texttt'>x<span class='operator'>.</span>swap<span class='parenthesis'>(</span>y<span class='parenthesis'>)</span></span><a class='hidden_link' href='#stopsource.nonmembers-2.sentence-1'>.</a></div></div></div></div></div></div><div id='stopcallback' class='section'><h3 ><a class='secnum' href='#stopcallback' style='min-width:80pt'>32.3.5</a> Class template <span class='texttt'>stop_&shy;callback</span> <a class='abbr_ref' href='stopcallback'>[stopcallback]</a></h3><div class='texpara'><a class='index' id='lib:stop_callback'></a></div><div id='stopcallback.general' class='section'><h4 ><a class='secnum' href='#stopcallback.general' style='min-width:95pt'>32.3.5.1</a> General <a class='abbr_ref' href='stopcallback.general'>[stopcallback.general]</a></h4><div class='para' id='stopcallback.general-1'><div class='marginalizedparent'><a class='marginalized' href='#stopcallback.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L851'>#</a></div><div class='texpara'><span id='lib:stop_callback_'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:stop_callback_'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Callback<span class='anglebracket'>&gt;</span>
  <span class='keyword'>class</span> stop_callback <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    <span class='keyword'>using</span> callback_type <span class='operator'>=</span> Callback;

    <span class='comment'>// <a href='#stopcallback.cons' title='32.3.5.2&emsp;Constructors and destructor'>[stopcallback.<span class='shy'></span>cons]</a>, constructors and destructor</span>
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> C<span class='anglebracket'>&gt;</span>
      <span class='keyword'>explicit</span> stop_callback<span class='parenthesis'>(</span><span class='keyword'>const</span> stop_token<span class='operator'>&amp;</span> st, C<span class='operator'>&amp;</span><span class='operator'>&amp;</span> cb<span class='parenthesis'>)</span>
        <span class='keyword'>noexcept</span><span class='parenthesis'>(</span>is_nothrow_constructible_v<span class='anglebracket'>&lt;</span>Callback, C<span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> C<span class='anglebracket'>&gt;</span>
      <span class='keyword'>explicit</span> stop_callback<span class='parenthesis'>(</span>stop_token<span class='operator'>&amp;</span><span class='operator'>&amp;</span> st, C<span class='operator'>&amp;</span><span class='operator'>&amp;</span> cb<span class='parenthesis'>)</span>
        <span class='keyword'>noexcept</span><span class='parenthesis'>(</span>is_nothrow_constructible_v<span class='anglebracket'>&lt;</span>Callback, C<span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span>;
    <span class='operator'>~</span>stop_callback<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    stop_callback<span class='parenthesis'>(</span><span class='keyword'>const</span> stop_callback<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    stop_callback<span class='parenthesis'>(</span>stop_callback<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    stop_callback<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> stop_callback<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    stop_callback<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>stop_callback<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;

  <span class='keyword'>private</span><span class='operator'>:</span>
    Callback callback;      <span class='comment'>// <i >exposition only</i></span>
  <span class='curlybracket'>}</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Callback<span class='anglebracket'>&gt;</span>
    stop_callback<span class='parenthesis'>(</span>stop_token, Callback<span class='parenthesis'>)</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> stop_callback<span class='anglebracket'>&lt;</span>Callback<span class='anglebracket'>&gt;</span>;
<span class='curlybracket'>}</span>
</span></span></div></div><div class='para' id='stopcallback.general-2'><div class='marginalizedparent'><a class='marginalized' href='#stopcallback.general-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L883'>#</a></div><div class='texpara'><div id='stopcallback.general-2.sentence-1' class='sentence'><i >Mandates</i>: <span class='texttt'>stop_&shy;callback</span> is instantiated with an argument for the
template parameter <span class='texttt'>Callback</span>
that satisfies both <a href='concept.invocable#concept:invocable' title='18.7.2&emsp;Concept invocable&emsp;[concept.invocable]'><span id='conceptref:invocable'><span class='texttt'>invocable</span></span></a>
and <a href='concept.destructible#concept:destructible' title='18.4.10&emsp;Concept destructible&emsp;[concept.destructible]'><span id='conceptref:destructible'><span class='texttt'>destructible</span></span></a><a class='hidden_link' href='#stopcallback.general-2.sentence-1'>.</a></div></div></div><div class='para' id='stopcallback.general-3'><div class='marginalizedparent'><a class='marginalized' href='#stopcallback.general-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L890'>#</a></div><div class='texpara'><div id='stopcallback.general-3.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'>stop_&shy;callback</span> is instantiated with an argument for the
template parameter <span class='texttt'>Callback</span>
that models both <a href='concept.invocable#concept:invocable' title='18.7.2&emsp;Concept invocable&emsp;[concept.invocable]'><span id='conceptref:invocable_'><span class='texttt'>invocable</span></span></a>
and <a href='concept.destructible#concept:destructible' title='18.4.10&emsp;Concept destructible&emsp;[concept.destructible]'><span id='conceptref:destructible_'><span class='texttt'>destructible</span></span></a><a class='hidden_link' href='#stopcallback.general-3.sentence-1'>.</a></div></div></div></div><div id='stopcallback.cons' class='section'><h4 ><a class='secnum' href='#stopcallback.cons' style='min-width:95pt'>32.3.5.2</a> Constructors and destructor <a class='abbr_ref' href='stopcallback.cons'>[stopcallback.cons]</a></h4><div class='texpara'><div id='lib:stop_callback,constructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:stop_callback,constructor'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> C<span class='anglebracket'>&gt;</span>
<span class='keyword'>explicit</span> stop_callback<span class='parenthesis'>(</span><span class='keyword'>const</span> stop_token<span class='operator'>&amp;</span> st, C<span class='operator'>&amp;</span><span class='operator'>&amp;</span> cb<span class='parenthesis'>)</span>
  <span class='keyword'>noexcept</span><span class='parenthesis'>(</span>is_nothrow_constructible_v<span class='anglebracket'>&lt;</span>Callback, C<span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> C<span class='anglebracket'>&gt;</span>
<span class='keyword'>explicit</span> stop_callback<span class='parenthesis'>(</span>stop_token<span class='operator'>&amp;</span><span class='operator'>&amp;</span> st, C<span class='operator'>&amp;</span><span class='operator'>&amp;</span> cb<span class='parenthesis'>)</span>
  <span class='keyword'>noexcept</span><span class='parenthesis'>(</span>is_nothrow_constructible_v<span class='anglebracket'>&lt;</span>Callback, C<span class='anglebracket'>&gt;</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='stopcallback.cons-1'><div class='marginalizedparent'><a class='marginalized' href='#stopcallback.cons-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L910'>#</a></div><div class='texpara'><div id='stopcallback.cons-1.sentence-1' class='sentence'><i >Constraints</i>: <span class='texttt'>Callback</span> and <span class='texttt'>C</span> satisfy <span class='texttt'><a href='concept.constructible#concept:constructible_from' title='18.4.11&emsp;Concept constructible_&shy;from&emsp;[concept.constructible]'><span id='conceptref:constructible_from'><span class='texttt'>constructible_&shy;from</span></span></a><span class='anglebracket'>&lt;</span>Callback, C<span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#stopcallback.cons-1.sentence-1'>.</a></div></div></div></div><div class='para' id='stopcallback.cons-2'><div class='marginalizedparent'><a class='marginalized' href='#stopcallback.cons-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L914'>#</a></div><div class='texpara'><div id='stopcallback.cons-2.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'>Callback</span> and <span class='texttt'>C</span> model <span class='texttt'><a href='concept.constructible#concept:constructible_from' title='18.4.11&emsp;Concept constructible_&shy;from&emsp;[concept.constructible]'><span id='conceptref:constructible_from_'><span class='texttt'>constructible_&shy;from</span></span></a><span class='anglebracket'>&lt;</span>Callback, C<span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#stopcallback.cons-2.sentence-1'>.</a></div></div></div></div><div class='para' id='stopcallback.cons-3'><div class='marginalizedparent'><a class='marginalized' href='#stopcallback.cons-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L918'>#</a></div><div class='texpara'><div id='stopcallback.cons-3.sentence-1' class='sentence'><i >Effects</i>: Initializes <span class='texttt'>callback</span> with <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>forward<span class='anglebracket'>&lt;</span>C<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>cb<span class='parenthesis'>)</span></span><a class='hidden_link' href='#stopcallback.cons-3.sentence-1'>.</a></div> <div id='stopcallback.cons-3.sentence-2' class='sentence'>If <span class='texttt'>st<span class='operator'>.</span>stop_&shy;requested<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span>, then
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>forward<span class='anglebracket'>&lt;</span>Callback<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>callback<span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
is evaluated in the current thread before the constructor returns<a class='hidden_link' href='#stopcallback.cons-3.sentence-2'>.</a></div> <div id='stopcallback.cons-3.sentence-3' class='sentence'>Otherwise, if <span class='texttt'>st</span> has ownership of a stop state,
acquires shared ownership of that stop state and registers
the callback with that stop state
such that <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>forward<span class='anglebracket'>&lt;</span>Callback<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>callback<span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
is evaluated by the first call to <span class='texttt'>request_&shy;stop<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
on an associated <span class='texttt'>stop_&shy;source</span><a class='hidden_link' href='#stopcallback.cons-3.sentence-3'>.</a></div></div></div></div><div class='para' id='stopcallback.cons-4'><div class='marginalizedparent'><a class='marginalized' href='#stopcallback.cons-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L931'>#</a></div><div class='texpara'><div id='stopcallback.cons-4.sentence-1' class='sentence'><i >Throws</i>: Any exception thrown by the initialization of <span class='texttt'>callback</span><a class='hidden_link' href='#stopcallback.cons-4.sentence-1'>.</a></div></div></div></div><div class='para' id='stopcallback.cons-5'><div class='marginalizedparent'><a class='marginalized' href='#stopcallback.cons-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L935'>#</a></div><div class='texpara'><div id='stopcallback.cons-5.sentence-1' class='sentence'><i >Remarks</i>: If evaluating
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>forward<span class='anglebracket'>&lt;</span>Callback<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>callback<span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
exits via an exception,
then <span class='texttt'>terminate</span> is invoked (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#stopcallback.cons-5.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:stop_callback,destructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:stop_callback,destructor'>🔗</a></div><code class='itemdeclcode'><span class='operator'>~</span>stop_callback<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='stopcallback.cons-6'><div class='marginalizedparent'><a class='marginalized' href='#stopcallback.cons-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L949'>#</a></div><div class='texpara'><div id='stopcallback.cons-6.sentence-1' class='sentence'><i >Effects</i>: Unregisters the callback from the owned stop state, if any<a class='hidden_link' href='#stopcallback.cons-6.sentence-1'>.</a></div> <div id='stopcallback.cons-6.sentence-2' class='sentence'>The destructor does not block waiting for the execution of another callback
registered by an associated <span class='texttt'>stop_&shy;callback</span><a class='hidden_link' href='#stopcallback.cons-6.sentence-2'>.</a></div> <div id='stopcallback.cons-6.sentence-3' class='sentence'>If <span class='texttt'>callback</span> is concurrently executing on another thread,
then the return from the invocation of <span class='texttt'>callback</span>
strongly happens before (<a href='intro.races' title='6.9.2.2&emsp;Data races'>[intro.<span class='shy'></span>races]</a>)
<span class='texttt'>callback</span> is destroyed<a class='hidden_link' href='#stopcallback.cons-6.sentence-3'>.</a></div> <div id='stopcallback.cons-6.sentence-4' class='sentence'>If <span class='texttt'>callback</span> is executing on the current thread,
then the destructor does not block (<a href='defns.block' title='3.7&emsp;block'>[defns.<span class='shy'></span>block]</a>) waiting for
the return from the invocation of <span class='texttt'>callback</span><a class='hidden_link' href='#stopcallback.cons-6.sentence-4'>.</a></div> <div id='stopcallback.cons-6.sentence-5' class='sentence'>Releases ownership of the stop state, if any<a class='hidden_link' href='#stopcallback.cons-6.sentence-5'>.</a></div></div></div></div></div></div></div><div id='threads' class='section'><h2 ><a class='secnum' href='#threads' style='min-width:65pt'>32.4</a> Threads <a class='abbr_ref' href='thread.threads'>[thread.threads]</a></h2><div id='threads.general' class='section'><h3 ><a class='secnum' href='#threads.general' style='min-width:80pt'>32.4.1</a> General <a class='abbr_ref' href='thread.threads.general'>[thread.threads.general]</a></h3><div class='para' id='threads.general-1'><div class='marginalizedparent'><a class='marginalized' href='#threads.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L969'>#</a></div><div class='texpara'><div id='threads.general-1.sentence-1' class='sentence'><a href='#threads' title='32.4&emsp;Threads'>[thread.<span class='shy'></span>threads]</a> describes components that can be used to create and manage threads<a class='hidden_link' href='#threads.general-1.sentence-1'>.</a></div> <div id='threads.general-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#threads.general-note-1'>1</a></i>: <div id='threads.general-1.sentence-2' class='sentence'>These threads are intended to map one-to-one with operating system threads<a class='hidden_link' href='#threads.general-1.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div id='syn' class='section'><h3 ><a class='secnum' href='#syn' style='min-width:80pt'>32.4.2</a> Header <span class='texttt'>&lt;thread&gt;</span> synopsis <a class='abbr_ref' href='thread.syn'>[thread.syn]</a></h3><div class='texpara'><span id='header:<thread>'><div class='marginalizedparent'><a class='itemDeclLink' href='#header:%3cthread%3e'>🔗</a></div><span class='codeblock'><span class='preprocessordirective'>#include</span> <span class='anglebracket'>&lt;</span>compare<span class='anglebracket'>&gt;</span>              <span class='comment'>// see <a href='compare.syn' title='17.11.1&emsp;Header &lt;compare&gt; synopsis'>[compare.<span class='shy'></span>syn]</a></span>

<span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>class</span> thread;

  <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>thread<span class='operator'>&amp;</span> x, thread<span class='operator'>&amp;</span> y<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

  <span class='comment'>// <a href='#jthread.class' title='32.4.4&emsp;Class jthread'>[thread.<span class='shy'></span>jthread.<span class='shy'></span>class]</a> class <span class='tcode_in_codeblock'>jthread</span></span>
  <span class='keyword'>class</span> jthread;

  <span class='keyword'>namespace</span> this_thread <span class='curlybracket'>{</span>
    thread<span class='operator'>::</span>id get_id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    <span class='keyword'>void</span> yield<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
      <span class='keyword'>void</span> sleep_until<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
      <span class='keyword'>void</span> sleep_for<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span>;
  <span class='curlybracket'>}</span>
<span class='curlybracket'>}</span>
</span></span></div></div><div id='thread.class' class='section'><h3 ><a class='secnum' href='#thread.class' style='min-width:80pt'>32.4.3</a> Class <span class='texttt'>thread</span> <a class='abbr_ref' href='thread.thread.class'>[thread.thread.class]</a></h3><div id='thread.class.general' class='section'><h4 ><a class='secnum' href='#thread.class.general' style='min-width:95pt'>32.4.3.1</a> General <a class='abbr_ref' href='thread.thread.class.general'>[thread.thread.class.general]</a></h4><div class='para' id='thread.class.general-1'><div class='marginalizedparent'><a class='marginalized' href='#thread.class.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1005'>#</a></div><div class='texpara'><div id='thread.class.general-1.sentence-1' class='sentence'>The class <span class='texttt'>thread</span> provides a mechanism to create a new thread of execution, to join with
a thread (i.e., wait for a thread to complete), and to perform other operations that manage and
query the state of a thread<a class='hidden_link' href='#thread.class.general-1.sentence-1'>.</a></div> <div id='thread.class.general-1.sentence-2' class='sentence'>A <span class='texttt'>thread</span> object uniquely represents a particular thread of
execution<a class='hidden_link' href='#thread.class.general-1.sentence-2'>.</a></div> <div id='thread.class.general-1.sentence-3' class='sentence'>That representation may be transferred to other <span class='texttt'>thread</span> objects in such a way
that no two <span class='texttt'>thread</span> objects simultaneously represent the same thread of execution<a class='hidden_link' href='#thread.class.general-1.sentence-3'>.</a></div> <div id='thread.class.general-1.sentence-4' class='sentence'>A
thread of execution is <a class='hidden_link' href='#def:detached' id='def:detached'><i>detached</i></a> when no <span class='texttt'>thread</span> object represents that thread<a class='hidden_link' href='#thread.class.general-1.sentence-4'>.</a></div> <div id='thread.class.general-1.sentence-5' class='sentence'>Objects of class <span class='texttt'>thread</span> can be in a state that does not represent a thread of
execution<a class='hidden_link' href='#thread.class.general-1.sentence-5'>.</a></div> <div id='thread.class.general-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#thread.class.general-note-1'>1</a></i>: <div id='thread.class.general-1.sentence-6' class='sentence'>A <span class='texttt'>thread</span> object does not represent a thread of execution after
default construction, after being moved from, or after a successful call to <span class='texttt'>detach</span> or
<span class='texttt'>join</span><a class='hidden_link' href='#thread.class.general-1.sentence-6'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div><div class='texpara'><span id='lib:thread'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:thread'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>class</span> thread <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    <span class='comment'>// types</span>
    <span class='keyword'>class</span> id;
    <span class='keyword'>using</span> native_handle_type <span class='operator'>=</span> <i >implementation-defined</i>;         <span class='comment'>// see <a href='#req.native' title='32.2.3&emsp;Native handles'>[thread.<span class='shy'></span>req.<span class='shy'></span>native]</a></span>

    <span class='comment'>// construct/copy/destroy</span>
    thread<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> F, <span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> Args<span class='anglebracket'>&gt;</span> <span class='keyword'>explicit</span> thread<span class='parenthesis'>(</span>F<span class='operator'>&amp;</span><span class='operator'>&amp;</span> f, Args<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> args<span class='parenthesis'>)</span>;
    <span class='operator'>~</span>thread<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    thread<span class='parenthesis'>(</span><span class='keyword'>const</span> thread<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    thread<span class='parenthesis'>(</span>thread<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    thread<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> thread<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    thread<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>thread<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    <span class='comment'>// members</span>
    <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>thread<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>bool</span> joinable<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>void</span> join<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>void</span> detach<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    id get_id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
    native_handle_type native_handle<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                         <span class='comment'>// see <a href='#req.native' title='32.2.3&emsp;Native handles'>[thread.<span class='shy'></span>req.<span class='shy'></span>native]</a></span>

    <span class='comment'>// static members</span>
    <span class='keyword'>static</span> <span class='keyword'>unsigned</span> <span class='keyword'>int</span> hardware_concurrency<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></div></div></div><div id='thread.id' class='section'><h4 ><a class='secnum' href='#thread.id' style='min-width:95pt'>32.4.3.2</a> Class <span class='texttt'>thread&#x200b;::&#x200b;id</span> <a class='abbr_ref' href='thread.thread.id'>[thread.thread.id]</a></h4><div class='texpara'><span id='lib:id,thread'><span id='lib:thread,id'><span id='lib:thread::id'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:thread::id'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>class</span> thread<span class='operator'>::</span>id <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
  <span class='curlybracket'>}</span>;

  <span class='keyword'>bool</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='operator'>=</span><span class='parenthesis'>(</span>thread<span class='operator'>::</span>id x, thread<span class='operator'>::</span>id y<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
  strong_ordering <span class='keyword'>operator</span><span class='anglebracket'>&lt;</span><span class='operator'>=</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>thread<span class='operator'>::</span>id x, thread<span class='operator'>::</span>id y<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> charT, <span class='keyword'>class</span> traits<span class='anglebracket'>&gt;</span>
    basic_ostream<span class='anglebracket'>&lt;</span>charT, traits<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span>
      <span class='keyword'>operator</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&lt;</span><span class='parenthesis'>(</span>basic_ostream<span class='anglebracket'>&lt;</span>charT, traits<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> out, thread<span class='operator'>::</span>id id<span class='parenthesis'>)</span>;

  <span class='comment'>// hash support</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> hash;
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> hash<span class='anglebracket'>&lt;</span>thread<span class='operator'>::</span>id<span class='anglebracket'>&gt;</span>;
<span class='curlybracket'>}</span>
</span></span></span></span></div><div class='para' id='thread.id-1'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1076'>#</a></div><div class='texpara'><div id='thread.id-1.sentence-1' class='sentence'>An object of type <span class='texttt'>thread<span class='operator'>&#x200b;::&#x200b;</span>id</span> provides a unique identifier for
each thread of execution and a single distinct value for all <span class='texttt'>thread</span>
objects that do not represent a thread of
execution (<a href='#thread.class' title='32.4.3&emsp;Class thread'>[thread.<span class='shy'></span>thread.<span class='shy'></span>class]</a>)<a class='hidden_link' href='#thread.id-1.sentence-1'>.</a></div> <div id='thread.id-1.sentence-2' class='sentence'>Each thread of execution has an
associated <span class='texttt'>thread<span class='operator'>&#x200b;::&#x200b;</span>id</span> object that is not equal to the
<span class='texttt'>thread<span class='operator'>&#x200b;::&#x200b;</span>id</span> object of any other thread of execution and that is not
equal to the <span class='texttt'>thread<span class='operator'>&#x200b;::&#x200b;</span>id</span> object of any <span class='texttt'>thread</span> object that
does not represent threads of execution<a class='hidden_link' href='#thread.id-1.sentence-2'>.</a></div></div></div><div class='para' id='thread.id-2'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1086'>#</a></div><div class='texpara'><div id='thread.id-2.sentence-1' class='sentence'><span class='texttt'>thread<span class='operator'>&#x200b;::&#x200b;</span>id</span> is a trivially copyable class (<a href='class.prop' title='11.2&emsp;Properties of classes'>[class.<span class='shy'></span>prop]</a>)<a class='hidden_link' href='#thread.id-2.sentence-1'>.</a></div> <div id='thread.id-2.sentence-2' class='sentence'>The library may reuse the value of a <span class='texttt'>thread<span class='operator'>&#x200b;::&#x200b;</span>id</span> of a terminated thread that can no longer be joined<a class='hidden_link' href='#thread.id-2.sentence-2'>.</a></div></div></div><div class='para nonNormativeOnly' id='thread.id-3'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1090'>#</a></div><div class='texpara'><div id='thread.id-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#thread.id-note-1'>1</a></i>: <div id='thread.id-3.sentence-1' class='sentence'>Relational operators allow <span class='texttt'>thread<span class='operator'>&#x200b;::&#x200b;</span>id</span> objects to be used as
keys in associative containers<a class='hidden_link' href='#thread.id-3.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='texpara'><div id='lib:thread::id,constructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:thread::id,constructor'>🔗</a></div><code class='itemdeclcode'>id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='thread.id-4'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1102'>#</a></div><div class='texpara'><div id='thread.id-4.sentence-1' class='sentence'><i >Postconditions</i>: The constructed object does not represent a thread of execution<a class='hidden_link' href='#thread.id-4.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:thread::id,operator=='><div id='lib:operator==,thread::id'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:operator==,thread::id'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>bool</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='operator'>=</span><span class='parenthesis'>(</span>thread<span class='operator'>::</span>id x, thread<span class='operator'>::</span>id y<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='thread.id-5'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1113'>#</a></div><div class='texpara'><div id='thread.id-5.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>true</span></span> only if <span class='texttt'>x</span> and <span class='texttt'>y</span> represent the same
thread of execution or neither <span class='texttt'>x</span> nor <span class='texttt'>y</span> represents a thread of
execution<a class='hidden_link' href='#thread.id-5.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:thread::id,operator<=>'><div id='lib:operator<=>,thread::id'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:operator%3c=%3e,thread::id'>🔗</a></div><code class='itemdeclcode'>strong_ordering <span class='keyword'>operator</span><span class='anglebracket'>&lt;</span><span class='operator'>=</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>thread<span class='operator'>::</span>id x, thread<span class='operator'>::</span>id y<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='thread.id-6'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1126'>#</a></div><div class='texpara'><div id='thread.id-6.sentence-1' class='sentence'>Let <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.109em;">P</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.225em; padding-bottom: 0.225em;">x</span></span></span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span><span class="mjx-texatom MJXc-space1"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.225em; padding-bottom: 0.519em;">y</span></span></span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span> be
an unspecified total ordering over <span class='texttt'>thread<span class='operator'>&#x200b;::&#x200b;</span>id</span>
as described in <a href='alg.sorting' title='25.8&emsp;Sorting and related operations'>[alg.<span class='shy'></span>sorting]</a><a class='hidden_link' href='#thread.id-6.sentence-1'>.</a></div></div></div></div><div class='para' id='thread.id-7'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1131'>#</a></div><div class='texpara'><div id='thread.id-7.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>strong_&shy;ordering<span class='operator'>&#x200b;::&#x200b;</span>less</span> if <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.109em;">P</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.225em; padding-bottom: 0.225em;">x</span></span></span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span><span class="mjx-texatom MJXc-space1"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.225em; padding-bottom: 0.519em;">y</span></span></span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#thread.id-7.sentence-1'>.</a></div> <div id='thread.id-7.sentence-2' class='sentence'>Otherwise, <span class='texttt'>strong_&shy;ordering<span class='operator'>&#x200b;::&#x200b;</span>greater</span>
if <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.109em;">P</span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">(</span></span><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.225em; padding-bottom: 0.519em;">y</span></span></span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="margin-top: -0.144em; padding-bottom: 0.519em;">,</span></span><span class="mjx-texatom MJXc-space1"><span class="mjx-mrow"><span class="mjx-mtext"><span class="mjx-char MJXc-TeX-type-R" style="padding-top: 0.225em; padding-bottom: 0.225em;">x</span></span></span></span><span class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.446em; padding-bottom: 0.593em;">)</span></span></span></span></span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#thread.id-7.sentence-2'>.</a></div> <div id='thread.id-7.sentence-3' class='sentence'>Otherwise, <span class='texttt'>strong_&shy;ordering<span class='operator'>&#x200b;::&#x200b;</span>equal</span><a class='hidden_link' href='#thread.id-7.sentence-3'>.</a></div></div></div></div><div class='texpara'><div id='lib:thread::id,operator<<'><div id='lib:operator<<,thread::id'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:operator%3c%3c,thread::id'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> charT, <span class='keyword'>class</span> traits<span class='anglebracket'>&gt;</span>
  basic_ostream<span class='anglebracket'>&lt;</span>charT, traits<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span>
    <span class='keyword'>operator</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&lt;</span> <span class='parenthesis'>(</span>basic_ostream<span class='anglebracket'>&lt;</span>charT, traits<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> out, thread<span class='operator'>::</span>id id<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='thread.id-8'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1147'>#</a></div><div class='texpara'><div id='thread.id-8.sentence-1' class='sentence'><i >Effects</i>: Inserts an unspecified text representation of <span class='texttt'>id</span> into
<span class='texttt'>out</span><a class='hidden_link' href='#thread.id-8.sentence-1'>.</a></div> <div id='thread.id-8.sentence-2' class='sentence'>For two objects of type <span class='texttt'>thread<span class='operator'>&#x200b;::&#x200b;</span>id</span> <span class='texttt'>x</span> and <span class='texttt'>y</span>,
if <span class='texttt'>x <span class='operator'>=</span><span class='operator'>=</span> y</span> the <span class='texttt'>thread<span class='operator'>&#x200b;::&#x200b;</span>id</span> objects have the same text
representation and if <span class='texttt'>x <span class='operator'>!</span><span class='operator'>=</span> y</span> the <span class='texttt'>thread<span class='operator'>&#x200b;::&#x200b;</span>id</span> objects have
distinct text representations<a class='hidden_link' href='#thread.id-8.sentence-2'>.</a></div></div></div></div><div class='para' id='thread.id-9'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1155'>#</a></div><div class='texpara'><div id='thread.id-9.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>out</span><a class='hidden_link' href='#thread.id-9.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:thread::id,hash'><div id='lib:hash,thread::id'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:hash,thread::id'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> hash<span class='anglebracket'>&lt;</span>thread<span class='operator'>::</span>id<span class='anglebracket'>&gt;</span>;
</code></div></div></div></div><div class='para' id='thread.id-10'><div class='marginalizedparent'><a class='marginalized' href='#thread.id-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1166'>#</a></div><div class='texpara'><div id='thread.id-10.sentence-1' class='sentence'>The specialization is enabled (<a href='unord.hash' title='20.14.19&emsp;Class template hash'>[unord.<span class='shy'></span>hash]</a>)<a class='hidden_link' href='#thread.id-10.sentence-1'>.</a></div></div></div></div></div><div id='thread.constr' class='section'><h4 ><a class='secnum' href='#thread.constr' style='min-width:95pt'>32.4.3.3</a> Constructors <a class='abbr_ref' href='thread.thread.constr'>[thread.thread.constr]</a></h4><div class='texpara'><div id='lib:thread,constructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:thread,constructor'>🔗</a></div><code class='itemdeclcode'>thread<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='thread.constr-1'><div class='marginalizedparent'><a class='marginalized' href='#thread.constr-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1178'>#</a></div><div class='texpara'><div id='thread.constr-1.sentence-1' class='sentence'><i >Effects</i>: The object does not represent a thread of execution<a class='hidden_link' href='#thread.constr-1.sentence-1'>.</a></div></div></div></div><div class='para' id='thread.constr-2'><div class='marginalizedparent'><a class='marginalized' href='#thread.constr-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1182'>#</a></div><div class='texpara'><div id='thread.constr-2.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#thread.constr-2.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:thread,constructor_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:thread,constructor_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> F, <span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> Args<span class='anglebracket'>&gt;</span> <span class='keyword'>explicit</span> thread<span class='parenthesis'>(</span>F<span class='operator'>&amp;</span><span class='operator'>&amp;</span> f, Args<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> args<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='thread.constr-3'><div class='marginalizedparent'><a class='marginalized' href='#thread.constr-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1193'>#</a></div><div class='texpara'><div id='thread.constr-3.sentence-1' class='sentence'><i >Constraints</i>: <span class='texttt'>remove_&shy;cvref_&shy;t<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span></span> is not the same type as <span class='texttt'>thread</span><a class='hidden_link' href='#thread.constr-3.sentence-1'>.</a></div></div></div></div><div class='para' id='thread.constr-4'><div class='marginalizedparent'><a class='marginalized' href='#thread.constr-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1197'>#</a></div><div class='texpara'><div id='thread.constr-4.sentence-1' class='sentence'><i >Mandates</i>: The following are all <span class='texttt'><span class='literal'>true</span></span>:
<ul class='itemize'><li id='thread.constr-4.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#thread.constr-4.1'>(4.1)</a></div><span class='texttt'>is_&shy;constructible_&shy;v<span class='anglebracket'>&lt;</span>decay_&shy;t<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span>, F<span class='anglebracket'>&gt;</span></span>,</li><li id='thread.constr-4.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#thread.constr-4.2'>(4.2)</a></div><span class='texttt'><span class='parenthesis'>(</span>is_&shy;constructible_&shy;v<span class='anglebracket'>&lt;</span>decay_&shy;t<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span>, Args<span class='anglebracket'>&gt;</span> <span class='operator'>&amp;</span><span class='operator'>&amp;</span> <span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span></span>, and</li><li id='thread.constr-4.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#thread.constr-4.3'>(4.3)</a></div><span class='texttt'>is_&shy;invocable_&shy;v<span class='anglebracket'>&lt;</span>decay_&shy;t<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span>, decay_&shy;t<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#thread.constr-4.sentence-1'>.</a></li></ul></div></div></div></div><div class='para' id='thread.constr-5'><div class='marginalizedparent'><a class='marginalized' href='#thread.constr-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1206'>#</a></div><div class='texpara'><div id='thread.constr-5.sentence-1' class='sentence'><i >Effects</i>: The new thread of execution executes
<span class='codeblock'>invoke<span class='parenthesis'>(</span><i >decay-copy</i><span class='parenthesis'>(</span>std<span class='operator'>::</span>forward<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>f<span class='parenthesis'>)</span><span class='parenthesis'>)</span>, <i >decay-copy</i><span class='parenthesis'>(</span>std<span class='operator'>::</span>forward<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>args<span class='parenthesis'>)</span><span class='parenthesis'>)</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>
</span>
with the calls to
<span class='texttt'><i >decay-copy</i></span> being evaluated in the constructing thread<a class='hidden_link' href='#thread.constr-5.sentence-1'>.</a></div> <div id='thread.constr-5.sentence-2' class='sentence'>Any return value from this invocation is ignored<a class='hidden_link' href='#thread.constr-5.sentence-2'>.</a></div> <div id='thread.constr-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#thread.constr-note-1'>1</a></i>: <div id='thread.constr-5.sentence-3' class='sentence'>This implies that any exceptions not thrown from the invocation of the copy
of <span class='texttt'>f</span> will be thrown in the constructing thread, not the new thread<a class='hidden_link' href='#thread.constr-5.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='thread.constr-5.sentence-4' class='sentence'>
If the invocation of <span class='texttt'>invoke</span> terminates with an uncaught exception,
<span class='texttt'>terminate</span> is invoked (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#thread.constr-5.sentence-4'>.</a></div></div></div></div><div class='para' id='thread.constr-6'><div class='marginalizedparent'><a class='marginalized' href='#thread.constr-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1222'>#</a></div><div class='texpara'><div id='thread.constr-6.sentence-1' class='sentence'><i >Synchronization</i>: The completion of the invocation of the constructor
synchronizes with the beginning of the invocation of the copy of <span class='texttt'>f</span><a class='hidden_link' href='#thread.constr-6.sentence-1'>.</a></div></div></div></div><div class='para' id='thread.constr-7'><div class='marginalizedparent'><a class='marginalized' href='#thread.constr-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1227'>#</a></div><div class='texpara'><div id='thread.constr-7.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>!</span><span class='operator'>=</span> id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#thread.constr-7.sentence-1'>.</a></div> <div id='thread.constr-7.sentence-2' class='sentence'><span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> represents the newly started thread<a class='hidden_link' href='#thread.constr-7.sentence-2'>.</a></div></div></div></div><div class='para' id='thread.constr-8'><div class='marginalizedparent'><a class='marginalized' href='#thread.constr-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1231'>#</a></div><div class='texpara'><div id='thread.constr-8.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>system_&shy;error</span> if unable to start the new thread<a class='hidden_link' href='#thread.constr-8.sentence-1'>.</a></div></div></div></div><div class='para' id='thread.constr-9'><div class='marginalizedparent'><a class='marginalized' href='#thread.constr-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1235'>#</a></div><div class='texpara'><div id='thread.constr-9.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='thread.constr-9.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#thread.constr-9.1'>(9.1)</a></div><span class='texttt'>resource_&shy;unavailable_&shy;try_&shy;again</span> — the system lacked the necessary
resources to create another thread, or the system-imposed limit on the number of
threads in a process would be exceeded<a class='hidden_link' href='#thread.constr-9.sentence-1'>.</a></li></ul></div></div></div></div><div class='texpara'><div id='lib:thread,constructor__'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:thread,constructor__'>🔗</a></div><code class='itemdeclcode'>thread<span class='parenthesis'>(</span>thread<span class='operator'>&amp;</span><span class='operator'>&amp;</span> x<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='thread.constr-10'><div class='marginalizedparent'><a class='marginalized' href='#thread.constr-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1250'>#</a></div><div class='texpara'><div id='thread.constr-10.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>x<span class='operator'>.</span>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> and <span class='texttt'>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns the
value of <span class='texttt'>x<span class='operator'>.</span>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> prior to the start of construction<a class='hidden_link' href='#thread.constr-10.sentence-1'>.</a></div></div></div></div></div><div id='thread.destr' class='section'><h4 ><a class='secnum' href='#thread.destr' style='min-width:95pt'>32.4.3.4</a> Destructor <a class='abbr_ref' href='thread.thread.destr'>[thread.thread.destr]</a></h4><div class='texpara'><div id='lib:thread,destructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:thread,destructor'>🔗</a></div><code class='itemdeclcode'><span class='operator'>~</span>thread<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='thread.destr-1'><div class='marginalizedparent'><a class='marginalized' href='#thread.destr-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1264'>#</a></div><div class='texpara'><div id='thread.destr-1.sentence-1' class='sentence'><i >Effects</i>: If <span class='texttt'>joinable<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, invokes <span class='texttt'>terminate</span> (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#thread.destr-1.sentence-1'>.</a></div> <div id='thread.destr-1.sentence-2' class='sentence'>Otherwise, has no effects<a class='hidden_link' href='#thread.destr-1.sentence-2'>.</a></div> <div id='thread.destr-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#thread.destr-note-1'>1</a></i>: <div id='thread.destr-1.sentence-3' class='sentence'>Either implicitly detaching or joining a <span class='texttt'>joinable<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> thread in its
destructor can result in difficult to debug correctness (for detach) or performance
(for join) bugs encountered only when an exception is thrown<a class='hidden_link' href='#thread.destr-1.sentence-3'>.</a></div> <div id='thread.destr-1.sentence-4' class='sentence'>These bugs can be avoided by ensuring that
the destructor is never executed while the thread is still joinable<a class='hidden_link' href='#thread.destr-1.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div></div><div id='thread.assign' class='section'><h4 ><a class='secnum' href='#thread.assign' style='min-width:95pt'>32.4.3.5</a> Assignment <a class='abbr_ref' href='thread.thread.assign'>[thread.thread.assign]</a></h4><div class='texpara'><div id='lib:thread,operator='><div id='lib:operator=,thread'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:operator=,thread'>🔗</a></div><code class='itemdeclcode'>thread<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>thread<span class='operator'>&amp;</span><span class='operator'>&amp;</span> x<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='thread.assign-1'><div class='marginalizedparent'><a class='marginalized' href='#thread.assign-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1285'>#</a></div><div class='texpara'><div id='thread.assign-1.sentence-1' class='sentence'><i >Effects</i>: If <span class='texttt'>joinable<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, invokes <span class='texttt'>terminate</span> (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#thread.assign-1.sentence-1'>.</a></div> <div id='thread.assign-1.sentence-2' class='sentence'>Otherwise, assigns the
state of <span class='texttt'>x</span> to <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> and sets <span class='texttt'>x</span> to a default constructed state<a class='hidden_link' href='#thread.assign-1.sentence-2'>.</a></div></div></div></div><div class='para' id='thread.assign-2'><div class='marginalizedparent'><a class='marginalized' href='#thread.assign-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1291'>#</a></div><div class='texpara'><div id='thread.assign-2.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>x<span class='operator'>.</span>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> and <span class='texttt'>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns the value of
<span class='texttt'>x<span class='operator'>.</span>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> prior to the assignment<a class='hidden_link' href='#thread.assign-2.sentence-1'>.</a></div></div></div></div><div class='para' id='thread.assign-3'><div class='marginalizedparent'><a class='marginalized' href='#thread.assign-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1296'>#</a></div><div class='texpara'><div id='thread.assign-3.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#thread.assign-3.sentence-1'>.</a></div></div></div></div></div><div id='thread.member' class='section'><h4 ><a class='secnum' href='#thread.member' style='min-width:95pt'>32.4.3.6</a> Members <a class='abbr_ref' href='thread.thread.member'>[thread.thread.member]</a></h4><div class='texpara'><div id='lib:thread,swap'><div id='lib:swap,thread'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:swap,thread'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> swap<span class='parenthesis'>(</span>thread<span class='operator'>&amp;</span> x<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='thread.member-1'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1309'>#</a></div><div class='texpara'><div id='thread.member-1.sentence-1' class='sentence'><i >Effects</i>: Swaps the state of <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> and <span class='texttt'>x</span><a class='hidden_link' href='#thread.member-1.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:thread,joinable'><div id='lib:joinable,thread'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:joinable,thread'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>bool</span> joinable<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='thread.member-2'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1320'>#</a></div><div class='texpara'><div id='thread.member-2.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>!</span><span class='operator'>=</span> id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#thread.member-2.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:thread,join'><div id='lib:join,thread'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:join,thread'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> join<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='thread.member-3'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1331'>#</a></div><div class='texpara'><div id='thread.member-3.sentence-1' class='sentence'><a class='index' id=':block_(execution)_'></a><i >Effects</i>: Blocks until the thread represented by <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> has completed<a class='hidden_link' href='#thread.member-3.sentence-1'>.</a></div></div></div></div><div class='para' id='thread.member-4'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1336'>#</a></div><div class='texpara'><div id='thread.member-4.sentence-1' class='sentence'><i >Synchronization</i>: The completion of the thread represented by <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> synchronizes with (<a href='intro.multithread' title='6.9.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>)
the corresponding successful
<span class='texttt'>join<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> return<a class='hidden_link' href='#thread.member-4.sentence-1'>.</a></div> <div id='thread.member-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#thread.member-note-1'>1</a></i>: <div id='thread.member-4.sentence-2' class='sentence'>Operations on
<span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> are not synchronized<a class='hidden_link' href='#thread.member-4.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='thread.member-5'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1346'>#</a></div><div class='texpara'><div id='thread.member-5.sentence-1' class='sentence'><i >Postconditions</i>: The thread represented by <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> has completed<a class='hidden_link' href='#thread.member-5.sentence-1'>.</a></div> <div id='thread.member-5.sentence-2' class='sentence'><span class='texttt'>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#thread.member-5.sentence-2'>.</a></div></div></div></div><div class='para' id='thread.member-6'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1350'>#</a></div><div class='texpara'><div id='thread.member-6.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>system_&shy;error</span> when
an exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#thread.member-6.sentence-1'>.</a></div></div></div></div><div class='para' id='thread.member-7'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1355'>#</a></div><div class='texpara'><div id='thread.member-7.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='thread.member-7.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#thread.member-7.1'>(7.1)</a></div><div class='texpara'><div id='thread.member-7.1.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if deadlock is detected or
<span class='texttt'>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> this_&shy;thread<span class='operator'>&#x200b;::&#x200b;</span>&#x200b;get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#thread.member-7.1.sentence-1'>.</a></div></div></li><li id='thread.member-7.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#thread.member-7.2'>(7.2)</a></div><div class='texpara'><div id='thread.member-7.2.sentence-1' class='sentence'><span class='texttt'>no_&shy;such_&shy;process</span> — if the thread is not valid<a class='hidden_link' href='#thread.member-7.2.sentence-1'>.</a></div></div></li><li id='thread.member-7.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#thread.member-7.3'>(7.3)</a></div><div class='texpara'><div id='thread.member-7.3.sentence-1' class='sentence'><span class='texttt'>invalid_&shy;argument</span> — if the thread is not joinable<a class='hidden_link' href='#thread.member-7.3.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:thread,detach'><div id='lib:detach,thread'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:detach,thread'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> detach<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='thread.member-8'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1373'>#</a></div><div class='texpara'><div id='thread.member-8.sentence-1' class='sentence'><i >Effects</i>: The thread represented by <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> continues execution without the calling thread
blocking<a class='hidden_link' href='#thread.member-8.sentence-1'>.</a></div> <div id='thread.member-8.sentence-2' class='sentence'>When <span class='texttt'>detach<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns, <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> no longer represents the possibly continuing
thread of execution<a class='hidden_link' href='#thread.member-8.sentence-2'>.</a></div> <div id='thread.member-8.sentence-3' class='sentence'>When the thread previously represented by <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> ends execution, the
implementation releases any owned resources<a class='hidden_link' href='#thread.member-8.sentence-3'>.</a></div></div></div></div><div class='para' id='thread.member-9'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1380'>#</a></div><div class='texpara'><div id='thread.member-9.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#thread.member-9.sentence-1'>.</a></div></div></div></div><div class='para' id='thread.member-10'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1384'>#</a></div><div class='texpara'><div id='thread.member-10.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>system_&shy;error</span> when
an exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#thread.member-10.sentence-1'>.</a></div></div></div></div><div class='para' id='thread.member-11'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1389'>#</a></div><div class='texpara'><div id='thread.member-11.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='thread.member-11.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#thread.member-11.1'>(11.1)</a></div><div class='texpara'><div id='thread.member-11.1.sentence-1' class='sentence'><span class='texttt'>no_&shy;such_&shy;process</span> — if the thread is not valid<a class='hidden_link' href='#thread.member-11.1.sentence-1'>.</a></div></div></li><li id='thread.member-11.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#thread.member-11.2'>(11.2)</a></div><div class='texpara'><div id='thread.member-11.2.sentence-1' class='sentence'><span class='texttt'>invalid_&shy;argument</span> — if the thread is not joinable<a class='hidden_link' href='#thread.member-11.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:thread,get_id'><div id='lib:get_id,thread'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:get_id,thread'>🔗</a></div><code class='itemdeclcode'>id get_id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='thread.member-12'><div class='marginalizedparent'><a class='marginalized' href='#thread.member-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1403'>#</a></div><div class='texpara'><div id='thread.member-12.sentence-1' class='sentence'><i >Returns</i>: A default constructed <span class='texttt'>id</span> object if <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> does not represent a thread,
otherwise <span class='texttt'>this_&shy;thread<span class='operator'>&#x200b;::&#x200b;</span>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> for the thread of execution represented by
<span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#thread.member-12.sentence-1'>.</a></div></div></div></div></div><div id='thread.static' class='section'><h4 ><a class='secnum' href='#thread.static' style='min-width:95pt'>32.4.3.7</a> Static members <a class='abbr_ref' href='thread.thread.static'>[thread.thread.static]</a></h4><div class='texpara'><div id='lib:thread,hardware_concurrency'><div id='lib:hardware_concurrency,thread'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:hardware_concurrency,thread'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>unsigned</span> hardware_concurrency<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='thread.static-1'><div class='marginalizedparent'><a class='marginalized' href='#thread.static-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1418'>#</a></div><div class='texpara'><div id='thread.static-1.sentence-1' class='sentence'><i >Returns</i>: The number of hardware thread contexts<a class='hidden_link' href='#thread.static-1.sentence-1'>.</a></div> <div id='thread.static-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#thread.static-note-1'>1</a></i>: <div id='thread.static-1.sentence-2' class='sentence'>This value should
only be considered to be a hint<a class='hidden_link' href='#thread.static-1.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='thread.static-1.sentence-3' class='sentence'>
If this value is not computable or
well-defined, an implementation should return 0<a class='hidden_link' href='#thread.static-1.sentence-3'>.</a></div></div></div></div></div><div id='thread.algorithm' class='section'><h4 ><a class='secnum' href='#thread.algorithm' style='min-width:95pt'>32.4.3.8</a> Specialized algorithms <a class='abbr_ref' href='thread.thread.algorithm'>[thread.thread.algorithm]</a></h4><div class='texpara'><div id='lib:thread,swap_'><div id='lib:swap,thread_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:swap,thread_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> swap<span class='parenthesis'>(</span>thread<span class='operator'>&amp;</span> x, thread<span class='operator'>&amp;</span> y<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='thread.algorithm-1'><div class='marginalizedparent'><a class='marginalized' href='#thread.algorithm-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1437'>#</a></div><div class='texpara'><div id='thread.algorithm-1.sentence-1' class='sentence'><i >Effects</i>: As if by <span class='texttt'>x<span class='operator'>.</span>swap<span class='parenthesis'>(</span>y<span class='parenthesis'>)</span></span><a class='hidden_link' href='#thread.algorithm-1.sentence-1'>.</a></div></div></div></div></div></div><div id='jthread.class' class='section'><h3 ><a class='secnum' href='#jthread.class' style='min-width:80pt'>32.4.4</a> Class <span class='texttt'>jthread</span> <a class='abbr_ref' href='thread.jthread.class'>[thread.jthread.class]</a></h3><div id='jthread.class.general' class='section'><h4 ><a class='secnum' href='#jthread.class.general' style='min-width:95pt'>32.4.4.1</a> General <a class='abbr_ref' href='thread.jthread.class.general'>[thread.jthread.class.general]</a></h4><div class='para' id='jthread.class.general-1'><div class='marginalizedparent'><a class='marginalized' href='#jthread.class.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1446'>#</a></div><div class='texpara'><div id='jthread.class.general-1.sentence-1' class='sentence'>The class <span class='texttt'>jthread</span> provides a mechanism
to create a new thread of execution<a class='hidden_link' href='#jthread.class.general-1.sentence-1'>.</a></div> <div id='jthread.class.general-1.sentence-2' class='sentence'>The functionality is the same as for
class <span class='texttt'>thread</span> (<a href='#thread.class' title='32.4.3&emsp;Class thread'>[thread.<span class='shy'></span>thread.<span class='shy'></span>class]</a>)
with the additional abilities to provide
a <span class='texttt'>stop_&shy;token</span> (<a href='#stoptoken' title='32.3&emsp;Stop tokens'>[thread.<span class='shy'></span>stoptoken]</a>) to the new thread of execution,
make stop requests, and automatically join<a class='hidden_link' href='#jthread.class.general-1.sentence-2'>.</a></div></div><div class='texpara'><span id='lib:jthread'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:jthread'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>class</span> jthread <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    <span class='comment'>// types</span>
    <span class='keyword'>using</span> id <span class='operator'>=</span> thread<span class='operator'>::</span>id;
    <span class='keyword'>using</span> native_handle_type <span class='operator'>=</span> thread<span class='operator'>::</span>native_handle_type;

    <span class='comment'>// <a href='#jthread.cons' title='32.4.4.2&emsp;Constructors, move, and assignment'>[thread.<span class='shy'></span>jthread.<span class='shy'></span>cons]</a>, constructors, move, and assignment</span>
    jthread<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> F, <span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> Args<span class='anglebracket'>&gt;</span> <span class='keyword'>explicit</span> jthread<span class='parenthesis'>(</span>F<span class='operator'>&amp;</span><span class='operator'>&amp;</span> f, Args<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> args<span class='parenthesis'>)</span>;
    <span class='operator'>~</span>jthread<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    jthread<span class='parenthesis'>(</span><span class='keyword'>const</span> jthread<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    jthread<span class='parenthesis'>(</span>jthread<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    jthread<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> jthread<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    jthread<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>jthread<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    <span class='comment'>// <a href='#jthread.mem' title='32.4.4.3&emsp;Members'>[thread.<span class='shy'></span>jthread.<span class='shy'></span>mem]</a>, members</span>
    <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>jthread<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='keyword'>bool</span> joinable<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>void</span> join<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>void</span> detach<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> id get_id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
    <span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> native_handle_type native_handle<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;   <span class='comment'>// see <a href='#req.native' title='32.2.3&emsp;Native handles'>[thread.<span class='shy'></span>req.<span class='shy'></span>native]</a></span>

    <span class='comment'>// <a href='#jthread.stop' title='32.4.4.4&emsp;Stop token handling'>[thread.<span class='shy'></span>jthread.<span class='shy'></span>stop]</a>, stop token handling</span>
    <span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> stop_source get_stop_source<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> stop_token get_stop_token<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>bool</span> request_stop<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    <span class='comment'>// <a href='#jthread.special' title='32.4.4.5&emsp;Specialized algorithms'>[thread.<span class='shy'></span>jthread.<span class='shy'></span>special]</a>, specialized algorithms</span>
    <span class='keyword'>friend</span> <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>jthread<span class='operator'>&amp;</span> lhs, jthread<span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    <span class='comment'>// <a href='#jthread.static' title='32.4.4.6&emsp;Static members'>[thread.<span class='shy'></span>jthread.<span class='shy'></span>static]</a>, static members</span>
    <span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='keyword'>static</span> <span class='keyword'>unsigned</span> <span class='keyword'>int</span> hardware_concurrency<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

  <span class='keyword'>private</span><span class='operator'>:</span>
    stop_source ssource;        <span class='comment'>// <i >exposition only</i></span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></div></div></div><div id='jthread.cons' class='section'><h4 ><a class='secnum' href='#jthread.cons' style='min-width:95pt'>32.4.4.2</a> Constructors, move, and assignment <a class='abbr_ref' href='thread.jthread.cons'>[thread.jthread.cons]</a></h4><div class='texpara'><div id='lib:jthread,constructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:jthread,constructor'>🔗</a></div><code class='itemdeclcode'>jthread<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='jthread.cons-1'><div class='marginalizedparent'><a class='marginalized' href='#jthread.cons-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1506'>#</a></div><div class='texpara'><div id='jthread.cons-1.sentence-1' class='sentence'><i >Effects</i>: Constructs a <span class='texttt'>jthread</span> object that does not represent
a thread of execution<a class='hidden_link' href='#jthread.cons-1.sentence-1'>.</a></div></div></div></div><div class='para' id='jthread.cons-2'><div class='marginalizedparent'><a class='marginalized' href='#jthread.cons-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1511'>#</a></div><div class='texpara'><div id='jthread.cons-2.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span>
and <span class='texttt'>ssource<span class='operator'>.</span>stop_&shy;possible<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#jthread.cons-2.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:jthread,constructor_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:jthread,constructor_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> F, <span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> Args<span class='anglebracket'>&gt;</span> <span class='keyword'>explicit</span> jthread<span class='parenthesis'>(</span>F<span class='operator'>&amp;</span><span class='operator'>&amp;</span> f, Args<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> args<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='jthread.cons-3'><div class='marginalizedparent'><a class='marginalized' href='#jthread.cons-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1523'>#</a></div><div class='texpara'><div id='jthread.cons-3.sentence-1' class='sentence'><i >Constraints</i>: <span class='texttt'>remove_&shy;cvref_&shy;t<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span></span> is not the same type as <span class='texttt'>jthread</span><a class='hidden_link' href='#jthread.cons-3.sentence-1'>.</a></div></div></div></div><div class='para' id='jthread.cons-4'><div class='marginalizedparent'><a class='marginalized' href='#jthread.cons-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1527'>#</a></div><div class='texpara'><div id='jthread.cons-4.sentence-1' class='sentence'><i >Mandates</i>: The following are all <span class='texttt'><span class='literal'>true</span></span>:
<ul class='itemize'><li id='jthread.cons-4.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#jthread.cons-4.1'>(4.1)</a></div><span class='texttt'>is_&shy;constructible_&shy;v<span class='anglebracket'>&lt;</span>decay_&shy;t<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span>, F<span class='anglebracket'>&gt;</span></span>,</li><li id='jthread.cons-4.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#jthread.cons-4.2'>(4.2)</a></div><span class='texttt'><span class='parenthesis'>(</span>is_&shy;constructible_&shy;v<span class='anglebracket'>&lt;</span>decay_&shy;t<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span>, Args<span class='anglebracket'>&gt;</span> <span class='operator'>&amp;</span><span class='operator'>&amp;</span> <span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span></span>, and</li><li id='jthread.cons-4.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#jthread.cons-4.3'>(4.3)</a></div><span class='texttt'>is_&shy;invocable_&shy;v<span class='anglebracket'>&lt;</span>decay_&shy;t<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span>, decay_&shy;t<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span> <span class='operator'>|</span><span class='operator'>|</span></span> <br/> <div class='texpara'><div id='jthread.cons-4.3.sentence-2' class='sentence'> <span class='texttt'>is_&shy;invocable_&shy;v<span class='anglebracket'>&lt;</span>decay_&shy;t<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span>, stop_&shy;token, decay_&shy;t<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#jthread.cons-4.3.sentence-2'>.</a></div></div></li></ul></div></div></div></div><div class='para' id='jthread.cons-5'><div class='marginalizedparent'><a class='marginalized' href='#jthread.cons-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1536'>#</a></div><div class='texpara'><div id='jthread.cons-5.sentence-1' class='sentence'><i >Effects</i>: Initializes <span class='texttt'>ssource</span><a class='hidden_link' href='#jthread.cons-5.sentence-1'>.</a></div> <div id='jthread.cons-5.sentence-2' class='sentence'>The new thread of execution executes
<span class='codeblock'>invoke<span class='parenthesis'>(</span><i >decay-copy</i><span class='parenthesis'>(</span>std<span class='operator'>::</span>forward<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>f<span class='parenthesis'>)</span><span class='parenthesis'>)</span>, get_stop_token<span class='parenthesis'>(</span><span class='parenthesis'>)</span>,
       <i >decay-copy</i><span class='parenthesis'>(</span>std<span class='operator'>::</span>forward<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>args<span class='parenthesis'>)</span><span class='parenthesis'>)</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>
</span>
if that expression is well-formed,
otherwise
<span class='codeblock'>invoke<span class='parenthesis'>(</span><i >decay-copy</i><span class='parenthesis'>(</span>std<span class='operator'>::</span>forward<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>f<span class='parenthesis'>)</span><span class='parenthesis'>)</span>, <i >decay-copy</i><span class='parenthesis'>(</span>std<span class='operator'>::</span>forward<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>args<span class='parenthesis'>)</span><span class='parenthesis'>)</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>
</span>
with the calls to
<span class='texttt'><i >decay-copy</i></span> being evaluated in the constructing thread<a class='hidden_link' href='#jthread.cons-5.sentence-2'>.</a></div> <div id='jthread.cons-5.sentence-3' class='sentence'>Any return value from this invocation is ignored<a class='hidden_link' href='#jthread.cons-5.sentence-3'>.</a></div> <div id='jthread.cons-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#jthread.cons-note-1'>1</a></i>: <div id='jthread.cons-5.sentence-4' class='sentence'>This implies that any exceptions not thrown from the invocation of the copy
of <span class='texttt'>f</span> will be thrown in the constructing thread, not the new thread<a class='hidden_link' href='#jthread.cons-5.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='jthread.cons-5.sentence-5' class='sentence'>
If the <span class='texttt'>invoke</span> expression exits via an exception,
<span class='texttt'>terminate</span> is called<a class='hidden_link' href='#jthread.cons-5.sentence-5'>.</a></div></div></div></div><div class='para' id='jthread.cons-6'><div class='marginalizedparent'><a class='marginalized' href='#jthread.cons-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1559'>#</a></div><div class='texpara'><div id='jthread.cons-6.sentence-1' class='sentence'><i >Synchronization</i>: The completion of the invocation of the constructor
synchronizes with the beginning of the invocation of the copy of <span class='texttt'>f</span><a class='hidden_link' href='#jthread.cons-6.sentence-1'>.</a></div></div></div></div><div class='para' id='jthread.cons-7'><div class='marginalizedparent'><a class='marginalized' href='#jthread.cons-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1564'>#</a></div><div class='texpara'><div id='jthread.cons-7.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>!</span><span class='operator'>=</span> id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span>
and <span class='texttt'>ssource<span class='operator'>.</span>stop_&shy;possible<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span>
and <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> represents the newly started thread<a class='hidden_link' href='#jthread.cons-7.sentence-1'>.</a></div> <div id='jthread.cons-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#jthread.cons-note-2'>2</a></i>: <div id='jthread.cons-7.sentence-2' class='sentence'>The calling thread can make a stop request only once,
because it cannot replace this stop token<a class='hidden_link' href='#jthread.cons-7.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='jthread.cons-8'><div class='marginalizedparent'><a class='marginalized' href='#jthread.cons-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1574'>#</a></div><div class='texpara'><div id='jthread.cons-8.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>system_&shy;error</span> if unable to start the new thread<a class='hidden_link' href='#jthread.cons-8.sentence-1'>.</a></div></div></div></div><div class='para' id='jthread.cons-9'><div class='marginalizedparent'><a class='marginalized' href='#jthread.cons-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1578'>#</a></div><div class='texpara'><div id='jthread.cons-9.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='jthread.cons-9.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#jthread.cons-9.1'>(9.1)</a></div><span class='texttt'>resource_&shy;unavailable_&shy;try_&shy;again</span> — the system lacked
the necessary resources to create another thread,
or the system-imposed limit on the number of threads in a process
would be exceeded<a class='hidden_link' href='#jthread.cons-9.sentence-1'>.</a></li></ul></div></div></div></div><div class='texpara'><div id='lib:jthread,constructor__'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:jthread,constructor__'>🔗</a></div><code class='itemdeclcode'>jthread<span class='parenthesis'>(</span>jthread<span class='operator'>&amp;</span><span class='operator'>&amp;</span> x<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='jthread.cons-10'><div class='marginalizedparent'><a class='marginalized' href='#jthread.cons-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1594'>#</a></div><div class='texpara'><div id='jthread.cons-10.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>x<span class='operator'>.</span>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
and <span class='texttt'>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns the value of <span class='texttt'>x<span class='operator'>.</span>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
prior to the start of construction<a class='hidden_link' href='#jthread.cons-10.sentence-1'>.</a></div> <div id='jthread.cons-10.sentence-2' class='sentence'><span class='texttt'>ssource</span> has the value of <span class='texttt'>x<span class='operator'>.</span>ssource</span>
prior to the start of construction
and <span class='texttt'>x<span class='operator'>.</span>ssource<span class='operator'>.</span>stop_&shy;possible<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#jthread.cons-10.sentence-2'>.</a></div></div></div></div><div class='texpara'><div id='lib:jthread,destructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:jthread,destructor'>🔗</a></div><code class='itemdeclcode'><span class='operator'>~</span>jthread<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='jthread.cons-11'><div class='marginalizedparent'><a class='marginalized' href='#jthread.cons-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1610'>#</a></div><div class='texpara'><div id='jthread.cons-11.sentence-1' class='sentence'><i >Effects</i>: If <span class='texttt'>joinable<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span>,
calls <span class='texttt'>request_&shy;stop<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> and then <span class='texttt'>join<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#jthread.cons-11.sentence-1'>.</a></div> <div id='jthread.cons-note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#jthread.cons-note-3'>3</a></i>: <div id='jthread.cons-11.sentence-2' class='sentence'>Operations on <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> are not synchronized<a class='hidden_link' href='#jthread.cons-11.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='texpara'><div id='lib:jthread,operator='><div id='lib:operator=,jthread'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:operator=,jthread'>🔗</a></div><code class='itemdeclcode'>jthread<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>jthread<span class='operator'>&amp;</span><span class='operator'>&amp;</span> x<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='jthread.cons-12'><div class='marginalizedparent'><a class='marginalized' href='#jthread.cons-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1625'>#</a></div><div class='texpara'><div id='jthread.cons-12.sentence-1' class='sentence'><i >Effects</i>: If <span class='texttt'>joinable<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span>,
calls <span class='texttt'>request_&shy;stop<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> and then <span class='texttt'>join<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#jthread.cons-12.sentence-1'>.</a></div> <div id='jthread.cons-12.sentence-2' class='sentence'>Assigns the state of <span class='texttt'>x</span> to <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span>
and sets <span class='texttt'>x</span> to a default constructed state<a class='hidden_link' href='#jthread.cons-12.sentence-2'>.</a></div></div></div></div><div class='para' id='jthread.cons-13'><div class='marginalizedparent'><a class='marginalized' href='#jthread.cons-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1632'>#</a></div><div class='texpara'><div id='jthread.cons-13.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>x<span class='operator'>.</span>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
and <span class='texttt'>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns the value of <span class='texttt'>x<span class='operator'>.</span>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
prior to the assignment<a class='hidden_link' href='#jthread.cons-13.sentence-1'>.</a></div> <div id='jthread.cons-13.sentence-2' class='sentence'><span class='texttt'>ssource</span> has the value of <span class='texttt'>x<span class='operator'>.</span>ssource</span>
prior to the assignment
and <span class='texttt'>x<span class='operator'>.</span>ssource<span class='operator'>.</span>stop_&shy;possible<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#jthread.cons-13.sentence-2'>.</a></div></div></div></div><div class='para' id='jthread.cons-14'><div class='marginalizedparent'><a class='marginalized' href='#jthread.cons-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1641'>#</a></div><div class='texpara'><div id='jthread.cons-14.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#jthread.cons-14.sentence-1'>.</a></div></div></div></div></div><div id='jthread.mem' class='section'><h4 ><a class='secnum' href='#jthread.mem' style='min-width:95pt'>32.4.4.3</a> Members <a class='abbr_ref' href='thread.jthread.mem'>[thread.jthread.mem]</a></h4><div class='texpara'><div id='lib:jthread,swap'><div id='lib:swap,jthread'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:swap,jthread'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> swap<span class='parenthesis'>(</span>jthread<span class='operator'>&amp;</span> x<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='jthread.mem-1'><div class='marginalizedparent'><a class='marginalized' href='#jthread.mem-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1654'>#</a></div><div class='texpara'><div id='jthread.mem-1.sentence-1' class='sentence'><i >Effects</i>: Exchanges the values of <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> and <span class='texttt'>x</span><a class='hidden_link' href='#jthread.mem-1.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:jthread,joinable'><div id='lib:joinable,jthread'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:joinable,jthread'>🔗</a></div><code class='itemdeclcode'><span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='keyword'>bool</span> joinable<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='jthread.mem-2'><div class='marginalizedparent'><a class='marginalized' href='#jthread.mem-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1665'>#</a></div><div class='texpara'><div id='jthread.mem-2.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>!</span><span class='operator'>=</span> id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#jthread.mem-2.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:jthread,join'><div id='lib:join,jthread'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:join,jthread'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> join<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='jthread.mem-3'><div class='marginalizedparent'><a class='marginalized' href='#jthread.mem-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1676'>#</a></div><div class='texpara'><div id='jthread.mem-3.sentence-1' class='sentence'><a class='index' id=':block_(execution)__'></a><i >Effects</i>: Blocks until the thread represented by <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> has completed<a class='hidden_link' href='#jthread.mem-3.sentence-1'>.</a></div></div></div></div><div class='para' id='jthread.mem-4'><div class='marginalizedparent'><a class='marginalized' href='#jthread.mem-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1681'>#</a></div><div class='texpara'><div id='jthread.mem-4.sentence-1' class='sentence'><i >Synchronization</i>: The completion of the thread represented by <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span>
synchronizes with (<a href='intro.multithread' title='6.9.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>)
the corresponding successful <span class='texttt'>join<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> return<a class='hidden_link' href='#jthread.mem-4.sentence-1'>.</a></div> <div id='jthread.mem-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#jthread.mem-note-1'>1</a></i>: <div id='jthread.mem-4.sentence-2' class='sentence'>Operations on <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> are not synchronized<a class='hidden_link' href='#jthread.mem-4.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='jthread.mem-5'><div class='marginalizedparent'><a class='marginalized' href='#jthread.mem-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1690'>#</a></div><div class='texpara'><div id='jthread.mem-5.sentence-1' class='sentence'><i >Postconditions</i>: The thread represented by <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> has completed<a class='hidden_link' href='#jthread.mem-5.sentence-1'>.</a></div> <div id='jthread.mem-5.sentence-2' class='sentence'><span class='texttt'>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#jthread.mem-5.sentence-2'>.</a></div></div></div></div><div class='para' id='jthread.mem-6'><div class='marginalizedparent'><a class='marginalized' href='#jthread.mem-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1695'>#</a></div><div class='texpara'><div id='jthread.mem-6.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>system_&shy;error</span> when an exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#jthread.mem-6.sentence-1'>.</a></div></div></div></div><div class='para' id='jthread.mem-7'><div class='marginalizedparent'><a class='marginalized' href='#jthread.mem-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1699'>#</a></div><div class='texpara'><div id='jthread.mem-7.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='jthread.mem-7.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#jthread.mem-7.1'>(7.1)</a></div><div class='texpara'><div id='jthread.mem-7.1.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if deadlock is detected or
<span class='texttt'>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> this_&shy;thread<span class='operator'>&#x200b;::&#x200b;</span>&#x200b;get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#jthread.mem-7.1.sentence-1'>.</a></div></div></li><li id='jthread.mem-7.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#jthread.mem-7.2'>(7.2)</a></div><div class='texpara'><div id='jthread.mem-7.2.sentence-1' class='sentence'><span class='texttt'>no_&shy;such_&shy;process</span> — if the thread is not valid<a class='hidden_link' href='#jthread.mem-7.2.sentence-1'>.</a></div></div></li><li id='jthread.mem-7.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#jthread.mem-7.3'>(7.3)</a></div><div class='texpara'><div id='jthread.mem-7.3.sentence-1' class='sentence'><span class='texttt'>invalid_&shy;argument</span> — if the thread is not joinable<a class='hidden_link' href='#jthread.mem-7.3.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:jthread,detach'><div id='lib:detach,jthread'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:detach,jthread'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> detach<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='jthread.mem-8'><div class='marginalizedparent'><a class='marginalized' href='#jthread.mem-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1717'>#</a></div><div class='texpara'><div id='jthread.mem-8.sentence-1' class='sentence'><i >Effects</i>: The thread represented by <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> continues execution
without the calling thread blocking<a class='hidden_link' href='#jthread.mem-8.sentence-1'>.</a></div> <div id='jthread.mem-8.sentence-2' class='sentence'>When <span class='texttt'>detach<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns,
<span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> no longer represents the possibly continuing thread of execution<a class='hidden_link' href='#jthread.mem-8.sentence-2'>.</a></div> <div id='jthread.mem-8.sentence-3' class='sentence'>When the thread previously represented by <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> ends execution,
the implementation releases any owned resources<a class='hidden_link' href='#jthread.mem-8.sentence-3'>.</a></div></div></div></div><div class='para' id='jthread.mem-9'><div class='marginalizedparent'><a class='marginalized' href='#jthread.mem-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1726'>#</a></div><div class='texpara'><div id='jthread.mem-9.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#jthread.mem-9.sentence-1'>.</a></div></div></div></div><div class='para' id='jthread.mem-10'><div class='marginalizedparent'><a class='marginalized' href='#jthread.mem-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1730'>#</a></div><div class='texpara'><div id='jthread.mem-10.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>system_&shy;error</span> when an exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#jthread.mem-10.sentence-1'>.</a></div></div></div></div><div class='para' id='jthread.mem-11'><div class='marginalizedparent'><a class='marginalized' href='#jthread.mem-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1734'>#</a></div><div class='texpara'><div id='jthread.mem-11.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='jthread.mem-11.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#jthread.mem-11.1'>(11.1)</a></div><div class='texpara'><div id='jthread.mem-11.1.sentence-1' class='sentence'><span class='texttt'>no_&shy;such_&shy;process</span> — if the thread is not valid<a class='hidden_link' href='#jthread.mem-11.1.sentence-1'>.</a></div></div></li><li id='jthread.mem-11.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#jthread.mem-11.2'>(11.2)</a></div><div class='texpara'><div id='jthread.mem-11.2.sentence-1' class='sentence'><span class='texttt'>invalid_&shy;argument</span> — if the thread is not joinable<a class='hidden_link' href='#jthread.mem-11.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:jthread,get_id'><div id='lib:get_id,jthread'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:get_id,jthread'>🔗</a></div><code class='itemdeclcode'>id get_id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='jthread.mem-12'><div class='marginalizedparent'><a class='marginalized' href='#jthread.mem-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1748'>#</a></div><div class='texpara'><div id='jthread.mem-12.sentence-1' class='sentence'><i >Returns</i>: A default constructed <span class='texttt'>id</span> object
if <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> does not represent a thread,
otherwise <span class='texttt'>this_&shy;thread<span class='operator'>&#x200b;::&#x200b;</span>get_&shy;id<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
for the thread of execution represented by <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#jthread.mem-12.sentence-1'>.</a></div></div></div></div></div><div id='jthread.stop' class='section'><h4 ><a class='secnum' href='#jthread.stop' style='min-width:95pt'>32.4.4.4</a> Stop token handling <a class='abbr_ref' href='thread.jthread.stop'>[thread.jthread.stop]</a></h4><div class='texpara'><div id='lib:jthread,get_stop_source'><div id='lib:get_stop_source,jthread'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:get_stop_source,jthread'>🔗</a></div><code class='itemdeclcode'><span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> stop_source get_stop_source<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='jthread.stop-1'><div class='marginalizedparent'><a class='marginalized' href='#jthread.stop-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1764'>#</a></div><div class='texpara'><div id='jthread.stop-1.sentence-1' class='sentence'><i >Effects</i>: Equivalent to: <span class='texttt'><span class='keyword'>return</span> ssource;</span></div></div></div></div><div class='texpara'><div id='lib:jthread,get_stop_token'><div id='lib:get_stop_token,jthread'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:get_stop_token,jthread'>🔗</a></div><code class='itemdeclcode'><span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> stop_token get_stop_token<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='jthread.stop-2'><div class='marginalizedparent'><a class='marginalized' href='#jthread.stop-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1775'>#</a></div><div class='texpara'><div id='jthread.stop-2.sentence-1' class='sentence'><i >Effects</i>: Equivalent to: <span class='texttt'><span class='keyword'>return</span> ssource<span class='operator'>.</span>get_&shy;token<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;</span></div></div></div></div><div class='texpara'><div id='lib:jthread,request_stop'><div id='lib:request_stop,jthread'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:request_stop,jthread'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>bool</span> request_stop<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='jthread.stop-3'><div class='marginalizedparent'><a class='marginalized' href='#jthread.stop-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1786'>#</a></div><div class='texpara'><div id='jthread.stop-3.sentence-1' class='sentence'><i >Effects</i>: Equivalent to: <span class='texttt'><span class='keyword'>return</span> ssource<span class='operator'>.</span>request_&shy;stop<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;</span></div></div></div></div></div><div id='jthread.special' class='section'><h4 ><a class='secnum' href='#jthread.special' style='min-width:95pt'>32.4.4.5</a> Specialized algorithms <a class='abbr_ref' href='thread.jthread.special'>[thread.jthread.special]</a></h4><div class='texpara'><div id='lib:jthread,swap_'><div id='lib:swap,jthread_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:swap,jthread_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>friend</span> <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>jthread<span class='operator'>&amp;</span> x, jthread<span class='operator'>&amp;</span> y<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='jthread.special-1'><div class='marginalizedparent'><a class='marginalized' href='#jthread.special-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1800'>#</a></div><div class='texpara'><div id='jthread.special-1.sentence-1' class='sentence'><i >Effects</i>: Equivalent to: <span class='texttt'>x<span class='operator'>.</span>swap<span class='parenthesis'>(</span>y<span class='parenthesis'>)</span></span><a class='hidden_link' href='#jthread.special-1.sentence-1'>.</a></div></div></div></div></div><div id='jthread.static' class='section'><h4 ><a class='secnum' href='#jthread.static' style='min-width:95pt'>32.4.4.6</a> Static members <a class='abbr_ref' href='thread.jthread.static'>[thread.jthread.static]</a></h4><div class='texpara'><div id='lib:jthread,hardware_concurrency'><div id='lib:hardware_concurrency,jthread'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:hardware_concurrency,jthread'>🔗</a></div><code class='itemdeclcode'><span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> <span class='keyword'>static</span> <span class='keyword'>unsigned</span> <span class='keyword'>int</span> hardware_concurrency<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='jthread.static-1'><div class='marginalizedparent'><a class='marginalized' href='#jthread.static-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1813'>#</a></div><div class='texpara'><div id='jthread.static-1.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>thread<span class='operator'>&#x200b;::&#x200b;</span>hardware_&shy;concurrency<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#jthread.static-1.sentence-1'>.</a></div></div></div></div></div></div><div id='thread.this' class='section'><h3 ><a class='secnum' href='#thread.this' style='min-width:80pt'>32.4.5</a> Namespace <span class='texttt'>this_&shy;thread</span> <a class='abbr_ref' href='thread.thread.this'>[thread.thread.this]</a></h3><div class='texpara'><span class='codeblock'><span class='keyword'>namespace</span> std<span class='operator'>::</span>this_thread <span class='curlybracket'>{</span>
  thread<span class='operator'>::</span>id get_id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

  <span class='keyword'>void</span> yield<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
    <span class='keyword'>void</span> sleep_until<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span>;
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
    <span class='keyword'>void</span> sleep_for<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
</span></div><div class='texpara'><div id='lib:this_thread,get_id'><div id='lib:get_id,this_thread'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:get_id,this_thread'>🔗</a></div><code class='itemdeclcode'>thread<span class='operator'>::</span>id this_thread<span class='operator'>::</span>get_id<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='thread.this-1'><div class='marginalizedparent'><a class='marginalized' href='#thread.this-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1839'>#</a></div><div class='texpara'><div id='thread.this-1.sentence-1' class='sentence'><i >Returns</i>: An object of type <span class='texttt'>thread<span class='operator'>&#x200b;::&#x200b;</span>id</span> that uniquely identifies the current thread of
execution<a class='hidden_link' href='#thread.this-1.sentence-1'>.</a></div> <div id='thread.this-1.sentence-2' class='sentence'>No other thread of execution has this id and this thread of execution
always has this id<a class='hidden_link' href='#thread.this-1.sentence-2'>.</a></div> <div id='thread.this-1.sentence-3' class='sentence'>The object returned does not compare equal to a default constructed
<span class='texttt'>thread<span class='operator'>&#x200b;::&#x200b;</span>id</span><a class='hidden_link' href='#thread.this-1.sentence-3'>.</a></div></div></div></div><div class='texpara'><div id='lib:this_thread,yield'><div id='lib:yield,this_thread'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:yield,this_thread'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> this_thread<span class='operator'>::</span>yield<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='thread.this-2'><div class='marginalizedparent'><a class='marginalized' href='#thread.this-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1853'>#</a></div><div class='texpara'><div id='thread.this-2.sentence-1' class='sentence'><i >Effects</i>: Offers the implementation the opportunity to reschedule<a class='hidden_link' href='#thread.this-2.sentence-1'>.</a></div></div></div></div><div class='para' id='thread.this-3'><div class='marginalizedparent'><a class='marginalized' href='#thread.this-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1857'>#</a></div><div class='texpara'><div id='thread.this-3.sentence-1' class='sentence'><i >Synchronization</i>: None<a class='hidden_link' href='#thread.this-3.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:this_thread,sleep_until'><div id='lib:sleep_until,this_thread'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:sleep_until,this_thread'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
  <span class='keyword'>void</span> sleep_until<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='thread.this-4'><div class='marginalizedparent'><a class='marginalized' href='#thread.this-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1869'>#</a></div><div class='texpara'><div id='thread.this-4.sentence-1' class='sentence'><a class='index' id=':block_(execution)___'></a><i >Effects</i>: Blocks the calling thread for the absolute timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>) specified
by <span class='texttt'>abs_&shy;time</span><a class='hidden_link' href='#thread.this-4.sentence-1'>.</a></div></div></div></div><div class='para' id='thread.this-5'><div class='marginalizedparent'><a class='marginalized' href='#thread.this-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1875'>#</a></div><div class='texpara'><div id='thread.this-5.sentence-1' class='sentence'><i >Synchronization</i>: None<a class='hidden_link' href='#thread.this-5.sentence-1'>.</a></div></div></div></div><div class='para' id='thread.this-6'><div class='marginalizedparent'><a class='marginalized' href='#thread.this-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1879'>#</a></div><div class='texpara'><div id='thread.this-6.sentence-1' class='sentence'><i >Throws</i>: Timeout-related exceptions (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>)<a class='hidden_link' href='#thread.this-6.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:this_thread,sleep_for'><div id='lib:sleep_for,this_thread'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:sleep_for,this_thread'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
  <span class='keyword'>void</span> sleep_for<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='thread.this-7'><div class='marginalizedparent'><a class='marginalized' href='#thread.this-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1891'>#</a></div><div class='texpara'><div id='thread.this-7.sentence-1' class='sentence'><a class='index' id=':block_(execution)____'></a><i >Effects</i>: Blocks the calling thread for the relative timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>) specified
by <span class='texttt'>rel_&shy;time</span><a class='hidden_link' href='#thread.this-7.sentence-1'>.</a></div></div></div></div><div class='para' id='thread.this-8'><div class='marginalizedparent'><a class='marginalized' href='#thread.this-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1897'>#</a></div><div class='texpara'><div id='thread.this-8.sentence-1' class='sentence'><i >Synchronization</i>: None<a class='hidden_link' href='#thread.this-8.sentence-1'>.</a></div></div></div></div><div class='para' id='thread.this-9'><div class='marginalizedparent'><a class='marginalized' href='#thread.this-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1901'>#</a></div><div class='texpara'><div id='thread.this-9.sentence-1' class='sentence'><i >Throws</i>: Timeout-related exceptions (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>)<a class='hidden_link' href='#thread.this-9.sentence-1'>.</a></div></div></div></div></div></div><div id='mutex' class='section'><h2 ><a class='secnum' href='#mutex' style='min-width:65pt'>32.5</a> Mutual exclusion <a class='abbr_ref' href='thread.mutex'>[thread.mutex]</a></h2><div id='mutex.general' class='section'><h3 ><a class='secnum' href='#mutex.general' style='min-width:80pt'>32.5.1</a> General <a class='abbr_ref' href='thread.mutex.general'>[thread.mutex.general]</a></h3><div class='para' id='mutex.general-1'><div class='marginalizedparent'><a class='marginalized' href='#mutex.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1910'>#</a></div><div class='texpara'><div id='mutex.general-1.sentence-1' class='sentence'>Subclause <a href='#mutex' title='32.5&emsp;Mutual exclusion'>[thread.<span class='shy'></span>mutex]</a> provides mechanisms for mutual exclusion: mutexes, locks, and call
once<a class='hidden_link' href='#mutex.general-1.sentence-1'>.</a></div> <div id='mutex.general-1.sentence-2' class='sentence'>These mechanisms ease the production of race-free
programs (<a href='intro.multithread' title='6.9.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>)<a class='hidden_link' href='#mutex.general-1.sentence-2'>.</a></div></div></div></div><div id='mutex.syn' class='section'><h3 ><a class='secnum' href='#mutex.syn' style='min-width:80pt'>32.5.2</a> Header <span class='texttt'>&lt;mutex&gt;</span> synopsis <a class='abbr_ref' href='mutex.syn'>[mutex.syn]</a></h3><div class='texpara'><span id='header:<mutex>'><div class='marginalizedparent'><a class='itemDeclLink' href='#header:%3cmutex%3e'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>class</span> mutex;
  <span class='keyword'>class</span> recursive_mutex;
  <span class='keyword'>class</span> timed_mutex;
  <span class='keyword'>class</span> recursive_timed_mutex;

  <span class='keyword'>struct</span> defer_lock_t <span class='curlybracket'>{</span> <span class='keyword'>explicit</span> defer_lock_t<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>default</span>; <span class='curlybracket'>}</span>;
  <span class='keyword'>struct</span> try_to_lock_t <span class='curlybracket'>{</span> <span class='keyword'>explicit</span> try_to_lock_t<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>default</span>; <span class='curlybracket'>}</span>;
  <span class='keyword'>struct</span> adopt_lock_t <span class='curlybracket'>{</span> <span class='keyword'>explicit</span> adopt_lock_t<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>default</span>; <span class='curlybracket'>}</span>;

  <span class='keyword'>inline</span> <span class='keyword'>constexpr</span> defer_lock_t  defer_lock <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
  <span class='keyword'>inline</span> <span class='keyword'>constexpr</span> try_to_lock_t try_to_lock <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
  <span class='keyword'>inline</span> <span class='keyword'>constexpr</span> adopt_lock_t  adopt_lock <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Mutex<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> lock_guard;
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> MutexTypes<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> scoped_lock;
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Mutex<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> unique_lock;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Mutex<span class='anglebracket'>&gt;</span>
    <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>unique_lock<span class='anglebracket'>&lt;</span>Mutex<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> x, unique_lock<span class='anglebracket'>&lt;</span>Mutex<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> y<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> L1, <span class='keyword'>class</span> L2, <span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> L3<span class='anglebracket'>&gt;</span> <span class='keyword'>int</span> try_lock<span class='parenthesis'>(</span>L1<span class='operator'>&amp;</span>, L2<span class='operator'>&amp;</span>, L3<span class='operator'>&amp;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>;
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> L1, <span class='keyword'>class</span> L2, <span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> L3<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> lock<span class='parenthesis'>(</span>L1<span class='operator'>&amp;</span>, L2<span class='operator'>&amp;</span>, L3<span class='operator'>&amp;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>;

  <span class='keyword'>struct</span> once_flag;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Callable, <span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> Args<span class='anglebracket'>&gt;</span>
    <span class='keyword'>void</span> call_once<span class='parenthesis'>(</span>once_flag<span class='operator'>&amp;</span> flag, Callable<span class='operator'>&amp;</span><span class='operator'>&amp;</span> func, Args<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> args<span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
</span></span></div></div><div id='shared.mutex.syn' class='section'><h3 ><a class='secnum' href='#shared.mutex.syn' style='min-width:80pt'>32.5.3</a> Header <span class='texttt'>&lt;shared_&shy;mutex&gt;</span> synopsis <a class='abbr_ref' href='shared.mutex.syn'>[shared.mutex.syn]</a></h3><div class='texpara'><span id='header:<shared_mutex>'><div class='marginalizedparent'><a class='itemDeclLink' href='#header:%3cshared_mutex%3e'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>class</span> shared_mutex;
  <span class='keyword'>class</span> shared_timed_mutex;
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Mutex<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> shared_lock;
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Mutex<span class='anglebracket'>&gt;</span>
    <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>shared_lock<span class='anglebracket'>&lt;</span>Mutex<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> x, shared_lock<span class='anglebracket'>&lt;</span>Mutex<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> y<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
<span class='curlybracket'>}</span>
</span></span></div></div><div id='mutex.requirements' class='section'><h3 ><a class='secnum' href='#mutex.requirements' style='min-width:80pt'>32.5.4</a> Mutex requirements <a class='abbr_ref' href='thread.mutex.requirements'>[thread.mutex.requirements]</a></h3><div id='mutex.requirements.general' class='section'><h4 ><a class='secnum' href='#mutex.requirements.general' style='min-width:95pt'>32.5.4.1</a> In general <a class='abbr_ref' href='thread.mutex.requirements.general'>[thread.mutex.requirements.general]</a></h4><div class='para' id='mutex.requirements.general-1'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1967'>#</a></div><div class='texpara'><div id='mutex.requirements.general-1.sentence-1' class='sentence'>A mutex object facilitates protection against data races and allows safe synchronization of
data between <a href='#def:execution_agent' title='32.2.5&emsp;Requirements for Cpp17Lockable types&emsp;[thread.req.lockable]'>execution agents</a><a class='hidden_link' href='#mutex.requirements.general-1.sentence-1'>.</a></div> <div id='mutex.requirements.general-1.sentence-2' class='sentence'>An execution agent <a class='hidden_link' href='#def:owns' id='def:owns'><i>owns</i></a> a mutex from the time it successfully calls one of the
lock functions until it calls unlock<a class='hidden_link' href='#mutex.requirements.general-1.sentence-2'>.</a></div> <div id='mutex.requirements.general-1.sentence-3' class='sentence'>Mutexes can be either recursive or non-recursive, and can
grant simultaneous ownership to one or many execution agents<a class='hidden_link' href='#mutex.requirements.general-1.sentence-3'>.</a></div> <div id='mutex.requirements.general-1.sentence-4' class='sentence'>Both
recursive and non-recursive mutexes are supplied<a class='hidden_link' href='#mutex.requirements.general-1.sentence-4'>.</a></div></div></div></div><div id='mutex.requirements.mutex' class='section'><h4 ><a class='secnum' href='#mutex.requirements.mutex' style='min-width:95pt'>32.5.4.2</a> Mutex types <a class='abbr_ref' href='thread.mutex.requirements.mutex'>[thread.mutex.requirements.mutex]</a></h4><div id='mutex.requirements.mutex.general' class='section'><h4 ><a class='secnum' href='#mutex.requirements.mutex.general' style='min-width:110pt'>32.5.4.2.1</a> General <a class='abbr_ref' href='thread.mutex.requirements.mutex.general'>[thread.mutex.requirements.mutex.general]</a></h4><div class='para' id='mutex.requirements.mutex.general-1'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1979'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-1.sentence-1' class='sentence'>The <a class='hidden_link' href='#def:mutex_types' title='32.5.4.2.1&emsp;General&emsp;[thread.mutex.requirements.mutex.general]'><span id='def:mutex_types'><i >mutex types</i></span></a> are the standard library types <span class='texttt'>mutex</span>,
<span class='texttt'>recursive_&shy;mutex</span>, <span class='texttt'>timed_&shy;mutex</span>, <span class='texttt'>recursive_&shy;timed_&shy;mutex</span>,
<span class='texttt'>shared_&shy;mutex</span>, and <span class='texttt'>shared_&shy;timed_&shy;mutex</span><a class='hidden_link' href='#mutex.requirements.mutex.general-1.sentence-1'>.</a></div> <div id='mutex.requirements.mutex.general-1.sentence-2' class='sentence'>They meet the requirements set out in <a href='#mutex.requirements.mutex' title='32.5.4.2&emsp;Mutex types'>[thread.<span class='shy'></span>mutex.<span class='shy'></span>requirements.<span class='shy'></span>mutex]</a><a class='hidden_link' href='#mutex.requirements.mutex.general-1.sentence-2'>.</a></div> <div id='mutex.requirements.mutex.general-1.sentence-3' class='sentence'>In this description, <span class='texttt'>m</span> denotes an object of a mutex type<a class='hidden_link' href='#mutex.requirements.mutex.general-1.sentence-3'>.</a></div></div></div><div class='para' id='mutex.requirements.mutex.general-2'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1986'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-2.sentence-1' class='sentence'>The mutex types meet the <i >Cpp17Lockable</i> requirements (<a href='#req.lockable.req' title='32.2.5.3&emsp;Cpp17Lockable requirements'>[thread.<span class='shy'></span>req.<span class='shy'></span>lockable.<span class='shy'></span>req]</a>)<a class='hidden_link' href='#mutex.requirements.mutex.general-2.sentence-1'>.</a></div></div></div><div class='para' id='mutex.requirements.mutex.general-3'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1989'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-3.sentence-1' class='sentence'>The mutex types meet <i >Cpp17DefaultConstructible</i> and <i >Cpp17Destructible</i><a class='hidden_link' href='#mutex.requirements.mutex.general-3.sentence-1'>.</a></div> <div id='mutex.requirements.mutex.general-3.sentence-2' class='sentence'>If initialization of an object of a mutex type fails,
an exception of type <span class='texttt'>system_&shy;error</span> is thrown<a class='hidden_link' href='#mutex.requirements.mutex.general-3.sentence-2'>.</a></div> <div id='mutex.requirements.mutex.general-3.sentence-3' class='sentence'>The mutex types are neither copyable nor movable<a class='hidden_link' href='#mutex.requirements.mutex.general-3.sentence-3'>.</a></div></div></div><div class='para' id='mutex.requirements.mutex.general-4'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L1995'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-4.sentence-1' class='sentence'>The error conditions for error codes, if any, reported by member functions of the mutex types
are as follows:
<ul class='itemize'><li id='mutex.requirements.mutex.general-4.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#mutex.requirements.mutex.general-4.1'>(4.1)</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-4.1.sentence-1' class='sentence'><span class='texttt'>resource_&shy;unavailable_&shy;try_&shy;again</span> — if any native handle type manipulated is not available<a class='hidden_link' href='#mutex.requirements.mutex.general-4.1.sentence-1'>.</a></div></div></li><li id='mutex.requirements.mutex.general-4.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#mutex.requirements.mutex.general-4.2'>(4.2)</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-4.2.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if the thread does not have the
privilege to perform the operation<a class='hidden_link' href='#mutex.requirements.mutex.general-4.2.sentence-1'>.</a></div></div></li><li id='mutex.requirements.mutex.general-4.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#mutex.requirements.mutex.general-4.3'>(4.3)</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-4.3.sentence-1' class='sentence'><span class='texttt'>invalid_&shy;argument</span> — if any native handle type manipulated as part of mutex
construction is incorrect<a class='hidden_link' href='#mutex.requirements.mutex.general-4.3.sentence-1'>.</a></div></div></li></ul></div></div></div><div class='para' id='mutex.requirements.mutex.general-5'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2006'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-5.sentence-1' class='sentence'>The implementation provides lock and unlock operations, as described below<a class='hidden_link' href='#mutex.requirements.mutex.general-5.sentence-1'>.</a></div> <div id='mutex.requirements.mutex.general-5.sentence-2' class='sentence'>For purposes of determining the existence of a data race, these behave as
atomic operations (<a href='intro.multithread' title='6.9.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>)<a class='hidden_link' href='#mutex.requirements.mutex.general-5.sentence-2'>.</a></div> <div id='mutex.requirements.mutex.general-5.sentence-3' class='sentence'>The lock and unlock operations on
a single mutex appears to occur in a single total order<a class='hidden_link' href='#mutex.requirements.mutex.general-5.sentence-3'>.</a></div> <div id='mutex.requirements.mutex.general-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#mutex.requirements.mutex.general-note-1'>1</a></i>: <div id='mutex.requirements.mutex.general-5.sentence-4' class='sentence'>This
can be viewed as the <a href='intro.multithread#def:modification_order' title='6.9.2&emsp;Multi-threaded executions and data races&emsp;[intro.multithread]'>modification order</a> of the
mutex<a class='hidden_link' href='#mutex.requirements.mutex.general-5.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='mutex.requirements.mutex.general-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#mutex.requirements.mutex.general-note-2'>2</a></i>: <div id='mutex.requirements.mutex.general-5.sentence-5' class='sentence'>Construction and
destruction of an object of a mutex type need not be thread-safe; other
synchronization can be used to ensure that mutex objects are initialized
and visible to other threads<a class='hidden_link' href='#mutex.requirements.mutex.general-5.sentence-5'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='mutex.requirements.mutex.general-6'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2023'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-6.sentence-1' class='sentence'>The expression <span class='texttt'>m<span class='operator'>.</span>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is well-formed and has the following semantics:</div></div></div><div class='para' id='mutex.requirements.mutex.general-7'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2026'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-7.sentence-1' class='sentence'><i >Preconditions</i>: If <span class='texttt'>m</span> is of type <span class='texttt'>mutex</span>, <span class='texttt'>timed_&shy;mutex</span>,
<span class='texttt'>shared_&shy;mutex</span>, or <span class='texttt'>shared_&shy;timed_&shy;mutex</span>, the calling
thread does not own the mutex<a class='hidden_link' href='#mutex.requirements.mutex.general-7.sentence-1'>.</a></div></div></div></div><div class='para' id='mutex.requirements.mutex.general-8'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2032'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-8.sentence-1' class='sentence'><a class='index' id=':block_(execution)_____'></a><i >Effects</i>: Blocks the calling thread until ownership of the mutex can be obtained for the calling thread<a class='hidden_link' href='#mutex.requirements.mutex.general-8.sentence-1'>.</a></div></div></div></div><div class='para' id='mutex.requirements.mutex.general-9'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2037'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-9.sentence-1' class='sentence'><i >Postconditions</i>: The calling thread owns the mutex<a class='hidden_link' href='#mutex.requirements.mutex.general-9.sentence-1'>.</a></div></div></div></div><div class='para' id='mutex.requirements.mutex.general-10'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2041'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-10.sentence-1' class='sentence'><i >Return type</i>: <span class='texttt'><span class='keyword'>void</span></span><a class='hidden_link' href='#mutex.requirements.mutex.general-10.sentence-1'>.</a></div></div></div></div><div class='para' id='mutex.requirements.mutex.general-11'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2044'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-11.sentence-1' class='sentence'><i >Synchronization</i>: Prior <span class='texttt'>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> operations on the same object
<a class='hidden_link' href='#def:synchronize_with' id='def:synchronize_with'><i>synchronize with</i></a> (<a href='intro.multithread' title='6.9.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>) this operation<a class='hidden_link' href='#mutex.requirements.mutex.general-11.sentence-1'>.</a></div></div></div></div><div class='para' id='mutex.requirements.mutex.general-12'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2049'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-12.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>system_&shy;error</span> when
an exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#mutex.requirements.mutex.general-12.sentence-1'>.</a></div></div></div></div><div class='para' id='mutex.requirements.mutex.general-13'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2054'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-13.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='mutex.requirements.mutex.general-13.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#mutex.requirements.mutex.general-13.1'>(13.1)</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-13.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if the thread does not have the
privilege to perform the operation<a class='hidden_link' href='#mutex.requirements.mutex.general-13.1.sentence-1'>.</a></div></div></li><li id='mutex.requirements.mutex.general-13.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#mutex.requirements.mutex.general-13.2'>(13.2)</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-13.2.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if the implementation detects
that a deadlock would occur<a class='hidden_link' href='#mutex.requirements.mutex.general-13.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='para' id='mutex.requirements.mutex.general-14'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-14'>14</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2065'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-14.sentence-1' class='sentence'>The expression <span class='texttt'>m<span class='operator'>.</span>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is well-formed and has the following semantics:</div></div></div><div class='para' id='mutex.requirements.mutex.general-15'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2068'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-15.sentence-1' class='sentence'><i >Preconditions</i>: If <span class='texttt'>m</span> is of type <span class='texttt'>mutex</span>, <span class='texttt'>timed_&shy;mutex</span>,
<span class='texttt'>shared_&shy;mutex</span>, or <span class='texttt'>shared_&shy;timed_&shy;mutex</span>, the calling
thread does not own the mutex<a class='hidden_link' href='#mutex.requirements.mutex.general-15.sentence-1'>.</a></div></div></div></div><div class='para' id='mutex.requirements.mutex.general-16'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2074'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-16.sentence-1' class='sentence'><i >Effects</i>: Attempts to obtain ownership of the mutex for the calling thread without
blocking<a class='hidden_link' href='#mutex.requirements.mutex.general-16.sentence-1'>.</a></div> <div id='mutex.requirements.mutex.general-16.sentence-2' class='sentence'>If ownership is not obtained, there is no effect and <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
immediately returns<a class='hidden_link' href='#mutex.requirements.mutex.general-16.sentence-2'>.</a></div> <div id='mutex.requirements.mutex.general-16.sentence-3' class='sentence'>An implementation may fail to obtain the lock even if it is not
held by any other thread<a class='hidden_link' href='#mutex.requirements.mutex.general-16.sentence-3'>.</a></div> <div id='mutex.requirements.mutex.general-note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#mutex.requirements.mutex.general-note-3'>3</a></i>: <div id='mutex.requirements.mutex.general-16.sentence-4' class='sentence'>This spurious failure is normally uncommon, but
allows interesting implementations based on a simple
compare and exchange (<a href='atomics' title='31&emsp;Atomic operations library'>[atomics]</a>)<a class='hidden_link' href='#mutex.requirements.mutex.general-16.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='mutex.requirements.mutex.general-16.sentence-5' class='sentence'>
An implementation should ensure that <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> does not consistently return <span class='texttt'><span class='literal'>false</span></span>
in the absence of contending mutex acquisitions<a class='hidden_link' href='#mutex.requirements.mutex.general-16.sentence-5'>.</a></div></div></div></div><div class='para' id='mutex.requirements.mutex.general-17'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2088'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-17.sentence-1' class='sentence'><i >Return type</i>: <span class='texttt'><span class='keyword'>bool</span></span><a class='hidden_link' href='#mutex.requirements.mutex.general-17.sentence-1'>.</a></div></div></div></div><div class='para' id='mutex.requirements.mutex.general-18'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2091'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-18.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>true</span></span> if ownership was obtained, otherwise <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#mutex.requirements.mutex.general-18.sentence-1'>.</a></div></div></div></div><div class='para' id='mutex.requirements.mutex.general-19'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2095'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-19.sentence-1' class='sentence'><i >Synchronization</i>: If <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns <span class='texttt'><span class='literal'>true</span></span>, prior <span class='texttt'>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> operations
on the same object <a href='intro.multithread#def:synchronize_with' title='6.9.2&emsp;Multi-threaded executions and data races&emsp;[intro.multithread]'>synchronize with</a> this operation<a class='hidden_link' href='#mutex.requirements.mutex.general-19.sentence-1'>.</a></div> <div id='mutex.requirements.mutex.general-note-4' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#mutex.requirements.mutex.general-note-4'>4</a></i>: <div id='mutex.requirements.mutex.general-19.sentence-2' class='sentence'>Since <span class='texttt'>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> does not synchronize with a failed subsequent
<span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, the visibility rules are weak enough that little would be
known about the state after a failure, even in the absence of spurious failures<a class='hidden_link' href='#mutex.requirements.mutex.general-19.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='mutex.requirements.mutex.general-20'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2105'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-20.sentence-1' class='sentence'><i >Throws</i>: Nothing<a class='hidden_link' href='#mutex.requirements.mutex.general-20.sentence-1'>.</a></div></div></div></div><div class='para' id='mutex.requirements.mutex.general-21'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-21'>21</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2110'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-21.sentence-1' class='sentence'>The expression <span class='texttt'>m<span class='operator'>.</span>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is well-formed and has the following semantics:</div></div></div><div class='para' id='mutex.requirements.mutex.general-22'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2113'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-22.sentence-1' class='sentence'><i >Preconditions</i>: The calling thread owns the mutex<a class='hidden_link' href='#mutex.requirements.mutex.general-22.sentence-1'>.</a></div></div></div></div><div class='para' id='mutex.requirements.mutex.general-23'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2117'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-23.sentence-1' class='sentence'><i >Effects</i>: Releases the calling thread's ownership of the mutex<a class='hidden_link' href='#mutex.requirements.mutex.general-23.sentence-1'>.</a></div></div></div></div><div class='para' id='mutex.requirements.mutex.general-24'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-24'>24</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2121'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-24.sentence-1' class='sentence'><i >Return type</i>: <span class='texttt'><span class='keyword'>void</span></span><a class='hidden_link' href='#mutex.requirements.mutex.general-24.sentence-1'>.</a></div></div></div></div><div class='para' id='mutex.requirements.mutex.general-25'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-25'>25</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2124'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-25.sentence-1' class='sentence'><i >Synchronization</i>: This operation <a href='intro.multithread#def:synchronize_with' title='6.9.2&emsp;Multi-threaded executions and data races&emsp;[intro.multithread]'>synchronizes with</a> subsequent
lock operations that obtain ownership on the same object<a class='hidden_link' href='#mutex.requirements.mutex.general-25.sentence-1'>.</a></div></div></div></div><div class='para' id='mutex.requirements.mutex.general-26'><div class='marginalizedparent'><a class='marginalized' href='#mutex.requirements.mutex.general-26'>26</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2129'>#</a></div><div class='texpara'><div id='mutex.requirements.mutex.general-26.sentence-1' class='sentence'><i >Throws</i>: Nothing<a class='hidden_link' href='#mutex.requirements.mutex.general-26.sentence-1'>.</a></div></div></div></div></div><div id='mutex.class' class='section'><h4 ><a class='secnum' href='#mutex.class' style='min-width:110pt'>32.5.4.2.2</a> Class <span class='texttt'>mutex</span> <a class='abbr_ref' href='thread.mutex.class'>[thread.mutex.class]</a></h4><div class='texpara'><span id='lib:mutex'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:mutex'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>class</span> mutex <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    <span class='keyword'>constexpr</span> mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='operator'>~</span>mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    mutex<span class='parenthesis'>(</span><span class='keyword'>const</span> mutex<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    mutex<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> mutex<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;

    <span class='keyword'>void</span> lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>bool</span> try_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>void</span> unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    <span class='keyword'>using</span> native_handle_type <span class='operator'>=</span> <i >implementation-defined</i>;          <span class='comment'>// see <a href='#req.native' title='32.2.3&emsp;Native handles'>[thread.<span class='shy'></span>req.<span class='shy'></span>native]</a></span>
    native_handle_type native_handle<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                         <span class='comment'>// see <a href='#req.native' title='32.2.3&emsp;Native handles'>[thread.<span class='shy'></span>req.<span class='shy'></span>native]</a></span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></div><div class='para' id='mutex.class-1'><div class='marginalizedparent'><a class='marginalized' href='#mutex.class-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2157'>#</a></div><div class='texpara'><div id='mutex.class-1.sentence-1' class='sentence'><a class='index' id=':block_(execution)______'></a>The class <span class='texttt'>mutex</span> provides a non-recursive mutex with exclusive ownership
semantics<a class='hidden_link' href='#mutex.class-1.sentence-1'>.</a></div> <div id='mutex.class-1.sentence-2' class='sentence'>If one thread owns a mutex object, attempts by another thread to acquire
ownership of that object will fail (for <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>) or block (for
<span class='texttt'>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>) until the owning thread has released ownership with a call to
<span class='texttt'>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#mutex.class-1.sentence-2'>.</a></div></div></div><div class='para nonNormativeOnly' id='mutex.class-2'><div class='marginalizedparent'><a class='marginalized' href='#mutex.class-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2165'>#</a></div><div class='texpara'><div id='mutex.class-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#mutex.class-note-1'>1</a></i>: <div id='mutex.class-2.sentence-1' class='sentence'>After a thread <span class='texttt'>A</span> has called <span class='texttt'>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, releasing a mutex, it is possible for another
thread <span class='texttt'>B</span> to lock the same mutex, observe that it is no longer in use, unlock it, and
destroy it, before thread <span class='texttt'>A</span> appears to have returned from its unlock call<a class='hidden_link' href='#mutex.class-2.sentence-1'>.</a></div> <div id='mutex.class-2.sentence-2' class='sentence'>Implementations
are required to handle such scenarios correctly, as long as thread <span class='texttt'>A</span> doesn't access the
mutex after the unlock call returns<a class='hidden_link' href='#mutex.class-2.sentence-2'>.</a></div> <div id='mutex.class-2.sentence-3' class='sentence'>These cases typically occur when a reference-counted object
contains a mutex that is used to protect the reference count<a class='hidden_link' href='#mutex.class-2.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='mutex.class-3'><div class='marginalizedparent'><a class='marginalized' href='#mutex.class-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2175'>#</a></div><div class='texpara'><div id='mutex.class-3.sentence-1' class='sentence'>The class <span class='texttt'>mutex</span> meets
all of the mutex requirements (<a href='#mutex.requirements' title='32.5.4&emsp;Mutex requirements'>[thread.<span class='shy'></span>mutex.<span class='shy'></span>requirements]</a>)<a class='hidden_link' href='#mutex.class-3.sentence-1'>.</a></div> <div id='mutex.class-3.sentence-2' class='sentence'>It is a standard-layout class (<a href='class.prop' title='11.2&emsp;Properties of classes'>[class.<span class='shy'></span>prop]</a>)<a class='hidden_link' href='#mutex.class-3.sentence-2'>.</a></div></div></div><div class='para nonNormativeOnly' id='mutex.class-4'><div class='marginalizedparent'><a class='marginalized' href='#mutex.class-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2180'>#</a></div><div class='texpara'><div id='mutex.class-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#mutex.class-note-2'>2</a></i>: <div id='mutex.class-4.sentence-1' class='sentence'>A program can deadlock if the thread that owns a <span class='texttt'>mutex</span> object calls
<span class='texttt'>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> on that object<a class='hidden_link' href='#mutex.class-4.sentence-1'>.</a></div> <div id='mutex.class-4.sentence-2' class='sentence'>If the implementation can detect the deadlock,
a <span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> error condition might be observed<a class='hidden_link' href='#mutex.class-4.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='mutex.class-5'><div class='marginalizedparent'><a class='marginalized' href='#mutex.class-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2187'>#</a></div><div class='texpara'><div id='mutex.class-5.sentence-1' class='sentence'>The behavior of a program is undefined if
it destroys a <span class='texttt'>mutex</span> object owned by any thread or
a thread terminates while owning a <span class='texttt'>mutex</span> object<a class='hidden_link' href='#mutex.class-5.sentence-1'>.</a></div></div></div></div><div id='mutex.recursive' class='section'><h4 ><a class='secnum' href='#mutex.recursive' style='min-width:110pt'>32.5.4.2.3</a> Class <span class='texttt'>recursive_&shy;mutex</span> <a class='abbr_ref' href='thread.mutex.recursive'>[thread.mutex.recursive]</a></h4><div class='texpara'><span id='lib:recursive_mutex'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:recursive_mutex'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>class</span> recursive_mutex <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    recursive_mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='operator'>~</span>recursive_mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    recursive_mutex<span class='parenthesis'>(</span><span class='keyword'>const</span> recursive_mutex<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    recursive_mutex<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> recursive_mutex<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;

    <span class='keyword'>void</span> lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>bool</span> try_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>void</span> unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    <span class='keyword'>using</span> native_handle_type <span class='operator'>=</span> <i >implementation-defined</i>;          <span class='comment'>// see <a href='#req.native' title='32.2.3&emsp;Native handles'>[thread.<span class='shy'></span>req.<span class='shy'></span>native]</a></span>
    native_handle_type native_handle<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                         <span class='comment'>// see <a href='#req.native' title='32.2.3&emsp;Native handles'>[thread.<span class='shy'></span>req.<span class='shy'></span>native]</a></span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></div><div class='para' id='mutex.recursive-1'><div class='marginalizedparent'><a class='marginalized' href='#mutex.recursive-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2215'>#</a></div><div class='texpara'><div id='mutex.recursive-1.sentence-1' class='sentence'><a class='index' id=':block_(execution)_______'></a>The class <span class='texttt'>recursive_&shy;mutex</span> provides a recursive mutex with exclusive ownership
semantics<a class='hidden_link' href='#mutex.recursive-1.sentence-1'>.</a></div> <div id='mutex.recursive-1.sentence-2' class='sentence'>If one thread owns a <span class='texttt'>recursive_&shy;mutex</span> object, attempts by another
thread to acquire ownership of that object will fail (for <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>) or block
(for <span class='texttt'>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>) until the first thread has completely released ownership<a class='hidden_link' href='#mutex.recursive-1.sentence-2'>.</a></div></div></div><div class='para' id='mutex.recursive-2'><div class='marginalizedparent'><a class='marginalized' href='#mutex.recursive-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2222'>#</a></div><div class='texpara'><div id='mutex.recursive-2.sentence-1' class='sentence'>The class <span class='texttt'>recursive_&shy;mutex</span> meets
all of the mutex requirements (<a href='#mutex.requirements' title='32.5.4&emsp;Mutex requirements'>[thread.<span class='shy'></span>mutex.<span class='shy'></span>requirements]</a>)<a class='hidden_link' href='#mutex.recursive-2.sentence-1'>.</a></div> <div id='mutex.recursive-2.sentence-2' class='sentence'>It is a standard-layout class (<a href='class.prop' title='11.2&emsp;Properties of classes'>[class.<span class='shy'></span>prop]</a>)<a class='hidden_link' href='#mutex.recursive-2.sentence-2'>.</a></div></div></div><div class='para' id='mutex.recursive-3'><div class='marginalizedparent'><a class='marginalized' href='#mutex.recursive-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2227'>#</a></div><div class='texpara'><div id='mutex.recursive-3.sentence-1' class='sentence'>A thread that owns a <span class='texttt'>recursive_&shy;mutex</span> object may acquire additional levels of
ownership by calling <span class='texttt'>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> or <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> on that object<a class='hidden_link' href='#mutex.recursive-3.sentence-1'>.</a></div> <div id='mutex.recursive-3.sentence-2' class='sentence'>It is
unspecified how many levels of ownership may be acquired by a single thread<a class='hidden_link' href='#mutex.recursive-3.sentence-2'>.</a></div> <div id='mutex.recursive-3.sentence-3' class='sentence'>If a thread
has already acquired the maximum level of ownership for a <span class='texttt'>recursive_&shy;mutex</span>
object, additional calls to <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> fail, and additional calls to
<span class='texttt'>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> throw an exception of type <span class='texttt'>system_&shy;error</span><a class='hidden_link' href='#mutex.recursive-3.sentence-3'>.</a></div> <div id='mutex.recursive-3.sentence-4' class='sentence'>A thread
shall call <span class='texttt'>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> once for each level of ownership acquired by calls to
<span class='texttt'>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> and <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#mutex.recursive-3.sentence-4'>.</a></div> <div id='mutex.recursive-3.sentence-5' class='sentence'>Only when all levels of ownership have been
released may ownership be acquired by another thread<a class='hidden_link' href='#mutex.recursive-3.sentence-5'>.</a></div></div></div><div class='para' id='mutex.recursive-4'><div class='marginalizedparent'><a class='marginalized' href='#mutex.recursive-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2238'>#</a></div><div class='texpara'><div id='mutex.recursive-4.sentence-1' class='sentence'>The behavior of a program is undefined if:
<ul class='itemize'><li id='mutex.recursive-4.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#mutex.recursive-4.1'>(4.1)</a></div>it destroys a <span class='texttt'>recursive_&shy;mutex</span> object owned by any thread or</li><li id='mutex.recursive-4.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#mutex.recursive-4.2'>(4.2)</a></div>a thread terminates while owning a <span class='texttt'>recursive_&shy;mutex</span> object<a class='hidden_link' href='#mutex.recursive-4.sentence-1'>.</a></li></ul></div></div></div></div></div><div id='timedmutex.requirements' class='section'><h4 ><a class='secnum' href='#timedmutex.requirements' style='min-width:95pt'>32.5.4.3</a> Timed mutex types <a class='abbr_ref' href='thread.timedmutex.requirements'>[thread.timedmutex.requirements]</a></h4><div id='timedmutex.requirements.general' class='section'><h4 ><a class='secnum' href='#timedmutex.requirements.general' style='min-width:110pt'>32.5.4.3.1</a> General <a class='abbr_ref' href='thread.timedmutex.requirements.general'>[thread.timedmutex.requirements.general]</a></h4><div class='para' id='timedmutex.requirements.general-1'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2249'>#</a></div><div class='texpara'><div id='timedmutex.requirements.general-1.sentence-1' class='sentence'>The <a class='hidden_link' href='#def:timed_mutex_types' title='32.5.4.3.1&emsp;General&emsp;[thread.timedmutex.requirements.general]'><span id='def:timed_mutex_types'><i >timed mutex types</i></span></a> are the standard library types <span class='texttt'>timed_&shy;mutex</span>,
<span class='texttt'>recursive_&shy;timed_&shy;mutex</span>, and <span class='texttt'>shared_&shy;timed_&shy;mutex</span><a class='hidden_link' href='#timedmutex.requirements.general-1.sentence-1'>.</a></div> <div id='timedmutex.requirements.general-1.sentence-2' class='sentence'>They
meet the requirements set out below<a class='hidden_link' href='#timedmutex.requirements.general-1.sentence-2'>.</a></div> <div id='timedmutex.requirements.general-1.sentence-3' class='sentence'>In this description, <span class='texttt'>m</span> denotes an object of a mutex type,
<span class='texttt'>rel_&shy;time</span> denotes an object of an
instantiation of <a href='time.duration' title='27.5&emsp;Class template duration&emsp;[time.duration]'><span class='texttt'>duration</span></a>, and <span class='texttt'>abs_&shy;time</span> denotes an
object of an
instantiation of <a href='time.point' title='27.6&emsp;Class template time_&shy;point&emsp;[time.point]'><span class='texttt'>time_&shy;point</span></a><a class='hidden_link' href='#timedmutex.requirements.general-1.sentence-3'>.</a></div></div></div><div class='para' id='timedmutex.requirements.general-2'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements.general-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2259'>#</a></div><div class='texpara'><div id='timedmutex.requirements.general-2.sentence-1' class='sentence'>The timed mutex types meet the <i >Cpp17TimedLockable</i>
requirements (<a href='#req.lockable.timed' title='32.2.5.4&emsp;Cpp17TimedLockable requirements'>[thread.<span class='shy'></span>req.<span class='shy'></span>lockable.<span class='shy'></span>timed]</a>)<a class='hidden_link' href='#timedmutex.requirements.general-2.sentence-1'>.</a></div></div></div><div class='para' id='timedmutex.requirements.general-3'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements.general-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2263'>#</a></div><div class='texpara'><div id='timedmutex.requirements.general-3.sentence-1' class='sentence'>The expression <span class='texttt'>m<span class='operator'>.</span>try_&shy;lock_&shy;for<span class='parenthesis'>(</span>rel_&shy;time<span class='parenthesis'>)</span></span> is well-formed
and has the following semantics:</div></div></div><div class='para' id='timedmutex.requirements.general-4'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements.general-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2267'>#</a></div><div class='texpara'><div id='timedmutex.requirements.general-4.sentence-1' class='sentence'><i >Preconditions</i>: If <span class='texttt'>m</span> is of type <span class='texttt'>timed_&shy;mutex</span> or
<span class='texttt'>shared_&shy;timed_&shy;mutex</span>, the calling thread does not
own the mutex<a class='hidden_link' href='#timedmutex.requirements.general-4.sentence-1'>.</a></div></div></div></div><div class='para' id='timedmutex.requirements.general-5'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements.general-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2273'>#</a></div><div class='texpara'><div id='timedmutex.requirements.general-5.sentence-1' class='sentence'><i >Effects</i>: The function attempts to obtain ownership of the mutex within the
relative timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>)
specified by <span class='texttt'>rel_&shy;time</span><a class='hidden_link' href='#timedmutex.requirements.general-5.sentence-1'>.</a></div> <div id='timedmutex.requirements.general-5.sentence-2' class='sentence'>If the time specified by <span class='texttt'>rel_&shy;time</span> is less than or
equal to <span class='texttt'>rel_&shy;time<span class='operator'>.</span>zero<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, the function attempts to obtain ownership without blocking (as if by calling
<span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>)<a class='hidden_link' href='#timedmutex.requirements.general-5.sentence-2'>.</a></div> <div id='timedmutex.requirements.general-5.sentence-3' class='sentence'>The function returns within the timeout specified by
<span class='texttt'>rel_&shy;time</span> only if it has obtained ownership of the mutex object<a class='hidden_link' href='#timedmutex.requirements.general-5.sentence-3'>.</a></div> <div id='timedmutex.requirements.general-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#timedmutex.requirements.general-note-1'>1</a></i>: <div id='timedmutex.requirements.general-5.sentence-4' class='sentence'>As
with <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, there is no guarantee that ownership will be obtained if the
lock is available, but implementations are expected to make a strong effort to do so<a class='hidden_link' href='#timedmutex.requirements.general-5.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='timedmutex.requirements.general-6'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements.general-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2287'>#</a></div><div class='texpara'><div id='timedmutex.requirements.general-6.sentence-1' class='sentence'><i >Return type</i>: <span class='texttt'><span class='keyword'>bool</span></span><a class='hidden_link' href='#timedmutex.requirements.general-6.sentence-1'>.</a></div></div></div></div><div class='para' id='timedmutex.requirements.general-7'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements.general-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2290'>#</a></div><div class='texpara'><div id='timedmutex.requirements.general-7.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>true</span></span> if ownership was obtained, otherwise <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#timedmutex.requirements.general-7.sentence-1'>.</a></div></div></div></div><div class='para' id='timedmutex.requirements.general-8'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements.general-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2294'>#</a></div><div class='texpara'><div id='timedmutex.requirements.general-8.sentence-1' class='sentence'><i >Synchronization</i>: If <span class='texttt'>try_&shy;lock_&shy;for<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns <span class='texttt'><span class='literal'>true</span></span>, prior <span class='texttt'>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> operations
on the same object <a href='intro.multithread#def:synchronize_with' title='6.9.2&emsp;Multi-threaded executions and data races&emsp;[intro.multithread]'>synchronize with</a> this operation<a class='hidden_link' href='#timedmutex.requirements.general-8.sentence-1'>.</a></div></div></div></div><div class='para' id='timedmutex.requirements.general-9'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements.general-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2299'>#</a></div><div class='texpara'><div id='timedmutex.requirements.general-9.sentence-1' class='sentence'><i >Throws</i>: Timeout-related exceptions (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>)<a class='hidden_link' href='#timedmutex.requirements.general-9.sentence-1'>.</a></div></div></div></div><div class='para' id='timedmutex.requirements.general-10'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements.general-10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2304'>#</a></div><div class='texpara'><div id='timedmutex.requirements.general-10.sentence-1' class='sentence'>The expression <span class='texttt'>m<span class='operator'>.</span>try_&shy;lock_&shy;until<span class='parenthesis'>(</span>abs_&shy;time<span class='parenthesis'>)</span></span> is well-formed
and has the following semantics:</div></div></div><div class='para' id='timedmutex.requirements.general-11'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements.general-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2308'>#</a></div><div class='texpara'><div id='timedmutex.requirements.general-11.sentence-1' class='sentence'><i >Preconditions</i>: If <span class='texttt'>m</span> is of type <span class='texttt'>timed_&shy;mutex</span> or
<span class='texttt'>shared_&shy;timed_&shy;mutex</span>, the calling thread does not own the
mutex<a class='hidden_link' href='#timedmutex.requirements.general-11.sentence-1'>.</a></div></div></div></div><div class='para' id='timedmutex.requirements.general-12'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements.general-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2314'>#</a></div><div class='texpara'><div id='timedmutex.requirements.general-12.sentence-1' class='sentence'><i >Effects</i>: The function attempts to obtain ownership of the mutex<a class='hidden_link' href='#timedmutex.requirements.general-12.sentence-1'>.</a></div> <div id='timedmutex.requirements.general-12.sentence-2' class='sentence'>If
<span class='texttt'>abs_&shy;time</span> has already passed, the function attempts to obtain ownership
without blocking (as if by calling <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>)<a class='hidden_link' href='#timedmutex.requirements.general-12.sentence-2'>.</a></div> <div id='timedmutex.requirements.general-12.sentence-3' class='sentence'>The function
returns before the absolute timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>) specified by
<span class='texttt'>abs_&shy;time</span> only if it has obtained ownership of the mutex object<a class='hidden_link' href='#timedmutex.requirements.general-12.sentence-3'>.</a></div> <div id='timedmutex.requirements.general-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#timedmutex.requirements.general-note-2'>2</a></i>: <div id='timedmutex.requirements.general-12.sentence-4' class='sentence'>As with <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, there is no guarantee that ownership will
be obtained if the lock is available, but implementations are expected to make a
strong effort to do so<a class='hidden_link' href='#timedmutex.requirements.general-12.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='timedmutex.requirements.general-13'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements.general-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2327'>#</a></div><div class='texpara'><div id='timedmutex.requirements.general-13.sentence-1' class='sentence'><i >Return type</i>: <span class='texttt'><span class='keyword'>bool</span></span><a class='hidden_link' href='#timedmutex.requirements.general-13.sentence-1'>.</a></div></div></div></div><div class='para' id='timedmutex.requirements.general-14'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements.general-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2330'>#</a></div><div class='texpara'><div id='timedmutex.requirements.general-14.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>true</span></span> if ownership was obtained, otherwise <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#timedmutex.requirements.general-14.sentence-1'>.</a></div></div></div></div><div class='para' id='timedmutex.requirements.general-15'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements.general-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2334'>#</a></div><div class='texpara'><div id='timedmutex.requirements.general-15.sentence-1' class='sentence'><i >Synchronization</i>: If <span class='texttt'>try_&shy;lock_&shy;until<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns <span class='texttt'><span class='literal'>true</span></span>, prior <span class='texttt'>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
operations on the same object <a href='intro.multithread#def:synchronize_with' title='6.9.2&emsp;Multi-threaded executions and data races&emsp;[intro.multithread]'>synchronize with</a>
this operation<a class='hidden_link' href='#timedmutex.requirements.general-15.sentence-1'>.</a></div></div></div></div><div class='para' id='timedmutex.requirements.general-16'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.requirements.general-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2340'>#</a></div><div class='texpara'><div id='timedmutex.requirements.general-16.sentence-1' class='sentence'><i >Throws</i>: Timeout-related exceptions (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>)<a class='hidden_link' href='#timedmutex.requirements.general-16.sentence-1'>.</a></div></div></div></div></div><div id='timedmutex.class' class='section'><h4 ><a class='secnum' href='#timedmutex.class' style='min-width:110pt'>32.5.4.3.2</a> Class <span class='texttt'>timed_&shy;mutex</span> <a class='abbr_ref' href='thread.timedmutex.class'>[thread.timedmutex.class]</a></h4><div class='texpara'><span id='lib:timed_mutex'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:timed_mutex'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>class</span> timed_mutex <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    timed_mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='operator'>~</span>timed_mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    timed_mutex<span class='parenthesis'>(</span><span class='keyword'>const</span> timed_mutex<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    timed_mutex<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> timed_mutex<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;

    <span class='keyword'>void</span> lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;    <span class='comment'>// blocking</span>
    <span class='keyword'>bool</span> try_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
      <span class='keyword'>bool</span> try_lock_for<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
      <span class='keyword'>bool</span> try_lock_until<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span>;
    <span class='keyword'>void</span> unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    <span class='keyword'>using</span> native_handle_type <span class='operator'>=</span> <i >implementation-defined</i>;          <span class='comment'>// see <a href='#req.native' title='32.2.3&emsp;Native handles'>[thread.<span class='shy'></span>req.<span class='shy'></span>native]</a></span>
    native_handle_type native_handle<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                         <span class='comment'>// see <a href='#req.native' title='32.2.3&emsp;Native handles'>[thread.<span class='shy'></span>req.<span class='shy'></span>native]</a></span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></div><div class='para' id='timedmutex.class-1'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.class-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2372'>#</a></div><div class='texpara'><div id='timedmutex.class-1.sentence-1' class='sentence'><a class='index' id=':block_(execution)________'></a>The class <span class='texttt'>timed_&shy;mutex</span> provides a non-recursive mutex with exclusive ownership
semantics<a class='hidden_link' href='#timedmutex.class-1.sentence-1'>.</a></div> <div id='timedmutex.class-1.sentence-2' class='sentence'>If one thread owns a <span class='texttt'>timed_&shy;mutex</span> object, attempts by another thread
to acquire ownership of that object will fail (for <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>) or block
(for <span class='texttt'>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, <span class='texttt'>try_&shy;lock_&shy;for<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, and <span class='texttt'>try_&shy;lock_&shy;until<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>) until
the owning thread has released ownership with a call to <span class='texttt'>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> or the
call to <span class='texttt'>try_&shy;lock_&shy;for<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> or <span class='texttt'>try_&shy;lock_&shy;until<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> times out (having
failed to obtain ownership)<a class='hidden_link' href='#timedmutex.class-1.sentence-2'>.</a></div></div></div><div class='para' id='timedmutex.class-2'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.class-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2382'>#</a></div><div class='texpara'><div id='timedmutex.class-2.sentence-1' class='sentence'>The class <span class='texttt'>timed_&shy;mutex</span> meets
all of the timed mutex requirements (<a href='#timedmutex.requirements' title='32.5.4.3&emsp;Timed mutex types'>[thread.<span class='shy'></span>timedmutex.<span class='shy'></span>requirements]</a>)<a class='hidden_link' href='#timedmutex.class-2.sentence-1'>.</a></div> <div id='timedmutex.class-2.sentence-2' class='sentence'>It is a standard-layout class (<a href='class.prop' title='11.2&emsp;Properties of classes'>[class.<span class='shy'></span>prop]</a>)<a class='hidden_link' href='#timedmutex.class-2.sentence-2'>.</a></div></div></div><div class='para' id='timedmutex.class-3'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.class-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2387'>#</a></div><div class='texpara'><div id='timedmutex.class-3.sentence-1' class='sentence'>The behavior of a program is undefined if:
<ul class='itemize'><li id='timedmutex.class-3.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#timedmutex.class-3.1'>(3.1)</a></div>it destroys a <span class='texttt'>timed_&shy;mutex</span> object owned by any thread,</li><li id='timedmutex.class-3.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#timedmutex.class-3.2'>(3.2)</a></div>a thread that owns a <span class='texttt'>timed_&shy;mutex</span> object calls <span class='texttt'>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>,
<span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, <span class='texttt'>try_&shy;lock_&shy;for<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, or <span class='texttt'>try_&shy;lock_&shy;until<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> on that object, or</li><li id='timedmutex.class-3.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#timedmutex.class-3.3'>(3.3)</a></div>a thread terminates while owning a <span class='texttt'>timed_&shy;mutex</span> object<a class='hidden_link' href='#timedmutex.class-3.sentence-1'>.</a></li></ul></div></div></div></div><div id='timedmutex.recursive' class='section'><h4 ><a class='secnum' href='#timedmutex.recursive' style='min-width:110pt'>32.5.4.3.3</a> Class <span class='texttt'>recursive_&shy;timed_&shy;mutex</span> <a class='abbr_ref' href='thread.timedmutex.recursive'>[thread.timedmutex.recursive]</a></h4><div class='texpara'><span id='lib:recursive_timed_mutex'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:recursive_timed_mutex'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>class</span> recursive_timed_mutex <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    recursive_timed_mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='operator'>~</span>recursive_timed_mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    recursive_timed_mutex<span class='parenthesis'>(</span><span class='keyword'>const</span> recursive_timed_mutex<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    recursive_timed_mutex<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> recursive_timed_mutex<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;

    <span class='keyword'>void</span> lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;    <span class='comment'>// blocking</span>
    <span class='keyword'>bool</span> try_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
      <span class='keyword'>bool</span> try_lock_for<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
      <span class='keyword'>bool</span> try_lock_until<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span>;
    <span class='keyword'>void</span> unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    <span class='keyword'>using</span> native_handle_type <span class='operator'>=</span> <i >implementation-defined</i>;          <span class='comment'>// see <a href='#req.native' title='32.2.3&emsp;Native handles'>[thread.<span class='shy'></span>req.<span class='shy'></span>native]</a></span>
    native_handle_type native_handle<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                         <span class='comment'>// see <a href='#req.native' title='32.2.3&emsp;Native handles'>[thread.<span class='shy'></span>req.<span class='shy'></span>native]</a></span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></div><div class='para' id='timedmutex.recursive-1'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.recursive-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2423'>#</a></div><div class='texpara'><div id='timedmutex.recursive-1.sentence-1' class='sentence'><a class='index' id=':block_(execution)_________'></a>The class <span class='texttt'>recursive_&shy;timed_&shy;mutex</span> provides a recursive mutex with exclusive
ownership semantics<a class='hidden_link' href='#timedmutex.recursive-1.sentence-1'>.</a></div> <div id='timedmutex.recursive-1.sentence-2' class='sentence'>If one thread owns a <span class='texttt'>recursive_&shy;timed_&shy;mutex</span> object,
attempts by another thread to acquire ownership of that object will fail (for
<span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>) or block (for <span class='texttt'>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, <span class='texttt'>try_&shy;lock_&shy;for<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, and
<span class='texttt'>try_&shy;lock_&shy;until<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>) until the owning thread has completely released
ownership or the call to <span class='texttt'>try_&shy;lock_&shy;for<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> or <span class='texttt'>try_&shy;lock_&shy;until<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
times out (having failed to obtain ownership)<a class='hidden_link' href='#timedmutex.recursive-1.sentence-2'>.</a></div></div></div><div class='para' id='timedmutex.recursive-2'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.recursive-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2433'>#</a></div><div class='texpara'><div id='timedmutex.recursive-2.sentence-1' class='sentence'>The class <span class='texttt'>recursive_&shy;timed_&shy;mutex</span> meets
all of the timed mutex requirements (<a href='#timedmutex.requirements' title='32.5.4.3&emsp;Timed mutex types'>[thread.<span class='shy'></span>timedmutex.<span class='shy'></span>requirements]</a>)<a class='hidden_link' href='#timedmutex.recursive-2.sentence-1'>.</a></div> <div id='timedmutex.recursive-2.sentence-2' class='sentence'>It is a standard-layout class (<a href='class.prop' title='11.2&emsp;Properties of classes'>[class.<span class='shy'></span>prop]</a>)<a class='hidden_link' href='#timedmutex.recursive-2.sentence-2'>.</a></div></div></div><div class='para' id='timedmutex.recursive-3'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.recursive-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2438'>#</a></div><div class='texpara'><div id='timedmutex.recursive-3.sentence-1' class='sentence'>A thread that owns a <span class='texttt'>recursive_&shy;timed_&shy;mutex</span> object may acquire additional
levels of ownership by calling <span class='texttt'>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>,
<span class='texttt'>try_&shy;lock_&shy;for<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, or <span class='texttt'>try_&shy;lock_&shy;until<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> on that object<a class='hidden_link' href='#timedmutex.recursive-3.sentence-1'>.</a></div> <div id='timedmutex.recursive-3.sentence-2' class='sentence'>It is
unspecified how many levels of ownership may be acquired by a single thread<a class='hidden_link' href='#timedmutex.recursive-3.sentence-2'>.</a></div> <div id='timedmutex.recursive-3.sentence-3' class='sentence'>If
a thread has already acquired the maximum level of ownership for a
<span class='texttt'>recursive_&shy;timed_&shy;mutex</span> object, additional calls to <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>,
<span class='texttt'>try_&shy;lock_&shy;for<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, or <span class='texttt'>try_&shy;lock_&shy;until<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> fail, and additional
calls to <span class='texttt'>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> throw an exception of type <span class='texttt'>system_&shy;error</span><a class='hidden_link' href='#timedmutex.recursive-3.sentence-3'>.</a></div> <div id='timedmutex.recursive-3.sentence-4' class='sentence'>A
thread shall call <span class='texttt'>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> once for each level of ownership acquired by
calls to <span class='texttt'>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, <span class='texttt'>try_&shy;lock_&shy;for<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, and
<span class='texttt'>try_&shy;lock_&shy;until<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#timedmutex.recursive-3.sentence-4'>.</a></div> <div id='timedmutex.recursive-3.sentence-5' class='sentence'>Only when all levels of ownership have been released
may ownership of the object be acquired by another thread<a class='hidden_link' href='#timedmutex.recursive-3.sentence-5'>.</a></div></div></div><div class='para' id='timedmutex.recursive-4'><div class='marginalizedparent'><a class='marginalized' href='#timedmutex.recursive-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2452'>#</a></div><div class='texpara'><div id='timedmutex.recursive-4.sentence-1' class='sentence'>The behavior of a program is undefined if:
<ul class='itemize'><li id='timedmutex.recursive-4.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#timedmutex.recursive-4.1'>(4.1)</a></div>it destroys a <span class='texttt'>recursive_&shy;timed_&shy;mutex</span> object owned by any thread, or</li><li id='timedmutex.recursive-4.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#timedmutex.recursive-4.2'>(4.2)</a></div>a thread terminates while owning a <span class='texttt'>recursive_&shy;timed_&shy;mutex</span> object<a class='hidden_link' href='#timedmutex.recursive-4.sentence-1'>.</a></li></ul></div></div></div></div></div><div id='sharedmutex.requirements' class='section'><h4 ><a class='secnum' href='#sharedmutex.requirements' style='min-width:95pt'>32.5.4.4</a> Shared mutex types <a class='abbr_ref' href='thread.sharedmutex.requirements'>[thread.sharedmutex.requirements]</a></h4><div id='sharedmutex.requirements.general' class='section'><h4 ><a class='secnum' href='#sharedmutex.requirements.general' style='min-width:110pt'>32.5.4.4.1</a> General <a class='abbr_ref' href='thread.sharedmutex.requirements.general'>[thread.sharedmutex.requirements.general]</a></h4><div class='para' id='sharedmutex.requirements.general-1'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2464'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-1.sentence-1' class='sentence'>The standard library types <span class='texttt'>shared_&shy;mutex</span> and <span class='texttt'>shared_&shy;timed_&shy;mutex</span>
are <a class='hidden_link' href='#def:shared_mutex_types' title='32.5.4.4.1&emsp;General&emsp;[thread.sharedmutex.requirements.general]'><span id='def:shared_mutex_types'><i >shared mutex types</i></span></a><a class='hidden_link' href='#sharedmutex.requirements.general-1.sentence-1'>.</a></div> <div id='sharedmutex.requirements.general-1.sentence-2' class='sentence'>Shared mutex types meet the requirements of
mutex types (<a href='#mutex.requirements.mutex' title='32.5.4.2&emsp;Mutex types'>[thread.<span class='shy'></span>mutex.<span class='shy'></span>requirements.<span class='shy'></span>mutex]</a>) and additionally
meet the requirements set out below<a class='hidden_link' href='#sharedmutex.requirements.general-1.sentence-2'>.</a></div> <div id='sharedmutex.requirements.general-1.sentence-3' class='sentence'>In this description,
<span class='texttt'>m</span> denotes an object of a shared mutex type<a class='hidden_link' href='#sharedmutex.requirements.general-1.sentence-3'>.</a></div></div></div><div class='para' id='sharedmutex.requirements.general-2'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2471'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-2.sentence-1' class='sentence'><a class='index' id=':block_(execution)__________'></a>In addition to the exclusive lock ownership mode specified
in <a href='#mutex.requirements.mutex' title='32.5.4.2&emsp;Mutex types'>[thread.<span class='shy'></span>mutex.<span class='shy'></span>requirements.<span class='shy'></span>mutex]</a>, shared mutex types provide a
<a class='hidden_link' href='#def:shared_lock' title='32.5.4.4.1&emsp;General&emsp;[thread.sharedmutex.requirements.general]'><span id='def:shared_lock'><i >shared lock</i></span></a> ownership mode<a class='hidden_link' href='#sharedmutex.requirements.general-2.sentence-1'>.</a></div> <div id='sharedmutex.requirements.general-2.sentence-2' class='sentence'>Multiple execution agents can
simultaneously hold a shared lock ownership of a shared mutex type<a class='hidden_link' href='#sharedmutex.requirements.general-2.sentence-2'>.</a></div> <div id='sharedmutex.requirements.general-2.sentence-3' class='sentence'>But no
execution agent holds a shared lock while another execution agent holds an
exclusive lock on the same shared mutex type, and vice-versa<a class='hidden_link' href='#sharedmutex.requirements.general-2.sentence-3'>.</a></div> <div id='sharedmutex.requirements.general-2.sentence-4' class='sentence'>The maximum
number of execution agents which can share a shared lock on a single shared
mutex type is unspecified, but is at least 10000<a class='hidden_link' href='#sharedmutex.requirements.general-2.sentence-4'>.</a></div> <div id='sharedmutex.requirements.general-2.sentence-5' class='sentence'>If more than the
maximum number of execution agents attempt to obtain a shared lock, the
excess execution agents block until the number of shared locks are
reduced below the maximum amount by other execution agents releasing their
shared lock<a class='hidden_link' href='#sharedmutex.requirements.general-2.sentence-5'>.</a></div></div></div><div class='para' id='sharedmutex.requirements.general-3'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2486'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-3.sentence-1' class='sentence'>The expression <span class='texttt'>m<span class='operator'>.</span>lock_&shy;shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is well-formed and has the
following semantics:</div></div></div><div class='para' id='sharedmutex.requirements.general-4'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2490'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-4.sentence-1' class='sentence'><i >Preconditions</i>: The calling thread has no ownership of the mutex<a class='hidden_link' href='#sharedmutex.requirements.general-4.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedmutex.requirements.general-5'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2494'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-5.sentence-1' class='sentence'><a class='index' id=':block_(execution)___________'></a><i >Effects</i>: Blocks the calling thread until shared ownership of the mutex can be obtained for the calling thread<a class='hidden_link' href='#sharedmutex.requirements.general-5.sentence-1'>.</a></div> <div id='sharedmutex.requirements.general-5.sentence-2' class='sentence'>If an exception is thrown then a shared lock has not been acquired for the current thread<a class='hidden_link' href='#sharedmutex.requirements.general-5.sentence-2'>.</a></div></div></div></div><div class='para' id='sharedmutex.requirements.general-6'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2500'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-6.sentence-1' class='sentence'><i >Postconditions</i>: The calling thread has a shared lock on the mutex<a class='hidden_link' href='#sharedmutex.requirements.general-6.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedmutex.requirements.general-7'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2504'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-7.sentence-1' class='sentence'><i >Return type</i>: <span class='texttt'><span class='keyword'>void</span></span><a class='hidden_link' href='#sharedmutex.requirements.general-7.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedmutex.requirements.general-8'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2507'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-8.sentence-1' class='sentence'><i >Synchronization</i>: Prior <span class='texttt'>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> operations on the same object synchronize with (<a href='intro.multithread' title='6.9.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>) this operation<a class='hidden_link' href='#sharedmutex.requirements.general-8.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedmutex.requirements.general-9'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2511'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-9.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>system_&shy;error</span> when an exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#sharedmutex.requirements.general-9.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedmutex.requirements.general-10'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2515'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-10.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='sharedmutex.requirements.general-10.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#sharedmutex.requirements.general-10.1'>(10.1)</a></div><div class='texpara'><div id='sharedmutex.requirements.general-10.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if the thread does not have the privilege to perform the operation<a class='hidden_link' href='#sharedmutex.requirements.general-10.1.sentence-1'>.</a></div></div></li><li id='sharedmutex.requirements.general-10.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#sharedmutex.requirements.general-10.2'>(10.2)</a></div><div class='texpara'><div id='sharedmutex.requirements.general-10.2.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if the implementation detects that a deadlock would occur<a class='hidden_link' href='#sharedmutex.requirements.general-10.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='para' id='sharedmutex.requirements.general-11'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2523'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-11.sentence-1' class='sentence'>The expression <span class='texttt'>m<span class='operator'>.</span>unlock_&shy;shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is well-formed and has the following semantics:</div></div></div><div class='para' id='sharedmutex.requirements.general-12'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2526'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-12.sentence-1' class='sentence'><i >Preconditions</i>: The calling thread holds a shared lock on the mutex<a class='hidden_link' href='#sharedmutex.requirements.general-12.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedmutex.requirements.general-13'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2530'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-13.sentence-1' class='sentence'><i >Effects</i>: Releases a shared lock on the mutex held by the calling thread<a class='hidden_link' href='#sharedmutex.requirements.general-13.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedmutex.requirements.general-14'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2534'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-14.sentence-1' class='sentence'><i >Return type</i>: <span class='texttt'><span class='keyword'>void</span></span><a class='hidden_link' href='#sharedmutex.requirements.general-14.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedmutex.requirements.general-15'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2537'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-15.sentence-1' class='sentence'><i >Synchronization</i>: This operation <a href='intro.multithread#def:synchronize_with' title='6.9.2&emsp;Multi-threaded executions and data races&emsp;[intro.multithread]'>synchronizes with</a> subsequent
<span class='texttt'>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> operations that obtain ownership on the same object<a class='hidden_link' href='#sharedmutex.requirements.general-15.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedmutex.requirements.general-16'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2542'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-16.sentence-1' class='sentence'><i >Throws</i>: Nothing<a class='hidden_link' href='#sharedmutex.requirements.general-16.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedmutex.requirements.general-17'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-17'>17</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2547'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-17.sentence-1' class='sentence'>The expression <span class='texttt'>m<span class='operator'>.</span>try_&shy;lock_&shy;shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is well-formed and has the following semantics:</div></div></div><div class='para' id='sharedmutex.requirements.general-18'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2550'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-18.sentence-1' class='sentence'><i >Preconditions</i>: The calling thread has no ownership of the mutex<a class='hidden_link' href='#sharedmutex.requirements.general-18.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedmutex.requirements.general-19'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2554'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-19.sentence-1' class='sentence'><i >Effects</i>: Attempts to obtain shared ownership of the mutex for the calling
thread without blocking<a class='hidden_link' href='#sharedmutex.requirements.general-19.sentence-1'>.</a></div> <div id='sharedmutex.requirements.general-19.sentence-2' class='sentence'>If shared ownership is not obtained, there is no
effect and <span class='texttt'>try_&shy;lock_&shy;shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> immediately returns<a class='hidden_link' href='#sharedmutex.requirements.general-19.sentence-2'>.</a></div> <div id='sharedmutex.requirements.general-19.sentence-3' class='sentence'>An implementation
may fail to obtain the lock even if it is not held by any other thread<a class='hidden_link' href='#sharedmutex.requirements.general-19.sentence-3'>.</a></div></div></div></div><div class='para' id='sharedmutex.requirements.general-20'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2561'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-20.sentence-1' class='sentence'><i >Return type</i>: <span class='texttt'><span class='keyword'>bool</span></span><a class='hidden_link' href='#sharedmutex.requirements.general-20.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedmutex.requirements.general-21'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2564'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-21.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>true</span></span> if the shared lock was acquired, otherwise <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#sharedmutex.requirements.general-21.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedmutex.requirements.general-22'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2568'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-22.sentence-1' class='sentence'><i >Synchronization</i>: If <span class='texttt'>try_&shy;lock_&shy;shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns <span class='texttt'><span class='literal'>true</span></span>, prior <span class='texttt'>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
operations on the same object <a href='intro.multithread#def:synchronize_with' title='6.9.2&emsp;Multi-threaded executions and data races&emsp;[intro.multithread]'>synchronize with</a> this
operation<a class='hidden_link' href='#sharedmutex.requirements.general-22.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedmutex.requirements.general-23'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.requirements.general-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2574'>#</a></div><div class='texpara'><div id='sharedmutex.requirements.general-23.sentence-1' class='sentence'><i >Throws</i>: Nothing<a class='hidden_link' href='#sharedmutex.requirements.general-23.sentence-1'>.</a></div></div></div></div></div><div id='sharedmutex.class' class='section'><h4 ><a class='secnum' href='#sharedmutex.class' style='min-width:110pt'>32.5.4.4.2</a> Class <span class='texttt'>shared_&shy;mutex</span> <a class='abbr_ref' href='thread.sharedmutex.class'>[thread.sharedmutex.class]</a></h4><div class='texpara'><span id='lib:shared_mutex'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:shared_mutex'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>class</span> shared_mutex <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    shared_mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='operator'>~</span>shared_mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    shared_mutex<span class='parenthesis'>(</span><span class='keyword'>const</span> shared_mutex<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    shared_mutex<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> shared_mutex<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;

    <span class='comment'>// exclusive ownership</span>
    <span class='keyword'>void</span> lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                <span class='comment'>// blocking</span>
    <span class='keyword'>bool</span> try_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>void</span> unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    <span class='comment'>// shared ownership</span>
    <span class='keyword'>void</span> lock_shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;         <span class='comment'>// blocking</span>
    <span class='keyword'>bool</span> try_lock_shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>void</span> unlock_shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    <span class='keyword'>using</span> native_handle_type <span class='operator'>=</span> <i >implementation-defined</i>;          <span class='comment'>// see <a href='#req.native' title='32.2.3&emsp;Native handles'>[thread.<span class='shy'></span>req.<span class='shy'></span>native]</a></span>
    native_handle_type native_handle<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                         <span class='comment'>// see <a href='#req.native' title='32.2.3&emsp;Native handles'>[thread.<span class='shy'></span>req.<span class='shy'></span>native]</a></span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></div><div class='para' id='sharedmutex.class-1'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.class-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2608'>#</a></div><div class='texpara'><div id='sharedmutex.class-1.sentence-1' class='sentence'>The class <span class='texttt'>shared_&shy;mutex</span> provides a non-recursive mutex
with shared ownership semantics<a class='hidden_link' href='#sharedmutex.class-1.sentence-1'>.</a></div></div></div><div class='para' id='sharedmutex.class-2'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.class-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2612'>#</a></div><div class='texpara'><div id='sharedmutex.class-2.sentence-1' class='sentence'>The class <span class='texttt'>shared_&shy;mutex</span> meets
all of the shared mutex requirements (<a href='#sharedmutex.requirements' title='32.5.4.4&emsp;Shared mutex types'>[thread.<span class='shy'></span>sharedmutex.<span class='shy'></span>requirements]</a>)<a class='hidden_link' href='#sharedmutex.class-2.sentence-1'>.</a></div> <div id='sharedmutex.class-2.sentence-2' class='sentence'>It is a standard-layout class (<a href='class.prop' title='11.2&emsp;Properties of classes'>[class.<span class='shy'></span>prop]</a>)<a class='hidden_link' href='#sharedmutex.class-2.sentence-2'>.</a></div></div></div><div class='para' id='sharedmutex.class-3'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.class-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2617'>#</a></div><div class='texpara'><div id='sharedmutex.class-3.sentence-1' class='sentence'>The behavior of a program is undefined if:
<ul class='itemize'><li id='sharedmutex.class-3.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#sharedmutex.class-3.1'>(3.1)</a></div>it destroys a <span class='texttt'>shared_&shy;mutex</span> object owned by any thread,</li><li id='sharedmutex.class-3.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#sharedmutex.class-3.2'>(3.2)</a></div>a thread attempts to recursively gain any ownership of a <span class='texttt'>shared_&shy;mutex</span>, or</li><li id='sharedmutex.class-3.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#sharedmutex.class-3.3'>(3.3)</a></div>a thread terminates while possessing any ownership of a <span class='texttt'>shared_&shy;mutex</span><a class='hidden_link' href='#sharedmutex.class-3.sentence-1'>.</a></li></ul></div></div></div><div class='para' id='sharedmutex.class-4'><div class='marginalizedparent'><a class='marginalized' href='#sharedmutex.class-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2625'>#</a></div><div class='texpara'><div id='sharedmutex.class-4.sentence-1' class='sentence'><span class='texttt'>shared_&shy;mutex</span> may be a synonym for <span class='texttt'>shared_&shy;timed_&shy;mutex</span><a class='hidden_link' href='#sharedmutex.class-4.sentence-1'>.</a></div></div></div></div></div><div id='sharedtimedmutex.requirements' class='section'><h4 ><a class='secnum' href='#sharedtimedmutex.requirements' style='min-width:95pt'>32.5.4.5</a> Shared timed mutex types <a class='abbr_ref' href='thread.sharedtimedmutex.requirements'>[thread.sharedtimedmutex.requirements]</a></h4><div id='sharedtimedmutex.requirements.general' class='section'><h4 ><a class='secnum' href='#sharedtimedmutex.requirements.general' style='min-width:110pt'>32.5.4.5.1</a> General <a class='abbr_ref' href='thread.sharedtimedmutex.requirements.general'>[thread.sharedtimedmutex.requirements.general]</a></h4><div class='para' id='sharedtimedmutex.requirements.general-1'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2632'>#</a></div><div class='texpara'><div id='sharedtimedmutex.requirements.general-1.sentence-1' class='sentence'>The standard library type <span class='texttt'>shared_&shy;timed_&shy;mutex</span> is a
<a class='hidden_link' href='#def:shared_timed_mutex_type' title='32.5.4.5.1&emsp;General&emsp;[thread.sharedtimedmutex.requirements.general]'><span id='def:shared_timed_mutex_type'><i >shared timed mutex type</i></span></a><a class='hidden_link' href='#sharedtimedmutex.requirements.general-1.sentence-1'>.</a></div> <div id='sharedtimedmutex.requirements.general-1.sentence-2' class='sentence'>Shared timed mutex types meet the requirements of
timed mutex types (<a href='#timedmutex.requirements' title='32.5.4.3&emsp;Timed mutex types'>[thread.<span class='shy'></span>timedmutex.<span class='shy'></span>requirements]</a>),
shared mutex types (<a href='#sharedmutex.requirements' title='32.5.4.4&emsp;Shared mutex types'>[thread.<span class='shy'></span>sharedmutex.<span class='shy'></span>requirements]</a>), and additionally
meet the requirements set out below<a class='hidden_link' href='#sharedtimedmutex.requirements.general-1.sentence-2'>.</a></div> <div id='sharedtimedmutex.requirements.general-1.sentence-3' class='sentence'>In this description,
<span class='texttt'>m</span> denotes an object of a shared timed mutex type,
<span class='texttt'>rel_&shy;time</span> denotes an object of an instantiation of
<span class='texttt'>duration</span> (<a href='time.duration' title='27.5&emsp;Class template duration'>[time.<span class='shy'></span>duration]</a>), and
<span class='texttt'>abs_&shy;time</span> denotes an object of an instantiation of
<a href='time.point' title='27.6&emsp;Class template time_&shy;point&emsp;[time.point]'><span class='texttt'>time_&shy;point</span></a><a class='hidden_link' href='#sharedtimedmutex.requirements.general-1.sentence-3'>.</a></div></div></div><div class='para' id='sharedtimedmutex.requirements.general-2'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements.general-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2644'>#</a></div><div class='texpara'><div id='sharedtimedmutex.requirements.general-2.sentence-1' class='sentence'>The expression <span class='texttt'>m<span class='operator'>.</span>try_&shy;lock_&shy;shared_&shy;for<span class='parenthesis'>(</span>rel_&shy;time<span class='parenthesis'>)</span></span> is well-formed and
has the following semantics:</div></div></div><div class='para' id='sharedtimedmutex.requirements.general-3'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements.general-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2648'>#</a></div><div class='texpara'><div id='sharedtimedmutex.requirements.general-3.sentence-1' class='sentence'><i >Preconditions</i>: The calling thread has no ownership of the mutex<a class='hidden_link' href='#sharedtimedmutex.requirements.general-3.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedtimedmutex.requirements.general-4'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements.general-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2652'>#</a></div><div class='texpara'><div id='sharedtimedmutex.requirements.general-4.sentence-1' class='sentence'><i >Effects</i>: Attempts to obtain
shared lock ownership for the calling thread within the relative
timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>) specified by <span class='texttt'>rel_&shy;time</span><a class='hidden_link' href='#sharedtimedmutex.requirements.general-4.sentence-1'>.</a></div> <div id='sharedtimedmutex.requirements.general-4.sentence-2' class='sentence'>If the time
specified by <span class='texttt'>rel_&shy;time</span> is less than or equal to <span class='texttt'>rel_&shy;time<span class='operator'>.</span>zero<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>,
the function attempts to obtain ownership without blocking (as if by calling
<span class='texttt'>try_&shy;lock_&shy;shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>)<a class='hidden_link' href='#sharedtimedmutex.requirements.general-4.sentence-2'>.</a></div> <div id='sharedtimedmutex.requirements.general-4.sentence-3' class='sentence'>The function returns within the timeout
specified by <span class='texttt'>rel_&shy;time</span> only if it has obtained shared ownership of the
mutex object<a class='hidden_link' href='#sharedtimedmutex.requirements.general-4.sentence-3'>.</a></div> <div id='sharedtimedmutex.requirements.general-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#sharedtimedmutex.requirements.general-note-1'>1</a></i>: <div id='sharedtimedmutex.requirements.general-4.sentence-4' class='sentence'>As with <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, there is no guarantee that
ownership will be obtained if the lock is available, but implementations are
expected to make a strong effort to do so<a class='hidden_link' href='#sharedtimedmutex.requirements.general-4.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='sharedtimedmutex.requirements.general-4.sentence-5' class='sentence'>
If an exception is thrown then a shared lock has not been acquired for
the current thread<a class='hidden_link' href='#sharedtimedmutex.requirements.general-4.sentence-5'>.</a></div></div></div></div><div class='para' id='sharedtimedmutex.requirements.general-5'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements.general-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2670'>#</a></div><div class='texpara'><div id='sharedtimedmutex.requirements.general-5.sentence-1' class='sentence'><i >Return type</i>: <span class='texttt'><span class='keyword'>bool</span></span><a class='hidden_link' href='#sharedtimedmutex.requirements.general-5.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedtimedmutex.requirements.general-6'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements.general-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2673'>#</a></div><div class='texpara'><div id='sharedtimedmutex.requirements.general-6.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>true</span></span> if the shared lock was acquired, otherwise <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#sharedtimedmutex.requirements.general-6.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedtimedmutex.requirements.general-7'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements.general-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2677'>#</a></div><div class='texpara'><div id='sharedtimedmutex.requirements.general-7.sentence-1' class='sentence'><i >Synchronization</i>: If <span class='texttt'>try_&shy;lock_&shy;shared_&shy;for<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns <span class='texttt'><span class='literal'>true</span></span>, prior
<span class='texttt'>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> operations on the same object synchronize
with (<a href='intro.multithread' title='6.9.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>) this operation<a class='hidden_link' href='#sharedtimedmutex.requirements.general-7.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedtimedmutex.requirements.general-8'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements.general-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2683'>#</a></div><div class='texpara'><div id='sharedtimedmutex.requirements.general-8.sentence-1' class='sentence'><i >Throws</i>: Timeout-related exceptions (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>)<a class='hidden_link' href='#sharedtimedmutex.requirements.general-8.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedtimedmutex.requirements.general-9'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements.general-9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2688'>#</a></div><div class='texpara'><div id='sharedtimedmutex.requirements.general-9.sentence-1' class='sentence'>The expression <span class='texttt'>m<span class='operator'>.</span>try_&shy;lock_&shy;shared_&shy;until<span class='parenthesis'>(</span>abs_&shy;time<span class='parenthesis'>)</span></span> is well-formed
and has the following semantics:</div></div></div><div class='para' id='sharedtimedmutex.requirements.general-10'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements.general-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2692'>#</a></div><div class='texpara'><div id='sharedtimedmutex.requirements.general-10.sentence-1' class='sentence'><i >Preconditions</i>: The calling thread has no ownership of the mutex<a class='hidden_link' href='#sharedtimedmutex.requirements.general-10.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedtimedmutex.requirements.general-11'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements.general-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2696'>#</a></div><div class='texpara'><div id='sharedtimedmutex.requirements.general-11.sentence-1' class='sentence'><i >Effects</i>: The function attempts to obtain shared ownership of the mutex<a class='hidden_link' href='#sharedtimedmutex.requirements.general-11.sentence-1'>.</a></div> <div id='sharedtimedmutex.requirements.general-11.sentence-2' class='sentence'>If
<span class='texttt'>abs_&shy;time</span> has already passed, the function attempts to obtain shared
ownership without blocking (as if by calling <span class='texttt'>try_&shy;lock_&shy;shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>)<a class='hidden_link' href='#sharedtimedmutex.requirements.general-11.sentence-2'>.</a></div> <div id='sharedtimedmutex.requirements.general-11.sentence-3' class='sentence'>The
function returns before the absolute timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>)
specified by <span class='texttt'>abs_&shy;time</span> only if it has obtained shared ownership of the
mutex object<a class='hidden_link' href='#sharedtimedmutex.requirements.general-11.sentence-3'>.</a></div> <div id='sharedtimedmutex.requirements.general-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#sharedtimedmutex.requirements.general-note-2'>2</a></i>: <div id='sharedtimedmutex.requirements.general-11.sentence-4' class='sentence'>As with <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, there is no guarantee that
ownership will be obtained if the lock is available, but implementations are
expected to make a strong effort to do so<a class='hidden_link' href='#sharedtimedmutex.requirements.general-11.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='sharedtimedmutex.requirements.general-11.sentence-5' class='sentence'>
If an exception is thrown then a shared lock has not been acquired for
the current thread<a class='hidden_link' href='#sharedtimedmutex.requirements.general-11.sentence-5'>.</a></div></div></div></div><div class='para' id='sharedtimedmutex.requirements.general-12'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements.general-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2712'>#</a></div><div class='texpara'><div id='sharedtimedmutex.requirements.general-12.sentence-1' class='sentence'><i >Return type</i>: <span class='texttt'><span class='keyword'>bool</span></span><a class='hidden_link' href='#sharedtimedmutex.requirements.general-12.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedtimedmutex.requirements.general-13'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements.general-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2715'>#</a></div><div class='texpara'><div id='sharedtimedmutex.requirements.general-13.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>true</span></span> if the shared lock was acquired, otherwise <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#sharedtimedmutex.requirements.general-13.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedtimedmutex.requirements.general-14'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements.general-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2719'>#</a></div><div class='texpara'><div id='sharedtimedmutex.requirements.general-14.sentence-1' class='sentence'><i >Synchronization</i>: If <span class='texttt'>try_&shy;lock_&shy;shared_&shy;until<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns <span class='texttt'><span class='literal'>true</span></span>, prior
<span class='texttt'>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> operations on the same object synchronize
with (<a href='intro.multithread' title='6.9.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>) this operation<a class='hidden_link' href='#sharedtimedmutex.requirements.general-14.sentence-1'>.</a></div></div></div></div><div class='para' id='sharedtimedmutex.requirements.general-15'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.requirements.general-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2725'>#</a></div><div class='texpara'><div id='sharedtimedmutex.requirements.general-15.sentence-1' class='sentence'><i >Throws</i>: Timeout-related exceptions (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>)<a class='hidden_link' href='#sharedtimedmutex.requirements.general-15.sentence-1'>.</a></div></div></div></div></div><div id='sharedtimedmutex.class' class='section'><h4 ><a class='secnum' href='#sharedtimedmutex.class' style='min-width:110pt'>32.5.4.5.2</a> Class <span class='texttt'>shared_&shy;timed_&shy;mutex</span> <a class='abbr_ref' href='thread.sharedtimedmutex.class'>[thread.sharedtimedmutex.class]</a></h4><div class='texpara'><span id='lib:shared_timed_mutex'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:shared_timed_mutex'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>class</span> shared_timed_mutex <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    shared_timed_mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='operator'>~</span>shared_timed_mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    shared_timed_mutex<span class='parenthesis'>(</span><span class='keyword'>const</span> shared_timed_mutex<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    shared_timed_mutex<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> shared_timed_mutex<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;

    <span class='comment'>// exclusive ownership</span>
    <span class='keyword'>void</span> lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                <span class='comment'>// blocking</span>
    <span class='keyword'>bool</span> try_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
      <span class='keyword'>bool</span> try_lock_for<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
      <span class='keyword'>bool</span> try_lock_until<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span>;
    <span class='keyword'>void</span> unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    <span class='comment'>// shared ownership</span>
    <span class='keyword'>void</span> lock_shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;         <span class='comment'>// blocking</span>
    <span class='keyword'>bool</span> try_lock_shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
      <span class='keyword'>bool</span> try_lock_shared_for<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
      <span class='keyword'>bool</span> try_lock_shared_until<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span>;
    <span class='keyword'>void</span> unlock_shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></div><div class='para' id='sharedtimedmutex.class-1'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.class-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2764'>#</a></div><div class='texpara'><div id='sharedtimedmutex.class-1.sentence-1' class='sentence'>The class <span class='texttt'>shared_&shy;timed_&shy;mutex</span> provides a non-recursive mutex with shared
ownership semantics<a class='hidden_link' href='#sharedtimedmutex.class-1.sentence-1'>.</a></div></div></div><div class='para' id='sharedtimedmutex.class-2'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.class-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2768'>#</a></div><div class='texpara'><div id='sharedtimedmutex.class-2.sentence-1' class='sentence'>The class <span class='texttt'>shared_&shy;timed_&shy;mutex</span> meets
all of the shared timed mutex requirements (<a href='#sharedtimedmutex.requirements' title='32.5.4.5&emsp;Shared timed mutex types'>[thread.<span class='shy'></span>sharedtimedmutex.<span class='shy'></span>requirements]</a>)<a class='hidden_link' href='#sharedtimedmutex.class-2.sentence-1'>.</a></div> <div id='sharedtimedmutex.class-2.sentence-2' class='sentence'>It is a standard-layout class (<a href='class.prop' title='11.2&emsp;Properties of classes'>[class.<span class='shy'></span>prop]</a>)<a class='hidden_link' href='#sharedtimedmutex.class-2.sentence-2'>.</a></div></div></div><div class='para' id='sharedtimedmutex.class-3'><div class='marginalizedparent'><a class='marginalized' href='#sharedtimedmutex.class-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2773'>#</a></div><div class='texpara'><div id='sharedtimedmutex.class-3.sentence-1' class='sentence'>The behavior of a program is undefined if:
<ul class='itemize'><li id='sharedtimedmutex.class-3.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#sharedtimedmutex.class-3.1'>(3.1)</a></div>it destroys a <span class='texttt'>shared_&shy;timed_&shy;mutex</span> object owned by any thread,</li><li id='sharedtimedmutex.class-3.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#sharedtimedmutex.class-3.2'>(3.2)</a></div>a thread attempts to recursively gain any ownership of a <span class='texttt'>shared_&shy;timed_&shy;mutex</span>, or</li><li id='sharedtimedmutex.class-3.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#sharedtimedmutex.class-3.3'>(3.3)</a></div>a thread terminates while possessing any ownership of a <span class='texttt'>shared_&shy;timed_&shy;mutex</span><a class='hidden_link' href='#sharedtimedmutex.class-3.sentence-1'>.</a></li></ul></div></div></div></div></div></div><div id='lock' class='section'><h3 ><a class='secnum' href='#lock' style='min-width:80pt'>32.5.5</a> Locks <a class='abbr_ref' href='thread.lock'>[thread.lock]</a></h3><div id='lock.general' class='section'><h4 ><a class='secnum' href='#lock.general' style='min-width:95pt'>32.5.5.1</a> General <a class='abbr_ref' href='thread.lock.general'>[thread.lock.general]</a></h4><div class='para' id='lock.general-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2785'>#</a></div><div class='texpara'><div id='lock.general-1.sentence-1' class='sentence'>A <a class='hidden_link' href='#def:lock' id='def:lock'><i>lock</i></a> is an object that holds a reference to a lockable object and may unlock the
lockable object during the lock's destruction (such as when leaving block scope)<a class='hidden_link' href='#lock.general-1.sentence-1'>.</a></div> <div id='lock.general-1.sentence-2' class='sentence'>An execution
agent may use a lock to aid in managing ownership of a lockable object in an exception safe
manner<a class='hidden_link' href='#lock.general-1.sentence-2'>.</a></div> <div id='lock.general-1.sentence-3' class='sentence'>A lock is said to <a class='hidden_link' href='#def:own' id='def:own'><i>own</i></a> a lockable object if it is currently managing the
ownership of that lockable object for an execution agent<a class='hidden_link' href='#lock.general-1.sentence-3'>.</a></div> <div id='lock.general-1.sentence-4' class='sentence'>A lock does not manage the lifetime
of the lockable object it references<a class='hidden_link' href='#lock.general-1.sentence-4'>.</a></div> <div id='lock.general-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#lock.general-note-1'>1</a></i>: <div id='lock.general-1.sentence-5' class='sentence'>Locks are intended to ease the burden of
unlocking the lockable object under both normal and exceptional circumstances<a class='hidden_link' href='#lock.general-1.sentence-5'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='lock.general-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.general-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2797'>#</a></div><div class='texpara'><div id='lock.general-2.sentence-1' class='sentence'>Some lock constructors take tag types which describe what should be done with the lockable
object during the lock's construction<a class='hidden_link' href='#lock.general-2.sentence-1'>.</a></div></div><div class='texpara'><span id='lib:adopt_lock'><span id='lib:try_to_lock'><span id='lib:defer_lock'><span id='lib:adopt_lock_t'><span id='lib:try_to_lock_t'><span id='lib:defer_lock_t'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:defer_lock_t'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>struct</span> defer_lock_t  <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;     <span class='comment'>// do not acquire ownership of the mutex</span>
  <span class='keyword'>struct</span> try_to_lock_t <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;     <span class='comment'>// try to acquire ownership of the mutex</span>
                                <span class='comment'>// without blocking</span>
  <span class='keyword'>struct</span> adopt_lock_t  <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;     <span class='comment'>// assume the calling thread has already</span>
                                <span class='comment'>// obtained mutex ownership and manage it</span>

  <span class='keyword'>inline</span> <span class='keyword'>constexpr</span> defer_lock_t   defer_lock <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
  <span class='keyword'>inline</span> <span class='keyword'>constexpr</span> try_to_lock_t  try_to_lock <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
  <span class='keyword'>inline</span> <span class='keyword'>constexpr</span> adopt_lock_t   adopt_lock <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></span></span></span></span></span></div></div></div><div id='lock.guard' class='section'><h4 ><a class='secnum' href='#lock.guard' style='min-width:95pt'>32.5.5.2</a> Class template <span class='texttt'>lock_&shy;guard</span> <a class='abbr_ref' href='thread.lock.guard'>[thread.lock.guard]</a></h4><div class='texpara'><span id='lib:lock_guard'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:lock_guard'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Mutex<span class='anglebracket'>&gt;</span>
  <span class='keyword'>class</span> lock_guard <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    <span class='keyword'>using</span> mutex_type <span class='operator'>=</span> Mutex;

    <span class='keyword'>explicit</span> lock_guard<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m<span class='parenthesis'>)</span>;
    lock_guard<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m, adopt_lock_t<span class='parenthesis'>)</span>;
    <span class='operator'>~</span>lock_guard<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    lock_guard<span class='parenthesis'>(</span><span class='keyword'>const</span> lock_guard<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    lock_guard<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> lock_guard<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;

  <span class='keyword'>private</span><span class='operator'>:</span>
    mutex_type<span class='operator'>&amp;</span> pm;             <span class='comment'>// <i >exposition only</i></span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></div><div class='para' id='lock.guard-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.guard-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2844'>#</a></div><div class='texpara'><div id='lock.guard-1.sentence-1' class='sentence'>An object of type <span class='texttt'>lock_&shy;guard</span> controls the ownership of a lockable object
within a scope<a class='hidden_link' href='#lock.guard-1.sentence-1'>.</a></div> <div id='lock.guard-1.sentence-2' class='sentence'>A <span class='texttt'>lock_&shy;guard</span> object maintains ownership of a lockable
object throughout the <span class='texttt'>lock_&shy;guard</span> object's <a href='basic.life#def:lifetime' title='6.7.3&emsp;Lifetime&emsp;[basic.life]'>lifetime</a><a class='hidden_link' href='#lock.guard-1.sentence-2'>.</a></div> <div id='lock.guard-1.sentence-3' class='sentence'>The behavior of a program is undefined if the lockable object referenced by
<span class='texttt'>pm</span> does not exist for the entire lifetime of the <span class='texttt'>lock_&shy;guard</span>
object<a class='hidden_link' href='#lock.guard-1.sentence-3'>.</a></div> <div id='lock.guard-1.sentence-4' class='sentence'>The supplied <span class='texttt'>Mutex</span> type shall meet the <i >Cpp17BasicLockable</i>
requirements (<a href='#req.lockable.basic' title='32.2.5.2&emsp;Cpp17BasicLockable requirements'>[thread.<span class='shy'></span>req.<span class='shy'></span>lockable.<span class='shy'></span>basic]</a>)<a class='hidden_link' href='#lock.guard-1.sentence-4'>.</a></div></div></div><div class='texpara'><div id='lib:lock_guard,constructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:lock_guard,constructor'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>explicit</span> lock_guard<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='lock.guard-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.guard-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2859'>#</a></div><div class='texpara'><div id='lock.guard-2.sentence-1' class='sentence'><i >Preconditions</i>: If <span class='texttt'>mutex_&shy;type</span> is not a recursive mutex,
the calling thread does not own the mutex <span class='texttt'>m</span><a class='hidden_link' href='#lock.guard-2.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.guard-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.guard-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2864'>#</a></div><div class='texpara'><div id='lock.guard-3.sentence-1' class='sentence'><i >Effects</i>: Initializes <span class='texttt'>pm</span> with <span class='texttt'>m</span><a class='hidden_link' href='#lock.guard-3.sentence-1'>.</a></div> <div id='lock.guard-3.sentence-2' class='sentence'>Calls <span class='texttt'>m<span class='operator'>.</span>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.guard-3.sentence-2'>.</a></div></div></div></div><div class='texpara'><div id='lib:lock_guard,constructor_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:lock_guard,constructor_'>🔗</a></div><code class='itemdeclcode'>lock_guard<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m, adopt_lock_t<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='lock.guard-4'><div class='marginalizedparent'><a class='marginalized' href='#lock.guard-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2875'>#</a></div><div class='texpara'><div id='lock.guard-4.sentence-1' class='sentence'><i >Preconditions</i>: The calling thread owns the mutex <span class='texttt'>m</span><a class='hidden_link' href='#lock.guard-4.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.guard-5'><div class='marginalizedparent'><a class='marginalized' href='#lock.guard-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2879'>#</a></div><div class='texpara'><div id='lock.guard-5.sentence-1' class='sentence'><i >Effects</i>: Initializes <span class='texttt'>pm</span> with <span class='texttt'>m</span><a class='hidden_link' href='#lock.guard-5.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.guard-6'><div class='marginalizedparent'><a class='marginalized' href='#lock.guard-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2883'>#</a></div><div class='texpara'><div id='lock.guard-6.sentence-1' class='sentence'><i >Throws</i>: Nothing<a class='hidden_link' href='#lock.guard-6.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:lock_guard,destructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:lock_guard,destructor'>🔗</a></div><code class='itemdeclcode'><span class='operator'>~</span>lock_guard<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='lock.guard-7'><div class='marginalizedparent'><a class='marginalized' href='#lock.guard-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2894'>#</a></div><div class='texpara'><div id='lock.guard-7.sentence-1' class='sentence'><i >Effects</i>: As if by <span class='texttt'>pm<span class='operator'>.</span>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.guard-7.sentence-1'>.</a></div></div></div></div></div><div id='lock.scoped' class='section'><h4 ><a class='secnum' href='#lock.scoped' style='min-width:95pt'>32.5.5.3</a> Class template <span class='texttt'>scoped_&shy;lock</span> <a class='abbr_ref' href='thread.lock.scoped'>[thread.lock.scoped]</a></h4><div class='texpara'><span id='lib:scoped_lock'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:scoped_lock'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> MutexTypes<span class='anglebracket'>&gt;</span>
  <span class='keyword'>class</span> scoped_lock <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    <span class='keyword'>using</span> mutex_type <span class='operator'>=</span> <i ><span class='texttt'>see below</span></i>;     <span class='comment'>// Only if <span class='tcode_in_codeblock'>sizeof...(MutexTypes) == 1</span> is <span class='tcode_in_codeblock'>true</span></span>

    <span class='keyword'>explicit</span> scoped_lock<span class='parenthesis'>(</span>MutexTypes<span class='operator'>&amp;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> m<span class='parenthesis'>)</span>;
    <span class='keyword'>explicit</span> scoped_lock<span class='parenthesis'>(</span>adopt_lock_t, MutexTypes<span class='operator'>&amp;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> m<span class='parenthesis'>)</span>;
    <span class='operator'>~</span>scoped_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    scoped_lock<span class='parenthesis'>(</span><span class='keyword'>const</span> scoped_lock<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    scoped_lock<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> scoped_lock<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;

  <span class='keyword'>private</span><span class='operator'>:</span>
    tuple<span class='anglebracket'>&lt;</span>MutexTypes<span class='operator'>&amp;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span> pm;   <span class='comment'>// <i >exposition only</i></span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></div><div class='para' id='lock.scoped-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.scoped-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2923'>#</a></div><div class='texpara'><div id='lock.scoped-1.sentence-1' class='sentence'>An object of type <span class='texttt'>scoped_&shy;lock</span> controls the ownership of lockable objects
within a scope<a class='hidden_link' href='#lock.scoped-1.sentence-1'>.</a></div> <div id='lock.scoped-1.sentence-2' class='sentence'>A <span class='texttt'>scoped_&shy;lock</span> object maintains ownership of lockable
objects throughout the <span class='texttt'>scoped_&shy;lock</span> object's <a href='basic.life#def:lifetime' title='6.7.3&emsp;Lifetime&emsp;[basic.life]'>lifetime</a><a class='hidden_link' href='#lock.scoped-1.sentence-2'>.</a></div> <div id='lock.scoped-1.sentence-3' class='sentence'>The behavior of a program is undefined if the lockable objects referenced by
<span class='texttt'>pm</span> do not exist for the entire lifetime of the <span class='texttt'>scoped_&shy;lock</span>
object<a class='hidden_link' href='#lock.scoped-1.sentence-3'>.</a></div> <ul class='itemize'><li id='lock.scoped-1.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#lock.scoped-1.1'>(1.1)</a></div><div class='texpara'><div id='lock.scoped-1.1.sentence-1' class='sentence'>If <span class='texttt'><span class='keyword'>sizeof</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>(</span>MutexTypes<span class='parenthesis'>)</span></span> is one,
let <span class='texttt'>Mutex</span> denote the sole type constituting the pack <span class='texttt'>MutexTypes</span><a class='hidden_link' href='#lock.scoped-1.1.sentence-1'>.</a></div> <div id='lock.scoped-1.1.sentence-2' class='sentence'><span class='texttt'>Mutex</span>
shall meet the <i >Cpp17BasicLockable</i> requirements (<a href='#req.lockable.basic' title='32.2.5.2&emsp;Cpp17BasicLockable requirements'>[thread.<span class='shy'></span>req.<span class='shy'></span>lockable.<span class='shy'></span>basic]</a>)<a class='hidden_link' href='#lock.scoped-1.1.sentence-2'>.</a></div> <div id='lock.scoped-1.1.sentence-3' class='sentence'>The member <a href='dcl.typedef#nt:typedef-name' title='9.2.4&emsp;The typedef specifier&emsp;[dcl.typedef]'><span id='ntref:typedef-name'><span class='textsf'><i >typedef-name</i></span></span></a> <span class='texttt'>mutex_&shy;type</span>
denotes the same type as <span class='texttt'>Mutex</span><a class='hidden_link' href='#lock.scoped-1.1.sentence-3'>.</a></div></div></li><li id='lock.scoped-1.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#lock.scoped-1.2'>(1.2)</a></div><div class='texpara'><div id='lock.scoped-1.2.sentence-1' class='sentence'>Otherwise, all types in the template parameter pack <span class='texttt'>MutexTypes</span>
shall meet the <i >Cpp17Lockable</i> requirements (<a href='#req.lockable.req' title='32.2.5.3&emsp;Cpp17Lockable requirements'>[thread.<span class='shy'></span>req.<span class='shy'></span>lockable.<span class='shy'></span>req]</a>)
and there is no member <span class='texttt'>mutex_&shy;type</span><a class='hidden_link' href='#lock.scoped-1.2.sentence-1'>.</a></div></div></li></ul></div></div><div class='texpara'><div id='lib:scoped_lock,constructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:scoped_lock,constructor'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>explicit</span> scoped_lock<span class='parenthesis'>(</span>MutexTypes<span class='operator'>&amp;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> m<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='lock.scoped-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.scoped-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2950'>#</a></div><div class='texpara'><div id='lock.scoped-2.sentence-1' class='sentence'><i >Preconditions</i>: If a <span class='texttt'>MutexTypes</span> type is not a recursive mutex,
the calling thread does not own the corresponding mutex element of <span class='texttt'>m</span><a class='hidden_link' href='#lock.scoped-2.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.scoped-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.scoped-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2955'>#</a></div><div class='texpara'><div id='lock.scoped-3.sentence-1' class='sentence'><i >Effects</i>: Initializes <span class='texttt'>pm</span> with <span class='texttt'>tie<span class='parenthesis'>(</span>m<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.scoped-3.sentence-1'>.</a></div> <div id='lock.scoped-3.sentence-2' class='sentence'>Then if <span class='texttt'><span class='keyword'>sizeof</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>(</span>MutexTypes<span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>0</span></span>, no effects<a class='hidden_link' href='#lock.scoped-3.sentence-2'>.</a></div> <div id='lock.scoped-3.sentence-3' class='sentence'>Otherwise if <span class='texttt'><span class='keyword'>sizeof</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>(</span>MutexTypes<span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>1</span></span>, then <span class='texttt'>m<span class='operator'>.</span>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.scoped-3.sentence-3'>.</a></div> <div id='lock.scoped-3.sentence-4' class='sentence'>Otherwise, <span class='texttt'>lock<span class='parenthesis'>(</span>m<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.scoped-3.sentence-4'>.</a></div></div></div></div><div class='texpara'><div id='lib:scoped_lock,constructor_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:scoped_lock,constructor_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>explicit</span> scoped_lock<span class='parenthesis'>(</span>adopt_lock_t, MutexTypes<span class='operator'>&amp;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> m<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='lock.scoped-4'><div class='marginalizedparent'><a class='marginalized' href='#lock.scoped-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2969'>#</a></div><div class='texpara'><div id='lock.scoped-4.sentence-1' class='sentence'><i >Preconditions</i>: The calling thread owns all the mutexes in <span class='texttt'>m</span><a class='hidden_link' href='#lock.scoped-4.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.scoped-5'><div class='marginalizedparent'><a class='marginalized' href='#lock.scoped-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2973'>#</a></div><div class='texpara'><div id='lock.scoped-5.sentence-1' class='sentence'><i >Effects</i>: Initializes <span class='texttt'>pm</span> with <span class='texttt'>tie<span class='parenthesis'>(</span>m<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.scoped-5.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.scoped-6'><div class='marginalizedparent'><a class='marginalized' href='#lock.scoped-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2977'>#</a></div><div class='texpara'><div id='lock.scoped-6.sentence-1' class='sentence'><i >Throws</i>: Nothing<a class='hidden_link' href='#lock.scoped-6.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:scoped_lock,destructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:scoped_lock,destructor'>🔗</a></div><code class='itemdeclcode'><span class='operator'>~</span>scoped_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='lock.scoped-7'><div class='marginalizedparent'><a class='marginalized' href='#lock.scoped-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L2988'>#</a></div><div class='texpara'><div id='lock.scoped-7.sentence-1' class='sentence'><i >Effects</i>: For all <span class='texttt'>i</span> in [<span class='texttt'><span class='literal'>0</span>, <span class='keyword'>sizeof</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>(</span>MutexTypes<span class='parenthesis'>)</span></span>),
<span class='texttt'>get<span class='anglebracket'>&lt;</span>i<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>pm<span class='parenthesis'>)</span><span class='operator'>.</span>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.scoped-7.sentence-1'>.</a></div></div></div></div></div><div id='lock.unique' class='section'><h4 ><a class='secnum' href='#lock.unique' style='min-width:95pt'>32.5.5.4</a> Class template <span class='texttt'>unique_&shy;lock</span> <a class='abbr_ref' href='thread.lock.unique'>[thread.lock.unique]</a></h4><div id='lock.unique.general' class='section'><h4 ><a class='secnum' href='#lock.unique.general' style='min-width:110pt'>32.5.5.4.1</a> General <a class='abbr_ref' href='thread.lock.unique.general'>[thread.lock.unique.general]</a></h4><div class='texpara'><span id='lib:unique_lock'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:unique_lock'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Mutex<span class='anglebracket'>&gt;</span>
  <span class='keyword'>class</span> unique_lock <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    <span class='keyword'>using</span> mutex_type <span class='operator'>=</span> Mutex;

    <span class='comment'>// <a href='#lock.unique.cons' title='32.5.5.4.2&emsp;Constructors, destructor, and assignment'>[thread.<span class='shy'></span>lock.<span class='shy'></span>unique.<span class='shy'></span>cons]</a>, construct/copy/destroy</span>
    unique_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>explicit</span> unique_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m<span class='parenthesis'>)</span>;
    unique_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m, defer_lock_t<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    unique_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m, try_to_lock_t<span class='parenthesis'>)</span>;
    unique_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m, adopt_lock_t<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
      unique_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m, <span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
      unique_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m, <span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span>;
    <span class='operator'>~</span>unique_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    unique_lock<span class='parenthesis'>(</span><span class='keyword'>const</span> unique_lock<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    unique_lock<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> unique_lock<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;

    unique_lock<span class='parenthesis'>(</span>unique_lock<span class='operator'>&amp;</span><span class='operator'>&amp;</span> u<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    unique_lock<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>unique_lock<span class='operator'>&amp;</span><span class='operator'>&amp;</span> u<span class='parenthesis'>)</span>;

    <span class='comment'>// <a href='#lock.unique.locking' title='32.5.5.4.3&emsp;Locking'>[thread.<span class='shy'></span>lock.<span class='shy'></span>unique.<span class='shy'></span>locking]</a>, locking</span>
    <span class='keyword'>void</span> lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>bool</span> try_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
      <span class='keyword'>bool</span> try_lock_for<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
      <span class='keyword'>bool</span> try_lock_until<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span>;

    <span class='keyword'>void</span> unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    <span class='comment'>// <a href='#lock.unique.mod' title='32.5.5.4.4&emsp;Modifiers'>[thread.<span class='shy'></span>lock.<span class='shy'></span>unique.<span class='shy'></span>mod]</a>, modifiers</span>
    <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>unique_lock<span class='operator'>&amp;</span> u<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    mutex_type<span class='operator'>*</span> release<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    <span class='comment'>// <a href='#lock.unique.obs' title='32.5.5.4.5&emsp;Observers'>[thread.<span class='shy'></span>lock.<span class='shy'></span>unique.<span class='shy'></span>obs]</a>, observers</span>
    <span class='keyword'>bool</span> owns_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>explicit</span> <span class='keyword'>operator</span> <span class='keyword'>bool</span> <span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
    mutex_type<span class='operator'>*</span> mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;

  <span class='keyword'>private</span><span class='operator'>:</span>
    mutex_type<span class='operator'>*</span> pm;             <span class='comment'>// <i >exposition only</i></span>
    <span class='keyword'>bool</span> owns;                  <span class='comment'>// <i >exposition only</i></span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></div><div class='para' id='lock.unique.general-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3051'>#</a></div><div class='texpara'><div id='lock.unique.general-1.sentence-1' class='sentence'>An object of type <span class='texttt'>unique_&shy;lock</span> controls the ownership of a lockable
object within a scope<a class='hidden_link' href='#lock.unique.general-1.sentence-1'>.</a></div> <div id='lock.unique.general-1.sentence-2' class='sentence'>Ownership of the lockable object may be acquired at
construction or after construction, and may be transferred, after
acquisition, to another <span class='texttt'>unique_&shy;lock</span> object<a class='hidden_link' href='#lock.unique.general-1.sentence-2'>.</a></div> <div id='lock.unique.general-1.sentence-3' class='sentence'>Objects of type <span class='texttt'>unique_&shy;lock</span> are not
copyable but are movable<a class='hidden_link' href='#lock.unique.general-1.sentence-3'>.</a></div> <div id='lock.unique.general-1.sentence-4' class='sentence'>The behavior of a program is undefined if the contained pointer
<span class='texttt'>pm</span> is not null and the lockable object pointed
to by <span class='texttt'>pm</span> does not exist for the entire remaining
lifetime (<a href='basic.life' title='6.7.3&emsp;Lifetime'>[basic.<span class='shy'></span>life]</a>) of the <span class='texttt'>unique_&shy;lock</span> object<a class='hidden_link' href='#lock.unique.general-1.sentence-4'>.</a></div> <div id='lock.unique.general-1.sentence-5' class='sentence'>The supplied
<span class='texttt'>Mutex</span> type shall meet the <i >Cpp17BasicLockable</i>
requirements (<a href='#req.lockable.basic' title='32.2.5.2&emsp;Cpp17BasicLockable requirements'>[thread.<span class='shy'></span>req.<span class='shy'></span>lockable.<span class='shy'></span>basic]</a>)<a class='hidden_link' href='#lock.unique.general-1.sentence-5'>.</a></div></div></div><div class='para nonNormativeOnly' id='lock.unique.general-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.general-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3063'>#</a></div><div class='texpara'><div id='lock.unique.general-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#lock.unique.general-note-1'>1</a></i>: <div id='lock.unique.general-2.sentence-1' class='sentence'><span class='texttt'>unique_&shy;lock<span class='anglebracket'>&lt;</span>Mutex<span class='anglebracket'>&gt;</span></span> meets the <i >Cpp17BasicLockable</i> requirements<a class='hidden_link' href='#lock.unique.general-2.sentence-1'>.</a></div> <div id='lock.unique.general-2.sentence-2' class='sentence'>If <span class='texttt'>Mutex</span>
meets the <i >Cpp17Lockable</i> requirements (<a href='#req.lockable.req' title='32.2.5.3&emsp;Cpp17Lockable requirements'>[thread.<span class='shy'></span>req.<span class='shy'></span>lockable.<span class='shy'></span>req]</a>),
<span class='texttt'>unique_&shy;lock<span class='anglebracket'>&lt;</span>Mutex<span class='anglebracket'>&gt;</span></span> also meets the <i >Cpp17Lockable</i> requirements;
if <span class='texttt'>Mutex</span>
meets the <i >Cpp17TimedLockable</i> requirements (<a href='#req.lockable.timed' title='32.2.5.4&emsp;Cpp17TimedLockable requirements'>[thread.<span class='shy'></span>req.<span class='shy'></span>lockable.<span class='shy'></span>timed]</a>),
<span class='texttt'>unique_&shy;lock<span class='anglebracket'>&lt;</span>Mutex<span class='anglebracket'>&gt;</span></span> also meets the <i >Cpp17TimedLockable</i> requirements<a class='hidden_link' href='#lock.unique.general-2.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div id='lock.unique.cons' class='section'><h4 ><a class='secnum' href='#lock.unique.cons' style='min-width:110pt'>32.5.5.4.2</a> Constructors, destructor, and assignment <a class='abbr_ref' href='thread.lock.unique.cons'>[thread.lock.unique.cons]</a></h4><div class='texpara'><div id='lib:unique_lock,constructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:unique_lock,constructor'>🔗</a></div><code class='itemdeclcode'>unique_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='lock.unique.cons-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3081'>#</a></div><div class='texpara'><div id='lock.unique.cons-1.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>pm <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>0</span></span> and <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span><a class='hidden_link' href='#lock.unique.cons-1.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:unique_lock,constructor_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:unique_lock,constructor_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>explicit</span> unique_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='lock.unique.cons-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3092'>#</a></div><div class='texpara'><div id='lock.unique.cons-2.sentence-1' class='sentence'><i >Preconditions</i>: If <span class='texttt'>mutex_&shy;type</span> is not a recursive mutex the calling thread does not own the mutex<a class='hidden_link' href='#lock.unique.cons-2.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.cons-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3096'>#</a></div><div class='texpara'><div id='lock.unique.cons-3.sentence-1' class='sentence'><i >Effects</i>: Calls <span class='texttt'>m<span class='operator'>.</span>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.cons-3.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.cons-4'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3100'>#</a></div><div class='texpara'><div id='lock.unique.cons-4.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>pm <span class='operator'>=</span><span class='operator'>=</span> addressof<span class='parenthesis'>(</span>m<span class='parenthesis'>)</span></span> and <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>true</span></span><a class='hidden_link' href='#lock.unique.cons-4.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:unique_lock,constructor__'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:unique_lock,constructor__'>🔗</a></div><code class='itemdeclcode'>unique_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m, defer_lock_t<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='lock.unique.cons-5'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3111'>#</a></div><div class='texpara'><div id='lock.unique.cons-5.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>pm <span class='operator'>=</span><span class='operator'>=</span> addressof<span class='parenthesis'>(</span>m<span class='parenthesis'>)</span></span> and <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span><a class='hidden_link' href='#lock.unique.cons-5.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:unique_lock,constructor___'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:unique_lock,constructor___'>🔗</a></div><code class='itemdeclcode'>unique_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m, try_to_lock_t<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='lock.unique.cons-6'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3122'>#</a></div><div class='texpara'><div id='lock.unique.cons-6.sentence-1' class='sentence'><i >Preconditions</i>: The supplied <span class='texttt'>Mutex</span> type meets the <i >Cpp17Lockable</i>
requirements (<a href='#req.lockable.req' title='32.2.5.3&emsp;Cpp17Lockable requirements'>[thread.<span class='shy'></span>req.<span class='shy'></span>lockable.<span class='shy'></span>req]</a>)<a class='hidden_link' href='#lock.unique.cons-6.sentence-1'>.</a></div> <div id='lock.unique.cons-6.sentence-2' class='sentence'>If <span class='texttt'>mutex_&shy;type</span> is not a recursive mutex the calling thread does not own the mutex<a class='hidden_link' href='#lock.unique.cons-6.sentence-2'>.</a></div></div></div></div><div class='para' id='lock.unique.cons-7'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3128'>#</a></div><div class='texpara'><div id='lock.unique.cons-7.sentence-1' class='sentence'><i >Effects</i>: Calls <span class='texttt'>m<span class='operator'>.</span>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.cons-7.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.cons-8'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3132'>#</a></div><div class='texpara'><div id='lock.unique.cons-8.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>pm <span class='operator'>=</span><span class='operator'>=</span> addressof<span class='parenthesis'>(</span>m<span class='parenthesis'>)</span></span> and <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> res</span>,
where <span class='texttt'>res</span> is the value returned by the call to <span class='texttt'>m<span class='operator'>.</span>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.cons-8.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:unique_lock,constructor____'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:unique_lock,constructor____'>🔗</a></div><code class='itemdeclcode'>unique_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m, adopt_lock_t<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='lock.unique.cons-9'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3144'>#</a></div><div class='texpara'><div id='lock.unique.cons-9.sentence-1' class='sentence'><i >Preconditions</i>: The calling thread owns the mutex<a class='hidden_link' href='#lock.unique.cons-9.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.cons-10'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3148'>#</a></div><div class='texpara'><div id='lock.unique.cons-10.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>pm <span class='operator'>=</span><span class='operator'>=</span> addressof<span class='parenthesis'>(</span>m<span class='parenthesis'>)</span></span> and <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>true</span></span><a class='hidden_link' href='#lock.unique.cons-10.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.cons-11'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3152'>#</a></div><div class='texpara'><div id='lock.unique.cons-11.sentence-1' class='sentence'><i >Throws</i>: Nothing<a class='hidden_link' href='#lock.unique.cons-11.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:unique_lock,constructor_____'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:unique_lock,constructor_____'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
  unique_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m, <span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='lock.unique.cons-12'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3164'>#</a></div><div class='texpara'><div id='lock.unique.cons-12.sentence-1' class='sentence'><i >Preconditions</i>: If <span class='texttt'>mutex_&shy;type</span> is not a recursive mutex the calling thread
does not own the mutex<a class='hidden_link' href='#lock.unique.cons-12.sentence-1'>.</a></div> <div id='lock.unique.cons-12.sentence-2' class='sentence'>The supplied <span class='texttt'>Mutex</span> type meets the
<i >Cpp17TimedLockable</i> requirements (<a href='#req.lockable.timed' title='32.2.5.4&emsp;Cpp17TimedLockable requirements'>[thread.<span class='shy'></span>req.<span class='shy'></span>lockable.<span class='shy'></span>timed]</a>)<a class='hidden_link' href='#lock.unique.cons-12.sentence-2'>.</a></div></div></div></div><div class='para' id='lock.unique.cons-13'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3170'>#</a></div><div class='texpara'><div id='lock.unique.cons-13.sentence-1' class='sentence'><i >Effects</i>: Calls <span class='texttt'>m<span class='operator'>.</span>try_&shy;lock_&shy;until<span class='parenthesis'>(</span>abs_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.cons-13.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.cons-14'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3174'>#</a></div><div class='texpara'><div id='lock.unique.cons-14.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>pm <span class='operator'>=</span><span class='operator'>=</span> addressof<span class='parenthesis'>(</span>m<span class='parenthesis'>)</span></span> and <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> res</span>,
where <span class='texttt'>res</span> is
the value returned by the call to <span class='texttt'>m<span class='operator'>.</span>try_&shy;lock_&shy;until<span class='parenthesis'>(</span>abs_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.cons-14.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:unique_lock,constructor______'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:unique_lock,constructor______'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
  unique_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m, <span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='lock.unique.cons-15'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3188'>#</a></div><div class='texpara'><div id='lock.unique.cons-15.sentence-1' class='sentence'><i >Preconditions</i>: If <span class='texttt'>mutex_&shy;type</span> is not a recursive mutex the calling thread does not own the mutex<a class='hidden_link' href='#lock.unique.cons-15.sentence-1'>.</a></div> <div id='lock.unique.cons-15.sentence-2' class='sentence'>The supplied <span class='texttt'>Mutex</span> type meets the <i >Cpp17TimedLockable</i> requirements (<a href='#req.lockable.timed' title='32.2.5.4&emsp;Cpp17TimedLockable requirements'>[thread.<span class='shy'></span>req.<span class='shy'></span>lockable.<span class='shy'></span>timed]</a>)<a class='hidden_link' href='#lock.unique.cons-15.sentence-2'>.</a></div></div></div></div><div class='para' id='lock.unique.cons-16'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3193'>#</a></div><div class='texpara'><div id='lock.unique.cons-16.sentence-1' class='sentence'><i >Effects</i>: Calls <span class='texttt'>m<span class='operator'>.</span>try_&shy;lock_&shy;for<span class='parenthesis'>(</span>rel_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.cons-16.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.cons-17'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3197'>#</a></div><div class='texpara'><div id='lock.unique.cons-17.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>pm <span class='operator'>=</span><span class='operator'>=</span> addressof<span class='parenthesis'>(</span>m<span class='parenthesis'>)</span></span> and <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> res</span>,
where <span class='texttt'>res</span> is the value returned by the call to <span class='texttt'>m<span class='operator'>.</span>try_&shy;lock_&shy;for<span class='parenthesis'>(</span>rel_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.cons-17.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:unique_lock,constructor_______'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:unique_lock,constructor_______'>🔗</a></div><code class='itemdeclcode'>unique_lock<span class='parenthesis'>(</span>unique_lock<span class='operator'>&amp;</span><span class='operator'>&amp;</span> u<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='lock.unique.cons-18'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3209'>#</a></div><div class='texpara'><div id='lock.unique.cons-18.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>pm <span class='operator'>=</span><span class='operator'>=</span> u_&shy;p<span class='operator'>.</span>pm</span> and <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> u_&shy;p<span class='operator'>.</span>owns</span> (where <span class='texttt'>u_&shy;p</span> is the state of <span class='texttt'>u</span> just prior to this construction),  <span class='texttt'>u<span class='operator'>.</span>pm <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>0</span></span> and <span class='texttt'>u<span class='operator'>.</span>owns <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span><a class='hidden_link' href='#lock.unique.cons-18.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:unique_lock,operator='><div id='lib:operator=,unique_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:operator=,unique_lock'>🔗</a></div><code class='itemdeclcode'>unique_lock<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>unique_lock<span class='operator'>&amp;</span><span class='operator'>&amp;</span> u<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='lock.unique.cons-19'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3220'>#</a></div><div class='texpara'><div id='lock.unique.cons-19.sentence-1' class='sentence'><i >Effects</i>: If <span class='texttt'>owns</span> calls <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.cons-19.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.cons-20'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3224'>#</a></div><div class='texpara'><div id='lock.unique.cons-20.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>pm <span class='operator'>=</span><span class='operator'>=</span> u_&shy;p<span class='operator'>.</span>pm</span> and <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> u_&shy;p<span class='operator'>.</span>owns</span> (where <span class='texttt'>u_&shy;p</span> is the state of <span class='texttt'>u</span> just prior to this construction),  <span class='texttt'>u<span class='operator'>.</span>pm <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>0</span></span> and <span class='texttt'>u<span class='operator'>.</span>owns <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span><a class='hidden_link' href='#lock.unique.cons-20.sentence-1'>.</a></div></div></div></div><div class='para nonNormativeOnly' id='lock.unique.cons-21'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3228'>#</a></div><div class='texpara'><div id='lock.unique.cons-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#lock.unique.cons-note-1'>1</a></i>: <div id='lock.unique.cons-21.sentence-1' class='sentence'>With a recursive mutex it is possible for both <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> and <span class='texttt'>u</span> to own the same mutex before the assignment<a class='hidden_link' href='#lock.unique.cons-21.sentence-1'>.</a></div> <div id='lock.unique.cons-21.sentence-2' class='sentence'>In this case, <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> will own the mutex after the assignment and <span class='texttt'>u</span> will not<a class='hidden_link' href='#lock.unique.cons-21.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='lock.unique.cons-22'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3233'>#</a></div><div class='texpara'><div id='lock.unique.cons-22.sentence-1' class='sentence'><i >Throws</i>: Nothing<a class='hidden_link' href='#lock.unique.cons-22.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:unique_lock,destructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:unique_lock,destructor'>🔗</a></div><code class='itemdeclcode'><span class='operator'>~</span>unique_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='lock.unique.cons-23'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.cons-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3244'>#</a></div><div class='texpara'><div id='lock.unique.cons-23.sentence-1' class='sentence'><i >Effects</i>: If <span class='texttt'>owns</span> calls <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.cons-23.sentence-1'>.</a></div></div></div></div></div><div id='lock.unique.locking' class='section'><h4 ><a class='secnum' href='#lock.unique.locking' style='min-width:110pt'>32.5.5.4.3</a> Locking <a class='abbr_ref' href='thread.lock.unique.locking'>[thread.lock.unique.locking]</a></h4><div class='texpara'><div id='lib:unique_lock,lock'><div id='lib:lock,unique_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:lock,unique_lock'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='lock.unique.locking-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3257'>#</a></div><div class='texpara'><div id='lock.unique.locking-1.sentence-1' class='sentence'><i >Effects</i>: As if by <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.locking-1.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.locking-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3261'>#</a></div><div class='texpara'><div id='lock.unique.locking-2.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>true</span></span><a class='hidden_link' href='#lock.unique.locking-2.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.locking-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3265'>#</a></div><div class='texpara'><div id='lock.unique.locking-3.sentence-1' class='sentence'><i >Throws</i>: Any exception thrown by <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.locking-3.sentence-1'>.</a></div> <div id='lock.unique.locking-3.sentence-2' class='sentence'><span class='texttt'>system_&shy;error</span> when an exception
is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#lock.unique.locking-3.sentence-2'>.</a></div></div></div></div><div class='para' id='lock.unique.locking-4'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3270'>#</a></div><div class='texpara'><div id='lock.unique.locking-4.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='lock.unique.locking-4.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#lock.unique.locking-4.1'>(4.1)</a></div><div class='texpara'><div id='lock.unique.locking-4.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if <span class='texttt'>pm</span> is <span class='texttt'><span class='literal'>nullptr</span></span><a class='hidden_link' href='#lock.unique.locking-4.1.sentence-1'>.</a></div></div></li><li id='lock.unique.locking-4.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#lock.unique.locking-4.2'>(4.2)</a></div><div class='texpara'><div id='lock.unique.locking-4.2.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if on entry <span class='texttt'>owns</span>
is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#lock.unique.locking-4.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:unique_lock,try_lock'><div id='lib:try_lock,unique_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:try_lock,unique_lock'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>bool</span> try_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='lock.unique.locking-5'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3285'>#</a></div><div class='texpara'><div id='lock.unique.locking-5.sentence-1' class='sentence'><i >Preconditions</i>: The supplied <span class='texttt'>Mutex</span> meets the <i >Cpp17Lockable</i>
requirements (<a href='#req.lockable.req' title='32.2.5.3&emsp;Cpp17Lockable requirements'>[thread.<span class='shy'></span>req.<span class='shy'></span>lockable.<span class='shy'></span>req]</a>)<a class='hidden_link' href='#lock.unique.locking-5.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.locking-6'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3290'>#</a></div><div class='texpara'><div id='lock.unique.locking-6.sentence-1' class='sentence'><i >Effects</i>: As if by <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.locking-6.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.locking-7'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3294'>#</a></div><div class='texpara'><div id='lock.unique.locking-7.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> res</span>, where <span class='texttt'>res</span> is the value returned by
the call to <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.locking-7.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.locking-8'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3299'>#</a></div><div class='texpara'><div id='lock.unique.locking-8.sentence-1' class='sentence'><i >Returns</i>: The value returned by the call to <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.locking-8.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.locking-9'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3303'>#</a></div><div class='texpara'><div id='lock.unique.locking-9.sentence-1' class='sentence'><i >Throws</i>: Any exception thrown by <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.locking-9.sentence-1'>.</a></div> <div id='lock.unique.locking-9.sentence-2' class='sentence'><span class='texttt'>system_&shy;error</span> when an exception
is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#lock.unique.locking-9.sentence-2'>.</a></div></div></div></div><div class='para' id='lock.unique.locking-10'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3308'>#</a></div><div class='texpara'><div id='lock.unique.locking-10.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='lock.unique.locking-10.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#lock.unique.locking-10.1'>(10.1)</a></div><div class='texpara'><div id='lock.unique.locking-10.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if <span class='texttt'>pm</span> is <span class='texttt'><span class='literal'>nullptr</span></span><a class='hidden_link' href='#lock.unique.locking-10.1.sentence-1'>.</a></div></div></li><li id='lock.unique.locking-10.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#lock.unique.locking-10.2'>(10.2)</a></div><div class='texpara'><div id='lock.unique.locking-10.2.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if on entry <span class='texttt'>owns</span>
is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#lock.unique.locking-10.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:unique_lock,try_lock_until'><div id='lib:try_lock_until,unique_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:try_lock_until,unique_lock'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
  <span class='keyword'>bool</span> try_lock_until<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='lock.unique.locking-11'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3324'>#</a></div><div class='texpara'><div id='lock.unique.locking-11.sentence-1' class='sentence'><i >Preconditions</i>: The supplied <span class='texttt'>Mutex</span> type meets the <i >Cpp17TimedLockable</i>
requirements (<a href='#req.lockable.timed' title='32.2.5.4&emsp;Cpp17TimedLockable requirements'>[thread.<span class='shy'></span>req.<span class='shy'></span>lockable.<span class='shy'></span>timed]</a>)<a class='hidden_link' href='#lock.unique.locking-11.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.locking-12'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3329'>#</a></div><div class='texpara'><div id='lock.unique.locking-12.sentence-1' class='sentence'><i >Effects</i>: As if by <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>try_&shy;lock_&shy;until<span class='parenthesis'>(</span>abs_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.locking-12.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.locking-13'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3333'>#</a></div><div class='texpara'><div id='lock.unique.locking-13.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> res</span>, where <span class='texttt'>res</span> is the value returned by
the call to <span class='texttt'>try_&shy;lock_&shy;until<span class='parenthesis'>(</span>abs_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.locking-13.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.locking-14'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3338'>#</a></div><div class='texpara'><div id='lock.unique.locking-14.sentence-1' class='sentence'><i >Returns</i>: The value returned by the call to <span class='texttt'>try_&shy;lock_&shy;until<span class='parenthesis'>(</span>abs_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.locking-14.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.locking-15'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3342'>#</a></div><div class='texpara'><div id='lock.unique.locking-15.sentence-1' class='sentence'><i >Throws</i>: Any exception thrown by <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>try_&shy;lock_&shy;until<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.locking-15.sentence-1'>.</a></div> <div id='lock.unique.locking-15.sentence-2' class='sentence'><span class='texttt'>system_&shy;error</span> when an
exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#lock.unique.locking-15.sentence-2'>.</a></div></div></div></div><div class='para' id='lock.unique.locking-16'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3347'>#</a></div><div class='texpara'><div id='lock.unique.locking-16.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='lock.unique.locking-16.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#lock.unique.locking-16.1'>(16.1)</a></div><div class='texpara'><div id='lock.unique.locking-16.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if <span class='texttt'>pm</span> is <span class='texttt'><span class='literal'>nullptr</span></span><a class='hidden_link' href='#lock.unique.locking-16.1.sentence-1'>.</a></div></div></li><li id='lock.unique.locking-16.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#lock.unique.locking-16.2'>(16.2)</a></div><div class='texpara'><div id='lock.unique.locking-16.2.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if on entry <span class='texttt'>owns</span> is
<span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#lock.unique.locking-16.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:unique_lock,try_lock_for'><div id='lib:try_lock_for,unique_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:try_lock_for,unique_lock'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
  <span class='keyword'>bool</span> try_lock_for<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='lock.unique.locking-17'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3363'>#</a></div><div class='texpara'><div id='lock.unique.locking-17.sentence-1' class='sentence'><i >Preconditions</i>: The supplied <span class='texttt'>Mutex</span> type meets the <i >Cpp17TimedLockable</i> requirements (<a href='#req.lockable.timed' title='32.2.5.4&emsp;Cpp17TimedLockable requirements'>[thread.<span class='shy'></span>req.<span class='shy'></span>lockable.<span class='shy'></span>timed]</a>)<a class='hidden_link' href='#lock.unique.locking-17.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.locking-18'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3367'>#</a></div><div class='texpara'><div id='lock.unique.locking-18.sentence-1' class='sentence'><i >Effects</i>: As if by <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>try_&shy;lock_&shy;for<span class='parenthesis'>(</span>rel_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.locking-18.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.locking-19'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3371'>#</a></div><div class='texpara'><div id='lock.unique.locking-19.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> res</span>, where <span class='texttt'>res</span> is the value returned by the call to <span class='texttt'>try_&shy;lock_&shy;for<span class='parenthesis'>(</span>rel_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.locking-19.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.locking-20'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3375'>#</a></div><div class='texpara'><div id='lock.unique.locking-20.sentence-1' class='sentence'><i >Returns</i>: The value returned by the call to <span class='texttt'>try_&shy;lock_&shy;for<span class='parenthesis'>(</span>rel_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.locking-20.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.locking-21'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3379'>#</a></div><div class='texpara'><div id='lock.unique.locking-21.sentence-1' class='sentence'><i >Throws</i>: Any exception thrown by <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>try_&shy;lock_&shy;for<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.locking-21.sentence-1'>.</a></div> <div id='lock.unique.locking-21.sentence-2' class='sentence'><span class='texttt'>system_&shy;error</span> when an
exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#lock.unique.locking-21.sentence-2'>.</a></div></div></div></div><div class='para' id='lock.unique.locking-22'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3384'>#</a></div><div class='texpara'><div id='lock.unique.locking-22.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='lock.unique.locking-22.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#lock.unique.locking-22.1'>(22.1)</a></div><div class='texpara'><div id='lock.unique.locking-22.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if <span class='texttt'>pm</span> is <span class='texttt'><span class='literal'>nullptr</span></span><a class='hidden_link' href='#lock.unique.locking-22.1.sentence-1'>.</a></div></div></li><li id='lock.unique.locking-22.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#lock.unique.locking-22.2'>(22.2)</a></div><div class='texpara'><div id='lock.unique.locking-22.2.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if on entry <span class='texttt'>owns</span> is
<span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#lock.unique.locking-22.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:unique_lock,unlock'><div id='lib:unlock,unique_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:unlock,unique_lock'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='lock.unique.locking-23'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3399'>#</a></div><div class='texpara'><div id='lock.unique.locking-23.sentence-1' class='sentence'><i >Effects</i>: As if by <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.locking-23.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.locking-24'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-24'>24</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3403'>#</a></div><div class='texpara'><div id='lock.unique.locking-24.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span><a class='hidden_link' href='#lock.unique.locking-24.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.locking-25'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-25'>25</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3407'>#</a></div><div class='texpara'><div id='lock.unique.locking-25.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>system_&shy;error</span> when
an exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#lock.unique.locking-25.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.locking-26'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.locking-26'>26</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3412'>#</a></div><div class='texpara'><div id='lock.unique.locking-26.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='lock.unique.locking-26.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#lock.unique.locking-26.1'>(26.1)</a></div><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if on entry <span class='texttt'>owns</span> is <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#lock.unique.locking-26.sentence-1'>.</a></li></ul></div></div></div></div></div><div id='lock.unique.mod' class='section'><h4 ><a class='secnum' href='#lock.unique.mod' style='min-width:110pt'>32.5.5.4.4</a> Modifiers <a class='abbr_ref' href='thread.lock.unique.mod'>[thread.lock.unique.mod]</a></h4><div class='texpara'><div id='lib:unique_lock,swap'><div id='lib:swap,unique_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:swap,unique_lock'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> swap<span class='parenthesis'>(</span>unique_lock<span class='operator'>&amp;</span> u<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='lock.unique.mod-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.mod-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3427'>#</a></div><div class='texpara'><div id='lock.unique.mod-1.sentence-1' class='sentence'><i >Effects</i>: Swaps the data members of <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> and <span class='texttt'>u</span><a class='hidden_link' href='#lock.unique.mod-1.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:unique_lock,release'><div id='lib:release,unique_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:release,unique_lock'>🔗</a></div><code class='itemdeclcode'>mutex_type<span class='operator'>*</span> release<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='lock.unique.mod-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.mod-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3438'>#</a></div><div class='texpara'><div id='lock.unique.mod-2.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>pm <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>0</span></span> and <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span><a class='hidden_link' href='#lock.unique.mod-2.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.unique.mod-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.mod-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3442'>#</a></div><div class='texpara'><div id='lock.unique.mod-3.sentence-1' class='sentence'><i >Returns</i>: The previous value of <span class='texttt'>pm</span><a class='hidden_link' href='#lock.unique.mod-3.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:unique_lock,swap_'><div id='lib:swap,unique_lock_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:swap,unique_lock_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Mutex<span class='anglebracket'>&gt;</span>
  <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>unique_lock<span class='anglebracket'>&lt;</span>Mutex<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> x, unique_lock<span class='anglebracket'>&lt;</span>Mutex<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> y<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='lock.unique.mod-4'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.mod-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3454'>#</a></div><div class='texpara'><div id='lock.unique.mod-4.sentence-1' class='sentence'><i >Effects</i>: As if by <span class='texttt'>x<span class='operator'>.</span>swap<span class='parenthesis'>(</span>y<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.unique.mod-4.sentence-1'>.</a></div></div></div></div></div><div id='lock.unique.obs' class='section'><h4 ><a class='secnum' href='#lock.unique.obs' style='min-width:110pt'>32.5.5.4.5</a> Observers <a class='abbr_ref' href='thread.lock.unique.obs'>[thread.lock.unique.obs]</a></h4><div class='texpara'><div id='lib:unique_lock,owns_lock'><div id='lib:owns_lock,unique_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:owns_lock,unique_lock'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>bool</span> owns_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='lock.unique.obs-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.obs-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3467'>#</a></div><div class='texpara'><div id='lock.unique.obs-1.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>owns</span><a class='hidden_link' href='#lock.unique.obs-1.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:unique_lock,operator_bool'><div id='lib:operator_bool,unique_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:operator_bool,unique_lock'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>explicit</span> <span class='keyword'>operator</span> <span class='keyword'>bool</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='lock.unique.obs-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.obs-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3478'>#</a></div><div class='texpara'><div id='lock.unique.obs-2.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>owns</span><a class='hidden_link' href='#lock.unique.obs-2.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:unique_lock,mutex'><div id='lib:mutex,unique_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:mutex,unique_lock'>🔗</a></div><code class='itemdeclcode'>mutex_type <span class='operator'>*</span>mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='lock.unique.obs-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.unique.obs-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3489'>#</a></div><div class='texpara'><div id='lock.unique.obs-3.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>pm</span><a class='hidden_link' href='#lock.unique.obs-3.sentence-1'>.</a></div></div></div></div></div></div><div id='lock.shared' class='section'><h4 ><a class='secnum' href='#lock.shared' style='min-width:95pt'>32.5.5.5</a> Class template <span class='texttt'>shared_&shy;lock</span> <a class='abbr_ref' href='thread.lock.shared'>[thread.lock.shared]</a></h4><div id='lock.shared.general' class='section'><h4 ><a class='secnum' href='#lock.shared.general' style='min-width:110pt'>32.5.5.5.1</a> General <a class='abbr_ref' href='thread.lock.shared.general'>[thread.lock.shared.general]</a></h4><div class='texpara'><span id='lib:shared_lock'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:shared_lock'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Mutex<span class='anglebracket'>&gt;</span>
  <span class='keyword'>class</span> shared_lock <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    <span class='keyword'>using</span> mutex_type <span class='operator'>=</span> Mutex;

    <span class='comment'>// <a href='#lock.shared.cons' title='32.5.5.5.2&emsp;Constructors, destructor, and assignment'>[thread.<span class='shy'></span>lock.<span class='shy'></span>shared.<span class='shy'></span>cons]</a>, construct/copy/destroy</span>
    shared_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>explicit</span> shared_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m<span class='parenthesis'>)</span>;        <span class='comment'>// blocking</span>
    shared_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m, defer_lock_t<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    shared_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m, try_to_lock_t<span class='parenthesis'>)</span>;
    shared_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m, adopt_lock_t<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
      shared_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m, <span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
      shared_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m, <span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span>;
    <span class='operator'>~</span>shared_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    shared_lock<span class='parenthesis'>(</span><span class='keyword'>const</span> shared_lock<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    shared_lock<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> shared_lock<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;

    shared_lock<span class='parenthesis'>(</span>shared_lock<span class='operator'>&amp;</span><span class='operator'>&amp;</span> u<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    shared_lock<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>shared_lock<span class='operator'>&amp;</span><span class='operator'>&amp;</span> u<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    <span class='comment'>// <a href='#lock.shared.locking' title='32.5.5.5.3&emsp;Locking'>[thread.<span class='shy'></span>lock.<span class='shy'></span>shared.<span class='shy'></span>locking]</a>, locking</span>
    <span class='keyword'>void</span> lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                                <span class='comment'>// blocking</span>
    <span class='keyword'>bool</span> try_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
      <span class='keyword'>bool</span> try_lock_for<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
      <span class='keyword'>bool</span> try_lock_until<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span>;
    <span class='keyword'>void</span> unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    <span class='comment'>// <a href='#lock.shared.mod' title='32.5.5.5.4&emsp;Modifiers'>[thread.<span class='shy'></span>lock.<span class='shy'></span>shared.<span class='shy'></span>mod]</a>, modifiers</span>
    <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>shared_lock<span class='operator'>&amp;</span> u<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    mutex_type<span class='operator'>*</span> release<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    <span class='comment'>// <a href='#lock.shared.obs' title='32.5.5.5.5&emsp;Observers'>[thread.<span class='shy'></span>lock.<span class='shy'></span>shared.<span class='shy'></span>obs]</a>, observers</span>
    <span class='keyword'>bool</span> owns_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>explicit</span> <span class='keyword'>operator</span> <span class='keyword'>bool</span> <span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
    mutex_type<span class='operator'>*</span> mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;

  <span class='keyword'>private</span><span class='operator'>:</span>
    mutex_type<span class='operator'>*</span> pm;                             <span class='comment'>// <i >exposition only</i></span>
    <span class='keyword'>bool</span> owns;                                  <span class='comment'>// <i >exposition only</i></span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></div><div class='para' id='lock.shared.general-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3549'>#</a></div><div class='texpara'><div id='lock.shared.general-1.sentence-1' class='sentence'>An object of type <span class='texttt'>shared_&shy;lock</span> controls the shared ownership of a
lockable object within a scope<a class='hidden_link' href='#lock.shared.general-1.sentence-1'>.</a></div> <div id='lock.shared.general-1.sentence-2' class='sentence'>Shared ownership of the lockable object may be
acquired at construction or after construction, and may be transferred, after
acquisition, to another <span class='texttt'>shared_&shy;lock</span> object<a class='hidden_link' href='#lock.shared.general-1.sentence-2'>.</a></div> <div id='lock.shared.general-1.sentence-3' class='sentence'>Objects of type
<span class='texttt'>shared_&shy;lock</span> are not copyable but are movable<a class='hidden_link' href='#lock.shared.general-1.sentence-3'>.</a></div> <div id='lock.shared.general-1.sentence-4' class='sentence'>The behavior of a program
is undefined if the contained pointer <span class='texttt'>pm</span> is not null and the lockable
object pointed to by <span class='texttt'>pm</span> does not exist for the entire remaining
lifetime (<a href='basic.life' title='6.7.3&emsp;Lifetime'>[basic.<span class='shy'></span>life]</a>) of the <span class='texttt'>shared_&shy;lock</span> object<a class='hidden_link' href='#lock.shared.general-1.sentence-4'>.</a></div> <div id='lock.shared.general-1.sentence-5' class='sentence'>The supplied
<span class='texttt'>Mutex</span> type shall meet the shared mutex
requirements (<a href='#sharedtimedmutex.requirements' title='32.5.4.5&emsp;Shared timed mutex types'>[thread.<span class='shy'></span>sharedtimedmutex.<span class='shy'></span>requirements]</a>)<a class='hidden_link' href='#lock.shared.general-1.sentence-5'>.</a></div></div></div><div class='para nonNormativeOnly' id='lock.shared.general-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.general-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3561'>#</a></div><div class='texpara'><div id='lock.shared.general-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#lock.shared.general-note-1'>1</a></i>: <div id='lock.shared.general-2.sentence-1' class='sentence'><span class='texttt'>shared_&shy;lock<span class='anglebracket'>&lt;</span>Mutex<span class='anglebracket'>&gt;</span></span> meets the <i >Cpp17TimedLockable</i>
requirements (<a href='#req.lockable.timed' title='32.2.5.4&emsp;Cpp17TimedLockable requirements'>[thread.<span class='shy'></span>req.<span class='shy'></span>lockable.<span class='shy'></span>timed]</a>)<a class='hidden_link' href='#lock.shared.general-2.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div id='lock.shared.cons' class='section'><h4 ><a class='secnum' href='#lock.shared.cons' style='min-width:110pt'>32.5.5.5.2</a> Constructors, destructor, and assignment <a class='abbr_ref' href='thread.lock.shared.cons'>[thread.lock.shared.cons]</a></h4><div class='texpara'><div id='lib:shared_lock,constructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:shared_lock,constructor'>🔗</a></div><code class='itemdeclcode'>shared_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='lock.shared.cons-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3575'>#</a></div><div class='texpara'><div id='lock.shared.cons-1.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>pm <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>nullptr</span></span> and <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span><a class='hidden_link' href='#lock.shared.cons-1.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:shared_lock,constructor_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:shared_lock,constructor_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>explicit</span> shared_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='lock.shared.cons-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3586'>#</a></div><div class='texpara'><div id='lock.shared.cons-2.sentence-1' class='sentence'><i >Preconditions</i>: The calling thread does not own the mutex for any ownership mode<a class='hidden_link' href='#lock.shared.cons-2.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.cons-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3590'>#</a></div><div class='texpara'><div id='lock.shared.cons-3.sentence-1' class='sentence'><i >Effects</i>: Calls <span class='texttt'>m<span class='operator'>.</span>lock_&shy;shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.cons-3.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.cons-4'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3594'>#</a></div><div class='texpara'><div id='lock.shared.cons-4.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>pm <span class='operator'>=</span><span class='operator'>=</span> addressof<span class='parenthesis'>(</span>m<span class='parenthesis'>)</span></span> and <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>true</span></span><a class='hidden_link' href='#lock.shared.cons-4.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:shared_lock,constructor__'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:shared_lock,constructor__'>🔗</a></div><code class='itemdeclcode'>shared_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m, defer_lock_t<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='lock.shared.cons-5'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3605'>#</a></div><div class='texpara'><div id='lock.shared.cons-5.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>pm <span class='operator'>=</span><span class='operator'>=</span> addressof<span class='parenthesis'>(</span>m<span class='parenthesis'>)</span></span> and <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span><a class='hidden_link' href='#lock.shared.cons-5.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:shared_lock,constructor___'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:shared_lock,constructor___'>🔗</a></div><code class='itemdeclcode'>shared_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m, try_to_lock_t<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='lock.shared.cons-6'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3616'>#</a></div><div class='texpara'><div id='lock.shared.cons-6.sentence-1' class='sentence'><i >Preconditions</i>: The calling thread does not own the mutex for any ownership mode<a class='hidden_link' href='#lock.shared.cons-6.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.cons-7'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3620'>#</a></div><div class='texpara'><div id='lock.shared.cons-7.sentence-1' class='sentence'><i >Effects</i>: Calls <span class='texttt'>m<span class='operator'>.</span>try_&shy;lock_&shy;shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.cons-7.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.cons-8'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3624'>#</a></div><div class='texpara'><div id='lock.shared.cons-8.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>pm <span class='operator'>=</span><span class='operator'>=</span> addressof<span class='parenthesis'>(</span>m<span class='parenthesis'>)</span></span> and <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> res</span>
where <span class='texttt'>res</span> is the
value returned by the call to <span class='texttt'>m<span class='operator'>.</span>try_&shy;lock_&shy;shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.cons-8.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:shared_lock,constructor____'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:shared_lock,constructor____'>🔗</a></div><code class='itemdeclcode'>shared_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m, adopt_lock_t<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='lock.shared.cons-9'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3637'>#</a></div><div class='texpara'><div id='lock.shared.cons-9.sentence-1' class='sentence'><i >Preconditions</i>: The calling thread has shared ownership of the mutex<a class='hidden_link' href='#lock.shared.cons-9.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.cons-10'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3641'>#</a></div><div class='texpara'><div id='lock.shared.cons-10.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>pm <span class='operator'>=</span><span class='operator'>=</span> addressof<span class='parenthesis'>(</span>m<span class='parenthesis'>)</span></span> and <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>true</span></span><a class='hidden_link' href='#lock.shared.cons-10.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:shared_lock,constructor_____'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:shared_lock,constructor_____'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
  shared_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m,
              <span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='lock.shared.cons-11'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3654'>#</a></div><div class='texpara'><div id='lock.shared.cons-11.sentence-1' class='sentence'><i >Preconditions</i>: The calling thread does not own the mutex for any ownership mode<a class='hidden_link' href='#lock.shared.cons-11.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.cons-12'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3658'>#</a></div><div class='texpara'><div id='lock.shared.cons-12.sentence-1' class='sentence'><i >Effects</i>: Calls <span class='texttt'>m<span class='operator'>.</span>try_&shy;lock_&shy;shared_&shy;until<span class='parenthesis'>(</span>abs_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.cons-12.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.cons-13'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3662'>#</a></div><div class='texpara'><div id='lock.shared.cons-13.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>pm <span class='operator'>=</span><span class='operator'>=</span> addressof<span class='parenthesis'>(</span>m<span class='parenthesis'>)</span></span> and <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> res</span>
where <span class='texttt'>res</span>
is the value returned by the call to <span class='texttt'>m<span class='operator'>.</span>try_&shy;lock_&shy;shared_&shy;until<span class='parenthesis'>(</span>abs_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.cons-13.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:shared_lock,constructor______'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:shared_lock,constructor______'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
  shared_lock<span class='parenthesis'>(</span>mutex_type<span class='operator'>&amp;</span> m,
              <span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='lock.shared.cons-14'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3677'>#</a></div><div class='texpara'><div id='lock.shared.cons-14.sentence-1' class='sentence'><i >Preconditions</i>: The calling thread does not own the mutex for any ownership mode<a class='hidden_link' href='#lock.shared.cons-14.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.cons-15'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3681'>#</a></div><div class='texpara'><div id='lock.shared.cons-15.sentence-1' class='sentence'><i >Effects</i>: Calls <span class='texttt'>m<span class='operator'>.</span>try_&shy;lock_&shy;shared_&shy;for<span class='parenthesis'>(</span>rel_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.cons-15.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.cons-16'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3685'>#</a></div><div class='texpara'><div id='lock.shared.cons-16.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>pm <span class='operator'>=</span><span class='operator'>=</span> addressof<span class='parenthesis'>(</span>m<span class='parenthesis'>)</span></span> and <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> res</span>
where <span class='texttt'>res</span> is
the value returned by the call to <span class='texttt'>m<span class='operator'>.</span>try_&shy;lock_&shy;shared_&shy;for<span class='parenthesis'>(</span>rel_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.cons-16.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:shared_lock,destructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:shared_lock,destructor'>🔗</a></div><code class='itemdeclcode'><span class='operator'>~</span>shared_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='lock.shared.cons-17'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3698'>#</a></div><div class='texpara'><div id='lock.shared.cons-17.sentence-1' class='sentence'><i >Effects</i>: If <span class='texttt'>owns</span> calls <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>unlock_&shy;shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.cons-17.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:shared_lock,constructor_______'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:shared_lock,constructor_______'>🔗</a></div><code class='itemdeclcode'>shared_lock<span class='parenthesis'>(</span>shared_lock<span class='operator'>&amp;</span><span class='operator'>&amp;</span> sl<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='lock.shared.cons-18'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3709'>#</a></div><div class='texpara'><div id='lock.shared.cons-18.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>pm <span class='operator'>=</span><span class='operator'>=</span> sl_&shy;p<span class='operator'>.</span>pm</span> and <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> sl_&shy;p<span class='operator'>.</span>owns</span> (where
<span class='texttt'>sl_&shy;p</span> is the state of <span class='texttt'>sl</span> just prior to this construction),
<span class='texttt'>sl<span class='operator'>.</span>pm <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>nullptr</span></span> and <span class='texttt'>sl<span class='operator'>.</span>owns <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span><a class='hidden_link' href='#lock.shared.cons-18.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:shared_lock,operator='><div id='lib:operator=,shared_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:operator=,shared_lock'>🔗</a></div><code class='itemdeclcode'>shared_lock<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>shared_lock<span class='operator'>&amp;</span><span class='operator'>&amp;</span> sl<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='lock.shared.cons-19'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3722'>#</a></div><div class='texpara'><div id='lock.shared.cons-19.sentence-1' class='sentence'><i >Effects</i>: If <span class='texttt'>owns</span> calls <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>unlock_&shy;shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.cons-19.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.cons-20'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.cons-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3726'>#</a></div><div class='texpara'><div id='lock.shared.cons-20.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>pm <span class='operator'>=</span><span class='operator'>=</span> sl_&shy;p<span class='operator'>.</span>pm</span> and <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> sl_&shy;p<span class='operator'>.</span>owns</span> (where
<span class='texttt'>sl_&shy;p</span> is the state of <span class='texttt'>sl</span> just prior to this assignment),
<span class='texttt'>sl<span class='operator'>.</span>pm <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>nullptr</span></span> and <span class='texttt'>sl<span class='operator'>.</span>owns <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span><a class='hidden_link' href='#lock.shared.cons-20.sentence-1'>.</a></div></div></div></div></div><div id='lock.shared.locking' class='section'><h4 ><a class='secnum' href='#lock.shared.locking' style='min-width:110pt'>32.5.5.5.3</a> Locking <a class='abbr_ref' href='thread.lock.shared.locking'>[thread.lock.shared.locking]</a></h4><div class='texpara'><div id='lib:shared_lock,lock'><div id='lib:lock,shared_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:lock,shared_lock'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='lock.shared.locking-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3741'>#</a></div><div class='texpara'><div id='lock.shared.locking-1.sentence-1' class='sentence'><i >Effects</i>: As if by <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>lock_&shy;shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.locking-1.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.locking-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3745'>#</a></div><div class='texpara'><div id='lock.shared.locking-2.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>true</span></span><a class='hidden_link' href='#lock.shared.locking-2.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.locking-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3749'>#</a></div><div class='texpara'><div id='lock.shared.locking-3.sentence-1' class='sentence'><i >Throws</i>: Any exception thrown by <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>lock_&shy;shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.locking-3.sentence-1'>.</a></div> <div id='lock.shared.locking-3.sentence-2' class='sentence'><span class='texttt'>system_&shy;error</span> when an exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#lock.shared.locking-3.sentence-2'>.</a></div></div></div></div><div class='para' id='lock.shared.locking-4'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3754'>#</a></div><div class='texpara'><div id='lock.shared.locking-4.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='lock.shared.locking-4.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#lock.shared.locking-4.1'>(4.1)</a></div><div class='texpara'><div id='lock.shared.locking-4.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if <span class='texttt'>pm</span> is <span class='texttt'><span class='literal'>nullptr</span></span><a class='hidden_link' href='#lock.shared.locking-4.1.sentence-1'>.</a></div></div></li><li id='lock.shared.locking-4.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#lock.shared.locking-4.2'>(4.2)</a></div><div class='texpara'><div id='lock.shared.locking-4.2.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if on entry <span class='texttt'>owns</span> is
<span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#lock.shared.locking-4.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:shared_lock,try_lock'><div id='lib:try_lock,shared_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:try_lock,shared_lock'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>bool</span> try_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='lock.shared.locking-5'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3769'>#</a></div><div class='texpara'><div id='lock.shared.locking-5.sentence-1' class='sentence'><i >Effects</i>: As if by <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>try_&shy;lock_&shy;shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.locking-5.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.locking-6'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3773'>#</a></div><div class='texpara'><div id='lock.shared.locking-6.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> res</span>, where <span class='texttt'>res</span> is the value returned by
the call to <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>try_&shy;lock_&shy;shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.locking-6.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.locking-7'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3778'>#</a></div><div class='texpara'><div id='lock.shared.locking-7.sentence-1' class='sentence'><i >Returns</i>: The value returned by the call to <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>try_&shy;lock_&shy;shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.locking-7.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.locking-8'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3782'>#</a></div><div class='texpara'><div id='lock.shared.locking-8.sentence-1' class='sentence'><i >Throws</i>: Any exception thrown by <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>try_&shy;lock_&shy;shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.locking-8.sentence-1'>.</a></div> <div id='lock.shared.locking-8.sentence-2' class='sentence'><span class='texttt'>system_&shy;error</span> when an exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#lock.shared.locking-8.sentence-2'>.</a></div></div></div></div><div class='para' id='lock.shared.locking-9'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3787'>#</a></div><div class='texpara'><div id='lock.shared.locking-9.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='lock.shared.locking-9.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#lock.shared.locking-9.1'>(9.1)</a></div><div class='texpara'><div id='lock.shared.locking-9.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if <span class='texttt'>pm</span> is <span class='texttt'><span class='literal'>nullptr</span></span><a class='hidden_link' href='#lock.shared.locking-9.1.sentence-1'>.</a></div></div></li><li id='lock.shared.locking-9.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#lock.shared.locking-9.2'>(9.2)</a></div><div class='texpara'><div id='lock.shared.locking-9.2.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if on entry <span class='texttt'>owns</span> is
<span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#lock.shared.locking-9.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:shared_lock,try_lock_until'><div id='lib:try_lock_until,shared_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:try_lock_until,shared_lock'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
  <span class='keyword'>bool</span> try_lock_until<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='lock.shared.locking-10'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3803'>#</a></div><div class='texpara'><div id='lock.shared.locking-10.sentence-1' class='sentence'><i >Effects</i>: As if by <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>try_&shy;lock_&shy;shared_&shy;until<span class='parenthesis'>(</span>abs_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.locking-10.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.locking-11'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3807'>#</a></div><div class='texpara'><div id='lock.shared.locking-11.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> res</span>, where <span class='texttt'>res</span> is the value returned by
the call to <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>try_&shy;lock_&shy;shared_&shy;until<span class='parenthesis'>(</span>abs_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.locking-11.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.locking-12'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3812'>#</a></div><div class='texpara'><div id='lock.shared.locking-12.sentence-1' class='sentence'><i >Returns</i>: The value returned by the call to
<span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>try_&shy;lock_&shy;shared_&shy;until<span class='parenthesis'>(</span>abs_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.locking-12.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.locking-13'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3817'>#</a></div><div class='texpara'><div id='lock.shared.locking-13.sentence-1' class='sentence'><i >Throws</i>: Any exception thrown by <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>try_&shy;lock_&shy;shared_&shy;until<span class='parenthesis'>(</span>abs_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.locking-13.sentence-1'>.</a></div> <div id='lock.shared.locking-13.sentence-2' class='sentence'><span class='texttt'>system_&shy;error</span> when an exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#lock.shared.locking-13.sentence-2'>.</a></div></div></div></div><div class='para' id='lock.shared.locking-14'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3822'>#</a></div><div class='texpara'><div id='lock.shared.locking-14.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='lock.shared.locking-14.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#lock.shared.locking-14.1'>(14.1)</a></div><div class='texpara'><div id='lock.shared.locking-14.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if <span class='texttt'>pm</span> is <span class='texttt'><span class='literal'>nullptr</span></span><a class='hidden_link' href='#lock.shared.locking-14.1.sentence-1'>.</a></div></div></li><li id='lock.shared.locking-14.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#lock.shared.locking-14.2'>(14.2)</a></div><div class='texpara'><div id='lock.shared.locking-14.2.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if on entry <span class='texttt'>owns</span> is
<span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#lock.shared.locking-14.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:shared_lock,try_lock_for'><div id='lib:try_lock_for,shared_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:try_lock_for,shared_lock'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
  <span class='keyword'>bool</span> try_lock_for<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='lock.shared.locking-15'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3838'>#</a></div><div class='texpara'><div id='lock.shared.locking-15.sentence-1' class='sentence'><i >Effects</i>: As if by <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>try_&shy;lock_&shy;shared_&shy;for<span class='parenthesis'>(</span>rel_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.locking-15.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.locking-16'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3842'>#</a></div><div class='texpara'><div id='lock.shared.locking-16.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> res</span>, where <span class='texttt'>res</span> is the value returned by the call to <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>try_&shy;lock_&shy;shared_&shy;for<span class='parenthesis'>(</span>rel_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.locking-16.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.locking-17'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3846'>#</a></div><div class='texpara'><div id='lock.shared.locking-17.sentence-1' class='sentence'><i >Returns</i>: The value returned by the call to <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>try_&shy;lock_&shy;shared_&shy;for<span class='parenthesis'>(</span>rel_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.locking-17.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.locking-18'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3850'>#</a></div><div class='texpara'><div id='lock.shared.locking-18.sentence-1' class='sentence'><i >Throws</i>: Any exception thrown by <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>try_&shy;lock_&shy;shared_&shy;for<span class='parenthesis'>(</span>rel_&shy;time<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.locking-18.sentence-1'>.</a></div> <div id='lock.shared.locking-18.sentence-2' class='sentence'><span class='texttt'>system_&shy;error</span> when an exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#lock.shared.locking-18.sentence-2'>.</a></div></div></div></div><div class='para' id='lock.shared.locking-19'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3854'>#</a></div><div class='texpara'><div id='lock.shared.locking-19.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='lock.shared.locking-19.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#lock.shared.locking-19.1'>(19.1)</a></div><div class='texpara'><div id='lock.shared.locking-19.1.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if <span class='texttt'>pm</span> is <span class='texttt'><span class='literal'>nullptr</span></span><a class='hidden_link' href='#lock.shared.locking-19.1.sentence-1'>.</a></div></div></li><li id='lock.shared.locking-19.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#lock.shared.locking-19.2'>(19.2)</a></div><div class='texpara'><div id='lock.shared.locking-19.2.sentence-1' class='sentence'><span class='texttt'>resource_&shy;deadlock_&shy;would_&shy;occur</span> — if on entry <span class='texttt'>owns</span> is
<span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#lock.shared.locking-19.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:shared_lock,unlock'><div id='lib:unlock,shared_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:unlock,shared_lock'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='lock.shared.locking-20'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3869'>#</a></div><div class='texpara'><div id='lock.shared.locking-20.sentence-1' class='sentence'><i >Effects</i>: As if by <span class='texttt'>pm<span class='operator'>-</span><span class='anglebracket'>&gt;</span>unlock_&shy;shared<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.locking-20.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.locking-21'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3873'>#</a></div><div class='texpara'><div id='lock.shared.locking-21.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span><a class='hidden_link' href='#lock.shared.locking-21.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.locking-22'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3877'>#</a></div><div class='texpara'><div id='lock.shared.locking-22.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>system_&shy;error</span> when an exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#lock.shared.locking-22.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.locking-23'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.locking-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3881'>#</a></div><div class='texpara'><div id='lock.shared.locking-23.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='lock.shared.locking-23.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#lock.shared.locking-23.1'>(23.1)</a></div><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if on entry <span class='texttt'>owns</span> is
<span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#lock.shared.locking-23.sentence-1'>.</a></li></ul></div></div></div></div></div><div id='lock.shared.mod' class='section'><h4 ><a class='secnum' href='#lock.shared.mod' style='min-width:110pt'>32.5.5.5.4</a> Modifiers <a class='abbr_ref' href='thread.lock.shared.mod'>[thread.lock.shared.mod]</a></h4><div class='texpara'><div id='lib:shared_lock,swap'><div id='lib:swap,shared_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:swap,shared_lock'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> swap<span class='parenthesis'>(</span>shared_lock<span class='operator'>&amp;</span> sl<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='lock.shared.mod-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.mod-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3897'>#</a></div><div class='texpara'><div id='lock.shared.mod-1.sentence-1' class='sentence'><i >Effects</i>: Swaps the data members of <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> and <span class='texttt'>sl</span><a class='hidden_link' href='#lock.shared.mod-1.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:shared_lock,release'><div id='lib:release,shared_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:release,shared_lock'>🔗</a></div><code class='itemdeclcode'>mutex_type<span class='operator'>*</span> release<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='lock.shared.mod-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.mod-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3908'>#</a></div><div class='texpara'><div id='lock.shared.mod-2.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>pm <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>nullptr</span></span> and <span class='texttt'>owns <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span><a class='hidden_link' href='#lock.shared.mod-2.sentence-1'>.</a></div></div></div></div><div class='para' id='lock.shared.mod-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.mod-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3912'>#</a></div><div class='texpara'><div id='lock.shared.mod-3.sentence-1' class='sentence'><i >Returns</i>: The previous value of <span class='texttt'>pm</span><a class='hidden_link' href='#lock.shared.mod-3.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:shared_lock,swap_'><div id='lib:swap,shared_lock_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:swap,shared_lock_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Mutex<span class='anglebracket'>&gt;</span>
  <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>shared_lock<span class='anglebracket'>&lt;</span>Mutex<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> x, shared_lock<span class='anglebracket'>&lt;</span>Mutex<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> y<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='lock.shared.mod-4'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.mod-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3924'>#</a></div><div class='texpara'><div id='lock.shared.mod-4.sentence-1' class='sentence'><i >Effects</i>: As if by <span class='texttt'>x<span class='operator'>.</span>swap<span class='parenthesis'>(</span>y<span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.shared.mod-4.sentence-1'>.</a></div></div></div></div></div><div id='lock.shared.obs' class='section'><h4 ><a class='secnum' href='#lock.shared.obs' style='min-width:110pt'>32.5.5.5.5</a> Observers <a class='abbr_ref' href='thread.lock.shared.obs'>[thread.lock.shared.obs]</a></h4><div class='texpara'><div id='lib:shared_lock,owns_lock'><div id='lib:owns_lock,shared_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:owns_lock,shared_lock'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>bool</span> owns_lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='lock.shared.obs-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.obs-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3937'>#</a></div><div class='texpara'><div id='lock.shared.obs-1.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>owns</span><a class='hidden_link' href='#lock.shared.obs-1.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:shared_lock,operator_bool'><div id='lib:operator_bool,shared_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:operator_bool,shared_lock'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>explicit</span> <span class='keyword'>operator</span> <span class='keyword'>bool</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='lock.shared.obs-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.obs-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3948'>#</a></div><div class='texpara'><div id='lock.shared.obs-2.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>owns</span><a class='hidden_link' href='#lock.shared.obs-2.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:shared_lock,mutex'><div id='lib:mutex,shared_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:mutex,shared_lock'>🔗</a></div><code class='itemdeclcode'>mutex_type<span class='operator'>*</span> mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='lock.shared.obs-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.shared.obs-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3959'>#</a></div><div class='texpara'><div id='lock.shared.obs-3.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>pm</span><a class='hidden_link' href='#lock.shared.obs-3.sentence-1'>.</a></div></div></div></div></div></div></div><div id='lock.algorithm' class='section'><h3 ><a class='secnum' href='#lock.algorithm' style='min-width:80pt'>32.5.6</a> Generic locking algorithms <a class='abbr_ref' href='thread.lock.algorithm'>[thread.lock.algorithm]</a></h3><div class='texpara'><div id='lib:try_lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:try_lock'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> L1, <span class='keyword'>class</span> L2, <span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> L3<span class='anglebracket'>&gt;</span> <span class='keyword'>int</span> try_lock<span class='parenthesis'>(</span>L1<span class='operator'>&amp;</span>, L2<span class='operator'>&amp;</span>, L3<span class='operator'>&amp;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='lock.algorithm-1'><div class='marginalizedparent'><a class='marginalized' href='#lock.algorithm-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3972'>#</a></div><div class='texpara'><div id='lock.algorithm-1.sentence-1' class='sentence'><i >Preconditions</i>: Each template parameter type meets the <i >Cpp17Lockable</i> requirements<a class='hidden_link' href='#lock.algorithm-1.sentence-1'>.</a></div> <div id='lock.algorithm-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#lock.algorithm-note-1'>1</a></i>: <div id='lock.algorithm-1.sentence-2' class='sentence'>The
<span class='texttt'>unique_&shy;lock</span> class template meets these requirements when suitably instantiated<a class='hidden_link' href='#lock.algorithm-1.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='lock.algorithm-2'><div class='marginalizedparent'><a class='marginalized' href='#lock.algorithm-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3980'>#</a></div><div class='texpara'><div id='lock.algorithm-2.sentence-1' class='sentence'><i >Effects</i>: Calls <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> for each argument in order beginning with the
first until all arguments have been processed or a call to <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> fails,
either by returning <span class='texttt'><span class='literal'>false</span></span> or by throwing an exception<a class='hidden_link' href='#lock.algorithm-2.sentence-1'>.</a></div> <div id='lock.algorithm-2.sentence-2' class='sentence'>If a call to
<span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> fails, <span class='texttt'>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is called for all prior arguments
with no further calls to <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.algorithm-2.sentence-2'>.</a></div></div></div></div><div class='para' id='lock.algorithm-3'><div class='marginalizedparent'><a class='marginalized' href='#lock.algorithm-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L3988'>#</a></div><div class='texpara'><div id='lock.algorithm-3.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='operator'>-</span><span class='literal'>1</span></span> if all calls to <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returned <span class='texttt'><span class='literal'>true</span></span>,
otherwise a zero-based index value that indicates the argument for which <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
returned <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#lock.algorithm-3.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:lock'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:lock'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> L1, <span class='keyword'>class</span> L2, <span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> L3<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> lock<span class='parenthesis'>(</span>L1<span class='operator'>&amp;</span>, L2<span class='operator'>&amp;</span>, L3<span class='operator'>&amp;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='lock.algorithm-4'><div class='marginalizedparent'><a class='marginalized' href='#lock.algorithm-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4001'>#</a></div><div class='texpara'><div id='lock.algorithm-4.sentence-1' class='sentence'><i >Preconditions</i>: Each template parameter type meets the <i >Cpp17Lockable</i> requirements<a class='hidden_link' href='#lock.algorithm-4.sentence-1'>.</a></div> <div id='lock.algorithm-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#lock.algorithm-note-2'>2</a></i>: <div id='lock.algorithm-4.sentence-2' class='sentence'>The
<span class='texttt'>unique_&shy;lock</span> class template meets these requirements when suitably instantiated<a class='hidden_link' href='#lock.algorithm-4.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='lock.algorithm-5'><div class='marginalizedparent'><a class='marginalized' href='#lock.algorithm-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4009'>#</a></div><div class='texpara'><div id='lock.algorithm-5.sentence-1' class='sentence'><i >Effects</i>: All arguments are locked via a sequence of calls to <span class='texttt'>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>,
<span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, or <span class='texttt'>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> on each argument<a class='hidden_link' href='#lock.algorithm-5.sentence-1'>.</a></div> <div id='lock.algorithm-5.sentence-2' class='sentence'>The sequence of calls does
not result in deadlock, but is otherwise unspecified<a class='hidden_link' href='#lock.algorithm-5.sentence-2'>.</a></div> <div id='lock.algorithm-note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#lock.algorithm-note-3'>3</a></i>: <div id='lock.algorithm-5.sentence-3' class='sentence'>A deadlock avoidance
algorithm such as try-and-back-off can be used, but the specific algorithm is not
specified to avoid over-constraining implementations<a class='hidden_link' href='#lock.algorithm-5.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='lock.algorithm-5.sentence-4' class='sentence'>
If a call to
<span class='texttt'>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> or <span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> throws an exception, <span class='texttt'>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is
called for any argument that had been locked by a call to <span class='texttt'>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> or
<span class='texttt'>try_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#lock.algorithm-5.sentence-4'>.</a></div></div></div></div></div><div id='once' class='section'><h3 ><a class='secnum' href='#once' style='min-width:80pt'>32.5.7</a> Call once <a class='abbr_ref' href='thread.once'>[thread.once]</a></h3><div id='once.onceflag' class='section'><h4 ><a class='secnum' href='#once.onceflag' style='min-width:95pt'>32.5.7.1</a> Struct <span class='texttt'>once_&shy;flag</span> <a class='abbr_ref' href='thread.once.onceflag'>[thread.once.onceflag]</a></h4><div class='texpara'><span id='lib:once_flag'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:once_flag'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>struct</span> once_flag <span class='curlybracket'>{</span>
    <span class='keyword'>constexpr</span> once_flag<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    once_flag<span class='parenthesis'>(</span><span class='keyword'>const</span> once_flag<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    once_flag<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> once_flag<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></div><div class='para' id='once.onceflag-1'><div class='marginalizedparent'><a class='marginalized' href='#once.onceflag-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4041'>#</a></div><div class='texpara'><div id='once.onceflag-1.sentence-1' class='sentence'>The class <span class='texttt'>once_&shy;flag</span> is an opaque data structure that <span class='texttt'>call_&shy;once</span> uses to
initialize data without causing a data race or deadlock<a class='hidden_link' href='#once.onceflag-1.sentence-1'>.</a></div></div></div><div class='texpara'><div id='lib:once_flag_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:once_flag_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>constexpr</span> once_flag<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='once.onceflag-2'><div class='marginalizedparent'><a class='marginalized' href='#once.onceflag-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4051'>#</a></div><div class='texpara'><div id='once.onceflag-2.sentence-1' class='sentence'><i >Synchronization</i>: The construction of a <span class='texttt'>once_&shy;flag</span> object is not synchronized<a class='hidden_link' href='#once.onceflag-2.sentence-1'>.</a></div></div></div></div><div class='para' id='once.onceflag-3'><div class='marginalizedparent'><a class='marginalized' href='#once.onceflag-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4055'>#</a></div><div class='texpara'><div id='once.onceflag-3.sentence-1' class='sentence'><i >Postconditions</i>: The object's internal state is set to indicate to an invocation of
<span class='texttt'>call_&shy;once</span> with the object as its initial argument that no function has been
called<a class='hidden_link' href='#once.onceflag-3.sentence-1'>.</a></div></div></div></div></div><div id='once.callonce' class='section'><h4 ><a class='secnum' href='#once.callonce' style='min-width:95pt'>32.5.7.2</a> Function <span class='texttt'>call_&shy;once</span> <a class='abbr_ref' href='thread.once.callonce'>[thread.once.callonce]</a></h4><div class='texpara'><div id='lib:call_once'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:call_once'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Callable, <span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> Args<span class='anglebracket'>&gt;</span>
  <span class='keyword'>void</span> call_once<span class='parenthesis'>(</span>once_flag<span class='operator'>&amp;</span> flag, Callable<span class='operator'>&amp;</span><span class='operator'>&amp;</span> func, Args<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> args<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='once.callonce-1'><div class='marginalizedparent'><a class='marginalized' href='#once.callonce-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4071'>#</a></div><div class='texpara'><div id='once.callonce-1.sentence-1' class='sentence'><i >Mandates</i>: <span class='texttt'>is_&shy;invocable_&shy;v<span class='anglebracket'>&lt;</span>Callable, Args<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#once.callonce-1.sentence-1'>.</a></div></div></div></div><div class='para' id='once.callonce-2'><div class='marginalizedparent'><a class='marginalized' href='#once.callonce-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4075'>#</a></div><div class='texpara'><div id='once.callonce-2.sentence-1' class='sentence'><i >Effects</i>: An execution of <span class='texttt'>call_&shy;once</span> that does not call its <span class='texttt'>func</span> is a
<a class='hidden_link' href='#def:passive' id='def:passive'><i>passive</i></a> execution<a class='hidden_link' href='#once.callonce-2.sentence-1'>.</a></div> <div id='once.callonce-2.sentence-2' class='sentence'>An execution of <span class='texttt'>call_&shy;once</span> that calls its <span class='texttt'>func</span>
is an <a class='hidden_link' href='#def:active' id='def:active'><i>active</i></a> execution<a class='hidden_link' href='#once.callonce-2.sentence-2'>.</a></div> <div id='once.callonce-2.sentence-3' class='sentence'>An active execution calls
<span class='texttt'><i >INVOKE</i><span class='parenthesis'>(</span>&#x200b;std<span class='operator'>&#x200b;::&#x200b;</span>forward<span class='anglebracket'>&lt;</span>Callable<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>func<span class='parenthesis'>)</span>,
std<span class='operator'>&#x200b;::&#x200b;</span>forward<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>args<span class='parenthesis'>)</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#once.callonce-2.sentence-3'>.</a></div> <div id='once.callonce-2.sentence-4' class='sentence'>If such a call to <span class='texttt'>func</span>
throws an exception the execution is <a class='hidden_link' href='#def:exceptional' id='def:exceptional'><i>exceptional</i></a>, otherwise it is <a class='hidden_link' href='#def:returning' id='def:returning'><i>returning</i></a><a class='hidden_link' href='#once.callonce-2.sentence-4'>.</a></div> <div id='once.callonce-2.sentence-5' class='sentence'>An exceptional execution propagates the exception to the caller of
<span class='texttt'>call_&shy;once</span><a class='hidden_link' href='#once.callonce-2.sentence-5'>.</a></div> <div id='once.callonce-2.sentence-6' class='sentence'>Among all executions of <span class='texttt'>call_&shy;once</span> for any given
<span class='texttt'>once_&shy;flag</span>: at most one is a returning execution; if there is a
returning execution, it is the last active execution; and there are
passive executions only if there is a returning execution<a class='hidden_link' href='#once.callonce-2.sentence-6'>.</a></div> <div id='once.callonce-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#once.callonce-note-1'>1</a></i>: <div id='once.callonce-2.sentence-7' class='sentence'>Passive
executions allow other threads to reliably observe the results produced by the
earlier returning execution<a class='hidden_link' href='#once.callonce-2.sentence-7'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='once.callonce-3'><div class='marginalizedparent'><a class='marginalized' href='#once.callonce-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4095'>#</a></div><div class='texpara'><div id='once.callonce-3.sentence-1' class='sentence'><i >Synchronization</i>: For any given <span class='texttt'>once_&shy;flag</span>: all active executions occur in a total
order; completion of an active execution <a href='intro.multithread#def:synchronize_with' title='6.9.2&emsp;Multi-threaded executions and data races&emsp;[intro.multithread]'>synchronizes with</a>
the start of the next one in this total order; and the returning execution
synchronizes with the return from all passive executions<a class='hidden_link' href='#once.callonce-3.sentence-1'>.</a></div></div></div></div><div class='para' id='once.callonce-4'><div class='marginalizedparent'><a class='marginalized' href='#once.callonce-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4102'>#</a></div><div class='texpara'><div id='once.callonce-4.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>system_&shy;error</span> when
an exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>), or any exception thrown by <span class='texttt'>func</span><a class='hidden_link' href='#once.callonce-4.sentence-1'>.</a></div></div></div></div><div class='para nonNormativeOnly' id='once.callonce-5'><div class='marginalizedparent'><a class='marginalized' href='#once.callonce-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4107'>#</a></div><div class='texpara'><div id='once.callonce-example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#once.callonce-example-1'>1</a></i>: <span class='codeblock'><span class='comment'>// global flag, regular function</span>
<span class='keyword'>void</span> init<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
std<span class='operator'>::</span>once_flag flag;

<span class='keyword'>void</span> f<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  std<span class='operator'>::</span>call_once<span class='parenthesis'>(</span>flag, init<span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>

<span class='comment'>// function static flag, function object</span>
<span class='keyword'>struct</span> initializer <span class='curlybracket'>{</span>
  <span class='keyword'>void</span> <span class='keyword'>operator</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>;

<span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>static</span> std<span class='operator'>::</span>once_flag flag2;
  std<span class='operator'>::</span>call_once<span class='parenthesis'>(</span>flag2, initializer<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>

<span class='comment'>// object flag, member function</span>
<span class='keyword'>class</span> information <span class='curlybracket'>{</span>
  std<span class='operator'>::</span>once_flag verified;
  <span class='keyword'>void</span> verifier<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='keyword'>public</span><span class='operator'>:</span>
  <span class='keyword'>void</span> verify<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span> std<span class='operator'>::</span>call_once<span class='parenthesis'>(</span>verified, <span class='operator'>&amp;</span>information<span class='operator'>::</span>verifier, <span class='operator'>*</span><span class='keyword'>this</span><span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>
<span class='curlybracket'>}</span>;
</span> —&nbsp;<i>end example</i>]</div></div></div></div></div></div></div></div><div id='condition' class='section'><h2 ><a class='secnum' href='#condition' style='min-width:65pt'>32.6</a> Condition variables <a class='abbr_ref' href='thread.condition'>[thread.condition]</a></h2><div id='condition.general' class='section'><h3 ><a class='secnum' href='#condition.general' style='min-width:80pt'>32.6.1</a> General <a class='abbr_ref' href='thread.condition.general'>[thread.condition.general]</a></h3><div class='para' id='condition.general-1'><div class='marginalizedparent'><a class='marginalized' href='#condition.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4144'>#</a></div><div class='texpara'><div id='condition.general-1.sentence-1' class='sentence'>Condition variables provide synchronization primitives used to block a thread until
notified by some other thread that some condition is met or until a system time is
reached<a class='hidden_link' href='#condition.general-1.sentence-1'>.</a></div> <div id='condition.general-1.sentence-2' class='sentence'>Class <span class='texttt'>condition_&shy;variable</span> provides a condition variable that can only
wait on an object of type <span class='texttt'>unique_&shy;lock<span class='anglebracket'>&lt;</span>mutex<span class='anglebracket'>&gt;</span></span>, allowing the implementation
to be more efficient<a class='hidden_link' href='#condition.general-1.sentence-2'>.</a></div> <div id='condition.general-1.sentence-3' class='sentence'>Class <span class='texttt'>condition_&shy;variable_&shy;any</span> provides a general
condition variable that can wait on objects of user-supplied lock types<a class='hidden_link' href='#condition.general-1.sentence-3'>.</a></div></div></div><div class='para' id='condition.general-2'><div class='marginalizedparent'><a class='marginalized' href='#condition.general-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4152'>#</a></div><div class='texpara'><div id='condition.general-2.sentence-1' class='sentence'>Condition variables permit concurrent invocation of the <span class='texttt'>wait</span>, <span class='texttt'>wait_&shy;for</span>,
<span class='texttt'>wait_&shy;until</span>, <span class='texttt'>notify_&shy;one</span> and <span class='texttt'>notify_&shy;all</span> member functions<a class='hidden_link' href='#condition.general-2.sentence-1'>.</a></div></div></div><div class='para' id='condition.general-3'><div class='marginalizedparent'><a class='marginalized' href='#condition.general-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4156'>#</a></div><div class='texpara'><div id='condition.general-3.sentence-1' class='sentence'>The executions of <span class='texttt'>notify_&shy;one</span> and <span class='texttt'>notify_&shy;all</span>
are atomic<a class='hidden_link' href='#condition.general-3.sentence-1'>.</a></div> <div id='condition.general-3.sentence-2' class='sentence'>The executions of <span class='texttt'>wait</span>, <span class='texttt'>wait_&shy;for</span>, and <span class='texttt'>wait_&shy;until</span> are performed
in three atomic parts:
<table class='enumerate'><tr id='condition.general-3.1'><td ><a class='enumerated_item_num' href='#condition.general-3.1'>1.</a></td><td >the release of the mutex and entry into the waiting state;</td></tr><tr id='condition.general-3.2'><td ><a class='enumerated_item_num' href='#condition.general-3.2'>2.</a></td><td >the unblocking of the wait; and</td></tr><tr id='condition.general-3.3'><td ><a class='enumerated_item_num' href='#condition.general-3.3'>3.</a></td><td >the reacquisition of the lock<a class='hidden_link' href='#condition.general-3.sentence-2'>.</a></td></tr></table></div></div></div><div class='para' id='condition.general-4'><div class='marginalizedparent'><a class='marginalized' href='#condition.general-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4167'>#</a></div><div class='texpara'><div id='condition.general-4.sentence-1' class='sentence'>The implementation behaves as if all executions of <span class='texttt'>notify_&shy;one</span>, <span class='texttt'>notify_&shy;all</span>, and each
part of the <span class='texttt'>wait</span>, <span class='texttt'>wait_&shy;for</span>, and <span class='texttt'>wait_&shy;until</span> executions are
executed in a single unspecified total order consistent with the “happens before” order<a class='hidden_link' href='#condition.general-4.sentence-1'>.</a></div></div></div><div class='para' id='condition.general-5'><div class='marginalizedparent'><a class='marginalized' href='#condition.general-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4172'>#</a></div><div class='texpara'><div id='condition.general-5.sentence-1' class='sentence'>Condition variable construction and destruction need not be synchronized<a class='hidden_link' href='#condition.general-5.sentence-1'>.</a></div></div></div></div><div id='condition.variable.syn' class='section'><h3 ><a class='secnum' href='#condition.variable.syn' style='min-width:80pt'>32.6.2</a> Header <span class='texttt'>&lt;condition_&shy;variable&gt;</span> synopsis <a class='abbr_ref' href='condition.variable.syn'>[condition.variable.syn]</a></h3><div class='texpara'><span id='lib:cv_status'><span id='header:<condition_variable>'><div class='marginalizedparent'><a class='itemDeclLink' href='#header:%3ccondition_variable%3e'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>class</span> condition_variable;
  <span class='keyword'>class</span> condition_variable_any;

  <span class='keyword'>void</span> notify_all_at_thread_exit<span class='parenthesis'>(</span>condition_variable<span class='operator'>&amp;</span> cond, unique_lock<span class='anglebracket'>&lt;</span>mutex<span class='anglebracket'>&gt;</span> lk<span class='parenthesis'>)</span>;

  <span class='keyword'>enum</span> <span class='keyword'>class</span> cv_status <span class='curlybracket'>{</span> no_timeout, timeout <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></span></div></div><div id='condition.nonmember' class='section'><h3 ><a class='secnum' href='#condition.nonmember' style='min-width:80pt'>32.6.3</a> Non-member functions <a class='abbr_ref' href='thread.condition.nonmember'>[thread.condition.nonmember]</a></h3><div class='texpara'><div id='lib:notify_all_at_thread_exit'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:notify_all_at_thread_exit'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> notify_all_at_thread_exit<span class='parenthesis'>(</span>condition_variable<span class='operator'>&amp;</span> cond, unique_lock<span class='anglebracket'>&lt;</span>mutex<span class='anglebracket'>&gt;</span> lk<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='condition.nonmember-1'><div class='marginalizedparent'><a class='marginalized' href='#condition.nonmember-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4197'>#</a></div><div class='texpara'><div id='condition.nonmember-1.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'>lk</span> is locked by the calling thread and either
<ul class='itemize'><li id='condition.nonmember-1.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.nonmember-1.1'>(1.1)</a></div>no other thread is waiting on <span class='texttt'>cond</span>, or</li><li id='condition.nonmember-1.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.nonmember-1.2'>(1.2)</a></div><span class='texttt'>lk<span class='operator'>.</span>mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns the same value for each of the lock arguments
supplied by all concurrently waiting (via <span class='texttt'>wait</span>, <span class='texttt'>wait_&shy;for</span>,
or <span class='texttt'>wait_&shy;until</span>) threads<a class='hidden_link' href='#condition.nonmember-1.sentence-1'>.</a></li></ul></div></div></div></div><div class='para' id='condition.nonmember-2'><div class='marginalizedparent'><a class='marginalized' href='#condition.nonmember-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4207'>#</a></div><div class='texpara'><div id='condition.nonmember-2.sentence-1' class='sentence'><i >Effects</i>: Transfers ownership of the lock associated with <span class='texttt'>lk</span> into
internal storage and schedules <span class='texttt'>cond</span> to be notified when the current
thread exits, after all objects of thread storage duration associated with
the current thread have been destroyed<a class='hidden_link' href='#condition.nonmember-2.sentence-1'>.</a></div> <div id='condition.nonmember-2.sentence-2' class='sentence'>This notification is equivalent to:
<span class='codeblock'>lk<span class='operator'>.</span>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
cond<span class='operator'>.</span>notify_all<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</span></div></div></div></div><div class='para' id='condition.nonmember-3'><div class='marginalizedparent'><a class='marginalized' href='#condition.nonmember-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4218'>#</a></div><div class='texpara'><div id='condition.nonmember-3.sentence-1' class='sentence'><i >Synchronization</i>: The implied <span class='texttt'>lk<span class='operator'>.</span>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> call is sequenced after the destruction of
all objects with thread storage duration associated with the current thread<a class='hidden_link' href='#condition.nonmember-3.sentence-1'>.</a></div></div></div></div><div class='para nonNormativeOnly' id='condition.nonmember-4'><div class='marginalizedparent'><a class='marginalized' href='#condition.nonmember-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4223'>#</a></div><div class='texpara'><div id='condition.nonmember-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condition.nonmember-note-1'>1</a></i>: <div id='condition.nonmember-4.sentence-1' class='sentence'>The supplied lock is held until the thread exits,
which might cause deadlock due to lock ordering issues<a class='hidden_link' href='#condition.nonmember-4.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para nonNormativeOnly' id='condition.nonmember-5'><div class='marginalizedparent'><a class='marginalized' href='#condition.nonmember-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4229'>#</a></div><div class='texpara'><div id='condition.nonmember-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condition.nonmember-note-2'>2</a></i>: <div id='condition.nonmember-5.sentence-1' class='sentence'>It is the user's responsibility to ensure that waiting threads
do not erroneously assume that the thread has finished if they experience
spurious wakeups<a class='hidden_link' href='#condition.nonmember-5.sentence-1'>.</a></div> <div id='condition.nonmember-5.sentence-2' class='sentence'>This typically requires that the condition being waited
for is satisfied while holding the lock on <span class='texttt'>lk</span>, and that this lock
is not released and reacquired prior to calling <span class='texttt'>notify_&shy;all_&shy;at_&shy;thread_&shy;exit</span><a class='hidden_link' href='#condition.nonmember-5.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div></div><div id='condition.condvar' class='section'><h3 ><a class='secnum' href='#condition.condvar' style='min-width:80pt'>32.6.4</a> Class <span class='texttt'>condition_&shy;variable</span> <a class='abbr_ref' href='thread.condition.condvar'>[thread.condition.condvar]</a></h3><div class='texpara'><span id='lib:condition_variable'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:condition_variable'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>class</span> condition_variable <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    condition_variable<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='operator'>~</span>condition_variable<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    condition_variable<span class='parenthesis'>(</span><span class='keyword'>const</span> condition_variable<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    condition_variable<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> condition_variable<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;

    <span class='keyword'>void</span> notify_one<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>void</span> notify_all<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>void</span> wait<span class='parenthesis'>(</span>unique_lock<span class='anglebracket'>&lt;</span>mutex<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> lock<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Predicate<span class='anglebracket'>&gt;</span>
      <span class='keyword'>void</span> wait<span class='parenthesis'>(</span>unique_lock<span class='anglebracket'>&lt;</span>mutex<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> lock, Predicate pred<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
      cv_status wait_until<span class='parenthesis'>(</span>unique_lock<span class='anglebracket'>&lt;</span>mutex<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> lock,
                           <span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration, <span class='keyword'>class</span> Predicate<span class='anglebracket'>&gt;</span>
      <span class='keyword'>bool</span> wait_until<span class='parenthesis'>(</span>unique_lock<span class='anglebracket'>&lt;</span>mutex<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> lock,
                      <span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time,
                      Predicate pred<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
      cv_status wait_for<span class='parenthesis'>(</span>unique_lock<span class='anglebracket'>&lt;</span>mutex<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> lock,
                         <span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period, <span class='keyword'>class</span> Predicate<span class='anglebracket'>&gt;</span>
      <span class='keyword'>bool</span> wait_for<span class='parenthesis'>(</span>unique_lock<span class='anglebracket'>&lt;</span>mutex<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> lock,
                    <span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time,
                    Predicate pred<span class='parenthesis'>)</span>;

    <span class='keyword'>using</span> native_handle_type <span class='operator'>=</span> <i >implementation-defined</i>;          <span class='comment'>// see <a href='#req.native' title='32.2.3&emsp;Native handles'>[thread.<span class='shy'></span>req.<span class='shy'></span>native]</a></span>
    native_handle_type native_handle<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;                         <span class='comment'>// see <a href='#req.native' title='32.2.3&emsp;Native handles'>[thread.<span class='shy'></span>req.<span class='shy'></span>native]</a></span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></div><div class='para' id='condition.condvar-1'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4278'>#</a></div><div class='texpara'><div id='condition.condvar-1.sentence-1' class='sentence'>The class <span class='texttt'>condition_&shy;variable</span> is a standard-layout class (<a href='class.prop' title='11.2&emsp;Properties of classes'>[class.<span class='shy'></span>prop]</a>)<a class='hidden_link' href='#condition.condvar-1.sentence-1'>.</a></div></div></div><div class='texpara'><div id='lib:condition_variable,constructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:condition_variable,constructor'>🔗</a></div><code class='itemdeclcode'>condition_variable<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='condition.condvar-2'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4287'>#</a></div><div class='texpara'><div id='condition.condvar-2.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>system_&shy;error</span> when an exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#condition.condvar-2.sentence-1'>.</a></div></div></div></div><div class='para' id='condition.condvar-3'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4291'>#</a></div><div class='texpara'><div id='condition.condvar-3.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='condition.condvar-3.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvar-3.1'>(3.1)</a></div><span class='texttt'>resource_&shy;unavailable_&shy;try_&shy;again</span> — if some non-memory resource
limitation prevents initialization<a class='hidden_link' href='#condition.condvar-3.sentence-1'>.</a></li></ul></div></div></div></div><div class='texpara'><div id='lib:condition_variable,destructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:condition_variable,destructor'>🔗</a></div><code class='itemdeclcode'><span class='operator'>~</span>condition_variable<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='condition.condvar-4'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4305'>#</a></div><div class='texpara'><div id='condition.condvar-4.sentence-1' class='sentence'><i >Preconditions</i>: There is no thread blocked on <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#condition.condvar-4.sentence-1'>.</a></div> <div id='condition.condvar-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condition.condvar-note-1'>1</a></i>: <div id='condition.condvar-4.sentence-2' class='sentence'>That is, all
threads have been notified; they can subsequently block on the lock specified in the
wait<a class='hidden_link' href='#condition.condvar-4.sentence-2'>.</a></div> <div id='condition.condvar-4.sentence-3' class='sentence'>This relaxes the usual rules, which would have required all wait calls to happen before
destruction<a class='hidden_link' href='#condition.condvar-4.sentence-3'>.</a></div> <div id='condition.condvar-4.sentence-4' class='sentence'>Only the notification to unblock the wait needs to happen before destruction<a class='hidden_link' href='#condition.condvar-4.sentence-4'>.</a></div> <div id='condition.condvar-4.sentence-5' class='sentence'>Undefined behavior ensues if a thread waits on <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> once the destructor has
been started, especially when the waiting threads are calling the wait functions in a loop or
using the overloads of <span class='texttt'>wait</span>, <span class='texttt'>wait_&shy;for</span>, or <span class='texttt'>wait_&shy;until</span> that take a predicate<a class='hidden_link' href='#condition.condvar-4.sentence-5'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='texpara'><div id='lib:condition_variable,notify_one'><div id='lib:notify_one,condition_variable'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:notify_one,condition_variable'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> notify_one<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='condition.condvar-5'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4326'>#</a></div><div class='texpara'><div id='condition.condvar-5.sentence-1' class='sentence'><i >Effects</i>: If any threads are blocked waiting for <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span>, unblocks one of those threads<a class='hidden_link' href='#condition.condvar-5.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:condition_variable,notify_all'><div id='lib:notify_all,condition_variable'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:notify_all,condition_variable'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> notify_all<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='condition.condvar-6'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4337'>#</a></div><div class='texpara'><div id='condition.condvar-6.sentence-1' class='sentence'><i >Effects</i>: Unblocks all threads that are blocked waiting for <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#condition.condvar-6.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:condition_variable,wait'><div id='lib:wait,condition_variable'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:wait,condition_variable'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> wait<span class='parenthesis'>(</span>unique_lock<span class='anglebracket'>&lt;</span>mutex<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> lock<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='condition.condvar-7'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4348'>#</a></div><div class='texpara'><div id='condition.condvar-7.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'>lock<span class='operator'>.</span>owns_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span> and <span class='texttt'>lock<span class='operator'>.</span>mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
is locked by the calling thread, and either
<ul class='itemize'><li id='condition.condvar-7.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvar-7.1'>(7.1)</a></div>no other thread is waiting on this <span class='texttt'>condition_&shy;variable</span> object or</li><li id='condition.condvar-7.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvar-7.2'>(7.2)</a></div><span class='texttt'>lock<span class='operator'>.</span>mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns the same value for each of the <span class='texttt'>lock</span>
arguments supplied by all concurrently waiting (via <span class='texttt'>wait</span>,
<span class='texttt'>wait_&shy;for</span>, or <span class='texttt'>wait_&shy;until</span>) threads<a class='hidden_link' href='#condition.condvar-7.sentence-1'>.</a></li></ul></div></div></div></div><div class='para' id='condition.condvar-8'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4359'>#</a></div><div class='texpara'><div id='condition.condvar-8.sentence-1' class='sentence'><a class='index' id=':block_(execution)____________'></a><i >Effects</i>: <ul class='itemize'><li id='condition.condvar-8.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvar-8.1'>(8.1)</a></div><div class='texpara'><div id='condition.condvar-8.1.sentence-1' class='sentence'>Atomically calls <span class='texttt'>lock<span class='operator'>.</span>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> and blocks on <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#condition.condvar-8.1.sentence-1'>.</a></div></div></li><li id='condition.condvar-8.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvar-8.2'>(8.2)</a></div><div class='texpara'><div id='condition.condvar-8.2.sentence-1' class='sentence'>When unblocked, calls <span class='texttt'>lock<span class='operator'>.</span>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> (possibly blocking on the lock), then returns<a class='hidden_link' href='#condition.condvar-8.2.sentence-1'>.</a></div></div></li><li id='condition.condvar-8.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvar-8.3'>(8.3)</a></div><div class='texpara'><div id='condition.condvar-8.3.sentence-1' class='sentence'>The function will unblock when signaled by a call to <span class='texttt'>notify_&shy;one<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
or a call to <span class='texttt'>notify_&shy;all<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, or spuriously<a class='hidden_link' href='#condition.condvar-8.3.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='para' id='condition.condvar-9'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4369'>#</a></div><div class='texpara'><div id='condition.condvar-9.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>lock<span class='operator'>.</span>owns_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span> and <span class='texttt'>lock<span class='operator'>.</span>mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
is locked by the calling thread<a class='hidden_link' href='#condition.condvar-9.sentence-1'>.</a></div></div></div></div><div class='para' id='condition.condvar-10'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4374'>#</a></div><div class='texpara'><div id='condition.condvar-10.sentence-1' class='sentence'><i >Throws</i>: Nothing<a class='hidden_link' href='#condition.condvar-10.sentence-1'>.</a></div></div></div></div><div class='para' id='condition.condvar-11'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4378'>#</a></div><div class='texpara'><div id='condition.condvar-11.sentence-1' class='sentence'><i >Remarks</i>: If the function fails to meet the postcondition, <span class='texttt'>terminate<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
is invoked (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#condition.condvar-11.sentence-1'>.</a></div> <div id='condition.condvar-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condition.condvar-note-2'>2</a></i>: <div id='condition.condvar-11.sentence-2' class='sentence'>This can happen if the re-locking of the mutex throws an exception<a class='hidden_link' href='#condition.condvar-11.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='texpara'><div id='lib:condition_variable,wait_'><div id='lib:wait,condition_variable_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:wait,condition_variable_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Predicate<span class='anglebracket'>&gt;</span>
  <span class='keyword'>void</span> wait<span class='parenthesis'>(</span>unique_lock<span class='anglebracket'>&lt;</span>mutex<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> lock, Predicate pred<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='condition.condvar-12'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4394'>#</a></div><div class='texpara'><div id='condition.condvar-12.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'>lock<span class='operator'>.</span>owns_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span> and <span class='texttt'>lock<span class='operator'>.</span>mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is
locked by the calling thread, and either
<ul class='itemize'><li id='condition.condvar-12.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvar-12.1'>(12.1)</a></div>no other thread is waiting on this <span class='texttt'>condition_&shy;variable</span> object or</li><li id='condition.condvar-12.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvar-12.2'>(12.2)</a></div><span class='texttt'>lock<span class='operator'>.</span>mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns the same value for each of the <span class='texttt'>lock</span>
arguments supplied by all concurrently waiting (via <span class='texttt'>wait</span>,
<span class='texttt'>wait_&shy;for</span>, or <span class='texttt'>wait_&shy;until</span>) threads<a class='hidden_link' href='#condition.condvar-12.sentence-1'>.</a></li></ul></div></div></div></div><div class='para' id='condition.condvar-13'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4405'>#</a></div><div class='texpara'><div id='condition.condvar-13.sentence-1' class='sentence'><i >Effects</i>: Equivalent to:
<span class='codeblock'><span class='keyword'>while</span> <span class='parenthesis'>(</span><span class='operator'>!</span>pred<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>
  wait<span class='parenthesis'>(</span>lock<span class='parenthesis'>)</span>;
</span></div></div></div></div><div class='para' id='condition.condvar-14'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4413'>#</a></div><div class='texpara'><div id='condition.condvar-14.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>lock<span class='operator'>.</span>owns_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span> and <span class='texttt'>lock<span class='operator'>.</span>mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
is locked by the calling thread<a class='hidden_link' href='#condition.condvar-14.sentence-1'>.</a></div></div></div></div><div class='para' id='condition.condvar-15'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4418'>#</a></div><div class='texpara'><div id='condition.condvar-15.sentence-1' class='sentence'><i >Throws</i>: Any exception thrown by <span class='texttt'>pred</span><a class='hidden_link' href='#condition.condvar-15.sentence-1'>.</a></div></div></div></div><div class='para' id='condition.condvar-16'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4422'>#</a></div><div class='texpara'><div id='condition.condvar-16.sentence-1' class='sentence'><i >Remarks</i>: If the function fails to meet the postcondition, <span class='texttt'>terminate<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
is invoked (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#condition.condvar-16.sentence-1'>.</a></div> <div id='condition.condvar-note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condition.condvar-note-3'>3</a></i>: <div id='condition.condvar-16.sentence-2' class='sentence'>This can happen if the re-locking of the mutex throws an exception<a class='hidden_link' href='#condition.condvar-16.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='texpara'><div id='lib:condition_variable,wait_until'><div id='lib:wait_until,condition_variable'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:wait_until,condition_variable'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
  cv_status wait_until<span class='parenthesis'>(</span>unique_lock<span class='anglebracket'>&lt;</span>mutex<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> lock,
                       <span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='condition.condvar-17'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4439'>#</a></div><div class='texpara'><div id='condition.condvar-17.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'>lock<span class='operator'>.</span>owns_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span> and <span class='texttt'>lock<span class='operator'>.</span>mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
is locked by the calling thread, and either
<ul class='itemize'><li id='condition.condvar-17.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvar-17.1'>(17.1)</a></div>no other thread is waiting on this <span class='texttt'>condition_&shy;variable</span> object or</li><li id='condition.condvar-17.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvar-17.2'>(17.2)</a></div><span class='texttt'>lock<span class='operator'>.</span>mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns the same value for each of the <span class='texttt'>lock</span>
arguments supplied by all concurrently waiting (via <span class='texttt'>wait</span>,
<span class='texttt'>wait_&shy;for</span>, or <span class='texttt'>wait_&shy;until</span>) threads<a class='hidden_link' href='#condition.condvar-17.sentence-1'>.</a></li></ul></div></div></div></div><div class='para' id='condition.condvar-18'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4450'>#</a></div><div class='texpara'><div id='condition.condvar-18.sentence-1' class='sentence'><i >Effects</i>: <ul class='itemize'><li id='condition.condvar-18.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvar-18.1'>(18.1)</a></div><div class='texpara'><div id='condition.condvar-18.1.sentence-1' class='sentence'>Atomically calls <span class='texttt'>lock<span class='operator'>.</span>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> and blocks on <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#condition.condvar-18.1.sentence-1'>.</a></div></div></li><li id='condition.condvar-18.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvar-18.2'>(18.2)</a></div><div class='texpara'><div id='condition.condvar-18.2.sentence-1' class='sentence'>When unblocked, calls <span class='texttt'>lock<span class='operator'>.</span>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> (possibly blocking on the lock), then returns<a class='hidden_link' href='#condition.condvar-18.2.sentence-1'>.</a></div></div></li><li id='condition.condvar-18.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvar-18.3'>(18.3)</a></div><div class='texpara'><div id='condition.condvar-18.3.sentence-1' class='sentence'>The function will unblock when signaled by a call to <span class='texttt'>notify_&shy;one<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, a call to <span class='texttt'>notify_&shy;all<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>,
expiration of the absolute timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>) specified by <span class='texttt'>abs_&shy;time</span>,
or spuriously<a class='hidden_link' href='#condition.condvar-18.3.sentence-1'>.</a></div></div></li><li id='condition.condvar-18.4'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvar-18.4'>(18.4)</a></div><div class='texpara'><div id='condition.condvar-18.4.sentence-1' class='sentence'>If the function exits via an exception, <span class='texttt'>lock<span class='operator'>.</span>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is called prior to exiting the function<a class='hidden_link' href='#condition.condvar-18.4.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='para' id='condition.condvar-19'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4468'>#</a></div><div class='texpara'><div id='condition.condvar-19.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>lock<span class='operator'>.</span>owns_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span> and <span class='texttt'>lock<span class='operator'>.</span>mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
is locked by the calling thread<a class='hidden_link' href='#condition.condvar-19.sentence-1'>.</a></div></div></div></div><div class='para' id='condition.condvar-20'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4473'>#</a></div><div class='texpara'><div id='condition.condvar-20.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>cv_&shy;status<span class='operator'>&#x200b;::&#x200b;</span>timeout</span> if
the absolute timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>) specified by <span class='texttt'>abs_&shy;time</span> expired,
otherwise <span class='texttt'>cv_&shy;status<span class='operator'>&#x200b;::&#x200b;</span>no_&shy;timeout</span><a class='hidden_link' href='#condition.condvar-20.sentence-1'>.</a></div></div></div></div><div class='para' id='condition.condvar-21'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4479'>#</a></div><div class='texpara'><div id='condition.condvar-21.sentence-1' class='sentence'><i >Throws</i>: Timeout-related
exceptions (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>)<a class='hidden_link' href='#condition.condvar-21.sentence-1'>.</a></div></div></div></div><div class='para' id='condition.condvar-22'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4484'>#</a></div><div class='texpara'><div id='condition.condvar-22.sentence-1' class='sentence'><i >Remarks</i>: If the function fails to meet the postcondition, <span class='texttt'>terminate<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
is invoked (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#condition.condvar-22.sentence-1'>.</a></div> <div id='condition.condvar-note-4' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condition.condvar-note-4'>4</a></i>: <div id='condition.condvar-22.sentence-2' class='sentence'>This can happen if the re-locking of the mutex throws an exception<a class='hidden_link' href='#condition.condvar-22.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='texpara'><div id='lib:condition_variable,wait_for'><div id='lib:wait_for,condition_variable'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:wait_for,condition_variable'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
  cv_status wait_for<span class='parenthesis'>(</span>unique_lock<span class='anglebracket'>&lt;</span>mutex<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> lock,
                     <span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='condition.condvar-23'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4501'>#</a></div><div class='texpara'><div id='condition.condvar-23.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'>lock<span class='operator'>.</span>owns_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span> and <span class='texttt'>lock<span class='operator'>.</span>mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
is locked by the calling thread, and either
<ul class='itemize'><li id='condition.condvar-23.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvar-23.1'>(23.1)</a></div>no other thread is waiting on this <span class='texttt'>condition_&shy;variable</span> object or</li><li id='condition.condvar-23.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvar-23.2'>(23.2)</a></div><span class='texttt'>lock<span class='operator'>.</span>mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns the same value for each of the <span class='texttt'>lock</span> arguments
supplied by all concurrently waiting (via <span class='texttt'>wait</span>, <span class='texttt'>wait_&shy;for</span>, or
<span class='texttt'>wait_&shy;until</span>) threads<a class='hidden_link' href='#condition.condvar-23.sentence-1'>.</a></li></ul></div></div></div></div><div class='para' id='condition.condvar-24'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-24'>24</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4512'>#</a></div><div class='texpara'><div id='condition.condvar-24.sentence-1' class='sentence'><i >Effects</i>: Equivalent to:
<span class='codeblock'><span class='keyword'>return</span> wait_until<span class='parenthesis'>(</span>lock, chrono<span class='operator'>::</span>steady_clock<span class='operator'>::</span>now<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>+</span> rel_time<span class='parenthesis'>)</span>;
</span></div></div></div></div><div class='para' id='condition.condvar-25'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-25'>25</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4519'>#</a></div><div class='texpara'><div id='condition.condvar-25.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>lock<span class='operator'>.</span>owns_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span> and <span class='texttt'>lock<span class='operator'>.</span>mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
is locked by the calling thread<a class='hidden_link' href='#condition.condvar-25.sentence-1'>.</a></div></div></div></div><div class='para' id='condition.condvar-26'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-26'>26</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4524'>#</a></div><div class='texpara'><div id='condition.condvar-26.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>cv_&shy;status<span class='operator'>&#x200b;::&#x200b;</span>timeout</span> if
the relative timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>) specified by <span class='texttt'>rel_&shy;time</span> expired,
otherwise <span class='texttt'>cv_&shy;status<span class='operator'>&#x200b;::&#x200b;</span>no_&shy;timeout</span><a class='hidden_link' href='#condition.condvar-26.sentence-1'>.</a></div></div></div></div><div class='para' id='condition.condvar-27'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-27'>27</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4530'>#</a></div><div class='texpara'><div id='condition.condvar-27.sentence-1' class='sentence'><i >Throws</i>: Timeout-related
exceptions (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>)<a class='hidden_link' href='#condition.condvar-27.sentence-1'>.</a></div></div></div></div><div class='para' id='condition.condvar-28'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-28'>28</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4535'>#</a></div><div class='texpara'><div id='condition.condvar-28.sentence-1' class='sentence'><i >Remarks</i>: If the function fails to meet the postcondition, <span class='texttt'>terminate</span>
is invoked (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#condition.condvar-28.sentence-1'>.</a></div> <div id='condition.condvar-note-5' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condition.condvar-note-5'>5</a></i>: <div id='condition.condvar-28.sentence-2' class='sentence'>This can happen if the re-locking of the mutex throws an exception<a class='hidden_link' href='#condition.condvar-28.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='texpara'><div id='lib:condition_variable,wait_until_'><div id='lib:wait_until,condition_variable_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:wait_until,condition_variable_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration, <span class='keyword'>class</span> Predicate<span class='anglebracket'>&gt;</span>
  <span class='keyword'>bool</span> wait_until<span class='parenthesis'>(</span>unique_lock<span class='anglebracket'>&lt;</span>mutex<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> lock,
                  <span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time,
                  Predicate pred<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='condition.condvar-29'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-29'>29</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4553'>#</a></div><div class='texpara'><div id='condition.condvar-29.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'>lock<span class='operator'>.</span>owns_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span> and <span class='texttt'>lock<span class='operator'>.</span>mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is
locked by the calling thread, and either
<ul class='itemize'><li id='condition.condvar-29.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvar-29.1'>(29.1)</a></div>no other thread is waiting on this <span class='texttt'>condition_&shy;variable</span> object or</li><li id='condition.condvar-29.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvar-29.2'>(29.2)</a></div><span class='texttt'>lock<span class='operator'>.</span>mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns the same value for each of the <span class='texttt'>lock</span>
arguments supplied by all concurrently waiting (via <span class='texttt'>wait</span>,
<span class='texttt'>wait_&shy;for</span>, or <span class='texttt'>wait_&shy;until</span>) threads<a class='hidden_link' href='#condition.condvar-29.sentence-1'>.</a></li></ul></div></div></div></div><div class='para' id='condition.condvar-30'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-30'>30</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4564'>#</a></div><div class='texpara'><div id='condition.condvar-30.sentence-1' class='sentence'><i >Effects</i>: Equivalent to:
<span class='codeblock'><span class='keyword'>while</span> <span class='parenthesis'>(</span><span class='operator'>!</span>pred<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>
  <span class='keyword'>if</span> <span class='parenthesis'>(</span>wait_until<span class='parenthesis'>(</span>lock, abs_time<span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> cv_status<span class='operator'>::</span>timeout<span class='parenthesis'>)</span>
    <span class='keyword'>return</span> pred<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='keyword'>return</span> <span class='literal'>true</span>;
</span></div></div></div></div><div class='para' id='condition.condvar-31'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-31'>31</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4574'>#</a></div><div class='texpara'><div id='condition.condvar-31.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>lock<span class='operator'>.</span>owns_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span> and <span class='texttt'>lock<span class='operator'>.</span>mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
is locked by the calling thread<a class='hidden_link' href='#condition.condvar-31.sentence-1'>.</a></div></div></div></div><div class='para nonNormativeOnly' id='condition.condvar-32'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-32'>32</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4579'>#</a></div><div class='texpara'><div id='condition.condvar-note-6' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condition.condvar-note-6'>6</a></i>: <div id='condition.condvar-32.sentence-1' class='sentence'>The returned value indicates whether the predicate evaluated to
<span class='texttt'><span class='literal'>true</span></span> regardless of whether the timeout was triggered<a class='hidden_link' href='#condition.condvar-32.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='condition.condvar-33'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-33'>33</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4585'>#</a></div><div class='texpara'><div id='condition.condvar-33.sentence-1' class='sentence'><i >Throws</i>: Timeout-related
exceptions (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>) or any exception thrown by <span class='texttt'>pred</span><a class='hidden_link' href='#condition.condvar-33.sentence-1'>.</a></div></div></div></div><div class='para' id='condition.condvar-34'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-34'>34</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4590'>#</a></div><div class='texpara'><div id='condition.condvar-34.sentence-1' class='sentence'><i >Remarks</i>: If the function fails to meet the postcondition, <span class='texttt'>terminate<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
is invoked (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#condition.condvar-34.sentence-1'>.</a></div> <div id='condition.condvar-note-7' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condition.condvar-note-7'>7</a></i>: <div id='condition.condvar-34.sentence-2' class='sentence'>This can happen if the re-locking of the mutex throws an exception<a class='hidden_link' href='#condition.condvar-34.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='texpara'><div id='lib:condition_variable,wait_for_'><div id='lib:wait_for,condition_variable_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:wait_for,condition_variable_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period, <span class='keyword'>class</span> Predicate<span class='anglebracket'>&gt;</span>
  <span class='keyword'>bool</span> wait_for<span class='parenthesis'>(</span>unique_lock<span class='anglebracket'>&lt;</span>mutex<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> lock,
                <span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time,
                Predicate pred<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='condition.condvar-35'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-35'>35</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4608'>#</a></div><div class='texpara'><div id='condition.condvar-35.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'>lock<span class='operator'>.</span>owns_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span> and <span class='texttt'>lock<span class='operator'>.</span>mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
is locked by the calling thread, and either
<ul class='itemize'><li id='condition.condvar-35.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvar-35.1'>(35.1)</a></div>no other thread is waiting on this <span class='texttt'>condition_&shy;variable</span> object or</li><li id='condition.condvar-35.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvar-35.2'>(35.2)</a></div><span class='texttt'>lock<span class='operator'>.</span>mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns the same value for each of the <span class='texttt'>lock</span> arguments
supplied by all concurrently waiting (via <span class='texttt'>wait</span>, <span class='texttt'>wait_&shy;for</span>, or
<span class='texttt'>wait_&shy;until</span>) threads<a class='hidden_link' href='#condition.condvar-35.sentence-1'>.</a></li></ul></div></div></div></div><div class='para' id='condition.condvar-36'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-36'>36</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4622'>#</a></div><div class='texpara'><div id='condition.condvar-36.sentence-1' class='sentence'><i >Effects</i>: Equivalent to:
<span class='codeblock'><span class='keyword'>return</span> wait_until<span class='parenthesis'>(</span>lock, chrono<span class='operator'>::</span>steady_clock<span class='operator'>::</span>now<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>+</span> rel_time, std<span class='operator'>::</span>move<span class='parenthesis'>(</span>pred<span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
</span></div></div></div></div><div class='para nonNormativeOnly' id='condition.condvar-37'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-37'>37</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4629'>#</a></div><div class='texpara'><div id='condition.condvar-note-8' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condition.condvar-note-8'>8</a></i>: <div id='condition.condvar-37.sentence-1' class='sentence'>There is no blocking if <span class='texttt'>pred<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is initially <span class='texttt'><span class='literal'>true</span></span>, even if the
timeout has already expired<a class='hidden_link' href='#condition.condvar-37.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='condition.condvar-38'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-38'>38</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4635'>#</a></div><div class='texpara'><div id='condition.condvar-38.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>lock<span class='operator'>.</span>owns_&shy;lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span> and <span class='texttt'>lock<span class='operator'>.</span>mutex<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
is locked by the calling thread<a class='hidden_link' href='#condition.condvar-38.sentence-1'>.</a></div></div></div></div><div class='para nonNormativeOnly' id='condition.condvar-39'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-39'>39</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4640'>#</a></div><div class='texpara'><div id='condition.condvar-note-9' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condition.condvar-note-9'>9</a></i>: <div id='condition.condvar-39.sentence-1' class='sentence'>The returned value indicates whether the predicate evaluates to <span class='texttt'><span class='literal'>true</span></span>
regardless of whether the timeout was triggered<a class='hidden_link' href='#condition.condvar-39.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='condition.condvar-40'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-40'>40</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4646'>#</a></div><div class='texpara'><div id='condition.condvar-40.sentence-1' class='sentence'><i >Throws</i>: Timeout-related
exceptions (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>) or any exception thrown by <span class='texttt'>pred</span><a class='hidden_link' href='#condition.condvar-40.sentence-1'>.</a></div></div></div></div><div class='para' id='condition.condvar-41'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvar-41'>41</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4651'>#</a></div><div class='texpara'><div id='condition.condvar-41.sentence-1' class='sentence'><i >Remarks</i>: If the function fails to meet the postcondition, <span class='texttt'>terminate<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
is invoked (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#condition.condvar-41.sentence-1'>.</a></div> <div id='condition.condvar-note-10' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condition.condvar-note-10'>10</a></i>: <div id='condition.condvar-41.sentence-2' class='sentence'>This can happen if the re-locking of the mutex throws an exception<a class='hidden_link' href='#condition.condvar-41.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div></div><div id='condition.condvarany' class='section'><h3 ><a class='secnum' href='#condition.condvarany' style='min-width:80pt'>32.6.5</a> Class <span class='texttt'>condition_&shy;variable_&shy;any</span> <a class='abbr_ref' href='thread.condition.condvarany'>[thread.condition.condvarany]</a></h3><div id='condition.condvarany.general' class='section'><h4 ><a class='secnum' href='#condition.condvarany.general' style='min-width:95pt'>32.6.5.1</a> General <a class='abbr_ref' href='thread.condition.condvarany.general'>[thread.condition.condvarany.general]</a></h4><div class='para' id='condition.condvarany.general-1'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4664'>#</a></div><div class='texpara'><div id='condition.condvarany.general-1.sentence-1' class='sentence'>In this subclause <a href='#condition.condvarany' title='32.6.5&emsp;Class condition_&shy;variable_&shy;any'>[thread.<span class='shy'></span>condition.<span class='shy'></span>condvarany]</a>,
template arguments for template parameters named <span class='texttt'>Lock</span>
shall meet the <i >Cpp17BasicLockable</i>
requirements (<a href='#req.lockable.basic' title='32.2.5.2&emsp;Cpp17BasicLockable requirements'>[thread.<span class='shy'></span>req.<span class='shy'></span>lockable.<span class='shy'></span>basic]</a>)<a class='hidden_link' href='#condition.condvarany.general-1.sentence-1'>.</a></div> <div id='condition.condvarany.general-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condition.condvarany.general-note-1'>1</a></i>: <div id='condition.condvarany.general-1.sentence-2' class='sentence'>All of the standard
mutex types meet this requirement<a class='hidden_link' href='#condition.condvarany.general-1.sentence-2'>.</a></div> <div id='condition.condvarany.general-1.sentence-3' class='sentence'>If a type other than one of the
standard mutex types or a <span class='texttt'>unique_&shy;lock</span> wrapper for a standard mutex type
is used with <span class='texttt'>condition_&shy;variable_&shy;any</span>, any
necessary synchronization is assumed to be in place with respect to the predicate associated
with the <span class='texttt'>condition_&shy;variable_&shy;any</span> instance<a class='hidden_link' href='#condition.condvarany.general-1.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div><div class='texpara'><span id='lib:condition_variable_any'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:condition_variable_any'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>class</span> condition_variable_any <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    condition_variable_any<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='operator'>~</span>condition_variable_any<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    condition_variable_any<span class='parenthesis'>(</span><span class='keyword'>const</span> condition_variable_any<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    condition_variable_any<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> condition_variable_any<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;

    <span class='keyword'>void</span> notify_one<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>void</span> notify_all<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    <span class='comment'>// <a href='#condvarany.wait' title='32.6.5.2&emsp;Noninterruptible waits'>[thread.<span class='shy'></span>condvarany.<span class='shy'></span>wait]</a>, noninterruptible waits</span>
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Lock<span class='anglebracket'>&gt;</span>
      <span class='keyword'>void</span> wait<span class='parenthesis'>(</span>Lock<span class='operator'>&amp;</span> lock<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Lock, <span class='keyword'>class</span> Predicate<span class='anglebracket'>&gt;</span>
      <span class='keyword'>void</span> wait<span class='parenthesis'>(</span>Lock<span class='operator'>&amp;</span> lock, Predicate pred<span class='parenthesis'>)</span>;

    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Lock, <span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
      cv_status wait_until<span class='parenthesis'>(</span>Lock<span class='operator'>&amp;</span> lock, <span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Lock, <span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration, <span class='keyword'>class</span> Predicate<span class='anglebracket'>&gt;</span>
      <span class='keyword'>bool</span> wait_until<span class='parenthesis'>(</span>Lock<span class='operator'>&amp;</span> lock, <span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time,
                      Predicate pred<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Lock, <span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
      cv_status wait_for<span class='parenthesis'>(</span>Lock<span class='operator'>&amp;</span> lock, <span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Lock, <span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period, <span class='keyword'>class</span> Predicate<span class='anglebracket'>&gt;</span>
      <span class='keyword'>bool</span> wait_for<span class='parenthesis'>(</span>Lock<span class='operator'>&amp;</span> lock, <span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time, Predicate pred<span class='parenthesis'>)</span>;

    <span class='comment'>// <a href='#condvarany.intwait' title='32.6.5.3&emsp;Interruptible waits'>[thread.<span class='shy'></span>condvarany.<span class='shy'></span>intwait]</a>, interruptible waits</span>
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Lock, <span class='keyword'>class</span> Predicate<span class='anglebracket'>&gt;</span>
      <span class='keyword'>bool</span> wait<span class='parenthesis'>(</span>Lock<span class='operator'>&amp;</span> lock, stop_token stoken, Predicate pred<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Lock, <span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration, <span class='keyword'>class</span> Predicate<span class='anglebracket'>&gt;</span>
      <span class='keyword'>bool</span> wait_until<span class='parenthesis'>(</span>Lock<span class='operator'>&amp;</span> lock, stop_token stoken,
                      <span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time, Predicate pred<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Lock, <span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period, <span class='keyword'>class</span> Predicate<span class='anglebracket'>&gt;</span>
      <span class='keyword'>bool</span> wait_for<span class='parenthesis'>(</span>Lock<span class='operator'>&amp;</span> lock, stop_token stoken,
                    <span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time, Predicate pred<span class='parenthesis'>)</span>;
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></div></div><div class='texpara'><div id='lib:condition_variable_any,constructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:condition_variable_any,constructor'>🔗</a></div><code class='itemdeclcode'>condition_variable_any<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='condition.condvarany.general-2'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany.general-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4727'>#</a></div><div class='texpara'><div id='condition.condvarany.general-2.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>bad_&shy;alloc</span> or <span class='texttt'>system_&shy;error</span> when an exception is
required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#condition.condvarany.general-2.sentence-1'>.</a></div></div></div></div><div class='para' id='condition.condvarany.general-3'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany.general-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4732'>#</a></div><div class='texpara'><div id='condition.condvarany.general-3.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='condition.condvarany.general-3.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvarany.general-3.1'>(3.1)</a></div><div class='texpara'><div id='condition.condvarany.general-3.1.sentence-1' class='sentence'><span class='texttt'>resource_&shy;unavailable_&shy;try_&shy;again</span> — if some non-memory resource
limitation prevents initialization<a class='hidden_link' href='#condition.condvarany.general-3.1.sentence-1'>.</a></div></div></li><li id='condition.condvarany.general-3.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condition.condvarany.general-3.2'>(3.2)</a></div><div class='texpara'><div id='condition.condvarany.general-3.2.sentence-1' class='sentence'><span class='texttt'>operation_&shy;not_&shy;permitted</span> — if the thread does not have the
privilege to perform the operation<a class='hidden_link' href='#condition.condvarany.general-3.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:condition_variable_any,destructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:condition_variable_any,destructor'>🔗</a></div><code class='itemdeclcode'><span class='operator'>~</span>condition_variable_any<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='condition.condvarany.general-4'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany.general-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4749'>#</a></div><div class='texpara'><div id='condition.condvarany.general-4.sentence-1' class='sentence'><i >Preconditions</i>: There is no thread blocked on <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#condition.condvarany.general-4.sentence-1'>.</a></div> <div id='condition.condvarany.general-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condition.condvarany.general-note-2'>2</a></i>: <div id='condition.condvarany.general-4.sentence-2' class='sentence'>That is, all
threads have been notified; they can subsequently block on the lock specified in the
wait<a class='hidden_link' href='#condition.condvarany.general-4.sentence-2'>.</a></div> <div id='condition.condvarany.general-4.sentence-3' class='sentence'>This relaxes the usual rules, which would have required all wait calls to happen before
destruction<a class='hidden_link' href='#condition.condvarany.general-4.sentence-3'>.</a></div> <div id='condition.condvarany.general-4.sentence-4' class='sentence'>Only the notification to unblock the wait needs to happen before destruction<a class='hidden_link' href='#condition.condvarany.general-4.sentence-4'>.</a></div> <div id='condition.condvarany.general-4.sentence-5' class='sentence'>Undefined behavior ensues if a thread waits on <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> once the destructor has
been started, especially when the waiting threads are calling the wait functions in a loop or
using the overloads of <span class='texttt'>wait</span>, <span class='texttt'>wait_&shy;for</span>, or <span class='texttt'>wait_&shy;until</span> that take a predicate<a class='hidden_link' href='#condition.condvarany.general-4.sentence-5'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='texpara'><div id='lib:condition_variable_any,notify_one'><div id='lib:notify_one,condition_variable_any'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:notify_one,condition_variable_any'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> notify_one<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='condition.condvarany.general-5'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany.general-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4770'>#</a></div><div class='texpara'><div id='condition.condvarany.general-5.sentence-1' class='sentence'><i >Effects</i>: If any threads are blocked waiting for <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span>, unblocks one of those threads<a class='hidden_link' href='#condition.condvarany.general-5.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:condition_variable_any,notify_all'><div id='lib:notify_all,condition_variable_any'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:notify_all,condition_variable_any'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> notify_all<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='condition.condvarany.general-6'><div class='marginalizedparent'><a class='marginalized' href='#condition.condvarany.general-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4781'>#</a></div><div class='texpara'><div id='condition.condvarany.general-6.sentence-1' class='sentence'><i >Effects</i>: Unblocks all threads that are blocked waiting for <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#condition.condvarany.general-6.sentence-1'>.</a></div></div></div></div></div><div id='condvarany.wait' class='section'><h4 ><a class='secnum' href='#condvarany.wait' style='min-width:95pt'>32.6.5.2</a> Noninterruptible waits <a class='abbr_ref' href='thread.condvarany.wait'>[thread.condvarany.wait]</a></h4><div class='texpara'><div id='lib:condition_variable_any,wait'><div id='lib:wait,condition_variable_any'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:wait,condition_variable_any'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Lock<span class='anglebracket'>&gt;</span>
  <span class='keyword'>void</span> wait<span class='parenthesis'>(</span>Lock<span class='operator'>&amp;</span> lock<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='condvarany.wait-1'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.wait-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4795'>#</a></div><div class='texpara'><div id='condvarany.wait-1.sentence-1' class='sentence'><a class='index' id=':block_(execution)_____________'></a><i >Effects</i>: <ul class='itemize'><li id='condvarany.wait-1.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condvarany.wait-1.1'>(1.1)</a></div><div class='texpara'><div id='condvarany.wait-1.1.sentence-1' class='sentence'>Atomically calls <span class='texttt'>lock<span class='operator'>.</span>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> and blocks on <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#condvarany.wait-1.1.sentence-1'>.</a></div></div></li><li id='condvarany.wait-1.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condvarany.wait-1.2'>(1.2)</a></div><div class='texpara'><div id='condvarany.wait-1.2.sentence-1' class='sentence'>When unblocked, calls <span class='texttt'>lock<span class='operator'>.</span>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> (possibly blocking on the lock) and returns<a class='hidden_link' href='#condvarany.wait-1.2.sentence-1'>.</a></div></div></li><li id='condvarany.wait-1.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condvarany.wait-1.3'>(1.3)</a></div><div class='texpara'><div id='condvarany.wait-1.3.sentence-1' class='sentence'>The function will unblock when signaled by a call to <span class='texttt'>notify_&shy;one<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>,
a call to <span class='texttt'>notify_&shy;all<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, or spuriously<a class='hidden_link' href='#condvarany.wait-1.3.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='para' id='condvarany.wait-2'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.wait-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4805'>#</a></div><div class='texpara'><div id='condvarany.wait-2.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>lock</span> is locked by the calling thread<a class='hidden_link' href='#condvarany.wait-2.sentence-1'>.</a></div></div></div></div><div class='para' id='condvarany.wait-3'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.wait-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4809'>#</a></div><div class='texpara'><div id='condvarany.wait-3.sentence-1' class='sentence'><i >Throws</i>: Nothing<a class='hidden_link' href='#condvarany.wait-3.sentence-1'>.</a></div></div></div></div><div class='para' id='condvarany.wait-4'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.wait-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4813'>#</a></div><div class='texpara'><div id='condvarany.wait-4.sentence-1' class='sentence'><i >Remarks</i>: If the function fails to meet the postcondition, <span class='texttt'>terminate<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
is invoked (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#condvarany.wait-4.sentence-1'>.</a></div> <div id='condvarany.wait-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condvarany.wait-note-1'>1</a></i>: <div id='condvarany.wait-4.sentence-2' class='sentence'>This can happen if the re-locking of the mutex throws an exception<a class='hidden_link' href='#condvarany.wait-4.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='texpara'><div id='lib:condition_variable_any,wait_'><div id='lib:wait,condition_variable_any_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:wait,condition_variable_any_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Lock, <span class='keyword'>class</span> Predicate<span class='anglebracket'>&gt;</span>
  <span class='keyword'>void</span> wait<span class='parenthesis'>(</span>Lock<span class='operator'>&amp;</span> lock, Predicate pred<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='condvarany.wait-5'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.wait-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4829'>#</a></div><div class='texpara'><div id='condvarany.wait-5.sentence-1' class='sentence'><i >Effects</i>: Equivalent to:
<span class='codeblock'><span class='keyword'>while</span> <span class='parenthesis'>(</span><span class='operator'>!</span>pred<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>
  wait<span class='parenthesis'>(</span>lock<span class='parenthesis'>)</span>;
</span></div></div></div></div><div class='texpara'><div id='lib:condition_variable_any,wait_until'><div id='lib:wait_until,condition_variable_any'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:wait_until,condition_variable_any'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Lock, <span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
  cv_status wait_until<span class='parenthesis'>(</span>Lock<span class='operator'>&amp;</span> lock, <span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='condvarany.wait-6'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.wait-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4845'>#</a></div><div class='texpara'><div id='condvarany.wait-6.sentence-1' class='sentence'><i >Effects</i>: <ul class='itemize'><li id='condvarany.wait-6.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condvarany.wait-6.1'>(6.1)</a></div><div class='texpara'><div id='condvarany.wait-6.1.sentence-1' class='sentence'><a class='index' id=':block_(execution)______________'></a>Atomically calls <span class='texttt'>lock<span class='operator'>.</span>unlock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> and blocks on <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#condvarany.wait-6.1.sentence-1'>.</a></div></div></li><li id='condvarany.wait-6.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condvarany.wait-6.2'>(6.2)</a></div><div class='texpara'><div id='condvarany.wait-6.2.sentence-1' class='sentence'>When unblocked, calls <span class='texttt'>lock<span class='operator'>.</span>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> (possibly blocking on the lock) and returns<a class='hidden_link' href='#condvarany.wait-6.2.sentence-1'>.</a></div></div></li><li id='condvarany.wait-6.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condvarany.wait-6.3'>(6.3)</a></div><div class='texpara'><div id='condvarany.wait-6.3.sentence-1' class='sentence'>The function will unblock when signaled by a call to <span class='texttt'>notify_&shy;one<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>, a call to <span class='texttt'>notify_&shy;all<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>,
expiration of the absolute timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>) specified by <span class='texttt'>abs_&shy;time</span>,
or spuriously<a class='hidden_link' href='#condvarany.wait-6.3.sentence-1'>.</a></div></div></li><li id='condvarany.wait-6.4'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#condvarany.wait-6.4'>(6.4)</a></div><div class='texpara'><div id='condvarany.wait-6.4.sentence-1' class='sentence'>If the function exits via an exception, <span class='texttt'>lock<span class='operator'>.</span>lock<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is called prior to exiting the function<a class='hidden_link' href='#condvarany.wait-6.4.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='para' id='condvarany.wait-7'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.wait-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4864'>#</a></div><div class='texpara'><div id='condvarany.wait-7.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>lock</span> is locked by the calling thread<a class='hidden_link' href='#condvarany.wait-7.sentence-1'>.</a></div></div></div></div><div class='para' id='condvarany.wait-8'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.wait-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4868'>#</a></div><div class='texpara'><div id='condvarany.wait-8.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>cv_&shy;status<span class='operator'>&#x200b;::&#x200b;</span>timeout</span> if
the absolute timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>) specified by <span class='texttt'>abs_&shy;time</span> expired,
otherwise <span class='texttt'>cv_&shy;status<span class='operator'>&#x200b;::&#x200b;</span>no_&shy;timeout</span><a class='hidden_link' href='#condvarany.wait-8.sentence-1'>.</a></div></div></div></div><div class='para' id='condvarany.wait-9'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.wait-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4874'>#</a></div><div class='texpara'><div id='condvarany.wait-9.sentence-1' class='sentence'><i >Throws</i>: Timeout-related
exceptions (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>)<a class='hidden_link' href='#condvarany.wait-9.sentence-1'>.</a></div></div></div></div><div class='para' id='condvarany.wait-10'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.wait-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4879'>#</a></div><div class='texpara'><div id='condvarany.wait-10.sentence-1' class='sentence'><i >Remarks</i>: If the function fails to meet the postcondition, <span class='texttt'>terminate<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>
is invoked (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#condvarany.wait-10.sentence-1'>.</a></div> <div id='condvarany.wait-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condvarany.wait-note-2'>2</a></i>: <div id='condvarany.wait-10.sentence-2' class='sentence'>This can happen if the re-locking of the mutex throws an exception<a class='hidden_link' href='#condvarany.wait-10.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='texpara'><div id='lib:condition_variable_any,wait_for'><div id='lib:wait_for,condition_variable_any'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:wait_for,condition_variable_any'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Lock, <span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
  cv_status wait_for<span class='parenthesis'>(</span>Lock<span class='operator'>&amp;</span> lock, <span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='condvarany.wait-11'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.wait-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4895'>#</a></div><div class='texpara'><div id='condvarany.wait-11.sentence-1' class='sentence'><i >Effects</i>: Equivalent to:
<span class='codeblock'><span class='keyword'>return</span> wait_until<span class='parenthesis'>(</span>lock, chrono<span class='operator'>::</span>steady_clock<span class='operator'>::</span>now<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>+</span> rel_time<span class='parenthesis'>)</span>;
</span></div></div></div></div><div class='para' id='condvarany.wait-12'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.wait-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4902'>#</a></div><div class='texpara'><div id='condvarany.wait-12.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>lock</span> is locked by the calling thread<a class='hidden_link' href='#condvarany.wait-12.sentence-1'>.</a></div></div></div></div><div class='para' id='condvarany.wait-13'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.wait-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4906'>#</a></div><div class='texpara'><div id='condvarany.wait-13.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>cv_&shy;status<span class='operator'>&#x200b;::&#x200b;</span>timeout</span> if
the relative timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>) specified by <span class='texttt'>rel_&shy;time</span> expired,
otherwise <span class='texttt'>cv_&shy;status<span class='operator'>&#x200b;::&#x200b;</span>no_&shy;timeout</span><a class='hidden_link' href='#condvarany.wait-13.sentence-1'>.</a></div></div></div></div><div class='para' id='condvarany.wait-14'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.wait-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4912'>#</a></div><div class='texpara'><div id='condvarany.wait-14.sentence-1' class='sentence'><i >Throws</i>: Timeout-related
exceptions (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>)<a class='hidden_link' href='#condvarany.wait-14.sentence-1'>.</a></div></div></div></div><div class='para' id='condvarany.wait-15'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.wait-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4917'>#</a></div><div class='texpara'><div id='condvarany.wait-15.sentence-1' class='sentence'><i >Remarks</i>: If the function fails to meet the postcondition, <span class='texttt'>terminate</span>
is invoked (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#condvarany.wait-15.sentence-1'>.</a></div> <div id='condvarany.wait-note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condvarany.wait-note-3'>3</a></i>: <div id='condvarany.wait-15.sentence-2' class='sentence'>This can happen if the re-locking of the mutex throws an exception<a class='hidden_link' href='#condvarany.wait-15.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='texpara'><div id='lib:condition_variable_any,wait_until_'><div id='lib:wait_until,condition_variable_any_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:wait_until,condition_variable_any_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Lock, <span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration, <span class='keyword'>class</span> Predicate<span class='anglebracket'>&gt;</span>
  <span class='keyword'>bool</span> wait_until<span class='parenthesis'>(</span>Lock<span class='operator'>&amp;</span> lock, <span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time, Predicate pred<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='condvarany.wait-16'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.wait-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4933'>#</a></div><div class='texpara'><div id='condvarany.wait-16.sentence-1' class='sentence'><i >Effects</i>: Equivalent to:
<span class='codeblock'><span class='keyword'>while</span> <span class='parenthesis'>(</span><span class='operator'>!</span>pred<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>
  <span class='keyword'>if</span> <span class='parenthesis'>(</span>wait_until<span class='parenthesis'>(</span>lock, abs_time<span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> cv_status<span class='operator'>::</span>timeout<span class='parenthesis'>)</span>
    <span class='keyword'>return</span> pred<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='keyword'>return</span> <span class='literal'>true</span>;
</span></div></div></div></div><div class='para nonNormativeOnly' id='condvarany.wait-17'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.wait-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4943'>#</a></div><div class='texpara'><div id='condvarany.wait-note-4' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condvarany.wait-note-4'>4</a></i>: <div id='condvarany.wait-17.sentence-1' class='sentence'>There is no blocking if <span class='texttt'>pred<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is initially <span class='texttt'><span class='literal'>true</span></span>, or
if the timeout has already expired<a class='hidden_link' href='#condvarany.wait-17.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para nonNormativeOnly' id='condvarany.wait-18'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.wait-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4949'>#</a></div><div class='texpara'><div id='condvarany.wait-note-5' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condvarany.wait-note-5'>5</a></i>: <div id='condvarany.wait-18.sentence-1' class='sentence'>The returned value indicates whether the predicate evaluates to <span class='texttt'><span class='literal'>true</span></span>
regardless of whether the timeout was triggered<a class='hidden_link' href='#condvarany.wait-18.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='texpara'><div id='lib:condition_variable_any,wait_for_'><div id='lib:wait_for,condition_variable_any_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:wait_for,condition_variable_any_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Lock, <span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period, <span class='keyword'>class</span> Predicate<span class='anglebracket'>&gt;</span>
  <span class='keyword'>bool</span> wait_for<span class='parenthesis'>(</span>Lock<span class='operator'>&amp;</span> lock, <span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time, Predicate pred<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='condvarany.wait-19'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.wait-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4963'>#</a></div><div class='texpara'><div id='condvarany.wait-19.sentence-1' class='sentence'><i >Effects</i>: Equivalent to:
<span class='codeblock'><span class='keyword'>return</span> wait_until<span class='parenthesis'>(</span>lock, chrono<span class='operator'>::</span>steady_clock<span class='operator'>::</span>now<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>+</span> rel_time, std<span class='operator'>::</span>move<span class='parenthesis'>(</span>pred<span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
</span></div></div></div></div></div><div id='condvarany.intwait' class='section'><h4 ><a class='secnum' href='#condvarany.intwait' style='min-width:95pt'>32.6.5.3</a> Interruptible waits <a class='abbr_ref' href='thread.condvarany.intwait'>[thread.condvarany.intwait]</a></h4><div class='para' id='condvarany.intwait-1'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.intwait-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4973'>#</a></div><div class='texpara'><div id='condvarany.intwait-1.sentence-1' class='sentence'>The following wait functions will be notified
when there is a stop request on the passed <span class='texttt'>stop_&shy;token</span><a class='hidden_link' href='#condvarany.intwait-1.sentence-1'>.</a></div> <div id='condvarany.intwait-1.sentence-2' class='sentence'>In that case the functions return immediately,
returning <span class='texttt'><span class='literal'>false</span></span> if the predicate evaluates to <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#condvarany.intwait-1.sentence-2'>.</a></div></div></div><div class='texpara'><div class='itemdecl' id='condvarany.intwait-itemdecl:1'><div class='marginalizedparent'><a class='itemDeclLink' href='#condvarany.intwait-itemdecl:1'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Lock, <span class='keyword'>class</span> Predicate<span class='anglebracket'>&gt;</span>
  <span class='keyword'>bool</span> wait<span class='parenthesis'>(</span>Lock<span class='operator'>&amp;</span> lock, stop_token stoken, Predicate pred<span class='parenthesis'>)</span>;
</code></div></div><div class='para' id='condvarany.intwait-2'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.intwait-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4985'>#</a></div><div class='texpara'><div id='condvarany.intwait-2.sentence-1' class='sentence'><i >Effects</i>: Registers for the duration of this call <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span>
to get notified on a stop request on <span class='texttt'>stoken</span>
during this call and then equivalent to:
<span class='codeblock'><span class='keyword'>while</span> <span class='parenthesis'>(</span><span class='operator'>!</span>stoken<span class='operator'>.</span>stop_requested<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>if</span> <span class='parenthesis'>(</span>pred<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>
    <span class='keyword'>return</span> <span class='literal'>true</span>;
  wait<span class='parenthesis'>(</span>lock<span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
<span class='keyword'>return</span> pred<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</span></div></div></div></div><div class='para nonNormativeOnly' id='condvarany.intwait-3'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.intwait-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L4999'>#</a></div><div class='texpara'><div id='condvarany.intwait-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condvarany.intwait-note-1'>1</a></i>: <div id='condvarany.intwait-3.sentence-1' class='sentence'>The returned value indicates whether the predicate evaluated to
<span class='texttt'><span class='literal'>true</span></span> regardless of whether there was a stop request<a class='hidden_link' href='#condvarany.intwait-3.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='condvarany.intwait-4'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.intwait-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5005'>#</a></div><div class='texpara'><div id='condvarany.intwait-4.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>lock</span> is locked by the calling thread<a class='hidden_link' href='#condvarany.intwait-4.sentence-1'>.</a></div></div></div></div><div class='para' id='condvarany.intwait-5'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.intwait-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5009'>#</a></div><div class='texpara'><div id='condvarany.intwait-5.sentence-1' class='sentence'><i >Throws</i>: Any exception thrown by <span class='texttt'>pred</span><a class='hidden_link' href='#condvarany.intwait-5.sentence-1'>.</a></div></div></div></div><div class='para' id='condvarany.intwait-6'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.intwait-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5013'>#</a></div><div class='texpara'><div id='condvarany.intwait-6.sentence-1' class='sentence'><i >Remarks</i>: If the function fails to meet the postcondition,
<span class='texttt'>terminate</span> is called (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#condvarany.intwait-6.sentence-1'>.</a></div> <div id='condvarany.intwait-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condvarany.intwait-note-2'>2</a></i>: <div id='condvarany.intwait-6.sentence-2' class='sentence'>This can happen if the re-locking of the mutex throws an exception<a class='hidden_link' href='#condvarany.intwait-6.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='texpara'><div class='itemdecl' id='condvarany.intwait-itemdecl:2'><div class='marginalizedparent'><a class='itemDeclLink' href='#condvarany.intwait-itemdecl:2'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Lock, <span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration, <span class='keyword'>class</span> Predicate<span class='anglebracket'>&gt;</span>
  <span class='keyword'>bool</span> wait_until<span class='parenthesis'>(</span>Lock<span class='operator'>&amp;</span> lock, stop_token stoken,
                  <span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time, Predicate pred<span class='parenthesis'>)</span>;
</code></div></div><div class='para' id='condvarany.intwait-7'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.intwait-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5029'>#</a></div><div class='texpara'><div id='condvarany.intwait-7.sentence-1' class='sentence'><i >Effects</i>: Registers for the duration of this call <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span>
to get notified on a stop request on <span class='texttt'>stoken</span>
during this call and then equivalent to:
<span class='codeblock'><span class='keyword'>while</span> <span class='parenthesis'>(</span><span class='operator'>!</span>stoken<span class='operator'>.</span>stop_requested<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>if</span> <span class='parenthesis'>(</span>pred<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>
    <span class='keyword'>return</span> <span class='literal'>true</span>;
  <span class='keyword'>if</span> <span class='parenthesis'>(</span>wait_until<span class='parenthesis'>(</span>lock, abs_time<span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> cv_status<span class='operator'>::</span>timeout<span class='parenthesis'>)</span>
    <span class='keyword'>return</span> pred<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
<span class='keyword'>return</span> pred<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</span></div></div></div></div><div class='para nonNormativeOnly' id='condvarany.intwait-8'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.intwait-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5044'>#</a></div><div class='texpara'><div id='condvarany.intwait-note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condvarany.intwait-note-3'>3</a></i>: <div id='condvarany.intwait-8.sentence-1' class='sentence'>There is no blocking if <span class='texttt'>pred<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is initially <span class='texttt'><span class='literal'>true</span></span>,
<span class='texttt'>stoken<span class='operator'>.</span>stop_&shy;requested<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> was already <span class='texttt'><span class='literal'>true</span></span>
or the timeout has already expired<a class='hidden_link' href='#condvarany.intwait-8.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para nonNormativeOnly' id='condvarany.intwait-9'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.intwait-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5051'>#</a></div><div class='texpara'><div id='condvarany.intwait-note-4' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condvarany.intwait-note-4'>4</a></i>: <div id='condvarany.intwait-9.sentence-1' class='sentence'>The returned value indicates whether the predicate evaluated to <span class='texttt'><span class='literal'>true</span></span>
regardless of whether the timeout was triggered or a stop request was made<a class='hidden_link' href='#condvarany.intwait-9.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='condvarany.intwait-10'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.intwait-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5057'>#</a></div><div class='texpara'><div id='condvarany.intwait-10.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>lock</span> is locked by the calling thread<a class='hidden_link' href='#condvarany.intwait-10.sentence-1'>.</a></div></div></div></div><div class='para' id='condvarany.intwait-11'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.intwait-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5061'>#</a></div><div class='texpara'><div id='condvarany.intwait-11.sentence-1' class='sentence'><i >Throws</i>: Timeout-related exceptions  (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>),
or any exception thrown by <span class='texttt'>pred</span><a class='hidden_link' href='#condvarany.intwait-11.sentence-1'>.</a></div></div></div></div><div class='para' id='condvarany.intwait-12'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.intwait-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5066'>#</a></div><div class='texpara'><div id='condvarany.intwait-12.sentence-1' class='sentence'><i >Remarks</i>: If the function fails to meet the postcondition,
<span class='texttt'>terminate</span> is called (<a href='except.terminate' title='14.6.2&emsp;The std&#x200b;::&#x200b;terminate function'>[except.<span class='shy'></span>terminate]</a>)<a class='hidden_link' href='#condvarany.intwait-12.sentence-1'>.</a></div> <div id='condvarany.intwait-note-5' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#condvarany.intwait-note-5'>5</a></i>: <div id='condvarany.intwait-12.sentence-2' class='sentence'>This can happen if the re-locking of the mutex throws an exception<a class='hidden_link' href='#condvarany.intwait-12.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='texpara'><div class='itemdecl' id='condvarany.intwait-itemdecl:3'><div class='marginalizedparent'><a class='itemDeclLink' href='#condvarany.intwait-itemdecl:3'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Lock, <span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period, <span class='keyword'>class</span> Predicate<span class='anglebracket'>&gt;</span>
  <span class='keyword'>bool</span> wait_for<span class='parenthesis'>(</span>Lock<span class='operator'>&amp;</span> lock, stop_token stoken,
                <span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time, Predicate pred<span class='parenthesis'>)</span>;
</code></div></div><div class='para' id='condvarany.intwait-13'><div class='marginalizedparent'><a class='marginalized' href='#condvarany.intwait-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5082'>#</a></div><div class='texpara'><div id='condvarany.intwait-13.sentence-1' class='sentence'><i >Effects</i>: Equivalent to:
<span class='codeblock'><span class='keyword'>return</span> wait_until<span class='parenthesis'>(</span>lock, std<span class='operator'>::</span>move<span class='parenthesis'>(</span>stoken<span class='parenthesis'>)</span>, chrono<span class='operator'>::</span>steady_clock<span class='operator'>::</span>now<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>+</span> rel_time,
                  std<span class='operator'>::</span>move<span class='parenthesis'>(</span>pred<span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
</span></div></div></div></div></div></div></div><div id='sema' class='section'><h2 ><a class='secnum' href='#sema' style='min-width:65pt'>32.7</a> Semaphore <a class='abbr_ref' href='thread.sema'>[thread.sema]</a></h2><div id='sema.general' class='section'><h3 ><a class='secnum' href='#sema.general' style='min-width:80pt'>32.7.1</a> General <a class='abbr_ref' href='thread.sema.general'>[thread.sema.general]</a></h3><div class='para' id='sema.general-1'><div class='marginalizedparent'><a class='marginalized' href='#sema.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5095'>#</a></div><div class='texpara'><div id='sema.general-1.sentence-1' class='sentence'>Semaphores are lightweight synchronization primitives
used to constrain concurrent access to a shared resource<a class='hidden_link' href='#sema.general-1.sentence-1'>.</a></div> <div id='sema.general-1.sentence-2' class='sentence'>They are widely used to implement other synchronization primitives and,
whenever both are applicable, can be more efficient than condition variables<a class='hidden_link' href='#sema.general-1.sentence-2'>.</a></div></div></div><div class='para' id='sema.general-2'><div class='marginalizedparent'><a class='marginalized' href='#sema.general-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5101'>#</a></div><div class='texpara'><div id='sema.general-2.sentence-1' class='sentence'>A counting semaphore is a semaphore object
that models a non-negative resource count<a class='hidden_link' href='#sema.general-2.sentence-1'>.</a></div> <div id='sema.general-2.sentence-2' class='sentence'>A binary semaphore is a semaphore object that has only two states<a class='hidden_link' href='#sema.general-2.sentence-2'>.</a></div> <div id='sema.general-2.sentence-3' class='sentence'>A binary semaphore should be more efficient than
the default implementation of a counting semaphore with a unit resource count<a class='hidden_link' href='#sema.general-2.sentence-3'>.</a></div></div></div></div><div id='semaphore.syn' class='section'><h3 ><a class='secnum' href='#semaphore.syn' style='min-width:80pt'>32.7.2</a> Header <span class='texttt'>&lt;semaphore&gt;</span> synopsis <a class='abbr_ref' href='semaphore.syn'>[semaphore.syn]</a></h3><div class='texpara'><span id='header:<semaphore>'><div class='marginalizedparent'><a class='itemDeclLink' href='#header:%3csemaphore%3e'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span>ptrdiff_t least_max_value <span class='operator'>=</span> <i >implementation-defined</i><span class='anglebracket'>&gt;</span>
    <span class='keyword'>class</span> counting_semaphore;

  <span class='keyword'>using</span> binary_semaphore <span class='operator'>=</span> counting_semaphore<span class='anglebracket'>&lt;</span><span class='literal'>1</span><span class='anglebracket'>&gt;</span>;
<span class='curlybracket'>}</span>
</span></span></div></div><div id='sema.cnt' class='section'><h3 ><a class='secnum' href='#sema.cnt' style='min-width:80pt'>32.7.3</a> Class template <span class='texttt'>counting_&shy;semaphore</span> <a class='abbr_ref' href='thread.sema.cnt'>[thread.sema.cnt]</a></h3><div class='texpara'><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span>ptrdiff_t least_max_value <span class='operator'>=</span> <a class='index' id=':default_value_for_least_max_value_template_parameter_of_counting_semaphore'></a><i >implementation-defined</i><span class='anglebracket'>&gt;</span>
  <span class='keyword'>class</span> counting_semaphore <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    <span class='keyword'>static</span> <span class='keyword'>constexpr</span> ptrdiff_t max<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    <span class='keyword'>constexpr</span> <span class='keyword'>explicit</span> counting_semaphore<span class='parenthesis'>(</span>ptrdiff_t desired<span class='parenthesis'>)</span>;
    <span class='operator'>~</span>counting_semaphore<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    counting_semaphore<span class='parenthesis'>(</span><span class='keyword'>const</span> counting_semaphore<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    counting_semaphore<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> counting_semaphore<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;

    <span class='keyword'>void</span> release<span class='parenthesis'>(</span>ptrdiff_t update <span class='operator'>=</span> <span class='literal'>1</span><span class='parenthesis'>)</span>;
    <span class='keyword'>void</span> acquire<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>bool</span> try_acquire<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
      <span class='keyword'>bool</span> try_acquire_for<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
      <span class='keyword'>bool</span> try_acquire_until<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span>;

  <span class='keyword'>private</span><span class='operator'>:</span>
    ptrdiff_t counter;          <span class='comment'>// <i >exposition only</i></span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></div><div class='para' id='sema.cnt-1'><div class='marginalizedparent'><a class='marginalized' href='#sema.cnt-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5149'>#</a></div><div class='texpara'><div id='sema.cnt-1.sentence-1' class='sentence'><a class='index' id=':block_(execution)_______________'></a>Class template <span class='texttt'>counting_&shy;semaphore</span> maintains an internal counter
that is initialized when the semaphore is created<a class='hidden_link' href='#sema.cnt-1.sentence-1'>.</a></div> <div id='sema.cnt-1.sentence-2' class='sentence'>The counter is decremented when a thread acquires the semaphore, and
is incremented when a thread releases the semaphore<a class='hidden_link' href='#sema.cnt-1.sentence-2'>.</a></div> <div id='sema.cnt-1.sentence-3' class='sentence'>If a thread tries to acquire the semaphore when the counter is zero,
the thread will block
until another thread increments the counter by releasing the semaphore<a class='hidden_link' href='#sema.cnt-1.sentence-3'>.</a></div></div></div><div class='para' id='sema.cnt-2'><div class='marginalizedparent'><a class='marginalized' href='#sema.cnt-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5159'>#</a></div><div class='texpara'><div id='sema.cnt-2.sentence-1' class='sentence'><span class='texttt'>least_&shy;max_&shy;value</span> shall be non-negative; otherwise the program is ill-formed<a class='hidden_link' href='#sema.cnt-2.sentence-1'>.</a></div></div></div><div class='para' id='sema.cnt-3'><div class='marginalizedparent'><a class='marginalized' href='#sema.cnt-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5162'>#</a></div><div class='texpara'><div id='sema.cnt-3.sentence-1' class='sentence'>Concurrent invocations of the member functions of <span class='texttt'>counting_&shy;semaphore</span>,
other than its destructor, do not introduce data races<a class='hidden_link' href='#sema.cnt-3.sentence-1'>.</a></div></div></div><div class='texpara'><div id='lib:counting_semaphore,max'><div id='lib:max,counting_semaphore'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:max,counting_semaphore'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>static</span> <span class='keyword'>constexpr</span> ptrdiff_t max<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='sema.cnt-4'><div class='marginalizedparent'><a class='marginalized' href='#sema.cnt-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5172'>#</a></div><div class='texpara'><div id='sema.cnt-4.sentence-1' class='sentence'><i >Returns</i>: The maximum value of <span class='texttt'>counter</span><a class='hidden_link' href='#sema.cnt-4.sentence-1'>.</a></div> <div id='sema.cnt-4.sentence-2' class='sentence'>This value is greater than or equal to <span class='texttt'>least_&shy;max_&shy;value</span><a class='hidden_link' href='#sema.cnt-4.sentence-2'>.</a></div></div></div></div><div class='texpara'><div id='lib:counting_semaphore,constructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:counting_semaphore,constructor'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>constexpr</span> <span class='keyword'>explicit</span> counting_semaphore<span class='parenthesis'>(</span>ptrdiff_t desired<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='sema.cnt-5'><div class='marginalizedparent'><a class='marginalized' href='#sema.cnt-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5184'>#</a></div><div class='texpara'><div id='sema.cnt-5.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'>desired <span class='anglebracket'>&gt;</span><span class='operator'>=</span> <span class='literal'>0</span></span> is <span class='texttt'><span class='literal'>true</span></span>, and
<span class='texttt'>desired <span class='anglebracket'>&lt;</span><span class='operator'>=</span> max<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#sema.cnt-5.sentence-1'>.</a></div></div></div></div><div class='para' id='sema.cnt-6'><div class='marginalizedparent'><a class='marginalized' href='#sema.cnt-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5189'>#</a></div><div class='texpara'><div id='sema.cnt-6.sentence-1' class='sentence'><i >Effects</i>: Initializes <span class='texttt'>counter</span> with <span class='texttt'>desired</span><a class='hidden_link' href='#sema.cnt-6.sentence-1'>.</a></div></div></div></div><div class='para' id='sema.cnt-7'><div class='marginalizedparent'><a class='marginalized' href='#sema.cnt-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5193'>#</a></div><div class='texpara'><div id='sema.cnt-7.sentence-1' class='sentence'><i >Throws</i>: Nothing<a class='hidden_link' href='#sema.cnt-7.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:counting_semaphore,release'><div id='lib:release,counting_semaphore'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:release,counting_semaphore'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> release<span class='parenthesis'>(</span>ptrdiff_t update <span class='operator'>=</span> <span class='literal'>1</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='sema.cnt-8'><div class='marginalizedparent'><a class='marginalized' href='#sema.cnt-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5204'>#</a></div><div class='texpara'><div id='sema.cnt-8.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'>update <span class='anglebracket'>&gt;</span><span class='operator'>=</span> <span class='literal'>0</span></span> is <span class='texttt'><span class='literal'>true</span></span>, and
<span class='texttt'>update <span class='anglebracket'>&lt;</span><span class='operator'>=</span> max<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>-</span> counter</span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#sema.cnt-8.sentence-1'>.</a></div></div></div></div><div class='para' id='sema.cnt-9'><div class='marginalizedparent'><a class='marginalized' href='#sema.cnt-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5209'>#</a></div><div class='texpara'><div id='sema.cnt-9.sentence-1' class='sentence'><i >Effects</i>: Atomically execute <span class='texttt'>counter <span class='operator'>+</span><span class='operator'>=</span> update</span><a class='hidden_link' href='#sema.cnt-9.sentence-1'>.</a></div> <div id='sema.cnt-9.sentence-2' class='sentence'>Then, unblocks any threads
that are waiting for <span class='texttt'>counter</span> to be greater than zero<a class='hidden_link' href='#sema.cnt-9.sentence-2'>.</a></div></div></div></div><div class='para' id='sema.cnt-10'><div class='marginalizedparent'><a class='marginalized' href='#sema.cnt-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5215'>#</a></div><div class='texpara'><div id='sema.cnt-10.sentence-1' class='sentence'><i >Synchronization</i>: Strongly happens before invocations of <span class='texttt'>try_&shy;acquire</span>
that observe the result of the effects<a class='hidden_link' href='#sema.cnt-10.sentence-1'>.</a></div></div></div></div><div class='para' id='sema.cnt-11'><div class='marginalizedparent'><a class='marginalized' href='#sema.cnt-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5220'>#</a></div><div class='texpara'><div id='sema.cnt-11.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>system_&shy;error</span> when an exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#sema.cnt-11.sentence-1'>.</a></div></div></div></div><div class='para' id='sema.cnt-12'><div class='marginalizedparent'><a class='marginalized' href='#sema.cnt-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5224'>#</a></div><div class='texpara'><div id='sema.cnt-12.sentence-1' class='sentence'><i >Error conditions</i>: Any of the error conditions
allowed for mutex types (<a href='#mutex.requirements.mutex' title='32.5.4.2&emsp;Mutex types'>[thread.<span class='shy'></span>mutex.<span class='shy'></span>requirements.<span class='shy'></span>mutex]</a>)<a class='hidden_link' href='#sema.cnt-12.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:counting_semaphore,try_acquire'><div id='lib:try_acquire,counting_semaphore'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:try_acquire,counting_semaphore'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>bool</span> try_acquire<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='sema.cnt-13'><div class='marginalizedparent'><a class='marginalized' href='#sema.cnt-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5236'>#</a></div><div class='texpara'><div id='sema.cnt-13.sentence-1' class='sentence'><i >Effects</i>: Attempts to atomically decrement <span class='texttt'>counter</span> if it is positive,
without blocking<a class='hidden_link' href='#sema.cnt-13.sentence-1'>.</a></div> <div id='sema.cnt-13.sentence-2' class='sentence'>If <span class='texttt'>counter</span> is not decremented, there is no effect and
<span class='texttt'>try_&shy;acquire</span> immediately returns<a class='hidden_link' href='#sema.cnt-13.sentence-2'>.</a></div> <div id='sema.cnt-13.sentence-3' class='sentence'>An implementation may fail to decrement <span class='texttt'>counter</span>
even if it is positive<a class='hidden_link' href='#sema.cnt-13.sentence-3'>.</a></div> <div id='sema.cnt-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#sema.cnt-note-1'>1</a></i>: <div id='sema.cnt-13.sentence-4' class='sentence'>This spurious failure is normally uncommon, but
allows interesting implementations
based on a simple compare and exchange (<a href='atomics' title='31&emsp;Atomic operations library'>[atomics]</a>)<a class='hidden_link' href='#sema.cnt-13.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='sema.cnt-13.sentence-5' class='sentence'>
An implementation should ensure that <span class='texttt'>try_&shy;acquire</span>
does not consistently return <span class='texttt'><span class='literal'>false</span></span>
in the absence of contending semaphore operations<a class='hidden_link' href='#sema.cnt-13.sentence-5'>.</a></div></div></div></div><div class='para' id='sema.cnt-14'><div class='marginalizedparent'><a class='marginalized' href='#sema.cnt-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5253'>#</a></div><div class='texpara'><div id='sema.cnt-14.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>true</span></span> if <span class='texttt'>counter</span> was decremented, otherwise <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#sema.cnt-14.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:counting_semaphore,acquire'><div id='lib:acquire,counting_semaphore'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:acquire,counting_semaphore'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> acquire<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='sema.cnt-15'><div class='marginalizedparent'><a class='marginalized' href='#sema.cnt-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5264'>#</a></div><div class='texpara'><div id='sema.cnt-15.sentence-1' class='sentence'><i >Effects</i>: Repeatedly performs the following steps, in order:
<ul class='itemize'><li id='sema.cnt-15.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#sema.cnt-15.1'>(15.1)</a></div><div class='texpara'><div id='sema.cnt-15.1.sentence-1' class='sentence'>Evaluates <span class='texttt'>try_&shy;acquire</span><a class='hidden_link' href='#sema.cnt-15.1.sentence-1'>.</a></div> <div id='sema.cnt-15.1.sentence-2' class='sentence'>If the result is <span class='texttt'><span class='literal'>true</span></span>, returns<a class='hidden_link' href='#sema.cnt-15.1.sentence-2'>.</a></div></div></li><li id='sema.cnt-15.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#sema.cnt-15.2'>(15.2)</a></div><div class='texpara'><div id='sema.cnt-15.2.sentence-1' class='sentence'><a class='index' id=':block_(execution)________________'></a>Blocks on <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> until <span class='texttt'>counter</span> is greater than zero<a class='hidden_link' href='#sema.cnt-15.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='para' id='sema.cnt-16'><div class='marginalizedparent'><a class='marginalized' href='#sema.cnt-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5274'>#</a></div><div class='texpara'><div id='sema.cnt-16.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>system_&shy;error</span> when an exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#sema.cnt-16.sentence-1'>.</a></div></div></div></div><div class='para' id='sema.cnt-17'><div class='marginalizedparent'><a class='marginalized' href='#sema.cnt-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5278'>#</a></div><div class='texpara'><div id='sema.cnt-17.sentence-1' class='sentence'><i >Error conditions</i>: Any of the error conditions
allowed for mutex types (<a href='#mutex.requirements.mutex' title='32.5.4.2&emsp;Mutex types'>[thread.<span class='shy'></span>mutex.<span class='shy'></span>requirements.<span class='shy'></span>mutex]</a>)<a class='hidden_link' href='#sema.cnt-17.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:counting_semaphore,try_acquire_until'><div id='lib:try_acquire_until,counting_semaphore'><div id='lib:counting_semaphore,try_acquire_for'><div id='lib:try_acquire_for,counting_semaphore'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:try_acquire_for,counting_semaphore'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
  <span class='keyword'>bool</span> try_acquire_for<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
  <span class='keyword'>bool</span> try_acquire_until<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span>;
</code></div></div></div></div></div></div><div class='para' id='sema.cnt-18'><div class='marginalizedparent'><a class='marginalized' href='#sema.cnt-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5294'>#</a></div><div class='texpara'><div id='sema.cnt-18.sentence-1' class='sentence'><i >Effects</i>: Repeatedly performs the following steps, in order:
<ul class='itemize'><li id='sema.cnt-18.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#sema.cnt-18.1'>(18.1)</a></div><div class='texpara'><div id='sema.cnt-18.1.sentence-1' class='sentence'>Evaluates <span class='texttt'>try_&shy;acquire<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#sema.cnt-18.1.sentence-1'>.</a></div> <div id='sema.cnt-18.1.sentence-2' class='sentence'>If the result is <span class='texttt'><span class='literal'>true</span></span>, returns <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#sema.cnt-18.1.sentence-2'>.</a></div></div></li><li id='sema.cnt-18.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#sema.cnt-18.2'>(18.2)</a></div><div class='texpara'><div id='sema.cnt-18.2.sentence-1' class='sentence'><a class='index' id=':block_(execution)_________________'></a>  Blocks on <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span>
  until <span class='texttt'>counter</span> is greater than zero or until the timeout expires<a class='hidden_link' href='#sema.cnt-18.2.sentence-1'>.</a></div> <div id='sema.cnt-18.2.sentence-2' class='sentence'>If it is unblocked by the timeout expiring, returns <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#sema.cnt-18.2.sentence-2'>.</a></div></div></li></ul></div> <div id='sema.cnt-18.sentence-2' class='sentence'>
The timeout expires (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>)
when the current time is after <span class='texttt'>abs_&shy;time</span> (for <span class='texttt'>try_&shy;acquire_&shy;until</span>)
or when at least <span class='texttt'>rel_&shy;time</span> has passed
from the start of the function (for <span class='texttt'>try_&shy;acquire_&shy;for</span>)<a class='hidden_link' href='#sema.cnt-18.sentence-2'>.</a></div></div></div></div><div class='para' id='sema.cnt-19'><div class='marginalizedparent'><a class='marginalized' href='#sema.cnt-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5312'>#</a></div><div class='texpara'><div id='sema.cnt-19.sentence-1' class='sentence'><i >Throws</i>: Timeout-related exceptions (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>), or <span class='texttt'>system_&shy;error</span>
when a non-timeout-related exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#sema.cnt-19.sentence-1'>.</a></div></div></div></div><div class='para' id='sema.cnt-20'><div class='marginalizedparent'><a class='marginalized' href='#sema.cnt-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5317'>#</a></div><div class='texpara'><div id='sema.cnt-20.sentence-1' class='sentence'><i >Error conditions</i>: Any of the error conditions
allowed for mutex types (<a href='#mutex.requirements.mutex' title='32.5.4.2&emsp;Mutex types'>[thread.<span class='shy'></span>mutex.<span class='shy'></span>requirements.<span class='shy'></span>mutex]</a>)<a class='hidden_link' href='#sema.cnt-20.sentence-1'>.</a></div></div></div></div></div></div><div id='coord' class='section'><h2 ><a class='secnum' href='#coord' style='min-width:65pt'>32.8</a> Coordination types <a class='abbr_ref' href='thread.coord'>[thread.coord]</a></h2><div id='coord.general' class='section'><h3 ><a class='secnum' href='#coord.general' style='min-width:80pt'>32.8.1</a> General <a class='abbr_ref' href='thread.coord.general'>[thread.coord.general]</a></h3><div class='para' id='coord.general-1'><div class='marginalizedparent'><a class='marginalized' href='#coord.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5327'>#</a></div><div class='texpara'><div id='coord.general-1.sentence-1' class='sentence'>Subclause <a href='#coord' title='32.8&emsp;Coordination types'>[thread.<span class='shy'></span>coord]</a> describes various concepts related to thread coordination, and
defines the coordination types <span class='texttt'>latch</span> and <span class='texttt'>barrier</span><a class='hidden_link' href='#coord.general-1.sentence-1'>.</a></div> <div id='coord.general-1.sentence-2' class='sentence'>These types facilitate concurrent computation performed by a number of threads<a class='hidden_link' href='#coord.general-1.sentence-2'>.</a></div></div></div></div><div id='latch' class='section'><h3 ><a class='secnum' href='#latch' style='min-width:80pt'>32.8.2</a> Latches <a class='abbr_ref' href='thread.latch'>[thread.latch]</a></h3><div id='latch.general' class='section'><h4 ><a class='secnum' href='#latch.general' style='min-width:95pt'>32.8.2.1</a> General <a class='abbr_ref' href='thread.latch.general'>[thread.latch.general]</a></h4><div class='para' id='latch.general-1'><div class='marginalizedparent'><a class='marginalized' href='#latch.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5336'>#</a></div><div class='texpara'><div id='latch.general-1.sentence-1' class='sentence'>A latch is a thread coordination mechanism
that allows any number of threads to block
until an expected number of threads arrive at the latch
(via the <span class='texttt'>count_&shy;down</span> function)<a class='hidden_link' href='#latch.general-1.sentence-1'>.</a></div> <div id='latch.general-1.sentence-2' class='sentence'>The expected count is set when the latch is created<a class='hidden_link' href='#latch.general-1.sentence-2'>.</a></div> <div id='latch.general-1.sentence-3' class='sentence'>An individual latch is a single-use object;
once the expected count has been reached, the latch cannot be reused<a class='hidden_link' href='#latch.general-1.sentence-3'>.</a></div></div></div></div><div id='latch.syn' class='section'><h4 ><a class='secnum' href='#latch.syn' style='min-width:95pt'>32.8.2.2</a> Header <span class='texttt'>&lt;latch&gt;</span> synopsis <a class='abbr_ref' href='latch.syn'>[latch.syn]</a></h4><div class='texpara'><span id='header:<latch>'><div class='marginalizedparent'><a class='itemDeclLink' href='#header:%3clatch%3e'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>class</span> latch;
<span class='curlybracket'>}</span>
</span></span></div></div><div id='latch.class' class='section'><h4 ><a class='secnum' href='#latch.class' style='min-width:95pt'>32.8.2.3</a> Class <span class='texttt'>latch</span> <a class='abbr_ref' href='thread.latch.class'>[thread.latch.class]</a></h4><div class='texpara'><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>class</span> latch <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    <span class='keyword'>static</span> <span class='keyword'>constexpr</span> ptrdiff_t max<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    <span class='keyword'>constexpr</span> <span class='keyword'>explicit</span> latch<span class='parenthesis'>(</span>ptrdiff_t expected<span class='parenthesis'>)</span>;
    <span class='operator'>~</span>latch<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    latch<span class='parenthesis'>(</span><span class='keyword'>const</span> latch<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    latch<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> latch<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;

    <span class='keyword'>void</span> count_down<span class='parenthesis'>(</span>ptrdiff_t update <span class='operator'>=</span> <span class='literal'>1</span><span class='parenthesis'>)</span>;
    <span class='keyword'>bool</span> try_wait<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>void</span> wait<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span>;
    <span class='keyword'>void</span> arrive_and_wait<span class='parenthesis'>(</span>ptrdiff_t update <span class='operator'>=</span> <span class='literal'>1</span><span class='parenthesis'>)</span>;

  <span class='keyword'>private</span><span class='operator'>:</span>
    ptrdiff_t counter;  <span class='comment'>// <i >exposition only</i></span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></div><div class='para' id='latch.class-1'><div class='marginalizedparent'><a class='marginalized' href='#latch.class-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5379'>#</a></div><div class='texpara'><div id='latch.class-1.sentence-1' class='sentence'>A <span class='texttt'>latch</span> maintains an internal counter
that is initialized when the latch is created<a class='hidden_link' href='#latch.class-1.sentence-1'>.</a></div> <div id='latch.class-1.sentence-2' class='sentence'>Threads can block on the latch object,
waiting for counter to be decremented to zero<a class='hidden_link' href='#latch.class-1.sentence-2'>.</a></div></div></div><div class='para' id='latch.class-2'><div class='marginalizedparent'><a class='marginalized' href='#latch.class-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5385'>#</a></div><div class='texpara'><div id='latch.class-2.sentence-1' class='sentence'>Concurrent invocations of the member functions of <span class='texttt'>latch</span>,
other than its destructor, do not introduce data races<a class='hidden_link' href='#latch.class-2.sentence-1'>.</a></div></div></div><div class='texpara'><div id='lib:latch,max'><div id='lib:max,latch'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:max,latch'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>static</span> <span class='keyword'>constexpr</span> ptrdiff_t max<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='latch.class-3'><div class='marginalizedparent'><a class='marginalized' href='#latch.class-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5395'>#</a></div><div class='texpara'><div id='latch.class-3.sentence-1' class='sentence'><i >Returns</i>: The maximum value of <span class='texttt'>counter</span> that the implementation supports<a class='hidden_link' href='#latch.class-3.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:latch,constructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:latch,constructor'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>constexpr</span> <span class='keyword'>explicit</span> latch<span class='parenthesis'>(</span>ptrdiff_t expected<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='latch.class-4'><div class='marginalizedparent'><a class='marginalized' href='#latch.class-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5406'>#</a></div><div class='texpara'><div id='latch.class-4.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'>expected <span class='anglebracket'>&gt;</span><span class='operator'>=</span> <span class='literal'>0</span></span> is <span class='texttt'><span class='literal'>true</span></span> and
<span class='texttt'>expected <span class='anglebracket'>&lt;</span><span class='operator'>=</span> max<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#latch.class-4.sentence-1'>.</a></div></div></div></div><div class='para' id='latch.class-5'><div class='marginalizedparent'><a class='marginalized' href='#latch.class-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5411'>#</a></div><div class='texpara'><div id='latch.class-5.sentence-1' class='sentence'><i >Effects</i>: Initializes <span class='texttt'>counter</span> with <span class='texttt'>expected</span><a class='hidden_link' href='#latch.class-5.sentence-1'>.</a></div></div></div></div><div class='para' id='latch.class-6'><div class='marginalizedparent'><a class='marginalized' href='#latch.class-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5415'>#</a></div><div class='texpara'><div id='latch.class-6.sentence-1' class='sentence'><i >Throws</i>: Nothing<a class='hidden_link' href='#latch.class-6.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:latch,count_down'><div id='lib:count_down,latch'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:count_down,latch'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> count_down<span class='parenthesis'>(</span>ptrdiff_t update <span class='operator'>=</span> <span class='literal'>1</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='latch.class-7'><div class='marginalizedparent'><a class='marginalized' href='#latch.class-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5426'>#</a></div><div class='texpara'><div id='latch.class-7.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'>update <span class='anglebracket'>&gt;</span><span class='operator'>=</span> <span class='literal'>0</span></span> is <span class='texttt'><span class='literal'>true</span></span>, and
<span class='texttt'>update <span class='anglebracket'>&lt;</span><span class='operator'>=</span> counter</span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#latch.class-7.sentence-1'>.</a></div></div></div></div><div class='para' id='latch.class-8'><div class='marginalizedparent'><a class='marginalized' href='#latch.class-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5431'>#</a></div><div class='texpara'><div id='latch.class-8.sentence-1' class='sentence'><i >Effects</i>: Atomically decrements <span class='texttt'>counter</span> by <span class='texttt'>update</span><a class='hidden_link' href='#latch.class-8.sentence-1'>.</a></div> <div id='latch.class-8.sentence-2' class='sentence'>If <span class='texttt'>counter</span> is equal to zero,
unblocks all threads blocked on <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#latch.class-8.sentence-2'>.</a></div></div></div></div><div class='para' id='latch.class-9'><div class='marginalizedparent'><a class='marginalized' href='#latch.class-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5437'>#</a></div><div class='texpara'><div id='latch.class-9.sentence-1' class='sentence'><i >Synchronization</i>: Strongly happens before the returns from all calls that are unblocked<a class='hidden_link' href='#latch.class-9.sentence-1'>.</a></div></div></div></div><div class='para' id='latch.class-10'><div class='marginalizedparent'><a class='marginalized' href='#latch.class-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5441'>#</a></div><div class='texpara'><div id='latch.class-10.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>system_&shy;error</span> when an exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#latch.class-10.sentence-1'>.</a></div></div></div></div><div class='para' id='latch.class-11'><div class='marginalizedparent'><a class='marginalized' href='#latch.class-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5445'>#</a></div><div class='texpara'><div id='latch.class-11.sentence-1' class='sentence'><i >Error conditions</i>: Any of the error conditions
allowed for mutex types (<a href='#mutex.requirements.mutex' title='32.5.4.2&emsp;Mutex types'>[thread.<span class='shy'></span>mutex.<span class='shy'></span>requirements.<span class='shy'></span>mutex]</a>)<a class='hidden_link' href='#latch.class-11.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:latch,try_wait'><div id='lib:try_wait,latch'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:try_wait,latch'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>bool</span> try_wait<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='latch.class-12'><div class='marginalizedparent'><a class='marginalized' href='#latch.class-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5457'>#</a></div><div class='texpara'><div id='latch.class-12.sentence-1' class='sentence'><i >Returns</i>: With very low probability <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#latch.class-12.sentence-1'>.</a></div> <div id='latch.class-12.sentence-2' class='sentence'>Otherwise <span class='texttt'>counter <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>0</span></span><a class='hidden_link' href='#latch.class-12.sentence-2'>.</a></div></div></div></div><div class='texpara'><div id='lib:latch,wait'><div id='lib:wait,latch'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:wait,latch'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> wait<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div></div></div><div class='para' id='latch.class-13'><div class='marginalizedparent'><a class='marginalized' href='#latch.class-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5468'>#</a></div><div class='texpara'><div id='latch.class-13.sentence-1' class='sentence'><a class='index' id=':block_(execution)__________________'></a><i >Effects</i>: If <span class='texttt'>counter</span> equals zero, returns immediately<a class='hidden_link' href='#latch.class-13.sentence-1'>.</a></div> <div id='latch.class-13.sentence-2' class='sentence'>Otherwise, blocks on <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span>
until a call to <span class='texttt'>count_&shy;down</span> that decrements <span class='texttt'>counter</span> to zero<a class='hidden_link' href='#latch.class-13.sentence-2'>.</a></div></div></div></div><div class='para' id='latch.class-14'><div class='marginalizedparent'><a class='marginalized' href='#latch.class-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5475'>#</a></div><div class='texpara'><div id='latch.class-14.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>system_&shy;error</span> when an exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#latch.class-14.sentence-1'>.</a></div></div></div></div><div class='para' id='latch.class-15'><div class='marginalizedparent'><a class='marginalized' href='#latch.class-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5479'>#</a></div><div class='texpara'><div id='latch.class-15.sentence-1' class='sentence'><i >Error conditions</i>: Any of the error conditions
allowed for mutex types (<a href='#mutex.requirements.mutex' title='32.5.4.2&emsp;Mutex types'>[thread.<span class='shy'></span>mutex.<span class='shy'></span>requirements.<span class='shy'></span>mutex]</a>)<a class='hidden_link' href='#latch.class-15.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:latch,arrive_and_wait'><div id='lib:arrive_and_wait,latch'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:arrive_and_wait,latch'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> arrive_and_wait<span class='parenthesis'>(</span>ptrdiff_t update <span class='operator'>=</span> <span class='literal'>1</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='latch.class-16'><div class='marginalizedparent'><a class='marginalized' href='#latch.class-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5491'>#</a></div><div class='texpara'><div id='latch.class-16.sentence-1' class='sentence'><i >Effects</i>: Equivalent to:
<span class='codeblock'>count_down<span class='parenthesis'>(</span>update<span class='parenthesis'>)</span>;
wait<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</span></div></div></div></div></div></div><div id='barrier' class='section'><h3 ><a class='secnum' href='#barrier' style='min-width:80pt'>32.8.3</a> Barriers <a class='abbr_ref' href='thread.barrier'>[thread.barrier]</a></h3><div id='barrier.general' class='section'><h4 ><a class='secnum' href='#barrier.general' style='min-width:95pt'>32.8.3.1</a> General <a class='abbr_ref' href='thread.barrier.general'>[thread.barrier.general]</a></h4><div class='para' id='barrier.general-1'><div class='marginalizedparent'><a class='marginalized' href='#barrier.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5504'>#</a></div><div class='texpara'><div id='barrier.general-1.sentence-1' class='sentence'>A barrier is a thread coordination mechanism
whose lifetime consists of a sequence of barrier phases,
where each phase allows at most an expected number of threads to block
until the expected number of threads arrive at the barrier<a class='hidden_link' href='#barrier.general-1.sentence-1'>.</a></div> <div id='barrier.general-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#barrier.general-note-1'>1</a></i>: <div id='barrier.general-1.sentence-2' class='sentence'>A barrier is useful for managing repeated tasks
that are handled by multiple threads<a class='hidden_link' href='#barrier.general-1.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div id='barrier.syn' class='section'><h4 ><a class='secnum' href='#barrier.syn' style='min-width:95pt'>32.8.3.2</a> Header <span class='texttt'>&lt;barrier&gt;</span> synopsis <a class='abbr_ref' href='barrier.syn'>[barrier.syn]</a></h4><div class='texpara'><span id='header:<barrier>'><div class='marginalizedparent'><a class='itemDeclLink' href='#header:%3cbarrier%3e'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> CompletionFunction <span class='operator'>=</span> <i ><span class='texttt'>see below</span></i><span class='anglebracket'>&gt;</span>
    <span class='keyword'>class</span> barrier;
<span class='curlybracket'>}</span>
</span></span></div></div><div id='barrier.class' class='section'><h4 ><a class='secnum' href='#barrier.class' style='min-width:95pt'>32.8.3.3</a> Class template <span class='texttt'>barrier</span> <a class='abbr_ref' href='thread.barrier.class'>[thread.barrier.class]</a></h4><div class='texpara'><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> CompletionFunction <span class='operator'>=</span> <i ><span class='texttt'>see below</span></i><span class='anglebracket'>&gt;</span>
  <span class='keyword'>class</span> barrier <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    <span class='keyword'>using</span> arrival_token <span class='operator'>=</span> <i ><span class='texttt'>see below</span></i>;

    <span class='keyword'>static</span> <span class='keyword'>constexpr</span> ptrdiff_t max<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    <span class='keyword'>constexpr</span> <span class='keyword'>explicit</span> barrier<span class='parenthesis'>(</span>ptrdiff_t expected,
                               CompletionFunction f <span class='operator'>=</span> CompletionFunction<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
    <span class='operator'>~</span>barrier<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    barrier<span class='parenthesis'>(</span><span class='keyword'>const</span> barrier<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    barrier<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> barrier<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;

    <span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> arrival_token arrive<span class='parenthesis'>(</span>ptrdiff_t update <span class='operator'>=</span> <span class='literal'>1</span><span class='parenthesis'>)</span>;
    <span class='keyword'>void</span> wait<span class='parenthesis'>(</span>arrival_token<span class='operator'>&amp;</span><span class='operator'>&amp;</span> arrival<span class='parenthesis'>)</span> <span class='keyword'>const</span>;

    <span class='keyword'>void</span> arrive_and_wait<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>void</span> arrive_and_drop<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

  <span class='keyword'>private</span><span class='operator'>:</span>
    CompletionFunction completion;      <span class='comment'>// <i >exposition only</i></span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></div><div class='para' id='barrier.class-1'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5554'>#</a></div><div class='texpara'><div id='barrier.class-1.sentence-1' class='sentence'>Each <a class='hidden_link' href='#def:barrier_phase' title='32.8.3.3&emsp;Class template barrier&emsp;[thread.barrier.class]'><span id='def:barrier_phase'><i >barrier phase</i></span></a> consists of the following steps:
<ul class='itemize'><li id='barrier.class-1.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#barrier.class-1.1'>(1.1)</a></div><div class='texpara'><div id='barrier.class-1.1.sentence-1' class='sentence'>The expected count is decremented
  by each call to <span class='texttt'>arrive</span> or <span class='texttt'>arrive_&shy;and_&shy;drop</span><a class='hidden_link' href='#barrier.class-1.1.sentence-1'>.</a></div></div></li><li id='barrier.class-1.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#barrier.class-1.2'>(1.2)</a></div><div class='texpara'><div id='barrier.class-1.2.sentence-1' class='sentence'>When the expected count reaches zero, the phase completion step is run<a class='hidden_link' href='#barrier.class-1.2.sentence-1'>.</a></div> <div id='barrier.class-1.2.sentence-2' class='sentence'>For the specialization
  with the default value of the <span class='texttt'>CompletionFunction</span> template parameter,
  the completion step is run
  as part of the call to <span class='texttt'>arrive</span> or <span class='texttt'>arrive_&shy;and_&shy;drop</span>
  that caused the expected count to reach zero<a class='hidden_link' href='#barrier.class-1.2.sentence-2'>.</a></div> <div id='barrier.class-1.2.sentence-3' class='sentence'>For other specializations,
  the completion step is run on one of the threads
  that arrived at the barrier during the phase<a class='hidden_link' href='#barrier.class-1.2.sentence-3'>.</a></div></div></li><li id='barrier.class-1.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#barrier.class-1.3'>(1.3)</a></div><div class='texpara'><div id='barrier.class-1.3.sentence-1' class='sentence'>When the completion step finishes,
  the expected count is reset
  to what was specified by the <span class='texttt'>expected</span> argument to the constructor,
  possibly adjusted by calls to <span class='texttt'>arrive_&shy;and_&shy;drop</span>, and
  the next phase starts<a class='hidden_link' href='#barrier.class-1.3.sentence-1'>.</a></div></div></li></ul></div> </div></div><div class='para' id='barrier.class-2'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5579'>#</a></div><div class='texpara'><div id='barrier.class-2.sentence-1' class='sentence'><a class='index' id=':block_(execution)___________________'></a>Each phase defines a <a class='hidden_link' href='#def:barrier,phase_synchronization_point' title='32.8.3.3&emsp;Class template barrier&emsp;[thread.barrier.class]'><span id='def:barrier,phase_synchronization_point'><i >phase synchronization point</i></span></a><a class='hidden_link' href='#barrier.class-2.sentence-1'>.</a></div> <div id='barrier.class-2.sentence-2' class='sentence'>Threads that arrive at the barrier during the phase
can block on the phase synchronization point by calling <span class='texttt'>wait</span>, and
will remain blocked until the phase completion step is run<a class='hidden_link' href='#barrier.class-2.sentence-2'>.</a></div></div></div><div class='para' id='barrier.class-3'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5586'>#</a></div><div class='texpara'><div id='barrier.class-3.sentence-1' class='sentence'>The <a class='hidden_link' href='#def:phase_completion_step' title='32.8.3.3&emsp;Class template barrier&emsp;[thread.barrier.class]'><span id='def:phase_completion_step'><i >phase completion step</i></span></a>
that is executed at the end of each phase has the following effects:
<ul class='itemize'><li id='barrier.class-3.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#barrier.class-3.1'>(3.1)</a></div><div class='texpara'><div id='barrier.class-3.1.sentence-1' class='sentence'>Invokes the completion function, equivalent to <span class='texttt'>completion<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#barrier.class-3.1.sentence-1'>.</a></div></div></li><li id='barrier.class-3.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#barrier.class-3.2'>(3.2)</a></div><div class='texpara'><div id='barrier.class-3.2.sentence-1' class='sentence'>Unblocks all threads that are blocked on the phase synchronization point<a class='hidden_link' href='#barrier.class-3.2.sentence-1'>.</a></div></div></li></ul></div> <div id='barrier.class-3.sentence-2' class='sentence'>
The end of the completion step strongly happens before
the returns from all calls that were unblocked by the completion step<a class='hidden_link' href='#barrier.class-3.sentence-2'>.</a></div> <div id='barrier.class-3.sentence-3' class='sentence'>For specializations that do not have
the default value of the <span class='texttt'>CompletionFunction</span> template parameter,
the behavior is undefined if any of the barrier object's member functions
other than <span class='texttt'>wait</span> are called while the completion step is in progress<a class='hidden_link' href='#barrier.class-3.sentence-3'>.</a></div></div></div><div class='para' id='barrier.class-4'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5600'>#</a></div><div class='texpara'><div id='barrier.class-4.sentence-1' class='sentence'>Concurrent invocations of the member functions of <span class='texttt'>barrier</span>,
other than its destructor, do not introduce data races<a class='hidden_link' href='#barrier.class-4.sentence-1'>.</a></div> <div id='barrier.class-4.sentence-2' class='sentence'>The member functions <span class='texttt'>arrive</span> and <span class='texttt'>arrive_&shy;and_&shy;drop</span>
execute atomically<a class='hidden_link' href='#barrier.class-4.sentence-2'>.</a></div></div></div><div class='para' id='barrier.class-5'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5606'>#</a></div><div class='texpara'><div id='barrier.class-5.sentence-1' class='sentence'><span class='texttt'>CompletionFunction</span> shall meet the
<i >Cpp17MoveConstructible</i> (Table <a href='utility.arg.requirements#tab:cpp17.moveconstructible' title='Table 30: Cpp17MoveConstructible requirements'>30</a>) and
<i >Cpp17Destructible</i> (Table <a href='utility.arg.requirements#tab:cpp17.destructible' title='Table 34: Cpp17Destructible requirements'>34</a>) requirements<a class='hidden_link' href='#barrier.class-5.sentence-1'>.</a></div> <div id='barrier.class-5.sentence-2' class='sentence'><span class='texttt'>is_&shy;nothrow_&shy;invocable_&shy;v<span class='anglebracket'>&lt;</span>CompletionFunction<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span></span> shall be <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#barrier.class-5.sentence-2'>.</a></div></div></div><div class='para' id='barrier.class-6'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5612'>#</a></div><div class='texpara'><div id='barrier.class-6.sentence-1' class='sentence'>The default value of the <span class='texttt'>CompletionFunction</span> template parameter is
an unspecified type, such that,
in addition to satisfying the requirements of <span class='texttt'>CompletionFunction</span>,
it meets the <i >Cpp17DefaultConstructible</i>
requirements (Table <a href='utility.arg.requirements#tab:cpp17.defaultconstructible' title='Table 29: Cpp17DefaultConstructible requirements'>29</a>) and
<span class='texttt'>completion<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> has no effects<a class='hidden_link' href='#barrier.class-6.sentence-1'>.</a></div></div></div><div class='para' id='barrier.class-7'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5620'>#</a></div><div class='texpara'><div id='barrier.class-7.sentence-1' class='sentence'><span class='texttt'>barrier<span class='operator'>&#x200b;::&#x200b;</span>arrival_&shy;token</span> is an unspecified type,
such that it meets the
<i >Cpp17MoveConstructible</i> (Table <a href='utility.arg.requirements#tab:cpp17.moveconstructible' title='Table 30: Cpp17MoveConstructible requirements'>30</a>),
<i >Cpp17MoveAssignable</i> (Table <a href='utility.arg.requirements#tab:cpp17.moveassignable' title='Table 32: Cpp17MoveAssignable requirements'>32</a>), and
<i >Cpp17Destructible</i> (Table <a href='utility.arg.requirements#tab:cpp17.destructible' title='Table 34: Cpp17Destructible requirements'>34</a>) requirements<a class='hidden_link' href='#barrier.class-7.sentence-1'>.</a></div></div></div><div class='texpara'><div id='lib:barrier,max'><div id='lib:max,barrier'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:max,barrier'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>static</span> <span class='keyword'>constexpr</span> ptrdiff_t max<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='barrier.class-8'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5633'>#</a></div><div class='texpara'><div id='barrier.class-8.sentence-1' class='sentence'><i >Returns</i>: The maximum expected count that the implementation supports<a class='hidden_link' href='#barrier.class-8.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:barrier,constructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:barrier,constructor'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>constexpr</span> <span class='keyword'>explicit</span> barrier<span class='parenthesis'>(</span>ptrdiff_t expected,
                           CompletionFunction f <span class='operator'>=</span> CompletionFunction<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='barrier.class-9'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5645'>#</a></div><div class='texpara'><div id='barrier.class-9.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'>expected <span class='anglebracket'>&gt;</span><span class='operator'>=</span> <span class='literal'>0</span></span> is <span class='texttt'><span class='literal'>true</span></span> and
<span class='texttt'>expected <span class='anglebracket'>&lt;</span><span class='operator'>=</span> max<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#barrier.class-9.sentence-1'>.</a></div></div></div></div><div class='para' id='barrier.class-10'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5650'>#</a></div><div class='texpara'><div id='barrier.class-10.sentence-1' class='sentence'><i >Effects</i>: Sets both the initial expected count for each barrier phase and
the current expected count for the first phase to <span class='texttt'>expected</span><a class='hidden_link' href='#barrier.class-10.sentence-1'>.</a></div> <div id='barrier.class-10.sentence-2' class='sentence'>Initializes <span class='texttt'>completion</span> with <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>move<span class='parenthesis'>(</span>f<span class='parenthesis'>)</span></span><a class='hidden_link' href='#barrier.class-10.sentence-2'>.</a></div> <div id='barrier.class-10.sentence-3' class='sentence'>Starts the first phase<a class='hidden_link' href='#barrier.class-10.sentence-3'>.</a></div> <div id='barrier.class-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#barrier.class-note-1'>1</a></i>: <div id='barrier.class-10.sentence-4' class='sentence'>If <span class='texttt'>expected</span> is 0 this object can only be destroyed<a class='hidden_link' href='#barrier.class-10.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='barrier.class-11'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5660'>#</a></div><div class='texpara'><div id='barrier.class-11.sentence-1' class='sentence'><i >Throws</i>: Any exception thrown by <span class='texttt'>CompletionFunction</span>'s move constructor<a class='hidden_link' href='#barrier.class-11.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:barrier,arrive'><div id='lib:arrive,barrier'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:arrive,barrier'>🔗</a></div><code class='itemdeclcode'><span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> arrival_token arrive<span class='parenthesis'>(</span>ptrdiff_t update <span class='operator'>=</span> <span class='literal'>1</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='barrier.class-12'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5671'>#</a></div><div class='texpara'><div id='barrier.class-12.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'>update <span class='anglebracket'>&gt;</span> <span class='literal'>0</span></span> is <span class='texttt'><span class='literal'>true</span></span>, and
<span class='texttt'>update</span> is less than or equal to
the expected count for the current barrier phase<a class='hidden_link' href='#barrier.class-12.sentence-1'>.</a></div></div></div></div><div class='para' id='barrier.class-13'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5677'>#</a></div><div class='texpara'><div id='barrier.class-13.sentence-1' class='sentence'><i >Effects</i>: Constructs an object of type <span class='texttt'>arrival_&shy;token</span>
that is associated with the phase synchronization point for the current phase<a class='hidden_link' href='#barrier.class-13.sentence-1'>.</a></div> <div id='barrier.class-13.sentence-2' class='sentence'>Then, decrements the expected count by <span class='texttt'>update</span><a class='hidden_link' href='#barrier.class-13.sentence-2'>.</a></div></div></div></div><div class='para' id='barrier.class-14'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5683'>#</a></div><div class='texpara'><div id='barrier.class-14.sentence-1' class='sentence'><i >Synchronization</i>: The call to <span class='texttt'>arrive</span> strongly happens before
the start of the phase completion step for the current phase<a class='hidden_link' href='#barrier.class-14.sentence-1'>.</a></div></div></div></div><div class='para' id='barrier.class-15'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5688'>#</a></div><div class='texpara'><div id='barrier.class-15.sentence-1' class='sentence'><i >Returns</i>: The constructed <span class='texttt'>arrival_&shy;token</span> object<a class='hidden_link' href='#barrier.class-15.sentence-1'>.</a></div></div></div></div><div class='para' id='barrier.class-16'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5692'>#</a></div><div class='texpara'><div id='barrier.class-16.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>system_&shy;error</span> when an exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#barrier.class-16.sentence-1'>.</a></div></div></div></div><div class='para' id='barrier.class-17'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5696'>#</a></div><div class='texpara'><div id='barrier.class-17.sentence-1' class='sentence'><i >Error conditions</i>: Any of the error conditions
allowed for mutex types (<a href='#mutex.requirements.mutex' title='32.5.4.2&emsp;Mutex types'>[thread.<span class='shy'></span>mutex.<span class='shy'></span>requirements.<span class='shy'></span>mutex]</a>)<a class='hidden_link' href='#barrier.class-17.sentence-1'>.</a></div></div></div></div><div class='para nonNormativeOnly' id='barrier.class-18'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5701'>#</a></div><div class='texpara'><div id='barrier.class-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#barrier.class-note-2'>2</a></i>: <div id='barrier.class-18.sentence-1' class='sentence'>This call can cause the completion step for the current phase to start<a class='hidden_link' href='#barrier.class-18.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='texpara'><div id='lib:barrier,wait'><div id='lib:wait,barrier'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:wait,barrier'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> wait<span class='parenthesis'>(</span>arrival_token<span class='operator'>&amp;</span><span class='operator'>&amp;</span> arrival<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div></div></div><div class='para' id='barrier.class-19'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5713'>#</a></div><div class='texpara'><div id='barrier.class-19.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'>arrival</span> is associated with
the phase synchronization point for the current phase or
the immediately preceding phase of the same barrier object<a class='hidden_link' href='#barrier.class-19.sentence-1'>.</a></div></div></div></div><div class='para' id='barrier.class-20'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5719'>#</a></div><div class='texpara'><div id='barrier.class-20.sentence-1' class='sentence'><a class='index' id=':block_(execution)____________________'></a><i >Effects</i>: Blocks at the synchronization point associated with <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>move<span class='parenthesis'>(</span>arrival<span class='parenthesis'>)</span></span>
until the phase completion step of the synchronization point's phase is run<a class='hidden_link' href='#barrier.class-20.sentence-1'>.</a></div> <div id='barrier.class-note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#barrier.class-note-3'>3</a></i>: <div id='barrier.class-20.sentence-2' class='sentence'>If <span class='texttt'>arrival</span> is associated with the synchronization point
for a previous phase, the call returns immediately<a class='hidden_link' href='#barrier.class-20.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='barrier.class-21'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5729'>#</a></div><div class='texpara'><div id='barrier.class-21.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>system_&shy;error</span> when an exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#barrier.class-21.sentence-1'>.</a></div></div></div></div><div class='para' id='barrier.class-22'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5733'>#</a></div><div class='texpara'><div id='barrier.class-22.sentence-1' class='sentence'><i >Error conditions</i>: Any of the error conditions
allowed for mutex types (<a href='#mutex.requirements.mutex' title='32.5.4.2&emsp;Mutex types'>[thread.<span class='shy'></span>mutex.<span class='shy'></span>requirements.<span class='shy'></span>mutex]</a>)<a class='hidden_link' href='#barrier.class-22.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:barrier,arrive_and_wait'><div id='lib:arrive_and_wait,barrier'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:arrive_and_wait,barrier'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> arrive_and_wait<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='barrier.class-23'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5745'>#</a></div><div class='texpara'><div id='barrier.class-23.sentence-1' class='sentence'><i >Effects</i>: Equivalent to: <span class='texttt'>wait<span class='parenthesis'>(</span>arrive<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#barrier.class-23.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:barrier,arrive_and_drop'><div id='lib:arrive_and_drop,barrier'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:arrive_and_drop,barrier'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> arrive_and_drop<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='barrier.class-24'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-24'>24</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5756'>#</a></div><div class='texpara'><div id='barrier.class-24.sentence-1' class='sentence'><i >Preconditions</i>: The expected count for the current barrier phase is greater than zero<a class='hidden_link' href='#barrier.class-24.sentence-1'>.</a></div></div></div></div><div class='para' id='barrier.class-25'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-25'>25</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5760'>#</a></div><div class='texpara'><div id='barrier.class-25.sentence-1' class='sentence'><i >Effects</i>: Decrements the initial expected count for all subsequent phases by one<a class='hidden_link' href='#barrier.class-25.sentence-1'>.</a></div> <div id='barrier.class-25.sentence-2' class='sentence'>Then decrements the expected count for the current phase by one<a class='hidden_link' href='#barrier.class-25.sentence-2'>.</a></div></div></div></div><div class='para' id='barrier.class-26'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-26'>26</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5765'>#</a></div><div class='texpara'><div id='barrier.class-26.sentence-1' class='sentence'><i >Synchronization</i>: The call to <span class='texttt'>arrive_&shy;and_&shy;drop</span> strongly happens before
the start of the phase completion step for the current phase<a class='hidden_link' href='#barrier.class-26.sentence-1'>.</a></div></div></div></div><div class='para' id='barrier.class-27'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-27'>27</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5770'>#</a></div><div class='texpara'><div id='barrier.class-27.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>system_&shy;error</span> when an exception is required (<a href='#req.exception' title='32.2.2&emsp;Exceptions'>[thread.<span class='shy'></span>req.<span class='shy'></span>exception]</a>)<a class='hidden_link' href='#barrier.class-27.sentence-1'>.</a></div></div></div></div><div class='para' id='barrier.class-28'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-28'>28</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5774'>#</a></div><div class='texpara'><div id='barrier.class-28.sentence-1' class='sentence'><i >Error conditions</i>: Any of the error conditions
allowed for mutex types (<a href='#mutex.requirements.mutex' title='32.5.4.2&emsp;Mutex types'>[thread.<span class='shy'></span>mutex.<span class='shy'></span>requirements.<span class='shy'></span>mutex]</a>)<a class='hidden_link' href='#barrier.class-28.sentence-1'>.</a></div></div></div></div><div class='para nonNormativeOnly' id='barrier.class-29'><div class='marginalizedparent'><a class='marginalized' href='#barrier.class-29'>29</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5779'>#</a></div><div class='texpara'><div id='barrier.class-note-4' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#barrier.class-note-4'>4</a></i>: <div id='barrier.class-29.sentence-1' class='sentence'>This call can cause the completion step for the current phase to start<a class='hidden_link' href='#barrier.class-29.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div></div></div></div><div id='futures' class='section'><h2 ><a class='secnum' href='#futures' style='min-width:65pt'>32.9</a> Futures <a class='abbr_ref' href='futures'>[futures]</a></h2><div id='futures.overview' class='section'><h3 ><a class='secnum' href='#futures.overview' style='min-width:80pt'>32.9.1</a> Overview <a class='abbr_ref' href='futures.overview'>[futures.overview]</a></h3><div class='para' id='futures.overview-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.overview-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5789'>#</a></div><div class='texpara'><div id='futures.overview-1.sentence-1' class='sentence'><a href='#futures' title='32.9&emsp;Futures'>[futures]</a> describes components that a C++ program can use to retrieve in one thread the
result (value or exception) from a function that has run in the same thread or another thread<a class='hidden_link' href='#futures.overview-1.sentence-1'>.</a></div> <div id='futures.overview-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#futures.overview-note-1'>1</a></i>: <div id='futures.overview-1.sentence-2' class='sentence'>These components are not restricted to multi-threaded programs but can be useful in
single-threaded programs as well<a class='hidden_link' href='#futures.overview-1.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div id='future.syn' class='section'><h3 ><a class='secnum' href='#future.syn' style='min-width:80pt'>32.9.2</a> Header <span class='texttt'>&lt;future&gt;</span> synopsis <a class='abbr_ref' href='future.syn'>[future.syn]</a></h3><div class='texpara'><span id='lib:future_errc'><span id='header:<future>'><div class='marginalizedparent'><a class='itemDeclLink' href='#header:%3cfuture%3e'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>enum</span> <span class='keyword'>class</span> future_errc <span class='curlybracket'>{</span>
    broken_promise <span class='operator'>=</span> <a class='index' id=':value_of_future_errc::broken_promise'></a><i >implementation-defined</i>,
    future_already_retrieved <span class='operator'>=</span> <a class='index' id=':value_of_future_errc::future_already_retrieved'></a><i >implementation-defined</i>,
    promise_already_satisfied <span class='operator'>=</span> <a class='index' id=':value_of_future_errc::promise_already_satisfied'></a><i >implementation-defined</i>,
    no_state <span class='operator'>=</span> <a class='index' id=':value_of_future_errc::no_state'></a><i >implementation-defined</i>
  <span class='curlybracket'>}</span>;

  <span class='keyword'>enum</span> <span class='keyword'>class</span> launch <span class='operator'>:</span> <i ><span class='texttt'>unspecified</span></i> <span class='curlybracket'>{</span>
    async <span class='operator'>=</span> <i ><span class='texttt'>unspecified</span></i>,
    deferred <span class='operator'>=</span> <i ><span class='texttt'>unspecified</span></i>,
    <a class='index' id=':last_enumerator_of_launch'></a><i >implementation-defined</i>
  <span class='curlybracket'>}</span>;

  <span class='keyword'>enum</span> <span class='keyword'>class</span> future_status <span class='curlybracket'>{</span>
    ready,
    timeout,
    deferred
  <span class='curlybracket'>}</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span> <span class='keyword'>struct</span> is_error_code_enum<span class='anglebracket'>&lt;</span>future_errc<span class='anglebracket'>&gt;</span> <span class='operator'>:</span> <span class='keyword'>public</span> true_type <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
  error_code make_error_code<span class='parenthesis'>(</span>future_errc e<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
  error_condition make_error_condition<span class='parenthesis'>(</span>future_errc e<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

  <span class='keyword'>const</span> error_category<span class='operator'>&amp;</span> future_category<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

  <span class='keyword'>class</span> future_error;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> R<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> promise;
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> R<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> promise<span class='anglebracket'>&lt;</span>R<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span>;
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> promise<span class='anglebracket'>&lt;</span><span class='keyword'>void</span><span class='anglebracket'>&gt;</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> R<span class='anglebracket'>&gt;</span>
    <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>promise<span class='anglebracket'>&lt;</span>R<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> x, promise<span class='anglebracket'>&lt;</span>R<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> y<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> R, <span class='keyword'>class</span> Alloc<span class='anglebracket'>&gt;</span>
    <span class='keyword'>struct</span> uses_allocator<span class='anglebracket'>&lt;</span>promise<span class='anglebracket'>&lt;</span>R<span class='anglebracket'>&gt;</span>, Alloc<span class='anglebracket'>&gt;</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> R<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> future;
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> R<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> future<span class='anglebracket'>&lt;</span>R<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span>;
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> future<span class='anglebracket'>&lt;</span><span class='keyword'>void</span><span class='anglebracket'>&gt;</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> R<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> shared_future;
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> R<span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> shared_future<span class='anglebracket'>&lt;</span>R<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span>;
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> shared_future<span class='anglebracket'>&lt;</span><span class='keyword'>void</span><span class='anglebracket'>&gt;</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span><span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> packaged_task;  <span class='comment'>// <i >not defined</i></span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> R, <span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> ArgTypes<span class='anglebracket'>&gt;</span>
    <span class='keyword'>class</span> packaged_task<span class='anglebracket'>&lt;</span>R<span class='parenthesis'>(</span>ArgTypes<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> R, <span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> ArgTypes<span class='anglebracket'>&gt;</span>
    <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>packaged_task<span class='anglebracket'>&lt;</span>R<span class='parenthesis'>(</span>ArgTypes<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span>, packaged_task<span class='anglebracket'>&lt;</span>R<span class='parenthesis'>(</span>ArgTypes<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> F, <span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> Args<span class='anglebracket'>&gt;</span>
    <span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> future<span class='anglebracket'>&lt;</span>invoke_result_t<span class='anglebracket'>&lt;</span>decay_t<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span>, decay_t<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span>
      async<span class='parenthesis'>(</span>F<span class='operator'>&amp;</span><span class='operator'>&amp;</span> f, Args<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> args<span class='parenthesis'>)</span>;
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> F, <span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> Args<span class='anglebracket'>&gt;</span>
    <span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> future<span class='anglebracket'>&lt;</span>invoke_result_t<span class='anglebracket'>&lt;</span>decay_t<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span>, decay_t<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span>
      async<span class='parenthesis'>(</span>launch policy, F<span class='operator'>&amp;</span><span class='operator'>&amp;</span> f, Args<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> args<span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
</span></span></span></div><div class='para' id='future.syn-1'><div class='marginalizedparent'><a class='marginalized' href='#future.syn-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5864'>#</a></div><div class='texpara'><div id='future.syn-1.sentence-1' class='sentence'>The <span class='texttt'><span class='keyword'>enum</span></span> type <span class='texttt'>launch</span> is a <a href='bitmask.types' title='16.3.3.3.4&emsp;Bitmask types&emsp;[bitmask.types]'>bitmask type</a> with
elements <span class='texttt'>launch<span class='operator'>&#x200b;::&#x200b;</span>async</span> and <span class='texttt'>launch<span class='operator'>&#x200b;::&#x200b;</span>deferred</span><a class='hidden_link' href='#future.syn-1.sentence-1'>.</a></div> <div id='future.syn-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#future.syn-note-1'>1</a></i>: <div id='future.syn-1.sentence-2' class='sentence'>Implementations can provide bitmasks to specify restrictions on task
interaction by functions launched by <span class='texttt'>async<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> applicable to a
corresponding subset of available launch policies<a class='hidden_link' href='#future.syn-1.sentence-2'>.</a></div> <div id='future.syn-1.sentence-3' class='sentence'>Implementations can extend
the behavior of the first overload of <span class='texttt'>async<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> by adding their extensions
to the launch policy under the “as if” rule<a class='hidden_link' href='#future.syn-1.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='future.syn-2'><div class='marginalizedparent'><a class='marginalized' href='#future.syn-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5875'>#</a></div><div class='texpara'><div id='future.syn-2.sentence-1' class='sentence'>The enum values of <span class='texttt'>future_&shy;errc</span> are distinct and not zero<a class='hidden_link' href='#future.syn-2.sentence-1'>.</a></div></div></div></div><div id='futures.errors' class='section'><h3 ><a class='secnum' href='#futures.errors' style='min-width:80pt'>32.9.3</a> Error handling <a class='abbr_ref' href='futures.errors'>[futures.errors]</a></h3><div class='texpara'><div id='lib:future_category'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:future_category'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>const</span> error_category<span class='operator'>&amp;</span> future_category<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='futures.errors-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.errors-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5886'>#</a></div><div class='texpara'><div id='futures.errors-1.sentence-1' class='sentence'><i >Returns</i>: A reference to an object of a type derived from class <span class='texttt'>error_&shy;category</span><a class='hidden_link' href='#futures.errors-1.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.errors-2'><div class='marginalizedparent'><a class='marginalized' href='#futures.errors-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5890'>#</a></div><div class='texpara'><div id='futures.errors-2.sentence-1' class='sentence'>The object's <span class='texttt'>default_&shy;error_&shy;condition</span> and equivalent virtual functions shall
behave as specified for the class <span class='texttt'>error_&shy;category</span><a class='hidden_link' href='#futures.errors-2.sentence-1'>.</a></div> <div id='futures.errors-2.sentence-2' class='sentence'>The object's <span class='texttt'>name</span>
virtual function returns a pointer to the string <span class='texttt'><span class='literal'>"future"</span></span><a class='hidden_link' href='#futures.errors-2.sentence-2'>.</a></div></div></div></div><div class='texpara'><div id='lib:future_errc,make_error_code'><div id='lib:make_error_code,future_errc'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:make_error_code,future_errc'>🔗</a></div><code class='itemdeclcode'>error_code make_error_code<span class='parenthesis'>(</span>future_errc e<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='futures.errors-3'><div class='marginalizedparent'><a class='marginalized' href='#futures.errors-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5902'>#</a></div><div class='texpara'><div id='futures.errors-3.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>error_&shy;code<span class='parenthesis'>(</span><span class='keyword'>static_&shy;cast</span><span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>e<span class='parenthesis'>)</span>, future_&shy;category<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#futures.errors-3.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:future_errc,make_error_condition'><div id='lib:make_error_condition,future_errc'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:make_error_condition,future_errc'>🔗</a></div><code class='itemdeclcode'>error_condition make_error_condition<span class='parenthesis'>(</span>future_errc e<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='futures.errors-4'><div class='marginalizedparent'><a class='marginalized' href='#futures.errors-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5913'>#</a></div><div class='texpara'><div id='futures.errors-4.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>error_&shy;condition<span class='parenthesis'>(</span><span class='keyword'>static_&shy;cast</span><span class='anglebracket'>&lt;</span><span class='keyword'>int</span><span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>e<span class='parenthesis'>)</span>, future_&shy;category<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#futures.errors-4.sentence-1'>.</a></div></div></div></div></div><div id='futures.future.error' class='section'><h3 ><a class='secnum' href='#futures.future.error' style='min-width:80pt'>32.9.4</a> Class <span class='texttt'>future_&shy;error</span> <a class='abbr_ref' href='futures.future.error'>[futures.future.error]</a></h3><div class='texpara'><span id='lib:future_error'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:future_error'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>class</span> future_error <span class='operator'>:</span> <span class='keyword'>public</span> logic_error <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    <span class='keyword'>explicit</span> future_error<span class='parenthesis'>(</span>future_errc e<span class='parenthesis'>)</span>;

    <span class='keyword'>const</span> error_code<span class='operator'>&amp;</span> code<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>const</span> <span class='keyword'>char</span><span class='operator'>*</span>       what<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;

  <span class='keyword'>private</span><span class='operator'>:</span>
    error_code ec_;             <span class='comment'>// <i >exposition only</i></span>
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></div><div class='texpara'><div id='lib:future_error,constructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:future_error,constructor'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>explicit</span> future_error<span class='parenthesis'>(</span>future_errc e<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='futures.future.error-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.future.error-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5942'>#</a></div><div class='texpara'><div id='futures.future.error-1.sentence-1' class='sentence'><i >Effects</i>: Initializes <span class='texttt'>ec_&shy;</span> with <span class='texttt'>make_&shy;error_&shy;code<span class='parenthesis'>(</span>e<span class='parenthesis'>)</span></span><a class='hidden_link' href='#futures.future.error-1.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:future_error,code'><div id='lib:code,future_error'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:code,future_error'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>const</span> error_code<span class='operator'>&amp;</span> code<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='futures.future.error-2'><div class='marginalizedparent'><a class='marginalized' href='#futures.future.error-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5953'>#</a></div><div class='texpara'><div id='futures.future.error-2.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>ec_&shy;</span><a class='hidden_link' href='#futures.future.error-2.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:future_error,what'><div id='lib:what,future_error'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:what,future_error'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>const</span> <span class='keyword'>char</span><span class='operator'>*</span> what<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='futures.future.error-3'><div class='marginalizedparent'><a class='marginalized' href='#futures.future.error-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5964'>#</a></div><div class='texpara'><div id='futures.future.error-3.sentence-1' class='sentence'><i >Returns</i>: An <span class='textsc'>ntbs</span> incorporating <span class='texttt'>code<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='operator'>.</span>message<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#futures.future.error-3.sentence-1'>.</a></div></div></div></div></div><div id='futures.state' class='section'><h3 ><a class='secnum' href='#futures.state' style='min-width:80pt'>32.9.5</a> Shared state <a class='abbr_ref' href='futures.state'>[futures.state]</a></h3><div class='para' id='futures.state-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5971'>#</a></div><div class='texpara'><div id='futures.state-1.sentence-1' class='sentence'>Many of the classes introduced in subclause <a href='#futures' title='32.9&emsp;Futures'>[futures]</a> use some state to communicate results<a class='hidden_link' href='#futures.state-1.sentence-1'>.</a></div> <div id='futures.state-1.sentence-2' class='sentence'>This

<a class='hidden_link' href='#def:future,shared_state' title='32.9.5&emsp;Shared state&emsp;[futures.state]'><span id='def:future,shared_state'><i >shared state</i></span></a> consists of some state information and some (possibly not
yet evaluated) <a class='hidden_link' href='#def:result' id='def:result'><i>result</i></a>, which can be a (possibly void) value or an exception<a class='hidden_link' href='#futures.state-1.sentence-2'>.</a></div> <div id='futures.state-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#futures.state-note-1'>1</a></i>: <div id='futures.state-1.sentence-3' class='sentence'>Futures, promises, and tasks defined in this Clause reference such shared state<a class='hidden_link' href='#futures.state-1.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para nonNormativeOnly' id='futures.state-2'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5980'>#</a></div><div class='texpara'><div id='futures.state-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#futures.state-note-2'>2</a></i>: <div id='futures.state-2.sentence-1' class='sentence'>The result can be any kind of object including a function to compute that result,
as used by <span class='texttt'>async</span> when <span class='texttt'>policy</span> is <span class='texttt'>launch<span class='operator'>&#x200b;::&#x200b;</span>deferred</span><a class='hidden_link' href='#futures.state-2.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='futures.state-3'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5986'>#</a></div><div class='texpara'><div id='futures.state-3.sentence-1' class='sentence'>An <a class='hidden_link' href='#def:asynchronous_return_object' title='32.9.5&emsp;Shared state&emsp;[futures.state]'><span id='def:asynchronous_return_object'><i >asynchronous return object</i></span></a> is an object that reads results from a
shared state<a class='hidden_link' href='#futures.state-3.sentence-1'>.</a></div> <div id='futures.state-3.sentence-2' class='sentence'>A <a class='hidden_link' href='#def:function,waiting' title='32.9.5&emsp;Shared state&emsp;[futures.state]'><span id='def:function,waiting'><i >waiting function</i></span></a> of an asynchronous return object is one
that potentially blocks to wait for the shared state to be made
ready<a class='hidden_link' href='#futures.state-3.sentence-2'>.</a></div> <div id='futures.state-3.sentence-3' class='sentence'>If a waiting function can return before the state is made ready because of a
timeout (<a href='#req.lockable' title='32.2.5&emsp;Requirements for Cpp17Lockable types'>[thread.<span class='shy'></span>req.<span class='shy'></span>lockable]</a>), then it is a <a class='hidden_link' href='#def:timed_waiting_function' id='def:timed_waiting_function'><i>timed waiting function</i></a>, otherwise
it is a <a class='hidden_link' href='#def:non-timed_waiting_function' id='def:non-timed_waiting_function'><i>non-timed waiting function</i></a><a class='hidden_link' href='#futures.state-3.sentence-3'>.</a></div></div></div><div class='para' id='futures.state-4'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L5995'>#</a></div><div class='texpara'><div id='futures.state-4.sentence-1' class='sentence'>An <a class='hidden_link' href='#def:asynchronous_provider' title='32.9.5&emsp;Shared state&emsp;[futures.state]'><span id='def:asynchronous_provider'><i >asynchronous provider</i></span></a> is an object that provides a result to a shared
state<a class='hidden_link' href='#futures.state-4.sentence-1'>.</a></div> <div id='futures.state-4.sentence-2' class='sentence'>The result of a shared state is set by
respective functions on the asynchronous provider<a class='hidden_link' href='#futures.state-4.sentence-2'>.</a></div> <div id='futures.state-note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#futures.state-note-3'>3</a></i>: <div id='futures.state-4.sentence-3' class='sentence'>Such as promises or tasks<a class='hidden_link' href='#futures.state-4.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div> <div id='futures.state-4.sentence-4' class='sentence'>
The means of setting the result of a shared state is specified
in the description of those classes and functions that create such a state object<a class='hidden_link' href='#futures.state-4.sentence-4'>.</a></div></div></div><div class='para' id='futures.state-5'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6006'>#</a></div><div class='texpara'><div id='futures.state-5.sentence-1' class='sentence'>When an asynchronous return object or an asynchronous provider is said to release its
shared state, it means:
<ul class='itemize'><li id='futures.state-5.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#futures.state-5.1'>(5.1)</a></div>if the return object or provider holds the last reference to its shared state,
the shared state is destroyed; and</li><li id='futures.state-5.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#futures.state-5.2'>(5.2)</a></div>the return object or provider gives up its reference to its shared state; and</li><li id='futures.state-5.3'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#futures.state-5.3'>(5.3)</a></div>these actions will not block for the shared state to become ready, except that it
may block if all of the following are true: the shared state was created by a call to
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>async</span>, the shared state is not yet ready, and this was the last reference
to the shared state<a class='hidden_link' href='#futures.state-5.sentence-1'>.</a></li></ul></div></div></div><div class='para' id='futures.state-6'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-6'>6</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6023'>#</a></div><div class='texpara'><div id='futures.state-6.sentence-1' class='sentence'>When an asynchronous provider is said to make its shared state ready, it means:
<ul class='itemize'><li id='futures.state-6.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#futures.state-6.1'>(6.1)</a></div>first, the provider marks its shared state as ready; and</li><li id='futures.state-6.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#futures.state-6.2'>(6.2)</a></div>second, the provider unblocks any execution agents waiting for its shared
state to become ready<a class='hidden_link' href='#futures.state-6.sentence-1'>.</a></li></ul></div></div></div><div class='para' id='futures.state-7'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-7'>7</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6033'>#</a></div><div class='texpara'><div id='futures.state-7.sentence-1' class='sentence'>When an asynchronous provider is said to abandon its shared state, it means:
<ul class='itemize'><li id='futures.state-7.1'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#futures.state-7.1'>(7.1)</a></div>first, if that state is not ready, the provider
<ul class='itemize'><li id='futures.state-7.1.1'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#futures.state-7.1.1'>(7.1.1)</a></div>stores an exception object of type <span class='texttt'>future_&shy;error</span> with an error condition of
<span class='texttt'>broken_&shy;promise</span> within its shared state; and then</li><li id='futures.state-7.1.2'><div class='marginalizedparent' style='left:-36mm'><a class='marginalized' href='#futures.state-7.1.2'>(7.1.2)</a></div>makes its shared state ready;</li></ul></li><li id='futures.state-7.2'><div class='marginalizedparent' style='left:-27mm'><a class='marginalized' href='#futures.state-7.2'>(7.2)</a></div>second, the provider releases its shared state<a class='hidden_link' href='#futures.state-7.sentence-1'>.</a></li></ul></div></div></div><div class='para' id='futures.state-8'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6049'>#</a></div><div class='texpara'><div id='futures.state-8.sentence-1' class='sentence'>A shared state is <a class='hidden_link' href='#def:ready' title='32.9.5&emsp;Shared state&emsp;[futures.state]'><span id='def:ready'><i >ready</i></span></a> only if it holds a value or an exception ready for
retrieval<a class='hidden_link' href='#futures.state-8.sentence-1'>.</a></div> <div id='futures.state-8.sentence-2' class='sentence'>Waiting for a shared state to become ready may invoke code to compute the result on
the waiting thread if so specified in the description of the class or function that creates
the state object<a class='hidden_link' href='#futures.state-8.sentence-2'>.</a></div></div></div><div class='para' id='futures.state-9'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-9'>9</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6056'>#</a></div><div class='texpara'><div id='futures.state-9.sentence-1' class='sentence'>Calls to functions that successfully set the stored result of a shared
state <a href='intro.multithread#def:synchronize_with' title='6.9.2&emsp;Multi-threaded executions and data races&emsp;[intro.multithread]'>synchronize with</a> calls to functions
successfully detecting the ready state resulting from that setting<a class='hidden_link' href='#futures.state-9.sentence-1'>.</a></div> <div id='futures.state-9.sentence-2' class='sentence'>The storage of the result
(whether normal or exceptional) into the shared state
<a href='intro.multithread#def:synchronize_with' title='6.9.2&emsp;Multi-threaded executions and data races&emsp;[intro.multithread]'>synchronizes with</a>
the successful return from a call to a waiting function on the shared state<a class='hidden_link' href='#futures.state-9.sentence-2'>.</a></div></div></div><div class='para' id='futures.state-10'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-10'>10</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6065'>#</a></div><div class='texpara'><div id='futures.state-10.sentence-1' class='sentence'>Some functions (e.g., <span class='texttt'>promise<span class='operator'>&#x200b;::&#x200b;</span>set_&shy;value_&shy;at_&shy;thread_&shy;exit</span>) delay making
the shared state ready until the calling thread exits<a class='hidden_link' href='#futures.state-10.sentence-1'>.</a></div> <div id='futures.state-10.sentence-2' class='sentence'>The destruction of
each of that thread's objects with <a href='basic.stc.thread' title='6.7.5.3&emsp;Thread storage duration&emsp;[basic.stc.thread]'>thread storage duration</a>
is sequenced before making that shared state ready<a class='hidden_link' href='#futures.state-10.sentence-2'>.</a></div></div></div><div class='para' id='futures.state-11'><div class='marginalizedparent'><a class='marginalized' href='#futures.state-11'>11</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6071'>#</a></div><div class='texpara'><div id='futures.state-11.sentence-1' class='sentence'>Access to the result of the same shared state may <a href='intro.multithread#def:conflict' title='6.9.2&emsp;Multi-threaded executions and data races&emsp;[intro.multithread]'>conflict</a><a class='hidden_link' href='#futures.state-11.sentence-1'>.</a></div> <div id='futures.state-note-4' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#futures.state-note-4'>4</a></i>: <div id='futures.state-11.sentence-2' class='sentence'>This explicitly specifies that the result of the shared state is
visible in the objects that reference this state in the sense of data race
avoidance (<a href='res.on.data.races' title='16.4.6.10&emsp;Data race avoidance'>[res.<span class='shy'></span>on.<span class='shy'></span>data.<span class='shy'></span>races]</a>)<a class='hidden_link' href='#futures.state-11.sentence-2'>.</a></div> <div id='futures.state-11.sentence-3' class='sentence'>For example, concurrent accesses through
references returned by <span class='texttt'>shared_&shy;future<span class='operator'>&#x200b;::&#x200b;</span>get<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> (<a href='#futures.shared.future' title='32.9.8&emsp;Class template shared_&shy;future'>[futures.<span class='shy'></span>shared.<span class='shy'></span>future]</a>)
must either use read-only operations or provide additional synchronization<a class='hidden_link' href='#futures.state-11.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div id='futures.promise' class='section'><h3 ><a class='secnum' href='#futures.promise' style='min-width:80pt'>32.9.6</a> Class template <span class='texttt'>promise</span> <a class='abbr_ref' href='futures.promise'>[futures.promise]</a></h3><div class='texpara'><span id='lib:promise'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:promise'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> R<span class='anglebracket'>&gt;</span>
  <span class='keyword'>class</span> promise <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    promise<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Allocator<span class='anglebracket'>&gt;</span>
      promise<span class='parenthesis'>(</span>allocator_arg_t, <span class='keyword'>const</span> Allocator<span class='operator'>&amp;</span> a<span class='parenthesis'>)</span>;
    promise<span class='parenthesis'>(</span>promise<span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    promise<span class='parenthesis'>(</span><span class='keyword'>const</span> promise<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    <span class='operator'>~</span>promise<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    <span class='comment'>// assignment</span>
    promise<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>promise<span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    promise<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> promise<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>promise<span class='operator'>&amp;</span> other<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    <span class='comment'>// retrieving the result</span>
    future<span class='anglebracket'>&lt;</span>R<span class='anglebracket'>&gt;</span> get_future<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    <span class='comment'>// setting the result</span>
    <span class='keyword'>void</span> set_value<span class='parenthesis'>(</span><i ><span class='texttt'>see below</span></i><span class='parenthesis'>)</span>;
    <span class='keyword'>void</span> set_exception<span class='parenthesis'>(</span>exception_ptr p<span class='parenthesis'>)</span>;

    <span class='comment'>// setting the result with deferred notification</span>
    <span class='keyword'>void</span> set_value_at_thread_exit<span class='parenthesis'>(</span><i ><span class='texttt'>see below</span></i><span class='parenthesis'>)</span>;
    <span class='keyword'>void</span> set_exception_at_thread_exit<span class='parenthesis'>(</span>exception_ptr p<span class='parenthesis'>)</span>;
  <span class='curlybracket'>}</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> R, <span class='keyword'>class</span> Alloc<span class='anglebracket'>&gt;</span>
    <span class='keyword'>struct</span> uses_allocator<span class='anglebracket'>&lt;</span>promise<span class='anglebracket'>&lt;</span>R<span class='anglebracket'>&gt;</span>, Alloc<span class='anglebracket'>&gt;</span>;
<span class='curlybracket'>}</span>
</span></span></div><div class='para' id='futures.promise-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6118'>#</a></div><div class='texpara'><div id='futures.promise-1.sentence-1' class='sentence'>For the primary template, <span class='texttt'>R</span> shall be an object type that
meets the <i >Cpp17Destructible</i> requirements<a class='hidden_link' href='#futures.promise-1.sentence-1'>.</a></div></div></div><div class='para' id='futures.promise-2'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6122'>#</a></div><div class='texpara'><div id='futures.promise-2.sentence-1' class='sentence'>The implementation provides the template <span class='texttt'>promise</span> and two specializations,
<span class='texttt'>promise<span class='anglebracket'>&lt;</span>R<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span></span> and <span class='texttt'>promise<span class='anglebracket'>&lt;</span>&#x200b;<span class='keyword'>void</span><span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#futures.promise-2.sentence-1'>.</a></div> <div id='futures.promise-2.sentence-2' class='sentence'>These differ only in the argument type
of the member functions <span class='texttt'>set_&shy;value</span> and <span class='texttt'>set_&shy;value_&shy;at_&shy;thread_&shy;exit</span>,
as set out in their descriptions, below<a class='hidden_link' href='#futures.promise-2.sentence-2'>.</a></div></div></div><div class='para' id='futures.promise-3'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6128'>#</a></div><div class='texpara'><div id='futures.promise-3.sentence-1' class='sentence'>The <span class='texttt'>set_&shy;value</span>, <span class='texttt'>set_&shy;exception</span>, <span class='texttt'>set_&shy;value_&shy;at_&shy;thread_&shy;exit</span>,
and <span class='texttt'>set_&shy;exception_&shy;at_&shy;thread_&shy;exit</span> member functions behave as though
they acquire a single mutex associated with the promise object while updating the
promise object<a class='hidden_link' href='#futures.promise-3.sentence-1'>.</a></div></div></div><div class='texpara'><div id='lib:promise,uses_allocator'><div id='lib:uses_allocator,promise'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:uses_allocator,promise'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> R, <span class='keyword'>class</span> Alloc<span class='anglebracket'>&gt;</span>
  <span class='keyword'>struct</span> uses_allocator<span class='anglebracket'>&lt;</span>promise<span class='anglebracket'>&lt;</span>R<span class='anglebracket'>&gt;</span>, Alloc<span class='anglebracket'>&gt;</span>
    <span class='operator'>:</span> true_type <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
</code></div></div></div></div><div class='para' id='futures.promise-4'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6142'>#</a></div><div class='texpara'><div id='futures.promise-4.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'>Alloc</span> meets the <i >Cpp17Allocator</i>
requirements (Table <a href='allocator.requirements.general#tab:cpp17.allocator' title='Table 38: Cpp17Allocator requirements'>38</a>)<a class='hidden_link' href='#futures.promise-4.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:promise,constructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:promise,constructor'>🔗</a></div><code class='itemdeclcode'>promise<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Allocator<span class='anglebracket'>&gt;</span>
  promise<span class='parenthesis'>(</span>allocator_arg_t, <span class='keyword'>const</span> Allocator<span class='operator'>&amp;</span> a<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='futures.promise-5'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6156'>#</a></div><div class='texpara'><div id='futures.promise-5.sentence-1' class='sentence'><i >Effects</i>: Creates a shared state<a class='hidden_link' href='#futures.promise-5.sentence-1'>.</a></div> <div id='futures.promise-5.sentence-2' class='sentence'>The second
constructor uses the allocator <span class='texttt'>a</span> to allocate memory for the shared
state<a class='hidden_link' href='#futures.promise-5.sentence-2'>.</a></div></div></div></div><div class='texpara'><div id='lib:promise,constructor_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:promise,constructor_'>🔗</a></div><code class='itemdeclcode'>promise<span class='parenthesis'>(</span>promise<span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='futures.promise-6'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6169'>#</a></div><div class='texpara'><div id='futures.promise-6.sentence-1' class='sentence'><i >Effects</i>: Transfers ownership of the shared state
of <span class='texttt'>rhs</span> (if any) to the newly-constructed object<a class='hidden_link' href='#futures.promise-6.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.promise-7'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6174'>#</a></div><div class='texpara'><div id='futures.promise-7.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>rhs</span> has no shared state<a class='hidden_link' href='#futures.promise-7.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:promise,destructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:promise,destructor'>🔗</a></div><code class='itemdeclcode'><span class='operator'>~</span>promise<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='futures.promise-8'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6185'>#</a></div><div class='texpara'><div id='futures.promise-8.sentence-1' class='sentence'><i >Effects</i>: Abandons any shared state (<a href='#futures.state' title='32.9.5&emsp;Shared state'>[futures.<span class='shy'></span>state]</a>)<a class='hidden_link' href='#futures.promise-8.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:promise,operator='><div id='lib:operator=,promise'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:operator=,promise'>🔗</a></div><code class='itemdeclcode'>promise<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>promise<span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='futures.promise-9'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6196'>#</a></div><div class='texpara'><div id='futures.promise-9.sentence-1' class='sentence'><i >Effects</i>: Abandons any shared state (<a href='#futures.state' title='32.9.5&emsp;Shared state'>[futures.<span class='shy'></span>state]</a>) and then as if
<span class='texttt'>promise<span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>move<span class='parenthesis'>(</span>rhs<span class='parenthesis'>)</span><span class='parenthesis'>)</span><span class='operator'>.</span>swap<span class='parenthesis'>(</span><span class='operator'>*</span><span class='keyword'>this</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#futures.promise-9.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.promise-10'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6201'>#</a></div><div class='texpara'><div id='futures.promise-10.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#futures.promise-10.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:promise,swap'><div id='lib:swap,promise'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:swap,promise'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> swap<span class='parenthesis'>(</span>promise<span class='operator'>&amp;</span> other<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='futures.promise-11'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6212'>#</a></div><div class='texpara'><div id='futures.promise-11.sentence-1' class='sentence'><i >Effects</i>: Exchanges the shared state of <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> and <span class='texttt'>other</span><a class='hidden_link' href='#futures.promise-11.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.promise-12'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6216'>#</a></div><div class='texpara'><div id='futures.promise-12.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> has the shared state (if any) that <span class='texttt'>other</span> had
prior to the call to <span class='texttt'>swap</span><a class='hidden_link' href='#futures.promise-12.sentence-1'>.</a></div> <div id='futures.promise-12.sentence-2' class='sentence'><span class='texttt'>other</span> has the shared state (if any) that
<span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> had prior to the call to <span class='texttt'>swap</span><a class='hidden_link' href='#futures.promise-12.sentence-2'>.</a></div></div></div></div><div class='texpara'><div id='lib:promise,get_future'><div id='lib:get_future,promise'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:get_future,promise'>🔗</a></div><code class='itemdeclcode'>future<span class='anglebracket'>&lt;</span>R<span class='anglebracket'>&gt;</span> get_future<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='futures.promise-13'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6229'>#</a></div><div class='texpara'><div id='futures.promise-13.sentence-1' class='sentence'><i >Returns</i>: A <span class='texttt'>future<span class='anglebracket'>&lt;</span>R<span class='anglebracket'>&gt;</span></span> object with the same shared state as
<span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#futures.promise-13.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.promise-14'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6234'>#</a></div><div class='texpara'><div id='futures.promise-14.sentence-1' class='sentence'><i >Synchronization</i>: Calls to this function do not introduce
data races  (<a href='intro.multithread' title='6.9.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>) with calls to
<span class='texttt'>set_&shy;value</span>,
<span class='texttt'>set_&shy;exception</span>,
<span class='texttt'>set_&shy;value_&shy;at_&shy;thread_&shy;exit</span>, or
<span class='texttt'>set_&shy;exception_&shy;at_&shy;thread_&shy;exit</span><a class='hidden_link' href='#futures.promise-14.sentence-1'>.</a></div> <div id='futures.promise-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#futures.promise-note-1'>1</a></i>: <div id='futures.promise-14.sentence-2' class='sentence'>Such calls need not synchronize with each other<a class='hidden_link' href='#futures.promise-14.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='futures.promise-15'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6246'>#</a></div><div class='texpara'><div id='futures.promise-15.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>future_&shy;error</span> if <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> has no shared state or if
<span class='texttt'>get_&shy;future</span> has already been called on a <span class='texttt'>promise</span> with the same
shared state as <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#futures.promise-15.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.promise-16'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6252'>#</a></div><div class='texpara'><div id='futures.promise-16.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='futures.promise-16.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.promise-16.1'>(16.1)</a></div><div class='texpara'><div id='futures.promise-16.1.sentence-1' class='sentence'><span class='texttt'>future_&shy;already_&shy;retrieved</span> if <span class='texttt'>get_&shy;future</span> has already been called on
a <span class='texttt'>promise</span> with the same shared state as <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#futures.promise-16.1.sentence-1'>.</a></div></div></li><li id='futures.promise-16.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.promise-16.2'>(16.2)</a></div><div class='texpara'><div id='futures.promise-16.2.sentence-1' class='sentence'><span class='texttt'>no_&shy;state</span> if <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> has no shared state<a class='hidden_link' href='#futures.promise-16.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:promise,set_value'><div id='lib:set_value,promise'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:set_value,promise'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> promise<span class='operator'>::</span>set_value<span class='parenthesis'>(</span><span class='keyword'>const</span> R<span class='operator'>&amp;</span> r<span class='parenthesis'>)</span>;
<span class='keyword'>void</span> promise<span class='operator'>::</span>set_value<span class='parenthesis'>(</span>R<span class='operator'>&amp;</span><span class='operator'>&amp;</span> r<span class='parenthesis'>)</span>;
<span class='keyword'>void</span> promise<span class='anglebracket'>&lt;</span>R<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span><span class='operator'>::</span>set_value<span class='parenthesis'>(</span>R<span class='operator'>&amp;</span> r<span class='parenthesis'>)</span>;
<span class='keyword'>void</span> promise<span class='anglebracket'>&lt;</span><span class='keyword'>void</span><span class='anglebracket'>&gt;</span><span class='operator'>::</span>set_value<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='futures.promise-17'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6271'>#</a></div><div class='texpara'><div id='futures.promise-17.sentence-1' class='sentence'><i >Effects</i>: Atomically stores the value <span class='texttt'>r</span> in the shared state and
makes that state ready (<a href='#futures.state' title='32.9.5&emsp;Shared state'>[futures.<span class='shy'></span>state]</a>)<a class='hidden_link' href='#futures.promise-17.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.promise-18'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6276'>#</a></div><div class='texpara'><div id='futures.promise-18.sentence-1' class='sentence'><i >Throws</i>: <ul class='itemize'><li id='futures.promise-18.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.promise-18.1'>(18.1)</a></div><span class='texttt'>future_&shy;error</span> if its shared state
already has a stored value or exception, or</li><li id='futures.promise-18.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.promise-18.2'>(18.2)</a></div>for the first version, any exception thrown by the constructor selected to copy an object of <span class='texttt'>R</span>, or</li><li id='futures.promise-18.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.promise-18.3'>(18.3)</a></div>for the second version, any exception thrown by the constructor selected to move an object of <span class='texttt'>R</span><a class='hidden_link' href='#futures.promise-18.sentence-1'>.</a></li></ul></div></div></div></div><div class='para' id='futures.promise-19'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6285'>#</a></div><div class='texpara'><div id='futures.promise-19.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='futures.promise-19.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.promise-19.1'>(19.1)</a></div><div class='texpara'><div id='futures.promise-19.1.sentence-1' class='sentence'><span class='texttt'>promise_&shy;already_&shy;satisfied</span> if its shared state
already has a stored value or exception<a class='hidden_link' href='#futures.promise-19.1.sentence-1'>.</a></div></div></li><li id='futures.promise-19.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.promise-19.2'>(19.2)</a></div><div class='texpara'><div id='futures.promise-19.2.sentence-1' class='sentence'><span class='texttt'>no_&shy;state</span> if <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> has no shared state<a class='hidden_link' href='#futures.promise-19.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:promise,set_exception'><div id='lib:set_exception,promise'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:set_exception,promise'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> set_exception<span class='parenthesis'>(</span>exception_ptr p<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='futures.promise-20'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6300'>#</a></div><div class='texpara'><div id='futures.promise-20.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'>p</span> is not null<a class='hidden_link' href='#futures.promise-20.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.promise-21'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6304'>#</a></div><div class='texpara'><div id='futures.promise-21.sentence-1' class='sentence'><i >Effects</i>: Atomically stores the exception pointer <span class='texttt'>p</span> in the shared state
and makes that state ready (<a href='#futures.state' title='32.9.5&emsp;Shared state'>[futures.<span class='shy'></span>state]</a>)<a class='hidden_link' href='#futures.promise-21.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.promise-22'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6309'>#</a></div><div class='texpara'><div id='futures.promise-22.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>future_&shy;error</span> if its shared state
already has a stored value or exception<a class='hidden_link' href='#futures.promise-22.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.promise-23'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6314'>#</a></div><div class='texpara'><div id='futures.promise-23.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='futures.promise-23.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.promise-23.1'>(23.1)</a></div><div class='texpara'><div id='futures.promise-23.1.sentence-1' class='sentence'><span class='texttt'>promise_&shy;already_&shy;satisfied</span> if its shared state
already has a stored value or exception<a class='hidden_link' href='#futures.promise-23.1.sentence-1'>.</a></div></div></li><li id='futures.promise-23.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.promise-23.2'>(23.2)</a></div><div class='texpara'><div id='futures.promise-23.2.sentence-1' class='sentence'><span class='texttt'>no_&shy;state</span> if <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> has no shared state<a class='hidden_link' href='#futures.promise-23.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:promise,set_value_at_thread_exit'><div id='lib:set_value_at_thread_exit,promise'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:set_value_at_thread_exit,promise'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> promise<span class='operator'>::</span>set_value_at_thread_exit<span class='parenthesis'>(</span><span class='keyword'>const</span> R<span class='operator'>&amp;</span> r<span class='parenthesis'>)</span>;
<span class='keyword'>void</span> promise<span class='operator'>::</span>set_value_at_thread_exit<span class='parenthesis'>(</span>R<span class='operator'>&amp;</span><span class='operator'>&amp;</span> r<span class='parenthesis'>)</span>;
<span class='keyword'>void</span> promise<span class='anglebracket'>&lt;</span>R<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span><span class='operator'>::</span>set_value_at_thread_exit<span class='parenthesis'>(</span>R<span class='operator'>&amp;</span> r<span class='parenthesis'>)</span>;
<span class='keyword'>void</span> promise<span class='anglebracket'>&lt;</span><span class='keyword'>void</span><span class='anglebracket'>&gt;</span><span class='operator'>::</span>set_value_at_thread_exit<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='futures.promise-24'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-24'>24</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6332'>#</a></div><div class='texpara'><div id='futures.promise-24.sentence-1' class='sentence'><i >Effects</i>: Stores the value <span class='texttt'>r</span> in the shared state without making that
state ready immediately<a class='hidden_link' href='#futures.promise-24.sentence-1'>.</a></div> <div id='futures.promise-24.sentence-2' class='sentence'>Schedules that state to be made ready when the current
thread exits, after all objects of thread storage duration associated with the
current thread have been destroyed<a class='hidden_link' href='#futures.promise-24.sentence-2'>.</a></div></div></div></div><div class='para' id='futures.promise-25'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-25'>25</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6339'>#</a></div><div class='texpara'><div id='futures.promise-25.sentence-1' class='sentence'><i >Throws</i>: <ul class='itemize'><li id='futures.promise-25.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.promise-25.1'>(25.1)</a></div><span class='texttt'>future_&shy;error</span> if its shared state
already has a stored value or exception, or</li><li id='futures.promise-25.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.promise-25.2'>(25.2)</a></div>for the first version, any exception thrown by the constructor selected to copy an object of <span class='texttt'>R</span>, or</li><li id='futures.promise-25.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.promise-25.3'>(25.3)</a></div>for the second version, any exception thrown by the constructor selected to move an object of <span class='texttt'>R</span><a class='hidden_link' href='#futures.promise-25.sentence-1'>.</a></li></ul></div></div></div></div><div class='para' id='futures.promise-26'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-26'>26</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6348'>#</a></div><div class='texpara'><div id='futures.promise-26.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='futures.promise-26.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.promise-26.1'>(26.1)</a></div><div class='texpara'><div id='futures.promise-26.1.sentence-1' class='sentence'><span class='texttt'>promise_&shy;already_&shy;satisfied</span> if its shared state
already has a stored value or exception<a class='hidden_link' href='#futures.promise-26.1.sentence-1'>.</a></div></div></li><li id='futures.promise-26.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.promise-26.2'>(26.2)</a></div><div class='texpara'><div id='futures.promise-26.2.sentence-1' class='sentence'><span class='texttt'>no_&shy;state</span> if <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> has no shared state<a class='hidden_link' href='#futures.promise-26.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:promise,set_exception_at_thread_exit'><div id='lib:set_exception_at_thread_exit,promise'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:set_exception_at_thread_exit,promise'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> set_exception_at_thread_exit<span class='parenthesis'>(</span>exception_ptr p<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='futures.promise-27'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-27'>27</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6363'>#</a></div><div class='texpara'><div id='futures.promise-27.sentence-1' class='sentence'><i >Preconditions</i>: <span class='texttt'>p</span> is not null<a class='hidden_link' href='#futures.promise-27.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.promise-28'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-28'>28</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6367'>#</a></div><div class='texpara'><div id='futures.promise-28.sentence-1' class='sentence'><i >Effects</i>: Stores the exception pointer <span class='texttt'>p</span> in the shared state without
making that state ready immediately<a class='hidden_link' href='#futures.promise-28.sentence-1'>.</a></div> <div id='futures.promise-28.sentence-2' class='sentence'>Schedules that state to be made ready when
the current thread exits, after all objects of thread storage duration
associated with the current thread have been destroyed<a class='hidden_link' href='#futures.promise-28.sentence-2'>.</a></div></div></div></div><div class='para' id='futures.promise-29'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-29'>29</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6374'>#</a></div><div class='texpara'><div id='futures.promise-29.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>future_&shy;error</span> if an error condition occurs<a class='hidden_link' href='#futures.promise-29.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.promise-30'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-30'>30</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6378'>#</a></div><div class='texpara'><div id='futures.promise-30.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='futures.promise-30.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.promise-30.1'>(30.1)</a></div><div class='texpara'><div id='futures.promise-30.1.sentence-1' class='sentence'><span class='texttt'>promise_&shy;already_&shy;satisfied</span> if its shared state
already has a stored value or exception<a class='hidden_link' href='#futures.promise-30.1.sentence-1'>.</a></div></div></li><li id='futures.promise-30.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.promise-30.2'>(30.2)</a></div><div class='texpara'><div id='futures.promise-30.2.sentence-1' class='sentence'><span class='texttt'>no_&shy;state</span> if <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> has no shared state<a class='hidden_link' href='#futures.promise-30.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:promise,swap_'><div id='lib:swap,promise_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:swap,promise_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> R<span class='anglebracket'>&gt;</span>
  <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>promise<span class='anglebracket'>&lt;</span>R<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> x, promise<span class='anglebracket'>&lt;</span>R<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> y<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='futures.promise-31'><div class='marginalizedparent'><a class='marginalized' href='#futures.promise-31'>31</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6394'>#</a></div><div class='texpara'><div id='futures.promise-31.sentence-1' class='sentence'><i >Effects</i>: As if by <span class='texttt'>x<span class='operator'>.</span>swap<span class='parenthesis'>(</span>y<span class='parenthesis'>)</span></span><a class='hidden_link' href='#futures.promise-31.sentence-1'>.</a></div></div></div></div></div><div id='futures.unique.future' class='section'><h3 ><a class='secnum' href='#futures.unique.future' style='min-width:80pt'>32.9.7</a> Class template <span class='texttt'>future</span> <a class='abbr_ref' href='futures.unique.future'>[futures.unique.future]</a></h3><div class='para' id='futures.unique.future-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6401'>#</a></div><div class='texpara'><div id='futures.unique.future-1.sentence-1' class='sentence'>The class template <span class='texttt'>future</span> defines a type for asynchronous return objects which
do not share their shared state with other asynchronous return objects<a class='hidden_link' href='#futures.unique.future-1.sentence-1'>.</a></div> <div id='futures.unique.future-1.sentence-2' class='sentence'>A default-constructed <span class='texttt'>future</span> object has no
shared state<a class='hidden_link' href='#futures.unique.future-1.sentence-2'>.</a></div> <div id='futures.unique.future-1.sentence-3' class='sentence'>A <span class='texttt'>future</span> object with shared state can be created by
functions on <a href='#def:asynchronous_provider' title='32.9.5&emsp;Shared state&emsp;[futures.state]'>asynchronous providers</a>
or by the move constructor and shares its shared state with
the original asynchronous provider<a class='hidden_link' href='#futures.unique.future-1.sentence-3'>.</a></div> <div id='futures.unique.future-1.sentence-4' class='sentence'>The result (value or exception) of
a <span class='texttt'>future</span> object
can be
set by
calling a respective function on an
object that shares the same
shared state<a class='hidden_link' href='#futures.unique.future-1.sentence-4'>.</a></div></div></div><div class='para nonNormativeOnly' id='futures.unique.future-2'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6416'>#</a></div><div class='texpara'><div id='futures.unique.future-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#futures.unique.future-note-1'>1</a></i>: <div id='futures.unique.future-2.sentence-1' class='sentence'>Member functions of <span class='texttt'>future</span> do not synchronize with themselves or with
member functions of <span class='texttt'>shared_&shy;future</span><a class='hidden_link' href='#futures.unique.future-2.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='futures.unique.future-3'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6422'>#</a></div><div class='texpara'><div id='futures.unique.future-3.sentence-1' class='sentence'>The effect of calling any member function other than the destructor, the
move-assignment operator, <span class='texttt'>share</span>, or <span class='texttt'>valid</span> on a <span class='texttt'>future</span> object for which
<span class='texttt'>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span>
is undefined<a class='hidden_link' href='#futures.unique.future-3.sentence-1'>.</a></div> <div id='futures.unique.future-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#futures.unique.future-note-2'>2</a></i>: <div id='futures.unique.future-3.sentence-2' class='sentence'>It is valid to move from a future object for which <span class='texttt'>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span><a class='hidden_link' href='#futures.unique.future-3.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div><div class='texpara'><div id='futures.unique.future-3.sentence-3' class='sentence'><i >Recommended practice</i>: Implementations should detect this case and throw an object of type
<span class='texttt'>future_&shy;error</span> with an error condition of <span class='texttt'>future_&shy;errc<span class='operator'>&#x200b;::&#x200b;</span>no_&shy;state</span><a class='hidden_link' href='#futures.unique.future-3.sentence-3'>.</a></div></div><div class='texpara'><span id='lib:future'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:future'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> R<span class='anglebracket'>&gt;</span>
  <span class='keyword'>class</span> future <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    future<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    future<span class='parenthesis'>(</span>future<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    future<span class='parenthesis'>(</span><span class='keyword'>const</span> future<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    <span class='operator'>~</span>future<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    future<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> future<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    future<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>future<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    shared_future<span class='anglebracket'>&lt;</span>R<span class='anglebracket'>&gt;</span> share<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    <span class='comment'>// retrieving the value</span>
    <i ><span class='texttt'>see below</span></i> get<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    <span class='comment'>// functions to check state</span>
    <span class='keyword'>bool</span> valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;

    <span class='keyword'>void</span> wait<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
      future_status wait_for<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
      future_status wait_until<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></div></div><div class='para' id='futures.unique.future-4'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6464'>#</a></div><div class='texpara'><div id='futures.unique.future-4.sentence-1' class='sentence'>For the primary template, <span class='texttt'>R</span> shall be an object type that
meets the <i >Cpp17Destructible</i> requirements<a class='hidden_link' href='#futures.unique.future-4.sentence-1'>.</a></div></div></div><div class='para' id='futures.unique.future-5'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6468'>#</a></div><div class='texpara'><div id='futures.unique.future-5.sentence-1' class='sentence'>The implementation provides the template <span class='texttt'>future</span> and two specializations,
<span class='texttt'>future<span class='anglebracket'>&lt;</span>R<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span></span> and <span class='texttt'>future<span class='anglebracket'>&lt;</span>&#x200b;<span class='keyword'>void</span><span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#futures.unique.future-5.sentence-1'>.</a></div> <div id='futures.unique.future-5.sentence-2' class='sentence'>These differ only in the return type and return
value of the member function <span class='texttt'>get</span>, as set out in its description, below<a class='hidden_link' href='#futures.unique.future-5.sentence-2'>.</a></div></div></div><div class='texpara'><div id='lib:future,constructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:future,constructor'>🔗</a></div><code class='itemdeclcode'>future<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='futures.unique.future-6'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6479'>#</a></div><div class='texpara'><div id='futures.unique.future-6.sentence-1' class='sentence'><i >Effects</i>: The object does not refer to a shared state<a class='hidden_link' href='#futures.unique.future-6.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.unique.future-7'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6483'>#</a></div><div class='texpara'><div id='futures.unique.future-7.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span><a class='hidden_link' href='#futures.unique.future-7.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:future,constructor_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:future,constructor_'>🔗</a></div><code class='itemdeclcode'>future<span class='parenthesis'>(</span>future<span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='futures.unique.future-8'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6494'>#</a></div><div class='texpara'><div id='futures.unique.future-8.sentence-1' class='sentence'><i >Effects</i>: Move constructs a <span class='texttt'>future</span> object that refers to the shared
state that
was originally referred to by <span class='texttt'>rhs</span> (if any)<a class='hidden_link' href='#futures.unique.future-8.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.unique.future-9'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6500'>#</a></div><div class='texpara'><div id='futures.unique.future-9.sentence-1' class='sentence'><i >Postconditions</i>: <ul class='itemize'><li id='futures.unique.future-9.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.unique.future-9.1'>(9.1)</a></div><div class='texpara'><div id='futures.unique.future-9.1.sentence-1' class='sentence'><span class='texttt'>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns the same value as <span class='texttt'>rhs<span class='operator'>.</span>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> prior to the
constructor invocation<a class='hidden_link' href='#futures.unique.future-9.1.sentence-1'>.</a></div></div></li><li id='futures.unique.future-9.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.unique.future-9.2'>(9.2)</a></div><div class='texpara'><div id='futures.unique.future-9.2.sentence-1' class='sentence'><span class='texttt'>rhs<span class='operator'>.</span>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span><a class='hidden_link' href='#futures.unique.future-9.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:future,constructor__'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:future,constructor__'>🔗</a></div><code class='itemdeclcode'><span class='operator'>~</span>future<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='futures.unique.future-10'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6515'>#</a></div><div class='texpara'><div id='futures.unique.future-10.sentence-1' class='sentence'><i >Effects</i>: <ul class='itemize'><li id='futures.unique.future-10.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.unique.future-10.1'>(10.1)</a></div>Releases any shared state (<a href='#futures.state' title='32.9.5&emsp;Shared state'>[futures.<span class='shy'></span>state]</a>);</li><li id='futures.unique.future-10.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.unique.future-10.2'>(10.2)</a></div>destroys <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#futures.unique.future-10.sentence-1'>.</a></li></ul></div></div></div></div><div class='texpara'><div id='lib:future,operator='><div id='lib:operator=,future'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:operator=,future'>🔗</a></div><code class='itemdeclcode'>future<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>future<span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='futures.unique.future-11'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6531'>#</a></div><div class='texpara'><div id='futures.unique.future-11.sentence-1' class='sentence'><i >Effects</i>: <ul class='itemize'><li id='futures.unique.future-11.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.unique.future-11.1'>(11.1)</a></div><div class='texpara'><div id='futures.unique.future-11.1.sentence-1' class='sentence'>Releases any shared state (<a href='#futures.state' title='32.9.5&emsp;Shared state'>[futures.<span class='shy'></span>state]</a>)<a class='hidden_link' href='#futures.unique.future-11.1.sentence-1'>.</a></div></div></li><li id='futures.unique.future-11.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.unique.future-11.2'>(11.2)</a></div><div class='texpara'><div id='futures.unique.future-11.2.sentence-1' class='sentence'>move assigns the contents of <span class='texttt'>rhs</span> to <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#futures.unique.future-11.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='para' id='futures.unique.future-12'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6540'>#</a></div><div class='texpara'><div id='futures.unique.future-12.sentence-1' class='sentence'><i >Postconditions</i>: <ul class='itemize'><li id='futures.unique.future-12.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.unique.future-12.1'>(12.1)</a></div><div class='texpara'><div id='futures.unique.future-12.1.sentence-1' class='sentence'><span class='texttt'>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns the same value as <span class='texttt'>rhs<span class='operator'>.</span>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> prior to the
assignment<a class='hidden_link' href='#futures.unique.future-12.1.sentence-1'>.</a></div></div></li><li id='futures.unique.future-12.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.unique.future-12.2'>(12.2)</a></div><div class='texpara'><div id='futures.unique.future-12.2.sentence-1' class='sentence'><span class='texttt'>rhs<span class='operator'>.</span>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span><a class='hidden_link' href='#futures.unique.future-12.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:future,share'><div id='lib:share,future'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:share,future'>🔗</a></div><code class='itemdeclcode'>shared_future<span class='anglebracket'>&lt;</span>R<span class='anglebracket'>&gt;</span> share<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='futures.unique.future-13'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6558'>#</a></div><div class='texpara'><div id='futures.unique.future-13.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span><a class='hidden_link' href='#futures.unique.future-13.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.unique.future-14'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6562'>#</a></div><div class='texpara'><div id='futures.unique.future-14.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'>shared_&shy;future<span class='anglebracket'>&lt;</span>R<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>move<span class='parenthesis'>(</span><span class='operator'>*</span><span class='keyword'>this</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#futures.unique.future-14.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:future,get'><div id='lib:get,future'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:get,future'>🔗</a></div><code class='itemdeclcode'>R future<span class='operator'>::</span>get<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
R<span class='operator'>&amp;</span> future<span class='anglebracket'>&lt;</span>R<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span><span class='operator'>::</span>get<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='keyword'>void</span> future<span class='anglebracket'>&lt;</span><span class='keyword'>void</span><span class='anglebracket'>&gt;</span><span class='operator'>::</span>get<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para nonNormativeOnly' id='futures.unique.future-15'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6575'>#</a></div><div class='texpara'><div id='futures.unique.future-note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#futures.unique.future-note-3'>3</a></i>: <div id='futures.unique.future-15.sentence-1' class='sentence'>As described above, the template and its two required specializations differ only in
the return type and return value of the member function <span class='texttt'>get</span><a class='hidden_link' href='#futures.unique.future-15.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='futures.unique.future-16'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6581'>#</a></div><div class='texpara'><div id='futures.unique.future-16.sentence-1' class='sentence'><i >Effects</i>: <ul class='itemize'><li id='futures.unique.future-16.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.unique.future-16.1'>(16.1)</a></div><span class='texttt'>wait<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>s until the shared state is ready, then retrieves the
value stored in the shared state;</li><li id='futures.unique.future-16.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.unique.future-16.2'>(16.2)</a></div>releases any shared state (<a href='#futures.state' title='32.9.5&emsp;Shared state'>[futures.<span class='shy'></span>state]</a>)<a class='hidden_link' href='#futures.unique.future-16.sentence-1'>.</a></li></ul></div></div></div></div><div class='para' id='futures.unique.future-17'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6589'>#</a></div><div class='texpara'><div id='futures.unique.future-17.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span><a class='hidden_link' href='#futures.unique.future-17.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.unique.future-18'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6593'>#</a></div><div class='texpara'><div id='futures.unique.future-18.sentence-1' class='sentence'><i >Returns</i>: <ul class='itemize'><li id='futures.unique.future-18.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.unique.future-18.1'>(18.1)</a></div><div class='texpara'><div id='futures.unique.future-18.1.sentence-1' class='sentence'><span class='texttt'>future<span class='operator'>&#x200b;::&#x200b;</span>get<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns the value <span class='texttt'>v</span> stored in the object's shared state as
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>move<span class='parenthesis'>(</span>v<span class='parenthesis'>)</span></span><a class='hidden_link' href='#futures.unique.future-18.1.sentence-1'>.</a></div></div></li><li id='futures.unique.future-18.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.unique.future-18.2'>(18.2)</a></div><div class='texpara'><div id='futures.unique.future-18.2.sentence-1' class='sentence'><span class='texttt'>future<span class='anglebracket'>&lt;</span>R<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span><span class='operator'>&#x200b;::&#x200b;</span>get<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns the reference stored as value in the object's shared state<a class='hidden_link' href='#futures.unique.future-18.2.sentence-1'>.</a></div></div></li><li id='futures.unique.future-18.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.unique.future-18.3'>(18.3)</a></div><div class='texpara'><div id='futures.unique.future-18.3.sentence-1' class='sentence'><span class='texttt'>future<span class='anglebracket'>&lt;</span><span class='keyword'>void</span><span class='anglebracket'>&gt;</span><span class='operator'>&#x200b;::&#x200b;</span>get<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns nothing<a class='hidden_link' href='#futures.unique.future-18.3.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='para' id='futures.unique.future-19'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6607'>#</a></div><div class='texpara'><div id='futures.unique.future-19.sentence-1' class='sentence'><i >Throws</i>: The stored exception, if an exception was stored in the shared state<a class='hidden_link' href='#futures.unique.future-19.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:future,valid'><div id='lib:valid,future'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:valid,future'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>bool</span> valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='futures.unique.future-20'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6618'>#</a></div><div class='texpara'><div id='futures.unique.future-20.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>true</span></span> only if <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> refers to a shared state<a class='hidden_link' href='#futures.unique.future-20.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:future,wait'><div id='lib:wait,future'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:wait,future'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> wait<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div></div></div><div class='para' id='futures.unique.future-21'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6629'>#</a></div><div class='texpara'><div id='futures.unique.future-21.sentence-1' class='sentence'><a class='index' id=':block_(execution)_____________________'></a><i >Effects</i>: Blocks until the shared state is ready<a class='hidden_link' href='#futures.unique.future-21.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:future,wait_for'><div id='lib:wait_for,future'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:wait_for,future'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
  future_status wait_for<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div></div></div><div class='para' id='futures.unique.future-22'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6642'>#</a></div><div class='texpara'><div id='futures.unique.future-22.sentence-1' class='sentence'><a class='index' id=':block_(execution)______________________'></a><i >Effects</i>: None if the shared state contains a deferred function (<a href='#futures.async' title='32.9.9&emsp;Function template async'>[futures.<span class='shy'></span>async]</a>),
otherwise
blocks until the shared state is ready or until
the relative timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>) specified by <span class='texttt'>rel_&shy;time</span> has expired<a class='hidden_link' href='#futures.unique.future-22.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.unique.future-23'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6650'>#</a></div><div class='texpara'><div id='futures.unique.future-23.sentence-1' class='sentence'><i >Returns</i>: <ul class='itemize'><li id='futures.unique.future-23.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.unique.future-23.1'>(23.1)</a></div><div class='texpara'><div id='futures.unique.future-23.1.sentence-1' class='sentence'><span class='texttt'>future_&shy;status<span class='operator'>&#x200b;::&#x200b;</span>deferred</span> if the shared state contains a deferred
function<a class='hidden_link' href='#futures.unique.future-23.1.sentence-1'>.</a></div></div></li><li id='futures.unique.future-23.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.unique.future-23.2'>(23.2)</a></div><div class='texpara'><div id='futures.unique.future-23.2.sentence-1' class='sentence'><span class='texttt'>future_&shy;status<span class='operator'>&#x200b;::&#x200b;</span>ready</span> if the shared state is ready<a class='hidden_link' href='#futures.unique.future-23.2.sentence-1'>.</a></div></div></li><li id='futures.unique.future-23.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.unique.future-23.3'>(23.3)</a></div><div class='texpara'><div id='futures.unique.future-23.3.sentence-1' class='sentence'><span class='texttt'>future_&shy;status<span class='operator'>&#x200b;::&#x200b;</span>timeout</span> if the function is returning because the
relative timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>)
specified by <span class='texttt'>rel_&shy;time</span> has expired<a class='hidden_link' href='#futures.unique.future-23.3.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='para' id='futures.unique.future-24'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-24'>24</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6663'>#</a></div><div class='texpara'><div id='futures.unique.future-24.sentence-1' class='sentence'><i >Throws</i>: timeout-related exceptions (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>)<a class='hidden_link' href='#futures.unique.future-24.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:future,wait_until'><div id='lib:wait_until,future'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:wait_until,future'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
  future_status wait_until<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div></div></div><div class='para' id='futures.unique.future-25'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-25'>25</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6675'>#</a></div><div class='texpara'><div id='futures.unique.future-25.sentence-1' class='sentence'><a class='index' id=':block_(execution)_______________________'></a><i >Effects</i>: None if the shared state contains a deferred function (<a href='#futures.async' title='32.9.9&emsp;Function template async'>[futures.<span class='shy'></span>async]</a>),
otherwise
blocks until the shared state is ready or until
the absolute timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>) specified by <span class='texttt'>abs_&shy;time</span> has expired<a class='hidden_link' href='#futures.unique.future-25.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.unique.future-26'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-26'>26</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6683'>#</a></div><div class='texpara'><div id='futures.unique.future-26.sentence-1' class='sentence'><i >Returns</i>: <ul class='itemize'><li id='futures.unique.future-26.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.unique.future-26.1'>(26.1)</a></div><div class='texpara'><div id='futures.unique.future-26.1.sentence-1' class='sentence'><span class='texttt'>future_&shy;status<span class='operator'>&#x200b;::&#x200b;</span>deferred</span> if the shared state contains a deferred
function<a class='hidden_link' href='#futures.unique.future-26.1.sentence-1'>.</a></div></div></li><li id='futures.unique.future-26.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.unique.future-26.2'>(26.2)</a></div><div class='texpara'><div id='futures.unique.future-26.2.sentence-1' class='sentence'><span class='texttt'>future_&shy;status<span class='operator'>&#x200b;::&#x200b;</span>ready</span> if the shared state is ready<a class='hidden_link' href='#futures.unique.future-26.2.sentence-1'>.</a></div></div></li><li id='futures.unique.future-26.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.unique.future-26.3'>(26.3)</a></div><div class='texpara'><div id='futures.unique.future-26.3.sentence-1' class='sentence'><span class='texttt'>future_&shy;status<span class='operator'>&#x200b;::&#x200b;</span>timeout</span> if the function is returning because the
absolute timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>)
specified by <span class='texttt'>abs_&shy;time</span> has expired<a class='hidden_link' href='#futures.unique.future-26.3.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='para' id='futures.unique.future-27'><div class='marginalizedparent'><a class='marginalized' href='#futures.unique.future-27'>27</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6697'>#</a></div><div class='texpara'><div id='futures.unique.future-27.sentence-1' class='sentence'><i >Throws</i>: timeout-related exceptions (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>)<a class='hidden_link' href='#futures.unique.future-27.sentence-1'>.</a></div></div></div></div></div><div id='futures.shared.future' class='section'><h3 ><a class='secnum' href='#futures.shared.future' style='min-width:80pt'>32.9.8</a> Class template <span class='texttt'>shared_&shy;future</span> <a class='abbr_ref' href='futures.shared.future'>[futures.shared.future]</a></h3><div class='para' id='futures.shared.future-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6705'>#</a></div><div class='texpara'><div id='futures.shared.future-1.sentence-1' class='sentence'>The class template <span class='texttt'>shared_&shy;future</span> defines a type for asynchronous return objects
which may share their shared state with other asynchronous return
objects<a class='hidden_link' href='#futures.shared.future-1.sentence-1'>.</a></div> <div id='futures.shared.future-1.sentence-2' class='sentence'>A default-constructed <span class='texttt'>shared_&shy;future</span>
object has no shared state<a class='hidden_link' href='#futures.shared.future-1.sentence-2'>.</a></div> <div id='futures.shared.future-1.sentence-3' class='sentence'>A <span class='texttt'>shared_&shy;future</span> object with
shared state can
be created
by conversion from a <span class='texttt'>future</span> object and shares its shared state with the
original <a href='#def:asynchronous_provider' title='32.9.5&emsp;Shared state&emsp;[futures.state]'>asynchronous provider</a> of the shared state<a class='hidden_link' href='#futures.shared.future-1.sentence-3'>.</a></div> <div id='futures.shared.future-1.sentence-4' class='sentence'>The result (value or exception) of a <span class='texttt'>shared_&shy;future</span> object
can be set by
calling a respective function on an
object that shares the same shared state<a class='hidden_link' href='#futures.shared.future-1.sentence-4'>.</a></div></div></div><div class='para nonNormativeOnly' id='futures.shared.future-2'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6719'>#</a></div><div class='texpara'><div id='futures.shared.future-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#futures.shared.future-note-1'>1</a></i>: <div id='futures.shared.future-2.sentence-1' class='sentence'>Member functions of <span class='texttt'>shared_&shy;future</span> do not synchronize with themselves,
but they synchronize with the shared state<a class='hidden_link' href='#futures.shared.future-2.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div><div class='para' id='futures.shared.future-3'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6725'>#</a></div><div class='texpara'><div id='futures.shared.future-3.sentence-1' class='sentence'>The effect of calling any member function other than the destructor,
the move-assignment operator, the copy-assignment operator, or
<span class='texttt'>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> on a <span class='texttt'>shared_&shy;future</span> object for which <span class='texttt'>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span> is undefined<a class='hidden_link' href='#futures.shared.future-3.sentence-1'>.</a></div> <div id='futures.shared.future-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#futures.shared.future-note-2'>2</a></i>: <div id='futures.shared.future-3.sentence-2' class='sentence'>It is valid to copy or move from a <span class='texttt'>shared_&shy;future</span>
object for which <span class='texttt'>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is <span class='texttt'><span class='literal'>false</span></span><a class='hidden_link' href='#futures.shared.future-3.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div><div class='texpara'><div id='futures.shared.future-3.sentence-3' class='sentence'><i >Recommended practice</i>: Implementations should detect this case and throw an object of type
<span class='texttt'>future_&shy;error</span> with an error condition of <span class='texttt'>future_&shy;errc<span class='operator'>&#x200b;::&#x200b;</span>no_&shy;state</span><a class='hidden_link' href='#futures.shared.future-3.sentence-3'>.</a></div></div><div class='texpara'><span id='lib:shared_future'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:shared_future'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> R<span class='anglebracket'>&gt;</span>
  <span class='keyword'>class</span> shared_future <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    shared_future<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    shared_future<span class='parenthesis'>(</span><span class='keyword'>const</span> shared_future<span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    shared_future<span class='parenthesis'>(</span>future<span class='anglebracket'>&lt;</span>R<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    shared_future<span class='parenthesis'>(</span>shared_future<span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='operator'>~</span>shared_future<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
    shared_future<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> shared_future<span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    shared_future<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>shared_future<span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    <span class='comment'>// retrieving the value</span>
    <i ><span class='texttt'>see below</span></i> get<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span>;

    <span class='comment'>// functions to check state</span>
    <span class='keyword'>bool</span> valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;

    <span class='keyword'>void</span> wait<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
      future_status wait_for<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
      future_status wait_until<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
  <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
</span></span></div></div><div class='para' id='futures.shared.future-4'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6767'>#</a></div><div class='texpara'><div id='futures.shared.future-4.sentence-1' class='sentence'>For the primary template, <span class='texttt'>R</span> shall be an object type that
meets the <i >Cpp17Destructible</i> requirements<a class='hidden_link' href='#futures.shared.future-4.sentence-1'>.</a></div></div></div><div class='para' id='futures.shared.future-5'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6771'>#</a></div><div class='texpara'><div id='futures.shared.future-5.sentence-1' class='sentence'>The implementation provides the template <span class='texttt'>shared_&shy;future</span> and two
specializations, <span class='texttt'>shared_&shy;future<span class='anglebracket'>&lt;</span>R<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span></span> and <span class='texttt'>shared_&shy;future<span class='anglebracket'>&lt;</span><span class='keyword'>void</span><span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#futures.shared.future-5.sentence-1'>.</a></div> <div id='futures.shared.future-5.sentence-2' class='sentence'>These
differ only in the return type and return value of the member function <span class='texttt'>get</span>, as
set out in its description, below<a class='hidden_link' href='#futures.shared.future-5.sentence-2'>.</a></div></div></div><div class='texpara'><div id='lib:shared_future,constructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:shared_future,constructor'>🔗</a></div><code class='itemdeclcode'>shared_future<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='futures.shared.future-6'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6783'>#</a></div><div class='texpara'><div id='futures.shared.future-6.sentence-1' class='sentence'><i >Effects</i>: The object does not refer to a shared state<a class='hidden_link' href='#futures.shared.future-6.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.shared.future-7'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6787'>#</a></div><div class='texpara'><div id='futures.shared.future-7.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span><a class='hidden_link' href='#futures.shared.future-7.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:shared_future,constructor_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:shared_future,constructor_'>🔗</a></div><code class='itemdeclcode'>shared_future<span class='parenthesis'>(</span><span class='keyword'>const</span> shared_future<span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='futures.shared.future-8'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6798'>#</a></div><div class='texpara'><div id='futures.shared.future-8.sentence-1' class='sentence'><i >Effects</i>: The object refers to the same
shared state as <span class='texttt'>rhs</span> (if any)<a class='hidden_link' href='#futures.shared.future-8.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.shared.future-9'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6803'>#</a></div><div class='texpara'><div id='futures.shared.future-9.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns the same value as <span class='texttt'>rhs<span class='operator'>.</span>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#futures.shared.future-9.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:shared_future,constructor__'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:shared_future,constructor__'>🔗</a></div><code class='itemdeclcode'>shared_future<span class='parenthesis'>(</span>future<span class='anglebracket'>&lt;</span>R<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
shared_future<span class='parenthesis'>(</span>shared_future<span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='futures.shared.future-10'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6815'>#</a></div><div class='texpara'><div id='futures.shared.future-10.sentence-1' class='sentence'><i >Effects</i>: Move constructs a <span class='texttt'>shared_&shy;future</span> object that refers to the
shared state that was originally referred to by <span class='texttt'>rhs</span> (if any)<a class='hidden_link' href='#futures.shared.future-10.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.shared.future-11'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6820'>#</a></div><div class='texpara'><div id='futures.shared.future-11.sentence-1' class='sentence'><i >Postconditions</i>: <ul class='itemize'><li id='futures.shared.future-11.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.shared.future-11.1'>(11.1)</a></div><div class='texpara'><div id='futures.shared.future-11.1.sentence-1' class='sentence'><span class='texttt'>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns the same value as <span class='texttt'>rhs<span class='operator'>.</span>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returned prior to
the constructor invocation<a class='hidden_link' href='#futures.shared.future-11.1.sentence-1'>.</a></div></div></li><li id='futures.shared.future-11.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.shared.future-11.2'>(11.2)</a></div><div class='texpara'><div id='futures.shared.future-11.2.sentence-1' class='sentence'><span class='texttt'>rhs<span class='operator'>.</span>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span><a class='hidden_link' href='#futures.shared.future-11.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:shared_future,destructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:shared_future,destructor'>🔗</a></div><code class='itemdeclcode'><span class='operator'>~</span>shared_future<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='futures.shared.future-12'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6835'>#</a></div><div class='texpara'><div id='futures.shared.future-12.sentence-1' class='sentence'><i >Effects</i>: <ul class='itemize'><li id='futures.shared.future-12.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.shared.future-12.1'>(12.1)</a></div>Releases any shared state (<a href='#futures.state' title='32.9.5&emsp;Shared state'>[futures.<span class='shy'></span>state]</a>);</li><li id='futures.shared.future-12.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.shared.future-12.2'>(12.2)</a></div>destroys <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#futures.shared.future-12.sentence-1'>.</a></li></ul></div></div></div></div><div class='texpara'><div id='lib:shared_future,operator='><div id='lib:operator=,shared_future'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:operator=,shared_future'>🔗</a></div><code class='itemdeclcode'>shared_future<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>shared_future<span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='futures.shared.future-13'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6851'>#</a></div><div class='texpara'><div id='futures.shared.future-13.sentence-1' class='sentence'><i >Effects</i>: <ul class='itemize'><li id='futures.shared.future-13.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.shared.future-13.1'>(13.1)</a></div>Releases any shared state (<a href='#futures.state' title='32.9.5&emsp;Shared state'>[futures.<span class='shy'></span>state]</a>);</li><li id='futures.shared.future-13.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.shared.future-13.2'>(13.2)</a></div>move assigns the contents of <span class='texttt'>rhs</span> to <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#futures.shared.future-13.sentence-1'>.</a></li></ul></div></div></div></div><div class='para' id='futures.shared.future-14'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6860'>#</a></div><div class='texpara'><div id='futures.shared.future-14.sentence-1' class='sentence'><i >Postconditions</i>: <ul class='itemize'><li id='futures.shared.future-14.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.shared.future-14.1'>(14.1)</a></div><div class='texpara'><div id='futures.shared.future-14.1.sentence-1' class='sentence'><span class='texttt'>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns the same value as <span class='texttt'>rhs<span class='operator'>.</span>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returned prior to
the assignment<a class='hidden_link' href='#futures.shared.future-14.1.sentence-1'>.</a></div></div></li><li id='futures.shared.future-14.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.shared.future-14.2'>(14.2)</a></div><div class='texpara'><div id='futures.shared.future-14.2.sentence-1' class='sentence'><span class='texttt'>rhs<span class='operator'>.</span>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> <span class='literal'>false</span></span><a class='hidden_link' href='#futures.shared.future-14.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:shared_future,operator=_'><div id='lib:operator=,shared_future_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:operator=,shared_future_'>🔗</a></div><code class='itemdeclcode'>shared_future<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> shared_future<span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='futures.shared.future-15'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6878'>#</a></div><div class='texpara'><div id='futures.shared.future-15.sentence-1' class='sentence'><i >Effects</i>: <ul class='itemize'><li id='futures.shared.future-15.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.shared.future-15.1'>(15.1)</a></div>Releases any shared state (<a href='#futures.state' title='32.9.5&emsp;Shared state'>[futures.<span class='shy'></span>state]</a>);</li><li id='futures.shared.future-15.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.shared.future-15.2'>(15.2)</a></div>assigns the contents of <span class='texttt'>rhs</span> to <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#futures.shared.future-15.sentence-1'>.</a> <div class='texpara'><div id='futures.shared.future-note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#futures.shared.future-note-3'>3</a></i>: <div id='futures.shared.future-15.2.sentence-2' class='sentence'>As a result,
<span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> refers to the same shared state as <span class='texttt'>rhs</span>
(if any)<a class='hidden_link' href='#futures.shared.future-15.2.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></li></ul></div></div></div></div><div class='para' id='futures.shared.future-16'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6892'>#</a></div><div class='texpara'><div id='futures.shared.future-16.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='operator'>=</span><span class='operator'>=</span> rhs<span class='operator'>.</span>valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#futures.shared.future-16.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:shared_future,get'><div id='lib:get,shared_future'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:get,shared_future'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>const</span> R<span class='operator'>&amp;</span> shared_future<span class='operator'>::</span>get<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span>;
R<span class='operator'>&amp;</span> shared_future<span class='anglebracket'>&lt;</span>R<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span><span class='operator'>::</span>get<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span>;
<span class='keyword'>void</span> shared_future<span class='anglebracket'>&lt;</span><span class='keyword'>void</span><span class='anglebracket'>&gt;</span><span class='operator'>::</span>get<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div></div></div><div class='para nonNormativeOnly' id='futures.shared.future-17'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6905'>#</a></div><div class='texpara'><div id='futures.shared.future-note-4' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#futures.shared.future-note-4'>4</a></i>: <div id='futures.shared.future-17.sentence-1' class='sentence'>As described above, the template and its two required specializations differ only in
the return type and return value of the member function <span class='texttt'>get</span><a class='hidden_link' href='#futures.shared.future-17.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para nonNormativeOnly' id='futures.shared.future-18'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6911'>#</a></div><div class='texpara'><div id='futures.shared.future-note-5' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#futures.shared.future-note-5'>5</a></i>: <div id='futures.shared.future-18.sentence-1' class='sentence'>Access to a value object stored in the shared state is
unsynchronized, so operations on <span class='texttt'>R</span> might
introduce a data race (<a href='intro.multithread' title='6.9.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>)<a class='hidden_link' href='#futures.shared.future-18.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='futures.shared.future-19'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6918'>#</a></div><div class='texpara'><div id='futures.shared.future-19.sentence-1' class='sentence'><i >Effects</i>: <span class='texttt'>wait<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span>s until the shared state is ready, then retrieves the
value stored in the shared state<a class='hidden_link' href='#futures.shared.future-19.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.shared.future-20'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6923'>#</a></div><div class='texpara'><div id='futures.shared.future-20.sentence-1' class='sentence'><i >Returns</i>: <ul class='itemize'><li id='futures.shared.future-20.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.shared.future-20.1'>(20.1)</a></div><div class='texpara'><div id='futures.shared.future-20.1.sentence-1' class='sentence'><span class='texttt'>shared_&shy;future<span class='operator'>&#x200b;::&#x200b;</span>get<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns a const reference to the value stored in the object's
shared state<a class='hidden_link' href='#futures.shared.future-20.1.sentence-1'>.</a></div> <div id='futures.shared.future-note-6' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#futures.shared.future-note-6'>6</a></i>: <div id='futures.shared.future-20.1.sentence-2' class='sentence'>Access through that reference after the shared state has been
destroyed produces undefined behavior; this can be avoided by not storing the reference in any
storage with a greater lifetime than the <span class='texttt'>shared_&shy;future</span> object that returned the
reference<a class='hidden_link' href='#futures.shared.future-20.1.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></li><li id='futures.shared.future-20.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.shared.future-20.2'>(20.2)</a></div><div class='texpara'><div id='futures.shared.future-20.2.sentence-1' class='sentence'><span class='texttt'>shared_&shy;future<span class='anglebracket'>&lt;</span>R<span class='operator'>&amp;</span><span class='anglebracket'>&gt;</span><span class='operator'>&#x200b;::&#x200b;</span>get<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns the reference stored as value in the object's
shared state<a class='hidden_link' href='#futures.shared.future-20.2.sentence-1'>.</a></div></div></li><li id='futures.shared.future-20.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.shared.future-20.3'>(20.3)</a></div><div class='texpara'><div id='futures.shared.future-20.3.sentence-1' class='sentence'><span class='texttt'>shared_&shy;future<span class='anglebracket'>&lt;</span><span class='keyword'>void</span><span class='anglebracket'>&gt;</span><span class='operator'>&#x200b;::&#x200b;</span>get<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> returns nothing<a class='hidden_link' href='#futures.shared.future-20.3.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='para' id='futures.shared.future-21'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6944'>#</a></div><div class='texpara'><div id='futures.shared.future-21.sentence-1' class='sentence'><i >Throws</i>: The stored exception, if an exception was stored in the shared state<a class='hidden_link' href='#futures.shared.future-21.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:shared_future,valid'><div id='lib:valid,shared_future'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:valid,shared_future'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>bool</span> valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='futures.shared.future-22'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6955'>#</a></div><div class='texpara'><div id='futures.shared.future-22.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>true</span></span> only if <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> refers to a shared state<a class='hidden_link' href='#futures.shared.future-22.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:shared_future,wait'><div id='lib:wait,shared_future'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:wait,shared_future'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> wait<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div></div></div><div class='para' id='futures.shared.future-23'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6966'>#</a></div><div class='texpara'><div id='futures.shared.future-23.sentence-1' class='sentence'><a class='index' id=':block_(execution)________________________'></a><i >Effects</i>: Blocks until the shared state is ready<a class='hidden_link' href='#futures.shared.future-23.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:shared_future,wait_for'><div id='lib:wait_for,shared_future'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:wait_for,shared_future'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Rep, <span class='keyword'>class</span> Period<span class='anglebracket'>&gt;</span>
  future_status wait_for<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>duration<span class='anglebracket'>&lt;</span>Rep, Period<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> rel_time<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div></div></div><div class='para' id='futures.shared.future-24'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-24'>24</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6979'>#</a></div><div class='texpara'><div id='futures.shared.future-24.sentence-1' class='sentence'><a class='index' id=':block_(execution)_________________________'></a><i >Effects</i>: None if the shared state contains a deferred function (<a href='#futures.async' title='32.9.9&emsp;Function template async'>[futures.<span class='shy'></span>async]</a>),
otherwise
blocks until the shared state is ready or until
the relative timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>) specified by
<span class='texttt'>rel_&shy;time</span> has expired<a class='hidden_link' href='#futures.shared.future-24.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.shared.future-25'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-25'>25</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L6988'>#</a></div><div class='texpara'><div id='futures.shared.future-25.sentence-1' class='sentence'><i >Returns</i>: <ul class='itemize'><li id='futures.shared.future-25.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.shared.future-25.1'>(25.1)</a></div><div class='texpara'><div id='futures.shared.future-25.1.sentence-1' class='sentence'><span class='texttt'>future_&shy;status<span class='operator'>&#x200b;::&#x200b;</span>deferred</span> if the shared state contains a deferred
function<a class='hidden_link' href='#futures.shared.future-25.1.sentence-1'>.</a></div></div></li><li id='futures.shared.future-25.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.shared.future-25.2'>(25.2)</a></div><div class='texpara'><div id='futures.shared.future-25.2.sentence-1' class='sentence'><span class='texttt'>future_&shy;status<span class='operator'>&#x200b;::&#x200b;</span>ready</span> if the shared state is ready<a class='hidden_link' href='#futures.shared.future-25.2.sentence-1'>.</a></div></div></li><li id='futures.shared.future-25.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.shared.future-25.3'>(25.3)</a></div><div class='texpara'><div id='futures.shared.future-25.3.sentence-1' class='sentence'><span class='texttt'>future_&shy;status<span class='operator'>&#x200b;::&#x200b;</span>timeout</span> if the function is returning because the
relative timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>)
specified by <span class='texttt'>rel_&shy;time</span> has expired<a class='hidden_link' href='#futures.shared.future-25.3.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='para' id='futures.shared.future-26'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-26'>26</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7001'>#</a></div><div class='texpara'><div id='futures.shared.future-26.sentence-1' class='sentence'><i >Throws</i>: timeout-related exceptions (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>)<a class='hidden_link' href='#futures.shared.future-26.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:shared_future,wait_until'><div id='lib:wait_until,shared_future'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:wait_until,shared_future'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> Clock, <span class='keyword'>class</span> Duration<span class='anglebracket'>&gt;</span>
  future_status wait_until<span class='parenthesis'>(</span><span class='keyword'>const</span> chrono<span class='operator'>::</span>time_point<span class='anglebracket'>&lt;</span>Clock, Duration<span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> abs_time<span class='parenthesis'>)</span> <span class='keyword'>const</span>;
</code></div></div></div></div><div class='para' id='futures.shared.future-27'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-27'>27</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7013'>#</a></div><div class='texpara'><div id='futures.shared.future-27.sentence-1' class='sentence'><a class='index' id=':block_(execution)__________________________'></a><i >Effects</i>: None if the shared state contains a deferred function (<a href='#futures.async' title='32.9.9&emsp;Function template async'>[futures.<span class='shy'></span>async]</a>),
otherwise
blocks until the shared state is ready or until the
absolute timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>) specified by
<span class='texttt'>abs_&shy;time</span> has expired<a class='hidden_link' href='#futures.shared.future-27.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.shared.future-28'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-28'>28</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7022'>#</a></div><div class='texpara'><div id='futures.shared.future-28.sentence-1' class='sentence'><i >Returns</i>: <ul class='itemize'><li id='futures.shared.future-28.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.shared.future-28.1'>(28.1)</a></div><div class='texpara'><div id='futures.shared.future-28.1.sentence-1' class='sentence'><span class='texttt'>future_&shy;status<span class='operator'>&#x200b;::&#x200b;</span>deferred</span> if the shared state contains a deferred
function<a class='hidden_link' href='#futures.shared.future-28.1.sentence-1'>.</a></div></div></li><li id='futures.shared.future-28.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.shared.future-28.2'>(28.2)</a></div><div class='texpara'><div id='futures.shared.future-28.2.sentence-1' class='sentence'><span class='texttt'>future_&shy;status<span class='operator'>&#x200b;::&#x200b;</span>ready</span> if the shared state is ready<a class='hidden_link' href='#futures.shared.future-28.2.sentence-1'>.</a></div></div></li><li id='futures.shared.future-28.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.shared.future-28.3'>(28.3)</a></div><div class='texpara'><div id='futures.shared.future-28.3.sentence-1' class='sentence'><span class='texttt'>future_&shy;status<span class='operator'>&#x200b;::&#x200b;</span>timeout</span> if the function is returning because the
absolute timeout (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>)
specified by <span class='texttt'>abs_&shy;time</span> has expired<a class='hidden_link' href='#futures.shared.future-28.3.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='para' id='futures.shared.future-29'><div class='marginalizedparent'><a class='marginalized' href='#futures.shared.future-29'>29</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7035'>#</a></div><div class='texpara'><div id='futures.shared.future-29.sentence-1' class='sentence'><i >Throws</i>: timeout-related exceptions (<a href='#req.timing' title='32.2.4&emsp;Timing specifications'>[thread.<span class='shy'></span>req.<span class='shy'></span>timing]</a>)<a class='hidden_link' href='#futures.shared.future-29.sentence-1'>.</a></div></div></div></div></div><div id='futures.async' class='section'><h3 ><a class='secnum' href='#futures.async' style='min-width:80pt'>32.9.9</a> Function template <span class='texttt'>async</span> <a class='abbr_ref' href='futures.async'>[futures.async]</a></h3><div class='para' id='futures.async-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.async-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7042'>#</a></div><div class='texpara'><div id='futures.async-1.sentence-1' class='sentence'>The function template <span class='texttt'>async</span> provides a mechanism to launch a function potentially
in a new thread and provides the result of the function in a <span class='texttt'>future</span> object with which
it shares a shared state<a class='hidden_link' href='#futures.async-1.sentence-1'>.</a></div></div></div><div class='texpara'><div id='lib:async'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:async'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> F, <span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> Args<span class='anglebracket'>&gt;</span>
  <span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> future<span class='anglebracket'>&lt;</span>invoke_result_t<span class='anglebracket'>&lt;</span>decay_t<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span>, decay_t<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span>
    async<span class='parenthesis'>(</span>F<span class='operator'>&amp;</span><span class='operator'>&amp;</span> f, Args<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> args<span class='parenthesis'>)</span>;
<span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> F, <span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> Args<span class='anglebracket'>&gt;</span>
  <span class='squarebracket'>[</span><span class='squarebracket'>[</span>nodiscard<span class='squarebracket'>]</span><span class='squarebracket'>]</span> future<span class='anglebracket'>&lt;</span>invoke_result_t<span class='anglebracket'>&lt;</span>decay_t<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span>, decay_t<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span>
    async<span class='parenthesis'>(</span>launch policy, F<span class='operator'>&amp;</span><span class='operator'>&amp;</span> f, Args<span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> args<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='futures.async-2'><div class='marginalizedparent'><a class='marginalized' href='#futures.async-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7058'>#</a></div><div class='texpara'><div id='futures.async-2.sentence-1' class='sentence'><i >Mandates</i>: The following are all <span class='texttt'><span class='literal'>true</span></span>:
<ul class='itemize'><li id='futures.async-2.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.async-2.1'>(2.1)</a></div><span class='texttt'>is_&shy;constructible_&shy;v<span class='anglebracket'>&lt;</span>decay_&shy;t<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span>, F<span class='anglebracket'>&gt;</span></span>,</li><li id='futures.async-2.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.async-2.2'>(2.2)</a></div><span class='texttt'><span class='parenthesis'>(</span>is_&shy;constructible_&shy;v<span class='anglebracket'>&lt;</span>decay_&shy;t<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span>, Args<span class='anglebracket'>&gt;</span> <span class='operator'>&amp;</span><span class='operator'>&amp;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span></span>, and</li><li id='futures.async-2.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.async-2.3'>(2.3)</a></div><span class='texttt'>is_&shy;invocable_&shy;v<span class='anglebracket'>&lt;</span>decay_&shy;t<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span>, decay_&shy;t<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#futures.async-2.sentence-1'>.</a></li></ul></div></div></div></div><div class='para' id='futures.async-3'><div class='marginalizedparent'><a class='marginalized' href='#futures.async-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7067'>#</a></div><div class='texpara'><div id='futures.async-3.sentence-1' class='sentence'><i >Effects</i>: The first function
behaves the same as a call to the second function with a <span class='texttt'>policy</span> argument of
<span class='texttt'>launch<span class='operator'>&#x200b;::&#x200b;</span>async <span class='operator'>|</span> launch<span class='operator'>&#x200b;::&#x200b;</span>deferred</span>
and the same arguments for <span class='texttt'>F</span> and <span class='texttt'>Args</span><a class='hidden_link' href='#futures.async-3.sentence-1'>.</a></div> <div id='futures.async-3.sentence-2' class='sentence'>The second function creates a shared state that is associated with
the returned <span class='texttt'>future</span> object<a class='hidden_link' href='#futures.async-3.sentence-2'>.</a></div> <div id='futures.async-3.sentence-3' class='sentence'>The further behavior
of the second function depends on the <span class='texttt'>policy</span> argument as follows (if
more than one of these conditions applies, the implementation may choose any of
the corresponding policies):
<ul class='itemize'><li id='futures.async-3.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.async-3.1'>(3.1)</a></div><div class='texpara'><div id='futures.async-3.1.sentence-1' class='sentence'>If <span class='texttt'>launch<span class='operator'>&#x200b;::&#x200b;</span>async</span> is set in <span class='texttt'>policy</span>, calls
<span class='texttt'>invoke<span class='parenthesis'>(</span><i >decay-copy</i><span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>forward<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>f<span class='parenthesis'>)</span><span class='parenthesis'>)</span>,</span>
<span class='texttt'><i >decay-&#x200b;copy</i><span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>forward<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>args<span class='parenthesis'>)</span><span class='parenthesis'>)</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span></span>
(<a href='func.require' title='20.14.4&emsp;Requirements'>[func.<span class='shy'></span>require]</a>, <a href='#thread.constr' title='32.4.3.3&emsp;Constructors'>[thread.<span class='shy'></span>thread.<span class='shy'></span>constr]</a>)
as if in a new thread of execution represented by a <span class='texttt'>thread</span> object
with the calls to <span class='texttt'><i >decay-copy</i></span> being evaluated in the thread that called <span class='texttt'>async</span><a class='hidden_link' href='#futures.async-3.1.sentence-1'>.</a></div> <div id='futures.async-3.1.sentence-2' class='sentence'>Any return value
is stored as the result in the
shared state<a class='hidden_link' href='#futures.async-3.1.sentence-2'>.</a></div> <div id='futures.async-3.1.sentence-3' class='sentence'>Any exception propagated from
the execution of
<span class='texttt'>invoke<span class='parenthesis'>(</span><i >decay-copy</i><span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>forward<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>f<span class='parenthesis'>)</span><span class='parenthesis'>)</span>,
<i >decay-copy</i><span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>forward&#x200b;<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>args<span class='parenthesis'>)</span><span class='parenthesis'>)</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span></span>
is stored as the exceptional result in the shared state<a class='hidden_link' href='#futures.async-3.1.sentence-3'>.</a></div> <div id='futures.async-3.1.sentence-4' class='sentence'>The <span class='texttt'>thread</span> object is
stored in the shared state
and affects the behavior of any asynchronous return objects that
reference that state<a class='hidden_link' href='#futures.async-3.1.sentence-4'>.</a></div></div></li><li id='futures.async-3.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.async-3.2'>(3.2)</a></div><div class='texpara'><div id='futures.async-3.2.sentence-1' class='sentence'>If <span class='texttt'>launch<span class='operator'>&#x200b;::&#x200b;</span>deferred</span> is set in <span class='texttt'>policy</span>,
stores <span class='texttt'><i >decay-copy</i><span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>forward<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>f<span class='parenthesis'>)</span><span class='parenthesis'>)</span></span> and
<span class='texttt'><i >decay-&#x200b;copy</i><span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>forward<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>args<span class='parenthesis'>)</span><span class='parenthesis'>)</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span>
in the shared state<a class='hidden_link' href='#futures.async-3.2.sentence-1'>.</a></div> <div id='futures.async-3.2.sentence-2' class='sentence'>These copies of <span class='texttt'>f</span> and <span class='texttt'>args</span> constitute
a <a class='hidden_link' href='#def:function,deferred' title='32.9.9&emsp;Function template async&emsp;[futures.async]'><span id='def:function,deferred'><i >deferred function</i></span></a><a class='hidden_link' href='#futures.async-3.2.sentence-2'>.</a></div> <div id='futures.async-3.2.sentence-3' class='sentence'>Invocation of the deferred function evaluates
<span class='texttt'>invoke<span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>move<span class='parenthesis'>(</span>g<span class='parenthesis'>)</span>, std<span class='operator'>&#x200b;::&#x200b;</span>move<span class='parenthesis'>(</span>xyz<span class='parenthesis'>)</span><span class='parenthesis'>)</span></span> where <span class='texttt'>g</span> is the stored value of
<span class='texttt'><i >decay-copy</i><span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>forward<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>f<span class='parenthesis'>)</span><span class='parenthesis'>)</span></span> and <span class='texttt'>xyz</span> is the stored copy of
<span class='texttt'><i >decay-copy</i><span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>forward<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>args<span class='parenthesis'>)</span><span class='parenthesis'>)</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span><a class='hidden_link' href='#futures.async-3.2.sentence-3'>.</a></div> <div id='futures.async-3.2.sentence-4' class='sentence'>Any return value is stored
as the result in the shared state<a class='hidden_link' href='#futures.async-3.2.sentence-4'>.</a></div> <div id='futures.async-3.2.sentence-5' class='sentence'>Any exception propagated
from the execution
of the deferred function
is stored as the exceptional result
in the shared state<a class='hidden_link' href='#futures.async-3.2.sentence-5'>.</a></div> <div id='futures.async-3.2.sentence-6' class='sentence'>The shared state is not
made ready until the function has completed<a class='hidden_link' href='#futures.async-3.2.sentence-6'>.</a></div> <div id='futures.async-3.2.sentence-7' class='sentence'>The first call to a
non-timed waiting function (<a href='#futures.state' title='32.9.5&emsp;Shared state'>[futures.<span class='shy'></span>state]</a>)
on an asynchronous return object referring to
this shared state invokes the
deferred function in the thread that called the waiting function<a class='hidden_link' href='#futures.async-3.2.sentence-7'>.</a></div> <div id='futures.async-3.2.sentence-8' class='sentence'>Once evaluation of <span class='texttt'>invoke<span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>move<span class='parenthesis'>(</span>g<span class='parenthesis'>)</span>, std<span class='operator'>&#x200b;::&#x200b;</span>move<span class='parenthesis'>(</span>xyz<span class='parenthesis'>)</span><span class='parenthesis'>)</span></span> begins, the function is no longer
considered deferred<a class='hidden_link' href='#futures.async-3.2.sentence-8'>.</a></div></div><div class='texpara'><div id='futures.async-3.2.sentence-9' class='sentence'><i >Recommended practice</i>: If this policy is specified together with other policies, such as when using a
<span class='texttt'>policy</span> value of <span class='texttt'>launch<span class='operator'>&#x200b;::&#x200b;</span>async <span class='operator'>|</span> launch<span class='operator'>&#x200b;::&#x200b;</span>deferred</span>, implementations should defer
invocation or the selection of the policy when no more concurrency can be effectively
exploited<a class='hidden_link' href='#futures.async-3.2.sentence-9'>.</a></div></div></li><li id='futures.async-3.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.async-3.3'>(3.3)</a></div><div class='texpara'><div id='futures.async-3.3.sentence-1' class='sentence'>If no value is set in the launch policy, or a value is set that is neither specified
in this document nor by the implementation, the behavior is undefined<a class='hidden_link' href='#futures.async-3.3.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='para' id='futures.async-4'><div class='marginalizedparent'><a class='marginalized' href='#futures.async-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7135'>#</a></div><div class='texpara'><div id='futures.async-4.sentence-1' class='sentence'><i >Returns</i>: An object of type
<span class='texttt'>future<span class='anglebracket'>&lt;</span>invoke_&shy;result_&shy;t<span class='anglebracket'>&lt;</span>decay_&shy;t<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span>, decay_&shy;t<span class='anglebracket'>&lt;</span>Args<span class='anglebracket'>&gt;</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span><span class='anglebracket'>&gt;</span></span> that refers
to the shared state created by this call to <span class='texttt'>async</span><a class='hidden_link' href='#futures.async-4.sentence-1'>.</a></div> <div id='futures.async-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#futures.async-note-1'>1</a></i>: <div id='futures.async-4.sentence-2' class='sentence'>If a future obtained from <span class='texttt'>async</span> is moved outside the local scope,
the future's destructor can block for the shared state to become ready<a class='hidden_link' href='#futures.async-4.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='futures.async-5'><div class='marginalizedparent'><a class='marginalized' href='#futures.async-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7145'>#</a></div><div class='texpara'><div id='futures.async-5.sentence-1' class='sentence'><i >Synchronization</i>: The invocation of <span class='texttt'>async</span> synchronizes with the invocation of <span class='texttt'>f</span><a class='hidden_link' href='#futures.async-5.sentence-1'>.</a></div> <div id='futures.async-5.sentence-2' class='sentence'>The completion of the function <span class='texttt'>f</span> is sequenced before
the shared state is made ready<a class='hidden_link' href='#futures.async-5.sentence-2'>.</a></div> <div id='futures.async-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#futures.async-note-2'>2</a></i>: <div id='futures.async-5.sentence-3' class='sentence'>These apply regardless of the provided <span class='texttt'>policy</span> argument, and
even if the corresponding <span class='texttt'>future</span> object is moved to another thread<a class='hidden_link' href='#futures.async-5.sentence-3'>.</a></div> <div id='futures.async-5.sentence-4' class='sentence'>However, it is possible for <span class='texttt'>f</span> not to be called at all,
in which case its completion never happens<a class='hidden_link' href='#futures.async-5.sentence-4'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div><div class='texpara'><div id='futures.async-5.sentence-5' class='sentence'>If the implementation chooses the <span class='texttt'>launch<span class='operator'>&#x200b;::&#x200b;</span>async</span> policy,
<ul class='itemize'><li id='futures.async-5.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.async-5.1'>(5.1)</a></div>a call to a waiting function on an asynchronous return
object that shares the shared state created by this <span class='texttt'>async</span> call shall
block until the associated thread has completed, as if joined, or else time
out (<a href='#thread.member' title='32.4.3.6&emsp;Members'>[thread.<span class='shy'></span>thread.<span class='shy'></span>member]</a>);</li><li id='futures.async-5.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.async-5.2'>(5.2)</a></div>the associated thread completion
<a href='intro.multithread#def:synchronize_with' title='6.9.2&emsp;Multi-threaded executions and data races&emsp;[intro.multithread]'>synchronizes with</a>
the return from
the first function
that successfully detects the ready status of the shared state or
with the return from the last
function that releases the shared state, whichever
happens first<a class='hidden_link' href='#futures.async-5.sentence-5'>.</a></li></ul></div></div></div></div><div class='para' id='futures.async-6'><div class='marginalizedparent'><a class='marginalized' href='#futures.async-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7175'>#</a></div><div class='texpara'><div id='futures.async-6.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>system_&shy;error</span> if <span class='texttt'>policy <span class='operator'>=</span><span class='operator'>=</span> launch<span class='operator'>&#x200b;::&#x200b;</span>async</span> and the
implementation is unable to start a new thread, or
<span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>bad_&shy;alloc</span> if memory for the internal data structures
cannot be allocated<a class='hidden_link' href='#futures.async-6.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.async-7'><div class='marginalizedparent'><a class='marginalized' href='#futures.async-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7182'>#</a></div><div class='texpara'><div id='futures.async-7.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='futures.async-7.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.async-7.1'>(7.1)</a></div><span class='texttt'>resource_&shy;unavailable_&shy;try_&shy;again</span> — if
<span class='texttt'>policy <span class='operator'>=</span><span class='operator'>=</span> launch<span class='operator'>&#x200b;::&#x200b;</span>async</span> and the system is unable to start a new thread<a class='hidden_link' href='#futures.async-7.sentence-1'>.</a></li></ul></div></div></div></div><div class='para nonNormativeOnly' id='futures.async-8'><div class='marginalizedparent'><a class='marginalized' href='#futures.async-8'>8</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7190'>#</a></div><div class='texpara'><div id='futures.async-example-1' class='example'><div class='texpara'>[<i>Example&nbsp;<a href='#futures.async-example-1'>1</a></i>: <span class='codeblock'><span class='keyword'>int</span> work1<span class='parenthesis'>(</span><span class='keyword'>int</span> value<span class='parenthesis'>)</span>;
<span class='keyword'>int</span> work2<span class='parenthesis'>(</span><span class='keyword'>int</span> value<span class='parenthesis'>)</span>;
<span class='keyword'>int</span> work<span class='parenthesis'>(</span><span class='keyword'>int</span> value<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>auto</span> handle <span class='operator'>=</span> std<span class='operator'>::</span>async<span class='parenthesis'>(</span><span class='squarebracket'>[</span><span class='operator'>=</span><span class='squarebracket'>]</span><span class='curlybracket'>{</span> <span class='keyword'>return</span> work2<span class='parenthesis'>(</span>value<span class='parenthesis'>)</span>; <span class='curlybracket'>}</span><span class='parenthesis'>)</span>;
  <span class='keyword'>int</span> tmp <span class='operator'>=</span> work1<span class='parenthesis'>(</span>value<span class='parenthesis'>)</span>;
  <span class='keyword'>return</span> tmp <span class='operator'>+</span> handle<span class='operator'>.</span>get<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;    <span class='comment'>// #1</span>
<span class='curlybracket'>}</span>
</span></div><div class='texpara'><div id='futures.async-note-3' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#futures.async-note-3'>3</a></i>: <div id='futures.async-8.sentence-1' class='sentence'>Line #1 might not result in concurrency because
the <span class='texttt'>async</span> call uses the default policy, which might use
<span class='texttt'>launch<span class='operator'>&#x200b;::&#x200b;</span>deferred</span>, in which case the lambda might not be invoked until the
<span class='texttt'>get<span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> call; in that case, <span class='texttt'>work1</span> and <span class='texttt'>work2</span> are called on the
same thread and there is no concurrency<a class='hidden_link' href='#futures.async-8.sentence-1'>.</a></div> —&nbsp;<i>end note</i>]</div></div> —&nbsp;<i>end example</i>]</div></div></div></div></div><div id='futures.task' class='section'><h3 ><a class='secnum' href='#futures.task' style='min-width:80pt'>32.9.10</a> Class template <span class='texttt'>packaged_&shy;task</span> <a class='abbr_ref' href='futures.task'>[futures.task]</a></h3><div id='futures.task.general' class='section'><h4 ><a class='secnum' href='#futures.task.general' style='min-width:95pt'>32.9.10.1</a> General <a class='abbr_ref' href='futures.task.general'>[futures.task.general]</a></h4><div class='para' id='futures.task.general-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.general-1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7215'>#</a></div><div class='texpara'><div id='futures.task.general-1.sentence-1' class='sentence'>The class template <span class='texttt'>packaged_&shy;task</span> defines a type for wrapping a function or
callable object so that the return value of the function or callable object is stored in
a future when it is invoked<a class='hidden_link' href='#futures.task.general-1.sentence-1'>.</a></div></div></div><div class='para' id='futures.task.general-2'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.general-2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7220'>#</a></div><div class='texpara'><div id='futures.task.general-2.sentence-1' class='sentence'>When the <span class='texttt'>packaged_&shy;task</span> object is invoked, its stored task is invoked and the
result (whether normal or exceptional) stored in the shared state<a class='hidden_link' href='#futures.task.general-2.sentence-1'>.</a></div> <div id='futures.task.general-2.sentence-2' class='sentence'>Any futures that
share the shared state will then be able to access the stored result<a class='hidden_link' href='#futures.task.general-2.sentence-2'>.</a></div></div><div class='texpara'><span id='lib:packaged_task'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:packaged_task'>🔗</a></div><span class='codeblock'><span class='keyword'>namespace</span> std <span class='curlybracket'>{</span>
  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span><span class='anglebracket'>&gt;</span> <span class='keyword'>class</span> packaged_task;  <span class='comment'>// <i >not defined</i></span>

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> R, <span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> ArgTypes<span class='anglebracket'>&gt;</span>
  <span class='keyword'>class</span> packaged_task<span class='anglebracket'>&lt;</span>R<span class='parenthesis'>(</span>ArgTypes<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span> <span class='curlybracket'>{</span>
  <span class='keyword'>public</span><span class='operator'>:</span>
    <span class='comment'>// construction and destruction</span>
    packaged_task<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> F<span class='anglebracket'>&gt;</span>
      <span class='keyword'>explicit</span> packaged_task<span class='parenthesis'>(</span>F<span class='operator'>&amp;</span><span class='operator'>&amp;</span> f<span class='parenthesis'>)</span>;
    <span class='operator'>~</span>packaged_task<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    <span class='comment'>// no copy</span>
    packaged_task<span class='parenthesis'>(</span><span class='keyword'>const</span> packaged_task<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;
    packaged_task<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span><span class='keyword'>const</span> packaged_task<span class='operator'>&amp;</span><span class='parenthesis'>)</span> <span class='operator'>=</span> <span class='keyword'>delete</span>;

    <span class='comment'>// move support</span>
    packaged_task<span class='parenthesis'>(</span>packaged_task<span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    packaged_task<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>packaged_task<span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
    <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>packaged_task<span class='operator'>&amp;</span> other<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;

    <span class='keyword'>bool</span> valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;

    <span class='comment'>// result retrieval</span>
    future<span class='anglebracket'>&lt;</span>R<span class='anglebracket'>&gt;</span> get_future<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;

    <span class='comment'>// execution</span>
    <span class='keyword'>void</span> <span class='keyword'>operator</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span>ArgTypes<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> <span class='parenthesis'>)</span>;
    <span class='keyword'>void</span> make_ready_at_thread_exit<span class='parenthesis'>(</span>ArgTypes<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span>;

    <span class='keyword'>void</span> reset<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
  <span class='curlybracket'>}</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> R, <span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> ArgTypes<span class='anglebracket'>&gt;</span>
    packaged_task<span class='parenthesis'>(</span>R <span class='parenthesis'>(</span><span class='operator'>*</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span>ArgTypes<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> packaged_task<span class='anglebracket'>&lt;</span>R<span class='parenthesis'>(</span>ArgTypes<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span>;

  <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> F<span class='anglebracket'>&gt;</span> packaged_task<span class='parenthesis'>(</span>F<span class='parenthesis'>)</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> packaged_task<span class='anglebracket'>&lt;</span><i ><span class='texttt'>see below</span></i><span class='anglebracket'>&gt;</span>;
<span class='curlybracket'>}</span>
</span></span></div></div></div><div id='futures.task.members' class='section'><h4 ><a class='secnum' href='#futures.task.members' style='min-width:95pt'>32.9.10.2</a> Member functions <a class='abbr_ref' href='futures.task.members'>[futures.task.members]</a></h4><div class='texpara'><div id='lib:packaged_task,constructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:packaged_task,constructor'>🔗</a></div><code class='itemdeclcode'>packaged_task<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='futures.task.members-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7275'>#</a></div><div class='texpara'><div id='futures.task.members-1.sentence-1' class='sentence'><i >Effects</i>: The object has no shared state and no stored task<a class='hidden_link' href='#futures.task.members-1.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:packaged_task,constructor_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:packaged_task,constructor_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> F<span class='anglebracket'>&gt;</span>
  packaged_task<span class='parenthesis'>(</span>F<span class='operator'>&amp;</span><span class='operator'>&amp;</span> f<span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='futures.task.members-2'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-2'>2</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7287'>#</a></div><div class='texpara'><div id='futures.task.members-2.sentence-1' class='sentence'><i >Constraints</i>: <span class='texttt'>remove_&shy;cvref_&shy;t<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span></span>
is not the same type as <span class='texttt'>packaged_&shy;task<span class='anglebracket'>&lt;</span>R<span class='parenthesis'>(</span>ArgTypes<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#futures.task.members-2.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.task.members-3'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-3'>3</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7292'>#</a></div><div class='texpara'><div id='futures.task.members-3.sentence-1' class='sentence'><i >Mandates</i>: <span class='texttt'>is_&shy;invocable_&shy;r_&shy;v<span class='anglebracket'>&lt;</span>R, F<span class='operator'>&amp;</span>, ArgTypes<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='anglebracket'>&gt;</span></span> is <span class='texttt'><span class='literal'>true</span></span><a class='hidden_link' href='#futures.task.members-3.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.task.members-4'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-4'>4</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7296'>#</a></div><div class='texpara'><div id='futures.task.members-4.sentence-1' class='sentence'><i >Preconditions</i>: Invoking a copy of <span class='texttt'>f</span> behaves the same as invoking <span class='texttt'>f</span><a class='hidden_link' href='#futures.task.members-4.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.task.members-5'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-5'>5</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7300'>#</a></div><div class='texpara'><div id='futures.task.members-5.sentence-1' class='sentence'><i >Effects</i>: Constructs a new <span class='texttt'>packaged_&shy;task</span> object with a shared state and
initializes the object's stored task with <span class='texttt'>std<span class='operator'>&#x200b;::&#x200b;</span>forward<span class='anglebracket'>&lt;</span>F<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>f<span class='parenthesis'>)</span></span><a class='hidden_link' href='#futures.task.members-5.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.task.members-6'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-6'>6</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7305'>#</a></div><div class='texpara'><div id='futures.task.members-6.sentence-1' class='sentence'><i >Throws</i>: Any exceptions thrown by the copy or move constructor of <span class='texttt'>f</span>, or
<span class='texttt'>bad_&shy;alloc</span> if memory for the internal data structures
cannot be allocated<a class='hidden_link' href='#futures.task.members-6.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:packaged_task,constructor__'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:packaged_task,constructor__'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> F<span class='anglebracket'>&gt;</span> packaged_task<span class='parenthesis'>(</span>F<span class='parenthesis'>)</span> <span class='operator'>-</span><span class='anglebracket'>&gt;</span> packaged_task<span class='anglebracket'>&lt;</span><i ><span class='texttt'>see below</span></i><span class='anglebracket'>&gt;</span>;
</code></div></div></div><div class='para' id='futures.task.members-7'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-7'>7</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7318'>#</a></div><div class='texpara'><div id='futures.task.members-7.sentence-1' class='sentence'><i >Constraints</i>: <span class='texttt'><span class='operator'>&amp;</span>F<span class='operator'>&#x200b;::&#x200b;</span><span class='keyword'>operator</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> is well-formed when
treated as an unevaluated operand and
<span class='texttt'><span class='keyword'>decltype</span><span class='parenthesis'>(</span>&#x200b;<span class='operator'>&amp;</span>F<span class='operator'>&#x200b;::&#x200b;</span><span class='keyword'>operator</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span></span> is of the form
<span class='texttt'>R<span class='parenthesis'>(</span>G<span class='operator'>&#x200b;::&#x200b;</span><span class='operator'>*</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span>A<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span></span> <span class='mathit'>cv</span> <span class='texttt'><span class='operator'>&amp;</span><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span><span class='operator'> </span><span class='keyword'>noexcept</span><span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-texatom"><span class="mjx-mrow"><span class="mjx-mstyle" style="font-size: 113.1%; color: black;"><span class="mjx-mrow" style="font-size: 88.4%;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.298em;">o</span></span></span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.225em; padding-bottom: 0.446em;">p</span></span><span class="mjx-mi"><span class="mjx-char MJXc-TeX-main-I" style="padding-top: 0.372em; padding-bottom: 0.298em;">t</span></span></span></span></span></span></span></span></span></span>
for a class type <span class='texttt'>G</span><a class='hidden_link' href='#futures.task.members-7.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.task.members-8'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-8'>8</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7326'>#</a></div><div class='texpara'><div id='futures.task.members-8.sentence-1' class='sentence'><i >Remarks</i>: The deduced type is <span class='texttt'>packaged_&shy;task<span class='anglebracket'>&lt;</span>R<span class='parenthesis'>(</span>A<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span></span><a class='hidden_link' href='#futures.task.members-8.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:packaged_task,constructor___'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:packaged_task,constructor___'>🔗</a></div><code class='itemdeclcode'>packaged_task<span class='parenthesis'>(</span>packaged_task<span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div><div class='para' id='futures.task.members-9'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-9'>9</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7337'>#</a></div><div class='texpara'><div id='futures.task.members-9.sentence-1' class='sentence'><i >Effects</i>: Transfers ownership of
<span class='texttt'>rhs</span>'s shared state to <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span>, leaving <span class='texttt'>rhs</span> with no
shared state<a class='hidden_link' href='#futures.task.members-9.sentence-1'>.</a></div> <div id='futures.task.members-9.sentence-2' class='sentence'>Moves the stored task from <span class='texttt'>rhs</span> to <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#futures.task.members-9.sentence-2'>.</a></div></div></div></div><div class='para' id='futures.task.members-10'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-10'>10</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7343'>#</a></div><div class='texpara'><div id='futures.task.members-10.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'>rhs</span> has no shared state<a class='hidden_link' href='#futures.task.members-10.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:packaged_task,operator='><div id='lib:operator=,packaged_task'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:operator=,packaged_task'>🔗</a></div><code class='itemdeclcode'>packaged_task<span class='operator'>&amp;</span> <span class='keyword'>operator</span><span class='operator'>=</span><span class='parenthesis'>(</span>packaged_task<span class='operator'>&amp;</span><span class='operator'>&amp;</span> rhs<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='futures.task.members-11'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-11'>11</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7354'>#</a></div><div class='texpara'><div id='futures.task.members-11.sentence-1' class='sentence'><i >Effects</i>: <ul class='itemize'><li id='futures.task.members-11.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.task.members-11.1'>(11.1)</a></div>Releases any shared state (<a href='#futures.state' title='32.9.5&emsp;Shared state'>[futures.<span class='shy'></span>state]</a>);</li><li id='futures.task.members-11.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.task.members-11.2'>(11.2)</a></div>calls <span class='texttt'>packaged_&shy;task<span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>move<span class='parenthesis'>(</span>rhs<span class='parenthesis'>)</span><span class='parenthesis'>)</span><span class='operator'>.</span>swap<span class='parenthesis'>(</span><span class='operator'>*</span><span class='keyword'>this</span><span class='parenthesis'>)</span></span><a class='hidden_link' href='#futures.task.members-11.sentence-1'>.</a></li></ul></div></div></div></div><div class='texpara'><div id='lib:packaged_task,destructor'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:packaged_task,destructor'>🔗</a></div><code class='itemdeclcode'><span class='operator'>~</span>packaged_task<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div><div class='para' id='futures.task.members-12'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-12'>12</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7370'>#</a></div><div class='texpara'><div id='futures.task.members-12.sentence-1' class='sentence'><i >Effects</i>: Abandons any shared state (<a href='#futures.state' title='32.9.5&emsp;Shared state'>[futures.<span class='shy'></span>state]</a>)<a class='hidden_link' href='#futures.task.members-12.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:packaged_task,swap'><div id='lib:swap,packaged_task'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:swap,packaged_task'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> swap<span class='parenthesis'>(</span>packaged_task<span class='operator'>&amp;</span> other<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='futures.task.members-13'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-13'>13</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7381'>#</a></div><div class='texpara'><div id='futures.task.members-13.sentence-1' class='sentence'><i >Effects</i>: Exchanges the shared states and stored tasks of <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> and <span class='texttt'>other</span><a class='hidden_link' href='#futures.task.members-13.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.task.members-14'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-14'>14</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7385'>#</a></div><div class='texpara'><div id='futures.task.members-14.sentence-1' class='sentence'><i >Postconditions</i>: <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> has the same shared state
and stored task (if any) as <span class='texttt'>other</span>
prior to the call to <span class='texttt'>swap</span><a class='hidden_link' href='#futures.task.members-14.sentence-1'>.</a></div> <div id='futures.task.members-14.sentence-2' class='sentence'><span class='texttt'>other</span> has the same shared state
and stored task (if any)
as <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> prior to the call to <span class='texttt'>swap</span><a class='hidden_link' href='#futures.task.members-14.sentence-2'>.</a></div></div></div></div><div class='texpara'><div id='lib:packaged_task,valid'><div id='lib:valid,packaged_task'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:valid,packaged_task'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>bool</span> valid<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='keyword'>const</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='futures.task.members-15'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-15'>15</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7400'>#</a></div><div class='texpara'><div id='futures.task.members-15.sentence-1' class='sentence'><i >Returns</i>: <span class='texttt'><span class='literal'>true</span></span> only if <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> has a shared state<a class='hidden_link' href='#futures.task.members-15.sentence-1'>.</a></div></div></div></div><div class='texpara'><div id='lib:packaged_task,get_future'><div id='lib:get_future,packaged_task'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:get_future,packaged_task'>🔗</a></div><code class='itemdeclcode'>future<span class='anglebracket'>&lt;</span>R<span class='anglebracket'>&gt;</span> get_future<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='futures.task.members-16'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-16'>16</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7411'>#</a></div><div class='texpara'><div id='futures.task.members-16.sentence-1' class='sentence'><i >Returns</i>: A <span class='texttt'>future</span> object that shares the same shared state as <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#futures.task.members-16.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.task.members-17'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-17'>17</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7415'>#</a></div><div class='texpara'><div id='futures.task.members-17.sentence-1' class='sentence'><i >Synchronization</i>: Calls to this function do not introduce
data races  (<a href='intro.multithread' title='6.9.2&emsp;Multi-threaded executions and data races'>[intro.<span class='shy'></span>multithread]</a>) with calls to
<span class='texttt'><span class='keyword'>operator</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span></span> or
<span class='texttt'>make_&shy;ready_&shy;at_&shy;thread_&shy;exit</span><a class='hidden_link' href='#futures.task.members-17.sentence-1'>.</a></div> <div id='futures.task.members-note-1' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#futures.task.members-note-1'>1</a></i>: <div id='futures.task.members-17.sentence-2' class='sentence'>Such calls need not synchronize with each other<a class='hidden_link' href='#futures.task.members-17.sentence-2'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='futures.task.members-18'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-18'>18</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7425'>#</a></div><div class='texpara'><div id='futures.task.members-18.sentence-1' class='sentence'><i >Throws</i>: A <span class='texttt'>future_&shy;error</span> object if an error occurs<a class='hidden_link' href='#futures.task.members-18.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.task.members-19'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-19'>19</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7429'>#</a></div><div class='texpara'><div id='futures.task.members-19.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='futures.task.members-19.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.task.members-19.1'>(19.1)</a></div><div class='texpara'><div id='futures.task.members-19.1.sentence-1' class='sentence'><span class='texttt'>future_&shy;already_&shy;retrieved</span> if <span class='texttt'>get_&shy;future</span> has already been called on
a <span class='texttt'>packaged_&shy;task</span> object with the same shared state as <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#futures.task.members-19.1.sentence-1'>.</a></div></div></li><li id='futures.task.members-19.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.task.members-19.2'>(19.2)</a></div><div class='texpara'><div id='futures.task.members-19.2.sentence-1' class='sentence'><span class='texttt'>no_&shy;state</span> if <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> has no shared state<a class='hidden_link' href='#futures.task.members-19.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:packaged_task,operator()'><div id='lib:operator(),packaged_task'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:operator(),packaged_task'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> <span class='keyword'>operator</span><span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>(</span>ArgTypes<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> args<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='futures.task.members-20'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-20'>20</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7444'>#</a></div><div class='texpara'><div id='futures.task.members-20.sentence-1' class='sentence'><i >Effects</i>: As if by <span class='texttt'><i >INVOKE</i><span class='anglebracket'>&lt;</span>R<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>f, t<span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span>, t<span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span>, <span class='math'>&hellip;</span>, t<span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.085em;">N</span></span></span></span></span></span></span><span class='parenthesis'>)</span></span> (<a href='func.require' title='20.14.4&emsp;Requirements'>[func.<span class='shy'></span>require]</a>),
where <span class='texttt'>f</span> is the
stored task of <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> and
<span class='texttt'>t<span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span>, t<span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span>, <span class='math'>&hellip;</span>, t<span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.085em;">N</span></span></span></span></span></span></span></span> are the values in <span class='texttt'>args<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span><a class='hidden_link' href='#futures.task.members-20.sentence-1'>.</a></div> <div id='futures.task.members-20.sentence-2' class='sentence'>If the task returns normally,
the return value is stored as the asynchronous result in the shared state of
<span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span>, otherwise the exception thrown by the task is stored<a class='hidden_link' href='#futures.task.members-20.sentence-2'>.</a></div> <div id='futures.task.members-20.sentence-3' class='sentence'>The
shared state of <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> is made ready, and any threads blocked in a
function waiting for
the shared state of <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> to become ready are unblocked<a class='hidden_link' href='#futures.task.members-20.sentence-3'>.</a></div></div></div></div><div class='para' id='futures.task.members-21'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-21'>21</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7456'>#</a></div><div class='texpara'><div id='futures.task.members-21.sentence-1' class='sentence'><i >Throws</i>: A <span class='texttt'>future_&shy;error</span> exception object if there is no shared
state or the stored task has already been invoked<a class='hidden_link' href='#futures.task.members-21.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.task.members-22'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-22'>22</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7461'>#</a></div><div class='texpara'><div id='futures.task.members-22.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='futures.task.members-22.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.task.members-22.1'>(22.1)</a></div><div class='texpara'><div id='futures.task.members-22.1.sentence-1' class='sentence'><span class='texttt'>promise_&shy;already_&shy;satisfied</span> if
the stored task has already been invoked<a class='hidden_link' href='#futures.task.members-22.1.sentence-1'>.</a></div></div></li><li id='futures.task.members-22.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.task.members-22.2'>(22.2)</a></div><div class='texpara'><div id='futures.task.members-22.2.sentence-1' class='sentence'><span class='texttt'>no_&shy;state</span> if <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> has no shared state<a class='hidden_link' href='#futures.task.members-22.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:packaged_task,make_ready_at_thread_exit'><div id='lib:make_ready_at_thread_exit,packaged_task'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:make_ready_at_thread_exit,packaged_task'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> make_ready_at_thread_exit<span class='parenthesis'>(</span>ArgTypes<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> args<span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='futures.task.members-23'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-23'>23</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7476'>#</a></div><div class='texpara'><div id='futures.task.members-23.sentence-1' class='sentence'><i >Effects</i>: As if by <span class='texttt'><i >INVOKE</i><span class='anglebracket'>&lt;</span>R<span class='anglebracket'>&gt;</span><span class='parenthesis'>(</span>f, t<span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span>, t<span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span>, <span class='math'>&hellip;</span>, t<span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.085em;">N</span></span></span></span></span></span></span><span class='parenthesis'>)</span></span> (<a href='func.require' title='20.14.4&emsp;Requirements'>[func.<span class='shy'></span>require]</a>),
where <span class='texttt'>f</span> is the stored task and
<span class='texttt'>t<span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">1</span></span></span></span></span></span></span>, t<span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.372em; padding-bottom: 0.372em;">2</span></span></span></span></span></span></span>, <span class='math'>&hellip;</span>, t<span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow" aria-hidden="true"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char"></span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.446em; padding-bottom: 0.298em; padding-right: 0.085em;">N</span></span></span></span></span></span></span></span> are the values in <span class='texttt'>args<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span></span><a class='hidden_link' href='#futures.task.members-23.sentence-1'>.</a></div> <div id='futures.task.members-23.sentence-2' class='sentence'>If the task returns normally,
the return value is stored as the asynchronous result in the shared state of
<span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span>, otherwise the exception thrown by the task is stored<a class='hidden_link' href='#futures.task.members-23.sentence-2'>.</a></div> <div id='futures.task.members-23.sentence-3' class='sentence'>In either
case, this is done without making that state ready (<a href='#futures.state' title='32.9.5&emsp;Shared state'>[futures.<span class='shy'></span>state]</a>) immediately<a class='hidden_link' href='#futures.task.members-23.sentence-3'>.</a></div> <div id='futures.task.members-23.sentence-4' class='sentence'>Schedules
the shared state to be made ready when the current thread exits,
after all objects of thread storage duration associated with the current thread
have been destroyed<a class='hidden_link' href='#futures.task.members-23.sentence-4'>.</a></div></div></div></div><div class='para' id='futures.task.members-24'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-24'>24</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7488'>#</a></div><div class='texpara'><div id='futures.task.members-24.sentence-1' class='sentence'><i >Throws</i>: <span class='texttt'>future_&shy;error</span> if an error condition occurs<a class='hidden_link' href='#futures.task.members-24.sentence-1'>.</a></div></div></div></div><div class='para' id='futures.task.members-25'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-25'>25</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7492'>#</a></div><div class='texpara'><div id='futures.task.members-25.sentence-1' class='sentence'><i >Error conditions</i>: <ul class='itemize'><li id='futures.task.members-25.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.task.members-25.1'>(25.1)</a></div><div class='texpara'><div id='futures.task.members-25.1.sentence-1' class='sentence'><span class='texttt'>promise_&shy;already_&shy;satisfied</span> if the
stored task has already been invoked<a class='hidden_link' href='#futures.task.members-25.1.sentence-1'>.</a></div></div></li><li id='futures.task.members-25.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.task.members-25.2'>(25.2)</a></div><div class='texpara'><div id='futures.task.members-25.2.sentence-1' class='sentence'><span class='texttt'>no_&shy;state</span> if <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span> has no shared state<a class='hidden_link' href='#futures.task.members-25.2.sentence-1'>.</a></div></div></li></ul></div></div></div></div><div class='texpara'><div id='lib:packaged_task,reset'><div id='lib:reset,packaged_task'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:reset,packaged_task'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>void</span> reset<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
</code></div></div></div></div><div class='para' id='futures.task.members-26'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-26'>26</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7507'>#</a></div><div class='texpara'><div id='futures.task.members-26.sentence-1' class='sentence'><i >Effects</i>: As if <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span> <span class='operator'>=</span> packaged_&shy;task<span class='parenthesis'>(</span>std<span class='operator'>&#x200b;::&#x200b;</span>move<span class='parenthesis'>(</span>f<span class='parenthesis'>)</span><span class='parenthesis'>)</span></span>, where
<span class='texttt'>f</span> is the task stored in
<span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#futures.task.members-26.sentence-1'>.</a></div> <div id='futures.task.members-note-2' class='note'><div class='texpara'>[<i>Note&nbsp;<a href='#futures.task.members-note-2'>2</a></i>: <div id='futures.task.members-26.sentence-2' class='sentence'>This constructs a new shared state for <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span><a class='hidden_link' href='#futures.task.members-26.sentence-2'>.</a></div> <div id='futures.task.members-26.sentence-3' class='sentence'>The
old state is abandoned (<a href='#futures.state' title='32.9.5&emsp;Shared state'>[futures.<span class='shy'></span>state]</a>)<a class='hidden_link' href='#futures.task.members-26.sentence-3'>.</a></div> —&nbsp;<i>end note</i>]</div></div></div></div></div><div class='para' id='futures.task.members-27'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.members-27'>27</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7517'>#</a></div><div class='texpara'><div id='futures.task.members-27.sentence-1' class='sentence'><i >Throws</i>: <ul class='itemize'><li id='futures.task.members-27.1'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.task.members-27.1'>(27.1)</a></div><div class='texpara'><div id='futures.task.members-27.1.sentence-1' class='sentence'><span class='texttt'>bad_&shy;alloc</span> if memory for the new shared state cannot be allocated<a class='hidden_link' href='#futures.task.members-27.1.sentence-1'>.</a></div></div></li><li id='futures.task.members-27.2'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.task.members-27.2'>(27.2)</a></div><div class='texpara'><div id='futures.task.members-27.2.sentence-1' class='sentence'>any exception thrown by the move constructor of the task stored in the shared
state<a class='hidden_link' href='#futures.task.members-27.2.sentence-1'>.</a></div></div></li><li id='futures.task.members-27.3'><div class='marginalizedparent' style='left:-39mm'><a class='marginalized' href='#futures.task.members-27.3'>(27.3)</a></div><div class='texpara'><div id='futures.task.members-27.3.sentence-1' class='sentence'><span class='texttt'>future_&shy;error</span> with an error condition of <span class='texttt'>no_&shy;state</span> if <span class='texttt'><span class='operator'>*</span><span class='keyword'>this</span></span>
has no shared state<a class='hidden_link' href='#futures.task.members-27.3.sentence-1'>.</a></div></div></li></ul></div></div></div></div></div><div id='futures.task.nonmembers' class='section'><h4 ><a class='secnum' href='#futures.task.nonmembers' style='min-width:95pt'>32.9.10.3</a> Globals <a class='abbr_ref' href='futures.task.nonmembers'>[futures.task.nonmembers]</a></h4><div class='texpara'><div id='lib:packaged_task,swap_'><div id='lib:swap,packaged_task_'><div class='itemdecl'><div class='marginalizedparent'><a class='itemDeclLink' href='#lib:swap,packaged_task_'>🔗</a></div><code class='itemdeclcode'><span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>class</span> R, <span class='keyword'>class</span><span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span> ArgTypes<span class='anglebracket'>&gt;</span>
  <span class='keyword'>void</span> swap<span class='parenthesis'>(</span>packaged_task<span class='anglebracket'>&lt;</span>R<span class='parenthesis'>(</span>ArgTypes<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> x, packaged_task<span class='anglebracket'>&lt;</span>R<span class='parenthesis'>(</span>ArgTypes<span class='operator'>.</span><span class='operator'>.</span><span class='operator'>.</span><span class='parenthesis'>)</span><span class='anglebracket'>&gt;</span><span class='operator'>&amp;</span> y<span class='parenthesis'>)</span> <span class='keyword'>noexcept</span>;
</code></div></div></div></div><div class='para' id='futures.task.nonmembers-1'><div class='marginalizedparent'><a class='marginalized' href='#futures.task.nonmembers-1'>1</a></div><div class='itemdescr'><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/7620db718df1ff82c2468b75f3449ced8ad7b716/source/threads.tex#L7537'>#</a></div><div class='texpara'><div id='futures.task.nonmembers-1.sentence-1' class='sentence'><i >Effects</i>: As if by <span class='texttt'>x<span class='operator'>.</span>swap<span class='parenthesis'>(</span>y<span class='parenthesis'>)</span></span><a class='hidden_link' href='#futures.task.nonmembers-1.sentence-1'>.</a></div></div></div></div></div></div></div></div></body></html>