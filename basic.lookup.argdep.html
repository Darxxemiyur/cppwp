<!DOCTYPE html><html lang='en'><head><title>[basic.lookup.argdep]</title><meta charset='UTF-8'/><link rel='stylesheet' type='text/css' href='14882.css'/><link rel='stylesheet' type='text/css' href='expanded.css' title='Notes and examples expanded'/><link rel='alternate stylesheet' type='text/css' href='colored.css' title='Notes and examples colored'/><link rel='icon' href='icon.png'/></head><body><div class='wrapper'><h1 ><a class='secnum' style='min-width:73pt'>6</a> Basics <a class='abbr_ref' href='./#basic'>[basic]</a></h1><h2 ><a class='secnum' style='min-width:88pt'>6.5</a> Name lookup <a class='abbr_ref' href='basic.lookup#argdep'>[basic.lookup]</a></h2><h3 ><a class='secnum' style='min-width:103pt'>6.5.2</a> Argument-dependent name lookup <a class='abbr_ref'>[basic.lookup.argdep]</a></h3><span class='indexparent'><a class='index' id=':lookup,argument-dependent'></a></span><div class='para' id='1'><div class='marginalizedparent'><a class='marginalized' href='#1'>1</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/basic.tex#L1775'>#</a></div><div id='1.sentence-1' class='sentence'>When the <a class='grammarterm' href='expr.post#nt:postfix-expression'>postfix-expression</a> in
a <a href='expr.call'>function call</a> is an <a class='grammarterm' href='expr.prim.id.unqual#nt:unqualified-id'>unqualified-id</a>, other namespaces not considered
during the usual <a href='basic.lookup.unqual'>unqualified lookup</a> may be
searched, and in those namespaces, namespace-scope friend function or
function template declarations (<a href='class.friend'>[class.friend]</a>) not otherwise
visible may be found<a class='hidden_link' href='#1.sentence-1'>.</a></div> <div id='1.sentence-2' class='sentence'>These modifications to the search depend on the types of the arguments
(and for template template arguments, the namespace of the template
argument)<a class='hidden_link' href='#1.sentence-2'>.</a></div> <div id='1.example-1' class='example'>[&nbsp;<a class='example_link' href='#1.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>namespace</span> N <span class='curlybracket'>{</span>
  <span class='keyword'>struct</span> S <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
  <span class='keyword'>void</span> f<span class='parenthesis'>(</span>S<span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>

<span class='keyword'>void</span> g<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  N<span class='operator'>::</span>S s;
  f<span class='parenthesis'>(</span>s<span class='parenthesis'>)</span>;     <span class='comment'>// OK: calls <span class='tcode_in_codeblock'>N&#x200b;::&#x200b;f</span></span>
  <span class='parenthesis'>(</span>f<span class='parenthesis'>)</span><span class='parenthesis'>(</span>s<span class='parenthesis'>)</span>;   <span class='comment'>// error: <span class='tcode_in_codeblock'>N&#x200b;::&#x200b;f</span> not considered; parentheses prevent argument-dependent lookup</span>
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='2'><div class='marginalizedparent'><a class='marginalized' href='#2'>2</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/basic.tex#L1800'>#</a></div><div id='2.sentence-1' class='sentence'>For each argument type <span class='texttt'>T</span> in the function call,
there is a set of zero or more
<a class='hidden_link' href='#def:namespace,associated' id='def:namespace,associated'><i >associated namespaces</i></a>
and a set of zero or more
<a class='hidden_link' href='#def:entity,associated' id='def:entity,associated'><i >associated entities</i></a>
(other than namespaces)
to be considered<a class='hidden_link' href='#2.sentence-1'>.</a></div> <div id='2.sentence-2' class='sentence'>The sets of namespaces and entities
are determined entirely by
the types of the function arguments
(and the namespace of any template template argument)<a class='hidden_link' href='#2.sentence-2'>.</a></div> <div id='2.sentence-3' class='sentence'>Typedef names and <a class='grammarterm' href='namespace.udecl#nt:using-declaration'>using-declaration</a><span class='textit'>s</span>
used to specify the types
do not contribute to this set<a class='hidden_link' href='#2.sentence-3'>.</a></div> <div id='2.sentence-4' class='sentence'>The sets of namespaces and entities
are determined in the following way:
<ul class='itemize'><li id='2.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.1'>(2.1)</a></div>If <span class='texttt'>T</span> is a fundamental type, its associated sets of
namespaces and entities are both empty.</li><li id='2.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.2'>(2.2)</a></div>If <span class='texttt'>T</span> is a class type (including unions),
its associated entities are:
the class itself;
the class of which it is a member, if any;
and its direct and indirect base classes. Its associated namespaces are
the innermost enclosing namespaces of its associated entities. Furthermore, if <span class='texttt'>T</span> is a class template specialization,
its associated namespaces and entities also include:
the namespaces and entities
associated with the types of the template arguments
provided for template type parameters
(excluding template template parameters);
the templates used as template template arguments;
the namespaces of which any template template arguments are members; and the
classes of which any member templates used as template template
arguments are members. <div id='2.2.note-1' class='note'>[&nbsp;<a class='note_link' href='#2.2.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> Non-type template arguments do not
contribute to the set of associated namespaces. —&nbsp;<i>end note</i></div>&nbsp;]</div> </li><li id='2.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.3'>(2.3)</a></div>If <span class='texttt'>T</span> is an enumeration type,
its associated namespace is
the innermost enclosing namespace of its declaration, and
its associated entities are <span class='texttt'>T</span>
and, if it is a class member, the member's class.</li><li id='2.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.4'>(2.4)</a></div>If <span class='texttt'>T</span> is a pointer to <span class='texttt'>U</span> or an array of <span class='texttt'>U</span>,
its associated namespaces and entities are those associated with
<span class='texttt'>U</span>.</li><li id='2.5'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.5'>(2.5)</a></div>If <span class='texttt'>T</span> is a function type, its associated namespaces and
entities are those associated with the function parameter types and those
associated with the return type.</li><li id='2.6'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.6'>(2.6)</a></div>If <span class='texttt'>T</span> is a pointer to a member function of a class
<span class='texttt'>X</span>, its associated namespaces and entities are those associated
with the function parameter types and return type, together with those
associated with <span class='texttt'>X</span>.</li><li id='2.7'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#2.7'>(2.7)</a></div>If <span class='texttt'>T</span> is a pointer to a data member of class <span class='texttt'>X</span>, its
associated namespaces and entities are those associated with the member
type together with those associated with <span class='texttt'>X</span>.</li></ul></div> <div id='2.sentence-5' class='sentence'>
If an associated namespace is an <a href='namespace.def#def:inline_namespace'>inline namespace</a>, its
enclosing namespace is also included in the set<a class='hidden_link' href='#2.sentence-5'>.</a></div> <div id='2.sentence-6' class='sentence'>If an associated namespace
directly contains inline namespaces, those inline namespaces are also included
in the set<a class='hidden_link' href='#2.sentence-6'>.</a></div> <div id='2.sentence-7' class='sentence'>In addition, if the argument is the name or address of an overload set,
its associated entities
and namespaces are the union of those associated with each of the
members of the set, i.e., the entities and namespaces associated with its
parameter types and return type<a class='hidden_link' href='#2.sentence-7'>.</a></div> <div id='2.sentence-8' class='sentence'>Additionally, if the aforementioned overload set is named with
a <a class='grammarterm' href='temp.names#nt:template-id'>template-id</a>, its associated entities and namespaces also include
those of its type <a class='grammarterm' href='temp.names#nt:template-argument'>template-argument</a><span class='textit'>s</span> and its template
<a class='grammarterm' href='temp.names#nt:template-argument'>template-argument</a><span class='textit'>s</span><a class='hidden_link' href='#2.sentence-8'>.</a></div></div><div class='para' id='3'><div class='marginalizedparent'><a class='marginalized' href='#3'>3</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/basic.tex#L1880'>#</a></div><div id='3.sentence-1' class='sentence'>Let <span class='textit'>X</span> be the lookup set produced by <a href='basic.lookup.unqual'>unqualified
lookup</a> and let <span class='textit'>Y</span> be the lookup set produced
by argument dependent lookup (defined as follows)<a class='hidden_link' href='#3.sentence-1'>.</a></div> <div id='3.sentence-2' class='sentence'>If <span class='textit'>X</span> contains
<ul class='itemize'><li id='3.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.1'>(3.1)</a></div>a declaration of a class member, or</li><li id='3.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.2'>(3.2)</a></div>a block-scope function declaration that is not a <a class='grammarterm' href='namespace.udecl#nt:using-declaration'>using-declaration</a>, or</li><li id='3.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#3.3'>(3.3)</a></div>a declaration that is neither a function nor a function template</li></ul>
then <span class='textit'>Y</span> is empty<a class='hidden_link' href='#3.sentence-2'>.</a></div> <div id='3.sentence-3' class='sentence'>Otherwise <span class='textit'>Y</span> is the set of declarations
found in the namespaces associated with the argument types as described
below<a class='hidden_link' href='#3.sentence-3'>.</a></div> <div id='3.sentence-4' class='sentence'>The set of declarations found by the lookup of the name is the
union of <span class='textit'>X</span> and <span class='textit'>Y</span><a class='hidden_link' href='#3.sentence-4'>.</a></div> <div id='3.note-1' class='note'>[&nbsp;<a class='note_link' href='#3.note-1'><span class='textit'>Note</span></a><div class='noteBody'><span class='textit'>:</span> <div id='3.sentence-5' class='sentence'>The namespaces and entities
associated with the argument types can include namespaces and entities
already considered by the ordinary unqualified lookup<a class='hidden_link' href='#3.sentence-5'>.</a></div> —&nbsp;<i>end note</i></div>&nbsp;]</div>  <div id='3.example-1' class='example'>[&nbsp;<a class='example_link' href='#3.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <pre class='codeblock'>
<span class='keyword'>namespace</span> NS <span class='curlybracket'>{</span>
  <span class='keyword'>class</span> T <span class='curlybracket'>{</span> <span class='curlybracket'>}</span>;
  <span class='keyword'>void</span> f<span class='parenthesis'>(</span>T<span class='parenthesis'>)</span>;
  <span class='keyword'>void</span> g<span class='parenthesis'>(</span>T, <span class='keyword'>int</span><span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
NS<span class='operator'>::</span>T parm;
<span class='keyword'>void</span> g<span class='parenthesis'>(</span>NS<span class='operator'>::</span>T, <span class='keyword'>float</span><span class='parenthesis'>)</span>;
<span class='keyword'>int</span> main<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  f<span class='parenthesis'>(</span>parm<span class='parenthesis'>)</span>;                      <span class='comment'>// OK: calls <span class='tcode_in_codeblock'>NS&#x200b;::&#x200b;f</span></span>
  <span class='keyword'>extern</span> <span class='keyword'>void</span> g<span class='parenthesis'>(</span>NS<span class='operator'>::</span>T, <span class='keyword'>float</span><span class='parenthesis'>)</span>;
  g<span class='parenthesis'>(</span>parm, <span class='literal'>1</span><span class='parenthesis'>)</span>;                   <span class='comment'>// OK: calls <span class='tcode_in_codeblock'>g(NS&#x200b;::&#x200b;T, float)</span></span>
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div><div class='para' id='4'><div class='marginalizedparent'><a class='marginalized' href='#4'>4</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/basic.tex#L1915'>#</a></div><div id='4.sentence-1' class='sentence'>When considering an associated namespace <span class='texttt'>N</span>,
the lookup is the same as the
lookup performed when <span class='texttt'>N</span>
is used as a qualifier (<a href='namespace.qual'>[namespace.qual]</a>)
except that:
<ul class='itemize'><li id='4.1'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.1'>(4.1)</a></div>Any <a class='grammarterm' href='namespace.udir#nt:using-directive'>using-directive</a><span class='textit'>s</span> in <span class='texttt'>N</span> are ignored.</li><li id='4.2'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.2'>(4.2)</a></div>All names except those of (possibly overloaded) functions and
function templates are ignored.</li><li id='4.3'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.3'>(4.3)</a></div>Any namespace-scope friend functions or friend function templates (<a href='class.friend'>[class.friend]</a>)
declared in classes with reachable definitions in the set of associated entities
are visible within their respective
namespaces even if they are not visible during an ordinary
lookup (<a href='namespace.memdef'>[namespace.memdef]</a>).</li><li id='4.4'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.4'>(4.4)</a></div>Any exported declaration <span class='texttt'>D</span> in <span class='texttt'>N</span>
declared within the purview of
a named module <span class='texttt'>M</span> (<a href='module.interface'>[module.interface]</a>)
is visible
if there is an associated entity attached to <span class='texttt'>M</span>
with the same innermost enclosing non-inline namespace as <span class='texttt'>D</span>.</li><li id='4.5'><div class='marginalizedparent' style='left:-7em'><a class='marginalized' href='#4.5'>(4.5)</a></div>If the lookup is for a dependent name (<a href='temp.dep'>[temp.dep]</a>, <a href='temp.dep.candidate'>[temp.dep.candidate]</a>),
any declaration <span class='texttt'>D</span> in <span class='texttt'>N</span>
is visible
if <span class='texttt'>D</span> would be visible to qualified name lookup (<a href='namespace.qual'>[namespace.qual]</a>)
at any point in the instantiation context (<a href='module.context'>[module.context]</a>) of the lookup,
unless <span class='texttt'>D</span> is declared in another translation unit, attached to the global module,
and is either discarded (<a href='module.global.frag'>[module.global.frag]</a>) or has internal linkage.</li></ul></div></div><div class='para' id='5'><div class='marginalizedparent'><a class='marginalized' href='#5'>5</a></div><div class='sourceLinkParent'><a class='sourceLink' href='https://github.com/cplusplus/draft/tree/3a3350ee86fb2dbc86752af66d56102d237d8c4f/source/basic.tex#L1951'>#</a></div><div id='5.example-1' class='example'>[&nbsp;<a class='example_link' href='#5.example-1'><span class='textit'>Example</span></a><div class='exampleBody'><span class='textit'>:</span> <p>Translation unit #1:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> M;
<span class='keyword'>namespace</span> R <span class='curlybracket'>{</span>
  <span class='keyword'>export</span> <span class='keyword'>struct</span> X <span class='curlybracket'>{</span><span class='curlybracket'>}</span>;
  <span class='keyword'>export</span> <span class='keyword'>void</span> f<span class='parenthesis'>(</span>X<span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
<span class='keyword'>namespace</span> S <span class='curlybracket'>{</span>
  <span class='keyword'>export</span> <span class='keyword'>void</span> f<span class='parenthesis'>(</span>R<span class='operator'>::</span>X, R<span class='operator'>::</span>X<span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
</pre><p>Translation unit #2:<pre class='codeblock'>
<span class='keyword'>export</span> <span class='keyword'>module</span> N;
<span class='keyword'>import</span> M;
<span class='keyword'>export</span> R<span class='operator'>::</span>X make<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;
<span class='keyword'>namespace</span> R <span class='curlybracket'>{</span> <span class='keyword'>static</span> <span class='keyword'>int</span> g<span class='parenthesis'>(</span>X<span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>
<span class='keyword'>export</span> <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T, <span class='keyword'>typename</span> U<span class='anglebracket'>&gt;</span> <span class='keyword'>void</span> apply<span class='parenthesis'>(</span>T t, U u<span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  f<span class='parenthesis'>(</span>t, u<span class='parenthesis'>)</span>;
  g<span class='parenthesis'>(</span>t<span class='parenthesis'>)</span>;
<span class='curlybracket'>}</span>
</pre><p>Translation unit #3:<pre class='codeblock'>
<span class='keyword'>module</span> Q;
<span class='keyword'>import</span> N;
<span class='keyword'>namespace</span> S <span class='curlybracket'>{</span>
  <span class='keyword'>struct</span> Z <span class='curlybracket'>{</span> <span class='keyword'>template</span><span class='anglebracket'>&lt;</span><span class='keyword'>typename</span> T<span class='anglebracket'>&gt;</span> <span class='keyword'>operator</span> T<span class='parenthesis'>(</span><span class='parenthesis'>)</span>; <span class='curlybracket'>}</span>;
<span class='curlybracket'>}</span>
<span class='keyword'>void</span> test<span class='parenthesis'>(</span><span class='parenthesis'>)</span> <span class='curlybracket'>{</span>
  <span class='keyword'>auto</span> x <span class='operator'>=</span> make<span class='parenthesis'>(</span><span class='parenthesis'>)</span>;              <span class='comment'>// OK, <span class='tcode_in_codeblock'>decltype(x)</span> is <span class='tcode_in_codeblock'>R&#x200b;::&#x200b;X</span> in module <span class='tcode_in_codeblock'>M</span></span>
  R<span class='operator'>::</span>f<span class='parenthesis'>(</span>x<span class='parenthesis'>)</span>;                      <span class='comment'>// error: <span class='tcode_in_codeblock'>R</span> and <span class='tcode_in_codeblock'>R&#x200b;::&#x200b;f</span> are not visible here</span>
  f<span class='parenthesis'>(</span>x<span class='parenthesis'>)</span>;                         <span class='comment'>// OK, calls <span class='tcode_in_codeblock'>R&#x200b;::&#x200b;f</span> from interface of <span class='tcode_in_codeblock'>M</span></span>
  f<span class='parenthesis'>(</span>x, S<span class='operator'>::</span>Z<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;                 <span class='comment'>// error: <span class='tcode_in_codeblock'>S&#x200b;::&#x200b;f</span> in module <span class='tcode_in_codeblock'>M</span> not considered</span>
                                <span class='comment'>// even though <span class='tcode_in_codeblock'>S</span> is an associated namespace</span>
  apply<span class='parenthesis'>(</span>x, S<span class='operator'>::</span>Z<span class='parenthesis'>(</span><span class='parenthesis'>)</span><span class='parenthesis'>)</span>;             <span class='comment'>// error: <span class='tcode_in_codeblock'>S&#x200b;::&#x200b;f</span> is visible in instantiation context, but</span>
                                <span class='comment'>// <span class='tcode_in_codeblock'>R&#x200b;::&#x200b;g</span> has internal linkage and cannot be used outside TU #2</span>
<span class='curlybracket'>}</span>
</pre> —&nbsp;<i>end example</i></div>&nbsp;]</div> </div></div></body></html>